<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Coupled Drive - NAVITHOR USER INSTRUCTIONS</title>
        <!-- Custom HTML head -->
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">
        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="index.html">Front page</a></li><li class="chapter-item expanded affix "><li class="part-title">Configuration</li><li class="chapter-item expanded "><a href="Installation_NavithorHardwareRequirements.html"><strong aria-hidden="true">1.</strong> System Hardware Requirement Specifications</a></li><li class="chapter-item expanded "><a href="Installation_SQLServerAndDatabaseInstallationGuide.html"><strong aria-hidden="true">2.</strong> Configuring database</a></li><li class="chapter-item expanded "><a href="fleetSim.html"><strong aria-hidden="true">3.</strong> Fleet Simulator - Setup and Configuration</a></li><li class="chapter-item expanded "><a href="Installation_NavithorServerAsAService.html"><strong aria-hidden="true">4.</strong> Server as a service</a></li><li class="chapter-item expanded "><a href="Installation_ConfiguringHotSwap.html"><strong aria-hidden="true">5.</strong> Server Hot Swap with Failover Cluster</a></li><li class="chapter-item expanded "><a href="Installation_RebrandingNavithor.html"><strong aria-hidden="true">6.</strong> Server and Client Rebranding</a></li><li class="chapter-item expanded "><a href="Machinetool.html"><strong aria-hidden="true">7.</strong> Machine Tool</a></li><li class="chapter-item expanded "><a href="MesTester3.html"><strong aria-hidden="true">8.</strong> MES Tester</a></li><li class="chapter-item expanded affix "><li class="part-title">Desktop client</li><li class="chapter-item expanded "><a href="navithorServerAndClientMegaDocument.html"><strong aria-hidden="true">9.</strong> System Overview and user instructions for Client UI</a></li><li class="chapter-item expanded "><a href="Feature_ClientUpdater.html"><strong aria-hidden="true">10.</strong> Client Updater</a></li><li class="chapter-item expanded affix "><li class="part-title">Web client</li><li class="chapter-item expanded "><a href="Installation_SettingUpNavithorWebServer.html"><strong aria-hidden="true">11.</strong> Setting up Web server to enable Web client</a></li><li class="chapter-item expanded "><a href="webClient.html"><strong aria-hidden="true">12.</strong> Web Client - User Instructions</a></li><li class="chapter-item expanded affix "><li class="part-title">Guides</li><li class="chapter-item expanded "><a href="bestProductionPractices.html"><strong aria-hidden="true">13.</strong> Best Practices for Creating Production Area</a></li><li class="chapter-item expanded affix "><li class="part-title">Logs</li><li class="chapter-item expanded "><a href="Navithor logs.html"><strong aria-hidden="true">14.</strong> Navithor Logs</a></li><li class="chapter-item expanded "><a href="Feature_VisualReplay.html"><strong aria-hidden="true">15.</strong> Visual Replay</a></li><li class="chapter-item expanded "><a href="Feature_DownloadManager.html"><strong aria-hidden="true">16.</strong> Log Download Manager</a></li><li class="chapter-item expanded affix "><li class="part-title">Users</li><li class="chapter-item expanded "><a href="Installation_UsingActiveDirectoryForAuthentication.html"><strong aria-hidden="true">17.</strong> User authentication against Active Directory</a></li><li class="chapter-item expanded "><a href="userRoles.html"><strong aria-hidden="true">18.</strong> User Management</a></li><li class="chapter-item expanded "><a href="userRolesRightsMatrix.html"><strong aria-hidden="true">19.</strong> Default User roles and User rights matrix</a></li><li class="chapter-item expanded affix "><li class="part-title">Features</li><li class="chapter-item expanded "><a href="symbolicPointGroups.html"><strong aria-hidden="true">20.</strong> Symbolic Point Groups</a></li><li class="chapter-item expanded "><a href="ResourceHandling.html"><strong aria-hidden="true">21.</strong> Resource handling</a></li><li class="chapter-item expanded "><a href="hold-release.html"><strong aria-hidden="true">22.</strong> Hold-Release reasoning and production order lists</a></li><li class="chapter-item expanded "><a href="transfer requests.html"><strong aria-hidden="true">23.</strong> Transfer requests</a></li><li class="chapter-item expanded "><a href="racking.html"><strong aria-hidden="true">24.</strong> Using warehouse racking feature</a></li><li class="chapter-item expanded "><a href="bufferLanes.html"><strong aria-hidden="true">25.</strong> Using Buffer Lanes</a></li><li class="chapter-item expanded "><a href="Feature_ChargingManagement.html"><strong aria-hidden="true">26.</strong> Managing Battery Levels</a></li><li class="chapter-item expanded "><a href="oneMachineZones.html"><strong aria-hidden="true">27.</strong> Using One Machine Zones</a></li><li class="chapter-item expanded "><a href="distanceControlZones.html"><strong aria-hidden="true">28.</strong> Distance Control Zones</a></li><li class="chapter-item expanded "><a href="FireAlarmZones.html"><strong aria-hidden="true">29.</strong> Fire Alarm Zones</a></li><li class="chapter-item expanded "><a href="Zone status use cases.html"><strong aria-hidden="true">30.</strong> Zone status use cases</a></li><li class="chapter-item expanded "><a href="tagStatuses.html"><strong aria-hidden="true">31.</strong> Tag Statuses</a></li><li class="chapter-item expanded "><a href="Trafficlights.html"><strong aria-hidden="true">32.</strong> Traffic Lights</a></li><li class="chapter-item expanded "><a href="Feature_Elevators.html"><strong aria-hidden="true">33.</strong> Elevators</a></li><li class="chapter-item expanded "><a href="ProductionBreak.html"><strong aria-hidden="true">34.</strong> Production Break</a></li><li class="chapter-item expanded "><a href="DynamicSafetyBounds.html"><strong aria-hidden="true">35.</strong> Virtual Dynamic Safety Bounds</a></li><li class="chapter-item expanded "><a href="WaitingSlots.html"><strong aria-hidden="true">36.</strong> Wait Queue Locations</a></li><li class="chapter-item expanded "><a href="CoupledDrive.html" class="active"><strong aria-hidden="true">37.</strong> Coupled Drive</a></li><li class="chapter-item expanded "><a href="Feature_StoppingPointOffsetsForSymbolicPoints.html"><strong aria-hidden="true">38.</strong> Stopping Point Offsets</a></li><li class="chapter-item expanded "><a href="TCStopPoint.html"><strong aria-hidden="true">39.</strong> Safe stopping point calculation</a></li><li class="chapter-item expanded "><a href="Navithor statistics.html"><strong aria-hidden="true">40.</strong> System Statistics</a></li><li class="chapter-item expanded "><a href="MachineInterfaces.html"><strong aria-hidden="true">41.</strong> Machine Interfaces</a></li><li class="chapter-item expanded affix "><li class="part-title">Interfaces</li><li class="chapter-item expanded "><a href="Communication specification between Navithor and MES.html"><strong aria-hidden="true">42.</strong> MES Interface</a></li><li class="chapter-item expanded "><a href="NavithorHttpApi.html"><strong aria-hidden="true">43.</strong> HTTP API</a></li><li class="chapter-item expanded "><a href="NavithorWebApi.html"><strong aria-hidden="true">44.</strong> WebSocket API</a></li><li class="chapter-item expanded "><a href="opcuadoc.html"><strong aria-hidden="true">45.</strong> OPC UA Server interface</a></li><li class="chapter-item expanded affix "><li class="part-title">Alarms</li><li class="chapter-item expanded "><a href="Fleet Control Alarms.html"><strong aria-hidden="true">46.</strong> Alarms</a></li><li class="chapter-item expanded "><a href="Alarms configuration override.html"><strong aria-hidden="true">47.</strong> Alarms configuration override</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="dark">Dark</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">NAVITHOR USER INSTRUCTIONS</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="coupled-drive"><a class="header" href="#coupled-drive">Coupled Drive</a></h1>
<p>This document contains information on how to use the Coupled Drive feature with Navithor Fleet Control.</p>
<p>Updated 31.01.2022</p>
<h2 id="version-history"><a class="header" href="#version-history">Version History</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Version</th><th>Date</th><th>Author</th><th>Change</th></tr></thead><tbody>
<tr><td>1.0</td><td>18.12.2020</td><td>Albert Georgs</td><td>Document created.</td></tr>
<tr><td>1.1</td><td>07.01.2021</td><td>Albert Georgs</td><td>Tools section updated.</td></tr>
<tr><td>1.2</td><td>05.02.2021</td><td>Aleksi Ålander</td><td>Document updated to reflect current fleet control.</td></tr>
<tr><td>1.3</td><td>14.05.2021</td><td>Aleksi Ålander</td><td>Small updates to document.</td></tr>
<tr><td>1.4</td><td>09.11.2021</td><td>Aleksi Ålander</td><td>Converted to markdown format and updated some images.</td></tr>
<tr><td>1.5</td><td>16.11.2021</td><td>Toni Liski</td><td>Update picture of manual coupling form and automatic recovery tool</td></tr>
<tr><td>1.6</td><td>31.01.2022</td><td>Aleksi Ålander</td><td>Updated document according to modified logic that does not require hold rule in coupling points.</td></tr>
</tbody></table>
</div>
<hr />
<h2 id="overview"><a class="header" href="#overview">Overview</a></h2>
<p>In Coupled Drive multiple AGVs are docked into a combined formation and controlled synchronously. The main purpose is to transport loads that are too large for a single AGV to carry. The synchronous driving is controlled by Navitrol and can be used as a stand-alone feature, but it is also possible to use Navithor Fleet Control to handle the production order logic for bigger fleets. The user always needs to define the routes for the AGVs to drive in Navithor Tools.</p>
<p>In Navithor Tools and Navithor Fleet Control, the coupled drive logic is based on having a separate coupled drive machine type. This allows handling the coupled (driven in coupled mode) and single (normal routes driven by single AGVs) routes differently, from allowed lane directions to calculating segment overlaps.</p>
<h2 id="definitions"><a class="header" href="#definitions">Definitions</a></h2>
<p><img src="./Images/CoupledDrive/CoupledDrive_Definitions.png" alt="Coupled drive definitions" /> </p>
<blockquote>
<p>Figure 1: Coupled drive definitions.</p>
</blockquote>
<p>The coupling point is referred to as <strong>SPconn</strong>. This is defined as the navigation point of the coupled machine type and is visualized as the red circle in the figure above. The single machine coupling points are referred to as <strong>SP</strong>. These are the stopping points of the single AGV used to form the coupling formation. The white arrow shows the formation heading of the coupled machine type, this corresponds to the positive default driving direction (positive X-axis when defining the machine type parameters).</p>
<h2 id="machine-type-parameters"><a class="header" href="#machine-type-parameters">Machine type parameters</a></h2>
<p>The positions of the symbolic points in relation to the SPconn are essential in order for the coupling logic to work, which is why the coupled machine type requires specifying these positions explicitly. This is done by adding the following elements to the <em>machine type parameter .xml file</em>.</p>
<pre><code class="language-xml">  &lt;CoupledDrive SingleMachineTypeID=&quot;10012&quot;&gt;
	&lt;SP Index=&quot;0&quot;&gt;
		&lt;OffsetX&gt;0&lt;/OffsetX&gt;
		&lt;OffsetY&gt;1.2&lt;/OffsetY&gt;
	&lt;/SP&gt;
	&lt;SP Index=&quot;1&quot;&gt;
		&lt;OffsetX&gt;0&lt;/OffsetX&gt;
		&lt;OffsetY&gt;-1.2&lt;/OffsetY&gt;
	&lt;/SP&gt;
	&lt;SP Index=&quot;2&quot;&gt;
		&lt;OffsetX&gt;0&lt;/OffsetX&gt;
		&lt;OffsetY&gt;-2.4&lt;/OffsetY&gt;
	&lt;/SP&gt;
  &lt;/CoupledDrive&gt;
</code></pre>
<blockquote>
<p>Figure 2: Coupled drive element specifying coupling point positions.</p>
</blockquote>
<p>The positive X-axis is the forward drive direction of the AGV. The large load carried whilst in coupled mode should also be specified in this coupled machine type parameter file. The machine type dimensions should also be edited to reflect the dimensions of the load that is to be carried.</p>
<p>The coupled drive machine type kinematic model needs to be defined as omni (=3).</p>
<pre><code class="language-xml">&lt;KINEMATIC_MODEL&gt;3&lt;/KINEMATIC_MODEL&gt;
</code></pre>
<blockquote>
<p>Figure 3: Machine type parameter file - kinematic model defined as omni.</p>
</blockquote>
<h3 id="singlemachinetypeid"><a class="header" href="#singlemachinetypeid">SingleMachineTypeID</a></h3>
<p>The coupled drive machine type needs to have a machine type ID corresponding to the single AGVs that are going to be used to dock into the coupled drive. This ID is defined as above for the whole section of the defined coupling points in the machine type parameter file. The routes drawn to the docking positions will only be enabled for this machine type and cannot be edited while having any other machine type selected. As the single machine type used for docking is defined as a separate machine type, it needs to have a unique <em>Machine type ID</em> and <em>Machine type name.</em> The single machine type also needs to be defined as omni.</p>
<h3 id="sp"><a class="header" href="#sp">SP</a></h3>
<p>The SP element defines the X and Y offsets of the single machine coupling points with respect to the SPconn. The <em><strong>Index</strong></em> attribute can be freely assigned by the user, this is then used to differentiate between the different Symbolic points in Navithor.</p>
<p>The offsets indirectly define the formation heading of the coupled machine type. It is recommended that the offsets are defined in such a way that when entering/leaving coupling points, no frame heading changes need to be done in Navithor Tools.</p>
<h3 id="resource-and-machine-dimensions"><a class="header" href="#resource-and-machine-dimensions">Resource and machine dimensions</a></h3>
<p>For each resource that has different dimensions, there has to be a separate coupled drive machine type parameter file included in the Navithor Tools project. For example, if the project has two different large resources with different dimensions, the project needs to have the single machine type parameter file and in addition two machine type parameter files for the two coupled drive formations like shown below in the figure.</p>
<p><img src="./Images/CoupledDrive/CoupledDrive_MachineTypes.png" alt="" /></p>
<blockquote>
<p>Figure 4: Navithor Tools project should have machine types for all different coupled drive formations.</p>
</blockquote>
<p>The coupled drive machine types should use the resource dimensions as the machine dimensions, so that the segment overlaps will be calculated correctly in the fleet control while moving the large resources. For a resource with dimensions of 8 meters long and 3 meters wide the machine dimensions could be set as shown in the figure below.</p>
<p><img src="./Images/CoupledDrive/CoupledDrive_Dimensions.png" alt="" /></p>
<blockquote>
<p>Figure 5: Coupled machine type visualized in Machine Tool.</p>
</blockquote>
<h2 id="drawing-coupled-routes"><a class="header" href="#drawing-coupled-routes">Drawing coupled routes</a></h2>
<p>When a coupled machine type has been added to a Navithor Tools project, coupled routes can be drawn. It is also recommended that the single machine type specified in the coupled machine type parameter file be added to the project before starting to work on the routes or environment.</p>
<p><em>Coupled routes</em> can be drawn by activating the coupled machine type. To create a <em>coupled docking point</em> (a location at which the single machine types are to enter/exit coupled mode, i.e. load/unload the large resource), press the <em><strong>C-key</strong></em> while editing routes. This will automatically calculate the position of the single machine types relative to the center point of the load based on the values specified in the machine type parameter file.</p>
<p><img src="./Images/CoupledDrive/CoupledDrive_DrawingRoutes.png" alt="Drawing coupled routes" /></p>
<blockquote>
<p>Figure 6: Coupled route drawing in Navithor Tools.</p>
</blockquote>
<p>The red arrow always shows the expected formation heading of the coupled route at the SPconns. Docking points should only be added at locations where the coupled drive starts/ends and coupled drive routes should <strong>always</strong> start and end in these points.</p>
<p><img src="./Images/CoupledDrive/CoupledDrive_CoupledRoute.png" alt="Coupled route" /></p>
<blockquote>
<p>Figure 7: Coupled drive route.</p>
</blockquote>
<p>The coupled drive routes and SPconn can only be edited when having the corresponding coupled drive machine type selected. These are disabled for all other machine types in the project. When rotating the SPconn, the single machine docking points are automatically rotated accordingly. These can not be moved independently, but are always moved by moving the SPconn.</p>
<p>SPconns can also be defined as pivot points to enable drawing routes in any direction, but in that case it is up to the user to make sure the frame headings are correct. It is recommended to avoid this as the position of the SPs can be changed depending on how the user wants to define the formation heading of the coupled machine type.</p>
<h2 id="drawing-single-routes"><a class="header" href="#drawing-single-routes">Drawing single routes</a></h2>
<p>Single routes are effectively normal routes for normal AGV with the exception that if connected to a coupled drive docking point, the connected route will be enabled only for the machine type specified in the corresponding coupled machine type parameter file. The same way as coupled routes cannot be edited with any other machine type than the corresponding coupled machine type, these routes can only be created/edited with the correct single machine type.</p>
<p><img src="./Images/CoupledDrive/CoupledDrive_DrawingSingleRoutes.png" alt="Drawing single routes" /></p>
<blockquote>
<p>Figure 8: Drawing single routes.</p>
</blockquote>
<p>Single routes can be drawn in any direction from the SP coupling location node. Since this is designed to be highly customizable, it is the responsibility of the user to make sure that the frame headings of the routes are correct.</p>
<h2 id="generating-environment"><a class="header" href="#generating-environment">Generating environment</a></h2>
<p>Since the coupled machine type isn’t an actual physical AGV type, it should have the same environment points as the single machine type. This is not required for navigation or positioning, that is still handled by the separately controlled single machine types in Navitrol, but rather to avoid changing the file handling since the coupled machine type is regarded a separate machine type in both Navithor Tools and Navithor.</p>
<p>When creating environment points for either the coupled machine type or the specified single machine type connected to the coupled type, environment points will be created for both machine types. The same applies for removing environment points, if removed from one machine type, the same points are removed from the connected coupled drive machine type too. This way we can make sure that the environment points are always identical between coupled machine types and connected single machine types and do not need to take this into consideration in the file upload phase.</p>
<h2 id="uploading-files"><a class="header" href="#uploading-files">Uploading files</a></h2>
<p>When uploading the route and environment files to Navithor or Navitrol, the coupled machine type files will be handled slightly differently than normal. The segment file for the coupled machine type will be named <em>segCD_.xml</em> differing from the normal <em>seg_.xml.</em> This is to enable changing the active segment file dynamically when entering/exiting coupled mode. The environment file is handled exactly the same way as for normal production areas.</p>
<p>When uploading to Navithor, Navithor will handle passing the files to Navitrol, but if uploading directly to a Navitrol client, both segment files (the <em>segCD_.xml</em> and <em>seg_.xml</em>) will both be uploaded to the same client.</p>
<h2 id="configuring-the-coupling-points-for-navithor-fleet-control"><a class="header" href="#configuring-the-coupling-points-for-navithor-fleet-control">Configuring the coupling points for Navithor Fleet Control</a></h2>
<p>If Coupled Drive is used as a stand-alone Navitrol feature, the rest of the chapters can be ignored.</p>
<p>Coupling points are the symbolic points that single machines are going to drive into to wait for the coupling command. Machines will wait at these points until all machines have arrived.
The coupling points can be defined either as Stop, WaitLoad or LoadUnload symbolic points depending on the needs of the production flow. If the same symbolic points are used also as load locations for single machines, they should be LoadUnload type. Otherwise either Stop or WaitLoad should work fine.</p>
<p>If the location is not WaitLoad, the automatically created production order to drive the AGV to the coupling point will stay active until the coupling has been done to ensure that the AGV will stay at the location until all AGVs have arrived.
If the location is defined as WaitLoad, the production order is completed as soon as the machine arrives at the location and AGV can also assign other valid unhandled orders, if it has to still wait for other AGVs to arrive in their coupling points. To make sure the AGV reserved for coupling do not drive away, it makes sense to define the coupling points either as Stop or LoadUnload symbolic points.</p>
<p>Starting from Navithor version 2.50.0.0, the coupling points do not need to be WaitLoad symbolic points or have anymore the Hold rule enabled. Earlier version of Navithor required one of these conditions to be applied for the automatic logic to work correctly for Coupled Drive.</p>
<h2 id="configuring-navithor-fleet-control"><a class="header" href="#configuring-navithor-fleet-control">Configuring Navithor Fleet Control</a></h2>
<p>The Coupled Drive feature is developed in a way, that it does not require special configuring in the Navithor Fleet Control. The important aspects of configuring the system are done in Navithor Tools and the synchronous driving is handled by Navitrol. Fleet Control is responsible for:</p>
<ol>
<li>Detecting a Transfer Request that includes a resource, that can be carried only in a Coupled Drive formation.</li>
<li>Assigning and driving the machines that will be in Couple Drive formation to the correct coupling points with Location Requests.</li>
<li>Driving the machines to coupling points is done with a production order that is generated by the Location Request. The production order has only the coupling point as a target location.</li>
<li>Waiting for all machines to arrive at coupling points before continuing with the coupling. The production order for each AGV stays active and in Executing state until the coupling has been successfully done.</li>
<li>Commanding the Leader and Followers to couple and wait for the respond.</li>
<li>Switching the Leader machine from single machine type into the coupled drive machine type.</li>
<li>Commanding the Leader to load the resource.</li>
<li>Driving the formation to the target location.</li>
<li>Commanding the Leader to unload the resource.</li>
<li>After unloading is complete, commanding the Leader and Followers to decouple.</li>
<li>Switching machines back into single machines and continuing production normally.</li>
</ol>
<p>It is enough to define the single machines in the Navithor Client Settings, even though the coupled drive machine types also exist in the system. Changing machine type into the coupled drive is done automatically by the system.</p>
<p><img src="./Images/CoupledDrive/CoupledDrive_MachinesDefined.png" alt="" /></p>
<blockquote>
<p>Figure 9: Only single machines need to be configured in Navithor Fleet Control.</p>
</blockquote>
<p>It is important to note though, that the active area files need to include the coupled machine type and the segment files linked to this coupled machine <em>SegCD_*</em>. When the files are uploaded with Navithor Tools and user decides to take the files into use, they are correctly activated. You can also check in Navithor Client which files are currently active.</p>
<p><img src="./Images/CoupledDrive/CoupledDrive_ActiveAreaFiles.png" alt="" /></p>
<blockquote>
<p>Figure 10: Active area files in a system with three different coupled drive machines.</p>
</blockquote>
<h2 id="coupled-drive-production"><a class="header" href="#coupled-drive-production">Coupled Drive Production</a></h2>
<p>Production should be triggered with the standard <strong>TransferRequest</strong> (ID = 21) message via MES Interface.</p>
<p>Running automatic production without Transfer Request is not supported. Triggering an unhandled order with request pick up alone is not enough.</p>
<p>To test the system, Transfer Request can be triggered manually through inventory form in Navithor Client or through Orders tab in Web Client. Check Navithor Client and Web Client documentation to read more about these options.</p>
<p>The pickup symbolic point should be in coupled drive production the LoadUnload symbolic point in the beginning of the coupled drive machine type routes and the target symbolic point should be the LoadUnload symbolic point in the end of the route network.</p>
<p><img src="./Images/CoupledDrive/CoupledDrive_ProductionLocations.png" alt="" /></p>
<blockquote>
<p>Figure 11: Simple example of pickup and target locations for coupled drive.</p>
</blockquote>
<p>In the figure above, the system would transfer a resource from symbolic point (9) to (31). In addition to the TransferRequest message, the resource should be set to the Pickup location via MES Interface either with <strong>SetStatusAtSymbolicPoint</strong> (ID = 20) or <strong>SetResourcesAtLocation</strong> (ID = 32) message, when it is available for transfer. For manual testing the resource can be set through the Navithor or Web Client.</p>
<p>When the resource is available at the pickup location and the Transfer Request has been given to the system, Navithor will assign machines for the coupled drive formation and drive the selected machines with drive orders to the pickup locations. If there are not enough machines available to fill all coupling points, the machines already available will be reserved and driven to the locations to wait for remaining coupling points to be filled. </p>
<p><img src="./Images/CoupledDrive/CoupledDrive_DrivingToCouplingPoints.png" alt="" /></p>
<blockquote>
<p>Figure 12: Fleet control is driving the machines to the coupling points.</p>
</blockquote>
<p>The production order to drive the AGV to the coupling point will stay active and in Executing state until the coupling has been completed to ensure the AGVs do not drive somewhere else and are instead reserved for the coupled drive.</p>
<p>After all machines have arrived at the coupling points, fleet control automatically selects the Leader and Followers for the formation and sends the machines command to couple. During this coupling task, the machine can be seen having a task called <em>coupling</em> and Fleet Control is updating the required area files for the Leader as shown in the figure below.</p>
<p><img src="./Images/CoupledDrive/CoupledDrive_CouplingTask.png" alt="" /></p>
<blockquote>
<p>Figure 13: Machine in coupling task.</p>
</blockquote>
<p>Similar <em>decoupling</em> task is active while the machine is decoupling after unloading the resource.</p>
<p>After coupling is ready, the Leader machine should be visualized with the coupled drive machine type with the large dimensions, that should match with the real resource dimensions as mentioned earlier. The visualization is shown in the figure below.</p>
<p><img src="./Images/CoupledDrive/CoupledDrive_AtCouplingPoints.png" alt="" /></p>
<blockquote>
<p>Figure 14: Coupled drive machine.</p>
</blockquote>
<p>The pallet is used here to visualize that machines have loaded the resource it is going to carry. The dimensions do not need to match with the real resource, as long as the machine dimensions are correctly set.</p>
<p>After this machine will drive the routes allowed for the coupled drive machine and complete the Transfer Request as it would be a normal machine. Navitrol takes care of the synchronous driving. At the target location machines will drop off the resource and decouple to single machines.</p>
<p><img src="./Images/CoupledDrive/CoupledDrive_Driving.png" alt="" /></p>
<blockquote>
<p>Figure 15: Coupled drive machine driving towards target.</p>
</blockquote>
<p><img src="./Images/CoupledDrive/CoupledDrive_DecoupledMachines.png" alt="" /></p>
<blockquote>
<p>Figure 16: After unloading the resource and decoupling, machines are free to continue production as single machines.</p>
</blockquote>
<h2 id="coupling-manually-in-navithor-client"><a class="header" href="#coupling-manually-in-navithor-client">Coupling manually in Navithor Client</a></h2>
<p>Coupling and decoupling can be done manually in Navithor Client from <em>Couple/Decouple machines</em> form. It can be opened under the top menu <em>Machines</em> -&gt; <em>Couple/Decouple machines</em>:</p>
<p><img src="./Images/CoupledDrive/CoupledDrive_ClientTopMenu.png" alt="" /></p>
<blockquote>
<p>Figure 17: Coupling/Decoupling machines form can be opened from top menu.</p>
</blockquote>
<p>The form displayed in the figure below should open up.</p>
<p><img src="./Images/CoupledDrive/CoupledDrive_ClientCouplingForm.png" alt="" /></p>
<blockquote>
<p>Figure 18: The form can be used to manually coupling and decoupling the machines.</p>
</blockquote>
<p>The form can be used to manually test coupling and decoupling of machines. If the machines used for the test have been driven to coupling symbolic points, it is enough to only fill out Machine ID fields for each machines and press button <em>Couple</em>. If the AGVs and the system have been just booted up, the machines need to be again driven to the symbolic points to make sure they are reporting at being at the symbolic point. Without the information Navithor cannot automatically detect the correct coupling positions from the symbolic points.</p>
<p>The positions of the machines and load dimensions can be also inserted manually in the form. In case the given positions and load dimensions do not match with the real positions of the AGVs, Navitrol will reject the coupling command.</p>
<p><strong>Note!</strong> In order to couple machines manually, so that they are not at the symbolicpoint, also <em>Coupled machine ID</em> must be defined.</p>
<p>Form has also button <em>Auto Recover</em> which can be used, for example if machines in formation have been rebooted. It will read the stored state from database and try to couple machines again. It has limitations, but it is recommended to try this button first in error situations, before decoupling and coupling machines manually.</p>
<p><strong>Note!</strong> For this functionality, each Machine ID must be filled accordingly to leader and follower machines.</p>
<h2 id="coupled-drive-feature-in-navitrol"><a class="header" href="#coupled-drive-feature-in-navitrol">Coupled Drive feature in Navitrol</a></h2>
<p>Navitrol Coupled Drive feature can be used either in combination with the Navithor Fleet Control or as a stand-alone system through Navitrol Supervisor interface.</p>
<p>Check Navitrol documentation for more information how to correctly configure the feature.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="WaitingSlots.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                            <a rel="next" href="Feature_StoppingPointOffsetsForSymbolicPoints.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="WaitingSlots.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                    <a rel="next" href="Feature_StoppingPointOffsetsForSymbolicPoints.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>

        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
    </body>
</html>
