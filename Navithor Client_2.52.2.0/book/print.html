<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>NAVITHOR USER INSTRUCTIONS</title>
        <meta name="robots" content="noindex" />
        <!-- Custom HTML head -->
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">
        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="index.html">Front page</a></li><li class="chapter-item expanded affix "><li class="part-title">Configuration</li><li class="chapter-item expanded "><a href="Installation_NavithorHardwareRequirements.html"><strong aria-hidden="true">1.</strong> System Hardware Requirement Specifications</a></li><li class="chapter-item expanded "><a href="Installation_SQLServerAndDatabaseInstallationGuide.html"><strong aria-hidden="true">2.</strong> Configuring database</a></li><li class="chapter-item expanded "><a href="fleetSim.html"><strong aria-hidden="true">3.</strong> Fleet Simulator - Setup and Configuration</a></li><li class="chapter-item expanded "><a href="Installation_NavithorServerAsAService.html"><strong aria-hidden="true">4.</strong> Server as a service</a></li><li class="chapter-item expanded "><a href="Installation_ConfiguringHotSwap.html"><strong aria-hidden="true">5.</strong> Server Hot Swap with Failover Cluster</a></li><li class="chapter-item expanded "><a href="Installation_RebrandingNavithor.html"><strong aria-hidden="true">6.</strong> Server and Client Rebranding</a></li><li class="chapter-item expanded "><a href="Machinetool.html"><strong aria-hidden="true">7.</strong> Machine Tool</a></li><li class="chapter-item expanded "><a href="MesTester3.html"><strong aria-hidden="true">8.</strong> MES Tester</a></li><li class="chapter-item expanded affix "><li class="part-title">Desktop client</li><li class="chapter-item expanded "><a href="navithorServerAndClientMegaDocument.html"><strong aria-hidden="true">9.</strong> System Overview and user instructions for Client UI</a></li><li class="chapter-item expanded "><a href="Feature_ClientUpdater.html"><strong aria-hidden="true">10.</strong> Client Updater</a></li><li class="chapter-item expanded affix "><li class="part-title">Web client</li><li class="chapter-item expanded "><a href="Installation_SettingUpNavithorWebServer.html"><strong aria-hidden="true">11.</strong> Setting up Web server to enable Web client</a></li><li class="chapter-item expanded "><a href="webClient.html"><strong aria-hidden="true">12.</strong> Web Client - User Instructions</a></li><li class="chapter-item expanded affix "><li class="part-title">Guides</li><li class="chapter-item expanded "><a href="bestProductionPractices.html"><strong aria-hidden="true">13.</strong> Best Practices for Creating Production Area</a></li><li class="chapter-item expanded affix "><li class="part-title">Logs</li><li class="chapter-item expanded "><a href="Navithor logs.html"><strong aria-hidden="true">14.</strong> Navithor Logs</a></li><li class="chapter-item expanded "><a href="Feature_VisualReplay.html"><strong aria-hidden="true">15.</strong> Visual Replay</a></li><li class="chapter-item expanded "><a href="Feature_DownloadManager.html"><strong aria-hidden="true">16.</strong> Log Download Manager</a></li><li class="chapter-item expanded affix "><li class="part-title">Users</li><li class="chapter-item expanded "><a href="Installation_UsingActiveDirectoryForAuthentication.html"><strong aria-hidden="true">17.</strong> User authentication against Active Directory</a></li><li class="chapter-item expanded "><a href="userRoles.html"><strong aria-hidden="true">18.</strong> User Management</a></li><li class="chapter-item expanded "><a href="userRolesRightsMatrix.html"><strong aria-hidden="true">19.</strong> Default User roles and User rights matrix</a></li><li class="chapter-item expanded affix "><li class="part-title">Features</li><li class="chapter-item expanded "><a href="symbolicPointGroups.html"><strong aria-hidden="true">20.</strong> Symbolic Point Groups</a></li><li class="chapter-item expanded "><a href="ResourceHandling.html"><strong aria-hidden="true">21.</strong> Resource handling</a></li><li class="chapter-item expanded "><a href="hold-release.html"><strong aria-hidden="true">22.</strong> Hold-Release reasoning and production order lists</a></li><li class="chapter-item expanded "><a href="transfer requests.html"><strong aria-hidden="true">23.</strong> Transfer requests</a></li><li class="chapter-item expanded "><a href="racking.html"><strong aria-hidden="true">24.</strong> Using warehouse racking feature</a></li><li class="chapter-item expanded "><a href="bufferLanes.html"><strong aria-hidden="true">25.</strong> Using Buffer Lanes</a></li><li class="chapter-item expanded "><a href="Feature_ChargingManagement.html"><strong aria-hidden="true">26.</strong> Managing Battery Levels</a></li><li class="chapter-item expanded "><a href="oneMachineZones.html"><strong aria-hidden="true">27.</strong> Using One Machine Zones</a></li><li class="chapter-item expanded "><a href="distanceControlZones.html"><strong aria-hidden="true">28.</strong> Distance Control Zones</a></li><li class="chapter-item expanded "><a href="FireAlarmZones.html"><strong aria-hidden="true">29.</strong> Fire Alarm Zones</a></li><li class="chapter-item expanded "><a href="Zone status use cases.html"><strong aria-hidden="true">30.</strong> Zone status use cases</a></li><li class="chapter-item expanded "><a href="tagStatuses.html"><strong aria-hidden="true">31.</strong> Tag Statuses</a></li><li class="chapter-item expanded "><a href="Trafficlights.html"><strong aria-hidden="true">32.</strong> Traffic Lights</a></li><li class="chapter-item expanded "><a href="Feature_Elevators.html"><strong aria-hidden="true">33.</strong> Elevators</a></li><li class="chapter-item expanded "><a href="ProductionBreak.html"><strong aria-hidden="true">34.</strong> Production Break</a></li><li class="chapter-item expanded "><a href="DynamicSafetyBounds.html"><strong aria-hidden="true">35.</strong> Virtual Dynamic Safety Bounds</a></li><li class="chapter-item expanded "><a href="WaitingSlots.html"><strong aria-hidden="true">36.</strong> Wait Queue Locations</a></li><li class="chapter-item expanded "><a href="CoupledDrive.html"><strong aria-hidden="true">37.</strong> Coupled Drive</a></li><li class="chapter-item expanded "><a href="Feature_StoppingPointOffsetsForSymbolicPoints.html"><strong aria-hidden="true">38.</strong> Stopping Point Offsets</a></li><li class="chapter-item expanded "><a href="TCStopPoint.html"><strong aria-hidden="true">39.</strong> Safe stopping point calculation</a></li><li class="chapter-item expanded "><a href="Navithor statistics.html"><strong aria-hidden="true">40.</strong> System Statistics</a></li><li class="chapter-item expanded "><a href="MachineInterfaces.html"><strong aria-hidden="true">41.</strong> Machine Interfaces</a></li><li class="chapter-item expanded affix "><li class="part-title">Interfaces</li><li class="chapter-item expanded "><a href="Communication specification between Navithor and MES.html"><strong aria-hidden="true">42.</strong> MES Interface</a></li><li class="chapter-item expanded "><a href="NavithorHttpApi.html"><strong aria-hidden="true">43.</strong> HTTP API</a></li><li class="chapter-item expanded "><a href="NavithorWebApi.html"><strong aria-hidden="true">44.</strong> WebSocket API</a></li><li class="chapter-item expanded "><a href="opcuadoc.html"><strong aria-hidden="true">45.</strong> OPC UA Server interface</a></li><li class="chapter-item expanded affix "><li class="part-title">Alarms</li><li class="chapter-item expanded "><a href="Fleet Control Alarms.html"><strong aria-hidden="true">46.</strong> Alarms</a></li><li class="chapter-item expanded "><a href="Alarms configuration override.html"><strong aria-hidden="true">47.</strong> Alarms configuration override</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="dark">Dark</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">NAVITHOR USER INSTRUCTIONS</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <div style="text-align: center;">
<img style="display: var(--show-light-logo);margin-left: auto;margin-right: auto;width: 60%;margin-bottom: 50px;margin-top:250px;" src="./Images/media/image1.png" alt="Navitec Logo">
<img style="display: var(--show-dark-logo);margin-left: auto;margin-right: auto;width: 60%;margin-bottom: 50px;margin-top:250px;" src="./Images/media/logo_for_dark_bg.png" alt="Navitec Logo">
<h1 style="color: var(--title-fg);display: block;margin-left: auto; margin-right: auto;width: 80%;">NAVITHOR USER INSTRUCTIONS</h1>
</div>
<div style="break-before: page; page-break-before: always;"></div><h1 id="hardware-requirements"><a class="header" href="#hardware-requirements">Hardware requirements</a></h1>
<p>This document contains information on hardware requirements.</p>
<p>Updated 07.02.2023</p>
<h2 id="version-history"><a class="header" href="#version-history">Version History</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Version</th><th>Date</th><th>Author</th><th>Change</th></tr></thead><tbody>
<tr><td>1.0</td><td>21.09.2020</td><td>Luis Rebelo</td><td>Conversion from word to md</td></tr>
<tr><td>1.1</td><td>21.09.2020</td><td>Luis Rebelo</td><td>Added extra information for fleets of 40-125 AGV's</td></tr>
<tr><td>1.2</td><td>21.09.2020</td><td>Luis Rebelo</td><td>Added extra Network bandwidth and latency information</td></tr>
<tr><td>1.3</td><td>24.09.2020</td><td>Luis Rebelo</td><td>Updated OSs and database requirements</td></tr>
<tr><td>1.4</td><td>18.12.2020</td><td>Tommi Kärki</td><td>Minor clean-up</td></tr>
<tr><td>1.5</td><td>11.06.2021</td><td>Aleksi Ålander</td><td>Renamed title</td></tr>
<tr><td>1.6</td><td>16.06.2021</td><td>Elena Sgonova</td><td>Fixed lists</td></tr>
<tr><td>1.7</td><td>07.02.2023</td><td>Aleksi Ålander</td><td>Updated the document with latest OSs and VDA5050 is included in default ports</td></tr>
</tbody></table>
</div>
<hr />
<h2 id="navithor-server-requirements"><a class="header" href="#navithor-server-requirements">Navithor Server requirements</a></h2>
<h3 id="agv-fleet-40-200-vehicles"><a class="header" href="#agv-fleet-40-200-vehicles">AGV Fleet 40-200 vehicles</a></h3>
<p><strong>Minimum</strong></p>
<ul>
<li>CPU: 8 logical cores, 2.4 GHz+</li>
<li>RAM: 8 GB</li>
<li>SSD: 500 - 1000 GB</li>
</ul>
<p><strong>Recommended</strong></p>
<ul>
<li>CPU: 12 logical cores, 3.0 GHz+</li>
<li>RAM: 16 GB</li>
<li>SSD: 1000 GB</li>
</ul>
<h3 id="agv-fleet-40-or-less-vehicles"><a class="header" href="#agv-fleet-40-or-less-vehicles">AGV Fleet 40 or less vehicles</a></h3>
<p><strong>Minimum</strong></p>
<ul>
<li>CPU: 4 logical cores, 2.4 GHz+</li>
<li>RAM: 8 GB</li>
<li>SSD: 240 GB</li>
</ul>
<p><strong>Recommended</strong></p>
<ul>
<li>CPU: 8 logical cores, 3.0 GHz+</li>
<li>RAM: 8 GB</li>
<li>SSD: 500 GB</li>
</ul>
<hr />
<h2 id="database-server-requirements"><a class="header" href="#database-server-requirements">Database Server requirements</a></h2>
<ul>
<li>CPU: Intel i5 / i7 or similar (only up to 4 cores on Express version)</li>
<li>Database does not require any above average specs.</li>
</ul>
<hr />
<h2 id="navithor-client-requirements"><a class="header" href="#navithor-client-requirements">Navithor Client requirements</a></h2>
<p><strong>Minimum</strong></p>
<ul>
<li>CPU: 4 logical cores, 2.4 GHz+</li>
<li>RAM: 8 GB</li>
<li>GPU: OpenGL 1.1 support</li>
<li>HDD/SSD: 200 GB</li>
</ul>
<p><strong>Recommended</strong></p>
<ul>
<li>CPU: 4 logical cores, 2.4 GHz+</li>
<li>RAM: 8 GB</li>
<li>GPU: OpenGL 3.3 support</li>
<li>SSD: 200 GB</li>
</ul>
<hr />
<h2 id="general-software-requirements"><a class="header" href="#general-software-requirements">General software requirements</a></h2>
<ul>
<li>Operating Systems: Windows 10 / 11, Windows Server 2016 / 2019 / 2022</li>
<li>Microsoft SQL Server 2022 / 2019 with SQL Server Management Studio (SQL server and tools) – Installed by Navitec if not found on system</li>
<li>Team Viewer version 15 – for remote installation and support of Navitec software</li>
<li>.Net Framework 4.7.2</li>
<li>Navithor Client should not be operated from the server computer</li>
<li>Navithor Server can either run in a virtual or a physical server (Navithor license needs to allow virtualization for it to be possible)</li>
<li>If hotswap for high availability is needed, Navithor Server needs two identical server instances (requires a secondary license)</li>
</ul>
<p>Windows server 2012 R2 has hit End-Of-Life on 10/09/2018 and is currently on extended support until 10/10/2023. Windows 7 hit End-Of-Life on 01/14/2020 and will continue to get Extended Security Updates until 01/10/2023. Both of these operating systems are likely to work with our software but they are no longer officially supported or tested.</p>
<h3 id="windows-remote-desktop"><a class="header" href="#windows-remote-desktop">Windows Remote Desktop</a></h3>
<p>Navithor Client is using OpenGL as rendering backend which has compatibility issues with Windows Remote Desktop and this will affect Client performance negatively. Windows Server 2016 (or newer) and Windows 10 (or newer) have optionally enabled group policy which will allow remote desktop connections to use hardware graphics adapter.</p>
<p>This can be enabled by doing the following (precise name of option might vary):</p>
<ol>
<li>Open the Edit Group Policy tool from Control Panel or use the Windows Search dialog (Windows Key + R, then type in gpedit.msc)</li>
<li>Browse to: Local Computer Policy\Computer Configuration\Administrative Templates\Windows Components\Remote Desktop Services\Remote Desktop Session Host\Remote Session Environment</li>
<li>Then enable “Use hardware graphics adapters for all Remote Desktop Services sessions”</li>
</ol>
<hr />
<h2 id="guidelines-for-network-bandwidth-and-latency"><a class="header" href="#guidelines-for-network-bandwidth-and-latency">Guidelines for Network Bandwidth and Latency</a></h2>
<p>These are some general guidelines on the network bandwidth and latency. For optimal performance there should be as much margin as possible for the network. Other software and components on the factory network should be taken into account when building a sufficient network.</p>
<p>Notice that when the number of AGV's or other devices connected to the network increases the latencies and load on the network and different access points increase often in a non-linear way. Network should be available everywhere where AGV's move on the production floor and the requirements should to be filled even in the worst case.</p>
<p>Our recommendation would be to use Gigabit ethernet connections and Wlan 802.11n or 802.11ac standard.</p>
<div class="table-wrapper"><table><thead><tr><th>Application</th><th>Server</th><th>Bandwidth</th><th>Connection</th></tr></thead><tbody>
<tr><td>Navithor Server</td><td>SQL Server</td><td>Gigabit</td><td>Preferably cable connected with gigabit ethernet</td></tr>
<tr><td>Navithor Client</td><td>Navithor Server</td><td>100 - 1000 kBps / per Navithor Client</td><td>Wlan with low latency ( &lt; 30 ms ). Bandwidth depends on area size, number of AGV's and MES behaviour.</td></tr>
<tr><td>MES Connection</td><td>Navithor Server</td><td>5 kBps / per MES application</td><td>Preferably cable connected. Depends on the MES program and Navithor configuration.</td></tr>
<tr><td>Navithor Server</td><td>Navitrol</td><td>10 kBps / per Navitrol AGV</td><td>Wlan with low latency ( &lt; 30 ms). Bandwidth requirement is more on large areas and with AGV's using multiple scanners.</td></tr>
<tr><td>Navitrol Monitor</td><td>Navitrol</td><td>1.2 MBps</td><td>Meant to be connected only for analysing situations, configuring and debugging. Not more than 1 connection per time recommended.</td></tr>
</tbody></table>
</div>
<h3 id="example-system-and-bandwidth-requirements"><a class="header" href="#example-system-and-bandwidth-requirements">Example system and bandwidth requirements</a></h3>
<p>With 3 AGV's, 1 Navithor Client, 1 MES connection and Dynamic Mapping Server. Capability to use Navitrol Monitor.</p>
<div class="table-wrapper"><table><thead><tr><th>Components</th><th></th></tr></thead><tbody>
<tr><td>SQL Server</td><td>Running on the Navithor Server computer</td></tr>
<tr><td>AGV's</td><td>3 * 10 kBps</td></tr>
<tr><td>Navithor Client</td><td>300 kBps</td></tr>
<tr><td>MES Connection</td><td>5 kBps</td></tr>
<tr><td>Dynamic Mapping server</td><td>3 * 50 kBps</td></tr>
<tr><td>Navitrol Monitor</td><td>1.2 MBps</td></tr>
<tr><td></td><td></td></tr>
<tr><td>Minimum Bandwidth requirement</td><td><strong>1.7 MBps</strong></td></tr>
</tbody></table>
</div>
<h2 id="default-ports"><a class="header" href="#default-ports">Default ports</a></h2>
<p><img src="./Images/hardwareRequirements_portsWithVDA.png" alt="Overview of Navithor ports" /></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="sql-server-and-database-installation-guide"><a class="header" href="#sql-server-and-database-installation-guide">SQL Server and Database installation guide</a></h1>
<p>This document contains information on how to install and configure SQL Server for Navithor.</p>
<p>Updated 11.06.2021</p>
<h2 id="version-history-1"><a class="header" href="#version-history-1">Version History</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Version</th><th>Date</th><th>Author</th><th>Change</th></tr></thead><tbody>
<tr><td>1.0</td><td>18.12.2020</td><td>Tommi Kärki</td><td>Rewrote document</td></tr>
<tr><td>1.1</td><td>16.04.2021</td><td>Evgenii Kuzminskii</td><td>Corrected the name for &quot;Creating an SQL login for Windows authentication mode&quot; chapter</td></tr>
<tr><td>1.2</td><td>11.06.2021</td><td>Aleksi Ålander</td><td>Renamed title</td></tr>
</tbody></table>
</div>
<hr />
<h2 id="applications-referred-to-in-this-guide"><a class="header" href="#applications-referred-to-in-this-guide">Applications referred to in this guide</a></h2>
<p>SQL Server</p>
<ul>
<li>Hosts databases</li>
</ul>
<p>SQL Server Configuration Manager</p>
<ul>
<li>Configuring SQL server connections</li>
<li>Can also be found as: SQLServerManager15.msc (number depends on version)</li>
</ul>
<p>SQL Server Management Studio</p>
<ul>
<li>Configuring SQL Server settings</li>
<li>Configuring SQL Server logins</li>
</ul>
<p>Navithor Database Tools</p>
<ul>
<li>Ships with Navithor Fleet Control</li>
<li>Configuring connection to SQL Server and specifying name of database to connect to</li>
<li>Performing installation and upgrade</li>
<li>Taking database backups</li>
</ul>
<p>Navithor Server</p>
<ul>
<li>Fleet control software</li>
<li>Requires database connection</li>
</ul>
<p>Navithor Tools</p>
<ul>
<li>Environment and route editing Tool</li>
<li>Required database connection</li>
</ul>
<h2 id="installing-sql-server"><a class="header" href="#installing-sql-server">Installing SQL Server</a></h2>
<p>Navithor Server uses SQL Server as the database of choice. SQL Server Express is free to use and sufficient for most production areas. Express edition comes with following major limitations at time of writing:</p>
<ul>
<li>Database size is limited to 10 GB</li>
<li>1 socket or 4 cores</li>
<li>High availability is not supported</li>
</ul>
<p>See: https://docs.microsoft.com/en-us/sql/sql-server/editions-and-components-of-sql-server-version-15?view=sql-server-ver15 for full comparison.</p>
<p>This document will cover Express installation but we also support other editions.</p>
<h3 id="downloading"><a class="header" href="#downloading">Downloading</a></h3>
<p>Choose Express. Developer version contains all features of SQL Server but license does not allow usage for production.</p>
<p><a href="https://www.microsoft.com/en-us/sql-server/sql-server-downloads">https://www.microsoft.com/en-us/sql-server/sql-server-downloads</a></p>
<p><img src="./Images/sql-server-installation-choose-edition.png" alt="Choose SQL Server edition" /></p>
<blockquote>
<p>Screen capture of site on 18.12.2020, current version might look different.</p>
</blockquote>
<h3 id="installation"><a class="header" href="#installation">Installation</a></h3>
<p>After download has been completed, launch the installer.</p>
<p><img src="./Images/installing-initial-window.png" alt="Installation initial window" /></p>
<blockquote>
<p>Initial pop-up window. If you have internet connection on your device choose &quot;Basic&quot;</p>
</blockquote>
<p>If you are installing on a device without internet connection the setup files need to be transferred manually. To do so:</p>
<ol>
<li>Launch installer on another device that has internet connection</li>
<li>Click on &quot;Download Media&quot;</li>
<li>Follow instructions on screen</li>
<li>Copy the setup files to device without internet connection</li>
<li>Launch installer again. It will ask for Setup files when needed.</li>
</ol>
<p><img src="./Images/installing-tos.png" alt="Installation license agreement" /></p>
<blockquote>
<p>License terms. Read and click Accept</p>
</blockquote>
<p><img src="./Images/installing-location.png" alt="Installation location" /></p>
<blockquote>
<p>Choose where to install.</p>
</blockquote>
<p><img src="./Images/installing-downloading-install-packages.png" alt="Installation downloading" /></p>
<blockquote>
<p>SQL Server is downloading and installing on background</p>
</blockquote>
<p><img src="./Images/installing-completed.png" alt="Installation completed" /></p>
<blockquote>
<p>SQL Server has been installed</p>
</blockquote>
<p><em>Next steps:</em></p>
<ul>
<li>Click on &quot;Install SSMS&quot; to Install SQL Server Management Studio which will be used for configuration</li>
<li>Install Navithor Fleet Control database</li>
<li>Configure SQL Server authentication with SSMS</li>
<li>Configure external connection using Named Pipes or TCP connection</li>
</ul>
<p>Launch SQL Server Management Studio (SSMS) on the device you installed SQL Server on and you will be greeted with this popup</p>
<p><img src="./Images/ssms-login-prompt.png" alt="Installation completed" /></p>
<blockquote>
<p>Connect window</p>
</blockquote>
<p>By default the server name should be local host (if this is the only installation of SQL Server on device) and Windows Authentication is enabled. Administrator rights are required To map Active Directory users, if you installed the SQL Server on your current account then these should be automatically granted. If not, contact your IT support.</p>
<p>Configuring server name and different types of authentication will be covered later in the document.</p>
<p>Click on Connect. <strong>If this fails take a look at <code>Configuring connection</code> or <code>Troubleshooting</code> for instructions</strong></p>
<h2 id="configuring-connection"><a class="header" href="#configuring-connection">Configuring connection</a></h2>
<h3 id="using-integrated-security"><a class="header" href="#using-integrated-security">Using Integrated Security</a></h3>
<p>An important thing know about Integrated security option is that the credentials of the user who launched the application will be used when authenticating. Generally this means the user that is logged in to the computer.  Application can be run as a different user by shift + right-clicking on the application or by running the application as a Windows service.</p>
<p>Windows authentication for remote connections work only if the accounts are defined in an Active Directory forest or in a Workgroup. It is not possible to use Windows authentication if the SQL Server and the Navithor Server application are not in the same domain, unless the domain where Navithor Server exists is marked as a trusted domain.</p>
<h3 id="using-navithor-database-tools-to-configure-connection-string"><a class="header" href="#using-navithor-database-tools-to-configure-connection-string">Using Navithor Database Tools to configure Connection string</a></h3>
<p>Navithor Database Tools provides user interface which can be used to build connection string. Connection string defines which server to connect to, with which protocol and what type of authentication to use among other things.</p>
<p><img src="./Images/troubleshooting-wrong-instance-name-dbtools-fix.png" alt="Default installation configuration" /></p>
<blockquote>
<p>Default installation configuration</p>
</blockquote>
<p>Overview of different options.</p>
<div class="table-wrapper"><table><thead><tr><th>Setting name</th><th>Usage</th></tr></thead><tbody>
<tr><td>DataSource</td><td>Where SQL Server instance is located. How to fill this field depends on connection type but generally it is <code>&lt;server address&gt;\&lt;instance name&gt;</code>. For example: <code>localhost\SQLEXPRESS</code></td></tr>
<tr><td>Integrated Security</td><td>Whether to use Microsoft authentication. If not specified Microsoft Authentication will be used. If set to false then <code>SQL Server authentication</code> which requires configuring SQL Server separately to allow this type of authentication.</td></tr>
<tr><td>User ID</td><td>If Microsoft authentication is used then this should not be used. Otherwise this will be SQL User name/id.</td></tr>
<tr><td>Password</td><td>If Microsoft authentication is used then this should not be used. Otherwise this will be SQL User password.</td></tr>
<tr><td>Network Library</td><td>Which protocol to use when connection to SQL Server instance. Generally best available connection protocol will be automatically picked based on DataSource.</td></tr>
<tr><td>Encrypt</td><td>Whether to enable SSL encryption for data transfer. Not that when TrustServerCertificate is false and Encrypt is true, the server name (or IP address) in a SQL Server SSL certificate must exactly match the server name (or IP address) specified in the connection string. Otherwise, the connection attempt will fail.</td></tr>
<tr><td>Trust Server Certificate</td><td>When encrypt is set to true this specifies whether to trust certificate without walking the certificate chain. If encrypt is set to false this doesn't do anything meaningful. More information at. <a href="https://docs.microsoft.com/en-us/sql/relational-databases/native-client/features/using-encryption-without-validation?view=sql-server-2017">Microsoft article</a></td></tr>
<tr><td>Failover Partner</td><td>Failover partner. More information at: <a href="https://docs.microsoft.com/en-us/dotnet/framework/data/adonet/sql/database-mirroring-in-sql-server">Microsoft article</a></td></tr>
</tbody></table>
</div>
<h3 id="allowing-sql-user-authentication"><a class="header" href="#allowing-sql-user-authentication">Allowing SQL user authentication</a></h3>
<p>By default, SQL Server only allows logins using Integrated Security (Windows authentication) and denies SQL Server user login attempts. If you plan to use SQL server authentication instead of integrated then the database has to be configured to allow it. To enable SQL Server authentication:</p>
<ol>
<li>Open SQL Server Management Studio on user account and PC that can access SQL Server</li>
<li>Login</li>
<li>Right click SQL Server instance on top of object explorer</li>
<li>Select properties</li>
<li>Select security</li>
<li>Change server authentication to allow SQL Server and Windows authentication mode if required.</li>
</ol>
<p><img src="Images/cheatsheet_ServerInstance_AuthenticationMode.png" alt="" /></p>
<h3 id="configuring-sql-server-logins"><a class="header" href="#configuring-sql-server-logins">Configuring SQL Server logins</a></h3>
<p>SQL server requires configuring Logins which allows users and applications to access the database. It's possible to create a new SQL server user for this purpose, the created user will only have access to database and will not have any access to operating system. Other option is to map operating system user (or Active Directory user) to SQL Server login. Each login can be configured to have one or many predefined roles or individual rights. Rights is for example ability to create new database or delete rows in a table.</p>
<p>For full installation following rights are required:</p>
<div class="table-wrapper"><table><thead><tr><th>Action</th><th>Required rights</th></tr></thead><tbody>
<tr><td>1. Configuring ntconn</td><td>CONNECT (testing connection)</td></tr>
<tr><td>2. Creating a new database</td><td>CREATE DATABASE</td></tr>
<tr><td>3. Install schemas and tables</td><td>CREATE SCHEMA, CREATE TABLE, ALTER TABLE</td></tr>
<tr><td>4. Insert initial data</td><td>CONNECT, UPDATE, DELETE</td></tr>
<tr><td>5. Upgrade database version</td><td>CREATE TABLE, ALTER TABLE</td></tr>
</tbody></table>
</div>
<p>Easiest configuration is to use Login with 'sysadmin' server role for installation. It is strongly recommended to use Login with less rights after installation.</p>
<p>For installing tables and schemas to existing empty database following rights are required:</p>
<div class="table-wrapper"><table><thead><tr><th>Action</th><th>Required rights</th></tr></thead><tbody>
<tr><td>1. Configuring ntconn</td><td>CONNECT (testing connection)</td></tr>
<tr><td>2. Install schemas and tables</td><td>CREATE SCHEMA, CREATE TABLE, ALTER TABLE</td></tr>
<tr><td>3. Insert initial data</td><td>CONNECT, UPDATE, DELETE</td></tr>
<tr><td>4. Upgrade database version</td><td>CREATE TABLE, ALTER TABLE</td></tr>
</tbody></table>
</div>
<p>These rights can be configured per database and thus it's recommended to allow Login for Navithor Server to keep above user rights to simplify database update.</p>
<p>Minimum Rights required for operation after installation:</p>
<div class="table-wrapper"><table><thead><tr><th>Required rights</th></tr></thead><tbody>
<tr><td>CONNECT</td></tr>
<tr><td>UPDATE</td></tr>
<tr><td>DELETE</td></tr>
</tbody></table>
</div>
<h4 id="creating-an-sql-login-for-sql-server-authentication-mode"><a class="header" href="#creating-an-sql-login-for-sql-server-authentication-mode">Creating an SQL login for SQL server authentication mode</a></h4>
<ol>
<li>Open SQL Server Management studio</li>
<li>Fill in credentials and click Connect</li>
</ol>
<p><img src="Images/addingUser_SSMS_Mainscreen.png" alt="" /></p>
<ol start="3">
<li>Navigate to Security -&gt; Logins and right click Login -&gt; New login...</li>
</ol>
<p><img src="Images/addingUser_SSMS_NewLogin.png" alt="" /></p>
<ol start="4">
<li>Select SQL User and fill information</li>
</ol>
<p><img src="Images/addingUser_SSMS_NewUser_Filled.png" alt="" /></p>
<h4 id="creating-an-sql-login-for-windows-authentication-mode"><a class="header" href="#creating-an-sql-login-for-windows-authentication-mode">Creating an SQL login for Windows authentication mode</a></h4>
<p>Setting up users for integrated security works the same way as adding SQL users. The only difference is that instead of creating an account for the SQL Server the account needs to be searched for from the domain.</p>
<p><img src="images/searchingUsersIntegratedSecurity.png" alt="" /></p>
<h3 id="configuration-cheatsheet"><a class="header" href="#configuration-cheatsheet">Configuration cheatsheet</a></h3>
<p>SQL Server Express on same PC</p>
<p><img src="./Images/cheatsheet_samePcExpress.png" alt="" /></p>
<hr />
<p>SQL Server (non express) on same PC</p>
<p><img src="Images/cheatsheet_samePcNonExpress.png" alt="" /></p>
<hr />
<p>Multiple instances on same PC</p>
<p><img src="Images/cheatsheet_samePcMultipleInstances_Config.png" alt="" /></p>
<p><img src="Images/cheatsheet_samePcMultipleInstances.png" alt="" /></p>
<hr />
<p>Multiple instances on remote PC (SQL Server Browser Enabled and working)</p>
<p><img src="Images/cheatsheet_diffrentIpMultipleInstances_Config.png" alt="" /></p>
<p><img src="Images/cheatsheet_diffrentIpMultipleInstances.png" alt="" /></p>
<hr />
<p>Multiple instances on remote PC (Manually configured port)</p>
<p><img src="images/cheatsheet_explicitConfig_DBTools.png" alt="" /></p>
<p><img src="Images/cheatsheet_explicitConfig_SQLConfigManager.png" alt="" /></p>
<p><img src="Images/cheatsheet_explicitConfig_SQLConfigManager_Protocol.png" alt="" /></p>
<h2 id="installing-database"><a class="header" href="#installing-database">Installing database</a></h2>
<p>Steps to create a functional database for Fleet control:</p>
<ol>
<li>Create database</li>
<li>Install initial schemas and tables</li>
<li>Insert initial data</li>
<li>Upgrade database version</li>
</ol>
<p>Step 1 requires: <code>CONNECT</code>, <code>CREATE DATABASE</code> rights.
Steps 2-4 require: <code>CREATE SCHEMA</code>, <code>CREATE TABLE</code>, <code>ALTER TABLE</code> rights.</p>
<p>Automatically doing full installation is recommended but step 1 can be done beforehand. Refer to <code>Adding Navithor data to existing database</code>.</p>
<h3 id="automatic-installation"><a class="header" href="#automatic-installation">Automatic installation</a></h3>
<p>Open database tools and fill in your connection details.</p>
<p><img src="./Images/troubleshooting-wrong-instance-name-dbtools-fix.png" alt="Default installation configuration" /></p>
<blockquote>
<p>Default installation configuration</p>
</blockquote>
<p>Click on &quot;Test connection&quot;, if there are no errors popup should say &quot;Connection ok&quot; and previously greyed out buttons should be available. If error popped up, refer to &quot;Troubleshooting&quot;.</p>
<p>Navithor Server is capable of creating new database, installing schemas, creating tables and filling out initial data on it's own. Next step is to click on <em>Generate ntconn file</em> which will generate encrypted file containing database connection information and database names. If Database Tools was opened using Navithor Server GUI the file should already be in correct location. Otherwise copy the generated <code>ntconn</code> file to same directory <code>Navithor Server.exe</code> is located at.</p>
<h3 id="custom-installation"><a class="header" href="#custom-installation">Custom installation</a></h3>
<h4 id="changing-database-name"><a class="header" href="#changing-database-name">Changing database name</a></h4>
<p>Database name can be changed by clicking on <em>Edit database names</em> button. This will open up a new pop-up window.</p>
<p><img src="./Images/dbtools-customize-installation-change-database-name.png" alt="Changing database name" /></p>
<blockquote>
<p>Changing database name</p>
</blockquote>
<p>Navithor is using 2 separate databases. Optionally enabled statistics database will contain generated statistics and is safe to read data from. Everything else goes inside main database that should not be used as interface for other programs. Using main database as interface is not supported.</p>
<p>Specify the desired names for databases and click <code>Save</code>.</p>
<h4 id="manually-creating-database-with-database-tools"><a class="header" href="#manually-creating-database-with-database-tools">Manually creating database with Database Tools</a></h4>
<p>It is possible to temporarily login with more privileged user account for database installation. This will make installation and updating more cumbersome but allows restricting the rights of user account <code>Navithor Server</code> uses to minimal. First connect to database with credentials that have <code>CONNECT, CREATE DATABASE, CREATE SCHEMA, CREATE TABLE, ALTER TABLE</code> rights, easiest is to login with database admin credentials. Configure the database names you want to use and then click on <code>Test connection</code> to unlock rest of controls. Finally click on <code>Open Install and Restore Tool</code>.</p>
<p><img src="./Images/dbtools-install-and-restore-tool.png" alt="Install and Restore Tool" /></p>
<p>Tool will give you choice on which database to perform actions on, the choices are generated from contents written in <code>Edit database names</code>. If names are wrong close the Tool, edit names and open Tool again.</p>
<p>To install new fresh database choose which database to install from top and then click on <code>Full install</code> button. This will:</p>
<ul>
<li>Create database</li>
<li>Create schema</li>
<li>Update database to latest version supported to Tool. This involves creating new tables, inserting data and altering existing tables.</li>
</ul>
<p>This will generate a fresh database which has all the data Navithor needs to function. Next step would be to configure SQL User for Navithor to use.</p>
<h4 id="adding-navithor-data-to-existing-database"><a class="header" href="#adding-navithor-data-to-existing-database">Adding Navithor data to existing database</a></h4>
<p>In some cases an empty database has already been created on SQL Server but it is missing data required by Navithor Server. This data will be automatically created by launching <code>Navithor Server</code> but this can also be done manually using <code>Install and Restore Tool</code>. Open the Tool and click on <code>Install tables only</code>. This will create the missing tables and upgrade database to newest version.</p>
<p><img src="./Images/dbtools-install-and-restore-tool.png" alt="Install and Restore Tool" /></p>
<h4 id="manually-upgrading-to-newest-version"><a class="header" href="#manually-upgrading-to-newest-version">Manually upgrading to newest version</a></h4>
<p>Open DatabaseTool and connect to SQL Server with admin credentials. Click on <code>Test connection</code> and then open <code>Install and Restore Tool</code>. Finally click on <code>Upgrade to latest</code>.</p>
<p>![Install and Restore Tool](./Images/dbtools-install-and-restore-tool.png</p>
<h2 id="adding-and-configuring-sql-server-user-for-navithor-sql-server-authentication-only"><a class="header" href="#adding-and-configuring-sql-server-user-for-navithor-sql-server-authentication-only">Adding and configuring SQL Server user for Navithor (SQL server authentication only)</a></h2>
<p>Not required for Integrated Security. Should be done after installing database.</p>
<ol>
<li>Open Login properties (Security -&gt; Logins -&gt; Right click user -&gt; Properties)</li>
<li>Select User Mapping and choose user rights. Following picture has recommended rights</li>
</ol>
<p><img src="Images/configuringRights_UserMapping_Filled.png" alt="" /></p>
<ol>
<li>Open Database Properties (Databases -&gt; Right click database (default: NTDB_PRODUCTION) -&gt; Properties</li>
<li>Select Permissions</li>
</ol>
<p><img src="Images/configuringRights_DatabaseRights.png" alt="" /></p>
<ol start="5">
<li>Ensure that user has at least following Effective Rights:</li>
</ol>
<ul>
<li>CONNECT</li>
<li>UPDATE</li>
<li>DELETE</li>
<li>SELECT</li>
</ul>
<ol start="6">
<li>For updating database version additional Effective Rights are required:</li>
</ol>
<ul>
<li>CREATE TABLE</li>
<li>ALTER TABLE</li>
</ul>
<h2 id="troubleshooting"><a class="header" href="#troubleshooting">Troubleshooting</a></h2>
<h3 id="tcp-connection-server-not-found"><a class="header" href="#tcp-connection-server-not-found">TCP connection, Server not found</a></h3>
<p>Example connection string: <code>Data Source=localhost,12345\SQLEXPRESS;Integrated Security=True</code></p>
<p>Most common reason for failure is that TCP is not configured correctly or at all. In the picture below is a typical error message when there is no configuration done.</p>
<p><img src="./Images/troubleshooting-tcp-connection-failure.png" alt="TCP connection failure" /></p>
<blockquote>
<p>Failed to connect, no response for TCP connection</p>
</blockquote>
<p>Make sure that TCP/IP is allowed for the SQL Server instance. In the picture below it is disabled.</p>
<p><img src="./Images/troubleshooting-tcp-not-allowed.png" alt="TCP connection not allowed" /></p>
<p>To fix the issue, navigate to <code>SQL Server network Configuration</code> -&gt; <code>Properties for &lt;INSTANCE_NAME&gt;</code> -&gt; <code>TCP/IP</code> -&gt; <code>Properties</code>. Enable the protocol and restart the SQL Server instance by navigating to <code>SQL Server Services</code> -&gt; <code>SQL Server (&lt;INSTANCE_NAME&gt;)</code> -&gt; <code>Restart</code>.</p>
<p><img src="./Images/troubleshooting-tcp-properties-enable.png" alt="TCP enabled" /></p>
<p><img src="./Images/troubleshooting-restart-instance.png" alt="Restart instance" /></p>
<p>If custom port was specified (,12345 in example connection string) or the connection still fails the next step is to verify which ports and ips are allowed otherwise the same error message as above will be shown.</p>
<p>Navigate to <code>SQL Server network Configuration</code> -&gt; <code>Properties for &lt;INSTANCE_NAME&gt;</code> -&gt; <code>TCP/IP</code> -&gt; <code>Properties</code> -&gt; <code>IP Addresses</code>. There should be pre-configured entries for network adapters found on device but all of the connections will be disabled.</p>
<p><img src="./Images/troubleshooting-tcp-ip-config-not-configured.png" alt="Addresses not configured" /></p>
<p>To enable connection for specific ip address change:</p>
<ul>
<li><code>Enabled</code> value to <code>Yes</code></li>
<li><code>IP Address</code> value to which remote IP to allow access to</li>
<li><code>TCP Dynamic Ports</code> to <code>0</code> to allow connection to any port or remove the value to use specific port</li>
<li>If dynamic ports was disabled, set <code>TCP Port</code> value to desired value. <em>IN BOTH CASES THE FIREWALL MUST ALLOW THE CONNECTION!</em>.</li>
</ul>
<p>To enable connection for any ip but specific port:</p>
<ul>
<li>Scroll down to bottom to find entry for IPALL</li>
<li>Change <code>TCP Dynamic Ports</code> to <code>0</code> to allow connection to any port</li>
<li>Remove value on<code>TCP Dynamic Ports</code> and fill out desired port to <code>TCP Port</code> to allow connections to specific port.</li>
</ul>
<p>After this, restart the SQL Server instance again.</p>
<h3 id="named-pipes-server-not-found"><a class="header" href="#named-pipes-server-not-found">Named pipes, Server not found</a></h3>
<p>Example connection string: <code>Data Source=localhost;Integrated Security=True</code></p>
<p><img src="./Images/dbtools-connection-failure-error-40.png" alt="DBTools error 40" />
<img src="./Images/connection-failure-error-2.png" alt="SSMS Error 2" /></p>
<blockquote>
<p>Failed to connect</p>
</blockquote>
<p>Likely cause for this image is that there are multiple SQL Server installations on same device or that instance name was not written correctly. Verify instance name using SQL Server Manager (SQLServerManager15.msc).</p>
<p><img src="./Images/troubleshooting-wrong-instance-name.png" alt="Installation completed" /></p>
<blockquote>
<p>SQL Server Configuration Manager</p>
</blockquote>
<p>We can see that there is SQL Server running with the name of SQLEXPRESS and that SQL Server Browser is disabled.</p>
<p>This can be fixed by explicitly specifying name of SQL instance in connection string.</p>
<p><img src="./Images/troubleshooting-wrong-instance-name-ssms-fix.png" alt="SSMS wrong instance name fix" /></p>
<blockquote>
<p>Fix for SSMS. Make sure your \ is pointing to correct direction</p>
</blockquote>
<p><img src="./Images/troubleshooting-wrong-instance-name-dbtools-fix.png" alt="DBTools wrong instance name fix" /></p>
<blockquote>
<p>Fix for Database tools</p>
</blockquote>
<p>Corrected connection string: <code>Data Source=localhost\SQLEXPRESS;Integrated Security=True</code></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="fleet-simulator---setup-and-configuration"><a class="header" href="#fleet-simulator---setup-and-configuration">Fleet Simulator - Setup and Configuration</a></h1>
<p>This document contains information on how to use the Navitec Fleet Simulator.</p>
<p>Updated 17.06.2022</p>
<h2 id="version-history-2"><a class="header" href="#version-history-2">Version History</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Version</th><th>Date</th><th>Author</th><th>Change</th></tr></thead><tbody>
<tr><td>1.0</td><td>20.01.2019</td><td></td><td>Created</td></tr>
<tr><td>1.1</td><td>02.01.2020</td><td>Joni Sundholm</td><td>Converted to Markdown</td></tr>
<tr><td>1.2</td><td>27.10.2020</td><td>Luis Rebelo</td><td>Updated formating</td></tr>
<tr><td>1.3</td><td>11.06.2021</td><td>Aleksi Ålander</td><td>Renamed title</td></tr>
<tr><td>1.4</td><td>09.07.2021</td><td>Benard Gathimba</td><td>Document update</td></tr>
<tr><td>1.5</td><td>27.04.2022</td><td>Toni Liski</td><td>Added option to specify SFTP port</td></tr>
<tr><td>1.6</td><td>17.06.2022</td><td>Aleksi Ålander</td><td>Added 'Drive Order Handling' and 'Resource Barcode' into Machine Control chapter.</td></tr>
</tbody></table>
</div>
<hr />
<h2 id="setup-and-configuration"><a class="header" href="#setup-and-configuration">Setup and Configuration</a></h2>
<h3 id="fleet-simulator-interface"><a class="header" href="#fleet-simulator-interface">Fleet Simulator Interface</a></h3>
<p>To start the Fleet Simulator interface, launch the &quot;NavithorFleetSimulator.exe&quot;
application found in the NavithorFleetSimulator folder. Upon a successful launch, the
Fleet Simulator interface should appear as shown in figure 1 below. </p>
<p><img src="./Images/fleetsim/image1.png" alt="" /></p>
<blockquote>
<p>Figure 1 : Fleet Simulator Interface</p>
</blockquote>
<h3 id="navithor-server-settings"><a class="header" href="#navithor-server-settings">Navithor Server Settings</a></h3>
<p>The next thing that must be done is configuring Navithor Server settings
to use the simulator. This is done in Navithor Client. The <strong>Use Simulator</strong>
setting must be enabled to <em>True</em> and <strong>Simulator Address</strong> and <strong>Simulator Port</strong>
settings must also be set accordingly.</p>
<p>NOTE: If running on a different computer, you must make sure that:</p>
<ol>
<li>The Simulator Port is open</li>
<li>SSH Port (default 22), is open (required for SFTP, transferring route files)</li>
</ol>
<p><img src="./Images/fleetsim/image2.png" alt="" /></p>
<blockquote>
<p>Figure 2 : Navithor Server Settings</p>
</blockquote>
<h3 id="configuration-files"><a class="header" href="#configuration-files">Configuration Files</a></h3>
<p>The Fleet Simulator can run using <em>default parameters</em>. However, it is also possible to
use real <em>params.txt</em> from Navitrol so as to simulate realistic parameter values. To update 
the parameter file, select Configuration Files from the left side panel of the fleet simulator.
The displayed interface allows one to add or reload parameter files. An alternative solution
would be to paste/add the parameter file to the simulator folder under the
following path: <em>FleetSimulatorPath/Files/Parameters</em> followed by a restart of the
fleet simulator.</p>
<p>Moreover, it is posible to initialize machines at a predefined position stored using <em>PositionInit</em>. To
store an initialization position, initialize a machine in the disired location and orientation then use
<em>Save set</em> to store the position. It is possible to store multiple positions by incrementing the integer
value under the <em>PositionInit</em> header. To load a stored position, select the required integer and press
<em>Load set</em>. Figure 3 below shows the configuration files tab.</p>
<p><img src="./Images/fleetsim/image4.png" alt="" /></p>
<blockquote>
<p>Figure 3 : Configuration Files tab</p>
</blockquote>
<h3 id="fleet-simulator-settings"><a class="header" href="#fleet-simulator-settings">Fleet Simulator Settings</a></h3>
<p>The fleet simulator settings can be viewed in figure 4 below followed by a
detailed description of the input values thereafter.</p>
<p><img src="./Images/fleetsim/image3.png" alt="" /></p>
<blockquote>
<p>Figure 4 : Fleet simulator settings.</p>
</blockquote>
<ul>
<li>
<p>BatteryUsagePerMinAuto and BatteryUsagePerMinSTBY: Define how much battery is consumed each
minute. (% per minute)</p>
</li>
<li>
<p>BatteryChargePerMin: The rate of increase in battery charge level per minute.</p>
</li>
<li>
<p>BatteryStartMin: Defines how much battery there is on startup, this must
be defined before the Machine is initialized and connected.</p>
</li>
<li>
<p>StopAndHoldTime: Defines how long the machine will wait upon reaching a
StopAndHold point. (ms)</p>
</li>
<li>
<p>MultiTime: Multiplier for machine velocities. For faster simulation, a maximum value of 3 is
supported.</p>
</li>
<li>
<p>AutoStartEnabled: Defines whether to automatically start machine simulation when new machines
are detected. Accepted input values are either True or False.</p>
</li>
<li>
<p>AutoStartAfterSeconds: The amount of time the simulator should wait before starting the simulation
in seconds.</p>
</li>
<li>
<p>CanUseDefaultParams: Determines whether the machine should use default parameters in case custom parameters were not found. The accepted values are either True or False.</p>
</li>
<li>
<p>LoadOrUnloadTime: The amount of time to simulate the loading process of a resource.</p>
</li>
<li>
<p>OpportunityChargingEnabled: A standalone feature separate from charging manager. It is
only effective when the AGV is at a Symbolic Point that is set as charging location
and machine type parameter <strong>BATTERY_ENABLED</strong> is set to 1.</p>
</li>
<li>
<p>ChargingStartStopDelayMs: The delay in reporting to Navithor that the machine
has started charging or finished charging and started a production task. The delay
can be used to simulate the time it takes for a charging rod to be mechanically
moved and connected to the machine.</p>
</li>
<li>
<p>EncryptCommunication: Security feature for encrypting and decrypting communication.</p>
</li>
<li>
<p>SshServerPort: SSH Port used for file transfer between Fleet Control and Fleet Simulator. Default 22, changing requires Fleet Simulator restart.</p>
</li>
<li>
<p>UseMQTTCommunication: Enable MQTT Client required for VDA communication. Changing requires Fleet Simulator restart.</p>
</li>
</ul>
<p>NOTE: In order to have battery simulation working properly, define Navithor parameters
correctly. This can be achieved by setting the following parameters to FALSE:</p>
<ol>
<li>ProductionManager_UseOperationTimesForChargingEnableDisable_Rule</li>
<li>ProductionManager_UseOperationTimesForChargingRequestEnableDisable_Rule</li>
<li>ProductionManager_UpdateBatteryTimesFromOpeTimes. (and possibly more)</li>
</ol>
<p>The usage of fleet simulator is very straightforward upon completion of the above setup steps.
Just press the start button to connect the fleet simulator to Navithor and a
virtual AGV will be created and the connection kept alive. The current state of
the fleet simulator should appear as shown in figure 5 below.</p>
<p><img src="./Images/fleetsim/image6.png" alt="" /></p>
<blockquote>
<p>Figure 5 : Fleet Simulator Running</p>
</blockquote>
<p>NOTE: If the simulation does not have a params.txt file that matches the
machine type ID of the same type that is trying to connect, no virtual
AGV will be created on the server.</p>
<p>Once connected the machine will respond to TCP messages and send
periodic status messages like real AGVs running Navitrol. A connected
AGV will be shown on the list with a green background.</p>
<p>RouteFiles are updated automatically through SFTP just like with real
AGVs but can also be manually added to SimualtorPath/Files/RouteFiles</p>
<h3 id="machine-control"><a class="header" href="#machine-control">Machine Control</a></h3>
<p>The Machine Control tab allows further control of AGV machines. The machine
control tab is shown in figure 6 below.</p>
<p><img src="./Images/fleetsim/image5.png" alt="" /></p>
<blockquote>
<p>Figure 6 : Machine Control tab</p>
</blockquote>
<p>The machine control tab enables the custom configuration of machine
parameters. To achive this, choose an AGV from the <strong>Controlled AGV</strong>
section. Under this section, there are two tabs: <em>One</em> and <em>Two</em>. Tab one is
already open by default.</p>
<p>The following options exist under tab <em>One</em>:</p>
<ul>
<li>
<p>Battery Control: Sets the battery level of the AGV as a percentage</p>
</li>
<li>
<p>Hold Control: Set the location where a machine goes to stop and hold mode
until its released. The current allowed positions include the default location
or three alternate locations.</p>
</li>
<li>
<p>Bufferlane Target Detection: Modify buffer lane settings for an AGV machine.
This setting allows one to select three options namely <em>Target detected</em>, <em>Set
target buffer full</em> and <em>Toggle load status</em>.</p>
<ol>
<li><em>Target detected</em>: Stops the machine and sends DriveReady signal to Navithor.</li>
<li><em>Set target buffer full</em>: Simulates the machine detecting that there is an object
blocking the buffer and reports to Navithor that the buffer seems to be full.</li>
<li><em>Toggle load status</em>: Switches the load sensor status reported to Navithor
between full and empty.</li>
</ol>
</li>
<li>
<p>Emergency Stop: This feature enables one to stop an AGV machine through
an FStop <em>(Fast stop)</em> or an EStop <em>(Emergency stop)</em>. It also allows the
release from a stop.</p>
</li>
<li>
<p>SupervisorErrors: A feature that enables creation or deletion of supervisor
errors.</p>
</li>
<li>
<p>Battery Status Message: Enables one to customize the type of battery status
message sent by an AGV machine. An example would be to enable or disable all
status messages by setting <strong>auto</strong> or <strong>none</strong> status respectively.</p>
</li>
</ul>
<p>The following features can be found under tab <em>Two</em>:</p>
<ul>
<li>
<p>Navitrol FeatureBits: This feature offers an option to simulate sending bits that prevent an AGV from
driving forward or backward.</p>
</li>
<li>
<p>Machine State: This feature enables one to toggle manual mode.</p>
</li>
<li>
<p>Production requests: This feature allows sending of a production
request message to Navithor, similar to message that is available in Supervisor
interface of Navitrol. The available requests are <em>start production</em>, <em>stop production</em>, <em>pause
production</em>, <em>continue production</em>, <em>clear production</em>, <em>go to destination</em> and finally
<em>set production order completed</em>.</p>
</li>
<li>
<p>Actuator control: Actuator position of the AGV can be set with this control.</p>
</li>
<li>
<p>Drive Order Handling: With these controls it is possible to send manually a <em>Drive Ready</em> message to Navithor,
prevent the simulated AGV from acknowledging any parsed messages to Navithor and to reject all drive orders
Navithor sends to the AGV.</p>
</li>
<li>
<p>Resource Barcode: It is possible to write a custom barcode in the text field in this group.
If the checkbox <em>Send barcode in status message</em> is selected, the written barcode is sent periodically to Navithor
in AGV status message. The barcode can be also sent in a separate event based message with the button
<em>Send once for load validation</em>.</p>
</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="server-as-a-service"><a class="header" href="#server-as-a-service">Server as a service</a></h1>
<p>This document contains information on how to configure Navithor Server to run as a service.</p>
<p>Updated 04.02.2022</p>
<h2 id="version-history-3"><a class="header" href="#version-history-3">Version history</a></h2>
<div class="table-wrapper"><table><thead><tr><th><strong>Version</strong></th><th><strong>Date</strong></th><th><strong>Author</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>1.0</td><td>15.01.2021</td><td>Tommi Kärki</td><td>Separated from another document</td></tr>
<tr><td>1.1</td><td>09.04.2021</td><td>Evgenii Kuzminskii</td><td>Changed formatting and added notes about whitespaces and moving the Server</td></tr>
<tr><td>1.2</td><td>16.04.2021</td><td>Evgenii Kuzminskii</td><td>Added &quot;Granting permissions for SQL login&quot; section</td></tr>
<tr><td>1.3</td><td>11.06.2021</td><td>Aleksi Ålander</td><td>Renamed title</td></tr>
<tr><td>1.4</td><td>16.06.2021</td><td>Elena Sgonova</td><td>Updated title of referred document</td></tr>
<tr><td>1.5</td><td>21.10.2021</td><td>Benard Gathimba</td><td>Updated installation procedures and troubleshooting</td></tr>
<tr><td>1.6</td><td>25.10.2021</td><td>Elena Sgonova</td><td>Reorganized troubleshooting section, added new  cases</td></tr>
<tr><td>1.7</td><td>04.02.2022</td><td>Tero Laakso-Pitkäkoski</td><td>Navithor Server.exe configuration moved to ServerSettings.json</td></tr>
</tbody></table>
</div>
<hr />
<h2 id="prerequisites"><a class="header" href="#prerequisites">Prerequisites</a></h2>
<ol>
<li>
<p>Navithor Server version 1.9.57 or later.</p>
</li>
<li>
<p>SQL Server and database installation done.</p>
</li>
<li>
<p>Navithor Server is configured and can be started.</p>
</li>
<li>
<p>Running as a service is enabled by setting ConfigFiles/ServerSettings.json option <code>RunAsService</code> to <code>true</code>.</p>
</li>
</ol>
<h2 id="important-notes"><a class="header" href="#important-notes">Important notes</a></h2>
<ul>
<li>
<p>Windows services listing can be opened by typing &quot;services&quot; to Windows search.</p>
</li>
<li>
<p>User account can be changed and configured in Windows services listing.
If user account is changed, make sure that the new user has permissions to use the database if integrated security is in use.</p>
</li>
<li>
<p>If you want to temporarily run Navithor Server with the GUI without uninstalling the service, you can do this by changing <code>RunAsService</code> setting to <code>false</code> in ConfigFiles/ServerSettings.json file and starting the Navithor Server as normal application.</p>
</li>
<li>
<p>It is recommended that the full file path for Navithor Server.exe file and related .json file should not contain any whitespaces because sometimes it can prevent the installation from starting and leads to a regular start of the Server with the GUI.</p>
</li>
<li>
<p>Before moving the server to another folder the previously installed service must be uninstalled from the same directory where it was installed from.</p>
</li>
</ul>
<h2 id="installing-the-service"><a class="header" href="#installing-the-service">Installing the service</a></h2>
<ol>
<li>
<p>Open command prompt using &quot;Run as administrator&quot; option.</p>
</li>
<li>
<p>Navigate to the directory where Navithor Server.exe is located.<br />
<strong>Note that this step is important as we write the execution directory to registry.</strong></p>
</li>
<li>
<p>Run command <code>&quot;Navithor Server.exe&quot; -install</code></p>
</li>
<li>
<p>Fill in the user account that is responsible for running Navithor. This should be the system credentials you use when log in to your Windows PC. To get the username, start command prompt and run command <code>whoami</code>. Use the result as the username and give the correct <strong>password</strong> for that user account in the installation prompt window.</p>
<ul>
<li>Account name needs to be filled in the format: <code>DOMAIN\UserName</code> and if your computer does not belong to a domain, use <code>*\UserName</code> format instead.</li>
</ul>
</li>
<li>
<p>Check that FleetControlService is now listed in the Windows services listing.<br />
a.  Services listing can be opened by typing &quot;services&quot; to the windows search.<br />
b.  If FleetControlService is not listed:</p>
<ul>
<li>Check EventViewer for errors.</li>
<li>See .InstallLog file from Navithor Server.exe's directory.</li>
</ul>
</li>
<li>
<p>Navithor Server can now be started from the Windows services listing.
If service named <strong>FleetControlService</strong> is not in the listing, check the <strong>Troubleshooting</strong> section for more information.</p>
</li>
</ol>
<p>Optional: User account running the service can be changed after installation.
Navigate to <strong>Services</strong> -&gt; <strong>Properties</strong> -&gt; <strong>Log on</strong> to configure.
This can also be a local system account instead of user account.</p>
<h2 id="granting-permissions-for-sql-login"><a class="header" href="#granting-permissions-for-sql-login">Granting permissions for SQL login</a></h2>
<p>If you start Navithor Server normally it will connect to the preconfigured database with the currently logged in Windows user.
However, the account used by a service also has to have SQL login with permissions configured on SQL Server.
Depending on how SQL Server was configured there might be a need to grant additional permissions manually.</p>
<p>If FleetControlService is running but Navithor Client fails to connect after several attempts then follow the next steps to configure your SQL login:</p>
<ol>
<li>
<p>Open SQL Server Management Studio and connect to SQL Server using account with sufficient rights for SQL logins management. For example, an account with <code>securityadmin</code> or <code>sysadmin</code> role.</p>
</li>
<li>
<p>Navigate to your SQL login under <strong>Security</strong> -&gt; <strong>Logins</strong>:</p>
</li>
</ol>
<ul>
<li>If you use Local System account (in <strong>Services</strong> -&gt; <strong>Properties</strong> -&gt; <strong>Log on</strong>) then navigate to <code>NT AUTHORITY\SYSTEM</code> SQL login.</li>
</ul>
<p><img src="./Images/NavithorAsAService/systemLogin.png" alt="" /></p>
<ul>
<li>If you use Windows account then you need to create an SQL login with Windows authentication mode for this account first.
For more information see the document * SQL Server and Database installation guide*, namely &quot;Creating an SQL login for Windows authentication mode&quot; chapter.</li>
</ul>
<ol start="3">
<li>
<p>Double-click on your SQL login and navigate to <strong>User Mapping</strong> page.</p>
</li>
<li>
<p>Check <strong>Map</strong> checkbox in the upper part and grant <code>db_owner</code> role in the lower part to both NTDB_Production and NTDB_Statistics databases.</p>
</li>
</ol>
<p><img src="./Images/NavithorAsAService/userMapping.png" alt="" /></p>
<ol start="5">
<li>Press <strong>OK</strong> button to apply granting permissions.</li>
</ol>
<h2 id="uninstalling-the-service"><a class="header" href="#uninstalling-the-service">Uninstalling the service</a></h2>
<ol>
<li>
<p>Open command prompt using &quot;Run as administrator&quot; option.</p>
</li>
<li>
<p>Navigate to the directory in which Navithor Server.exe is located.</p>
</li>
<li>
<p>Run command <code>&quot;Navithor Server.exe&quot; -uninstall</code></p>
</li>
</ol>
<p><strong>Note:</strong> If the executable is not available anymore, to remove the service from the listing, open Command line prompt using &quot;Run as administrator&quot; option and run command <code>sc delete MCSServerAsService</code>.</p>
<h2 id="troubleshooting-1"><a class="header" href="#troubleshooting-1">Troubleshooting</a></h2>
<div class="table-wrapper"><table><thead><tr><th><strong>Problem</strong></th><th><strong>Potential reason</strong></th><th><strong>Solution</strong></th></tr></thead><tbody>
<tr><td>Navithor Client can not connect to server</td><td>FleetControlService is not running</td><td>Navigate to Windows Services listing. Check if <em>FleetControlService</em> is in the listing and in the Running status. If status is not Running, right-click <em>FleetControlService</em> in the listing and click Start in the context menu</td></tr>
<tr><td>FleetControlService is not in the list of services</td><td>FleetControlService is not installed</td><td>Go to <strong>Installing the service</strong> chapter and perform the installation as described</td></tr>
<tr><td>FleetControlService can not start with <strong>Error 2</strong>: The system cannot find the file specified</td><td>Navithor Server executable was moved or deleted</td><td>Right-click <em>FleetControlService</em> in the listing and click Properties in the context menu. Check <em>Path to executable</em> value, it points to a location from which the executable is trying to start. Move executable files to the right location or re-install Navithor Server service (uninstall and install it again).</td></tr>
<tr><td>FleetControlService can not start with <strong>Error 1068</strong>: The dependency service or group failed to start</td><td>Log On account issues</td><td>Right-click <em>FleetControlService</em> in the listing and click Properties in the context menu. Navigate to Log On tab, check <em>Local System account</em> option and press OK</td></tr>
<tr><td>FleetControlService is running, but Navithor Client can not connect to Server</td><td>Database connection issues</td><td>Stop FleetControlService through Services listing and if needed kill Navithor Server process. <br/><br/> Navigate to ConfigFiles folder in Navithor Server executable directory, set <code>RunAsService</code> setting to <code>false</code> in ServerSettings.json file and run <em>Navithor Server.exe</em>. If needed, set up a new database connection.<br/><br/> Check if Client now is able to connect to the Server. If it is not, check NavithorLog.txt and startInfo.log for further troubleshooting.  <br/><br/> When the problem is solved, shut down Navithor Server executable.  Set <code>RunAsService</code> setting back to <code>true</code> and start FleetControlService from Services listing</td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="configuring-hot-swap"><a class="header" href="#configuring-hot-swap">Configuring hot swap</a></h1>
<p>This document contains information on Navithor cluster failover requirements and scenarios</p>
<p>Updated 07.02.2023</p>
<h2 id="version-history-4"><a class="header" href="#version-history-4">Version History</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Version</th><th>Date</th><th>Author</th><th>Change</th></tr></thead><tbody>
<tr><td>1.0</td><td>09.10.2018</td><td>Antti Parkkonen</td><td>First version</td></tr>
<tr><td>2.0</td><td>15.01.2021</td><td>Tommi Kärki</td><td>Converted to markdown</td></tr>
<tr><td>2.1</td><td>11.06.2021</td><td>Aleksi Ålander</td><td>Renamed title</td></tr>
<tr><td>2.2</td><td>07.02.2023</td><td>Aleksi Ålander</td><td>Updated the document</td></tr>
</tbody></table>
</div>
<hr />
<h2 id="requirements"><a class="header" href="#requirements">Requirements</a></h2>
<p>Setting up the environment requires some general IT knowledge and
understanding how networking and Windows environment works.</p>
<h2 id="hardware-requirements-1"><a class="header" href="#hardware-requirements-1">Hardware requirements</a></h2>
<p>The hardware requirements are adopted from Microsoft developer network
documentation, as our testing was set up in Microsoft Azure Cloud
environment. The information provided in this section is not tested
fully and minor changes might be necessary.</p>
<ul>
<li>
<p>Servers used in the failover cluster should have identical hardware
or at least similar components.</p>
</li>
<li>
<p>Servers need networking capabilities.</p>
</li>
<li>
<p>Servers are on the same network subnet.</p>
</li>
<li>
<p>Servers need to pass the hardware requirements for running Navithor
Server.</p>
</li>
</ul>
<h2 id="software-requirements"><a class="header" href="#software-requirements">Software requirements</a></h2>
<ul>
<li>
<p>Windows Server 2016, 2019 or 2022 Operating system. 2022 is preferred. All
servers need the same version.</p>
</li>
<li>
<p>Failover Cluster feature installed on each computer that is used as
a part of the cluster.</p>
</li>
<li>
<p>All servers to be added as cluster nodes need to be joined to the
same Active Directory domain.</p>
</li>
<li>
<p>Account used to create the cluster has to be a domain user who has
administrator rights on all servers to be added as cluster nodes.</p>
</li>
<li>
<p>The user who creates the cluster has the Create Computer objects
permission to the OU or the container where the servers that will
form the cluster reside<br />
OR<br />
Ask a domain administrator to pre-stage a cluster computer object for
the cluster.<br />
(<a href="https://docs.microsoft.com/en-us/windows-server/failover-clustering/prestage-cluster-adds">https://docs.microsoft.com/en-us/windows-server/failover-clustering/prestage-cluster-adds</a>)</p>
</li>
</ul>
<h2 id="extra"><a class="header" href="#extra">Extra</a></h2>
<p>More information and documentation can be found on multiple languages:<br />
https://docs.microsoft.com/en-us/windows-server/failover-clustering/create-failover-cluster</p>
<h3 id="how-does-the-hot-swap-work"><a class="header" href="#how-does-the-hot-swap-work">How does the hot swap work?</a></h3>
<p>Hot swapping Navithor server from one computer to another pre-configured
computer can be done manually or automatically in case of failure.
Manual switching is initiated from the Failover cluster manager (Windows
server tool) and can be used for example when the software needs to be
updated or other maintenance on the computer running Navithor is needed.
Automatic switching occurs in case of Navithor server stops for some
reason. The most obvious reason for this is that the computer crashes or
is faulted.</p>
<p>Switching to another computer lasts at least 10 (t<sub>1</sub>) seconds.
Switching time depends on the size of the production area and the
cluster configuration. Switching time is longer if also the database is
configured to the cluster. After a switch all information will be loaded
back to the new Navithor server instance from the database (t<sub>2</sub>).
This means that if server parameter</p>
<p>ProductionManager_TakeMachinesIntoProductionAutomaticallyRule</p>
<p>is set true, production will continue automatically after the timeout
(t<sub>3</sub>) set in the</p>
<p>TrafficController_TAKE_INTO_PRODUCTION_TIMER_SEC</p>
<p>parameter. In conclusion, the total time the hot swap takes
t<sub>1</sub> + t<sub>2</sub> + t<sub>3</sub> amount of time, which is around 40 seconds for
a medium sized environment with default settings. For faster switching
setting the TrafficController_TAKE_INTO_PRODUCTION_TIMER_SEC to 0
is a good first step.</p>
<p>All production orders set to Navithor Server will be continued after the
switch. For the people monitoring the system a switch will only be
visible as a disconnection and reconnection. The same applies also for
the machines. Below are some simple use cases that illustrate the hot
swap capabilities.</p>
<h3 id="use-case-1-windows-updates"><a class="header" href="#use-case-1-windows-updates">Use case 1: Windows updates</a></h3>
<h4 id="situation"><a class="header" href="#situation">Situation</a></h4>
<p>Microsoft publishes critical security updates for Windows operating systems. These updates need to be installed as soon as possible to minimize security  risks. Navithor Server is running in a Failover cluster that consists of computers 1 and 2.</p>
<h4 id="user-actions"><a class="header" href="#user-actions">User actions</a></h4>
<ol>
<li>User takes a connection to a  PC in the Failover cluster.</li>
<li>User moves all related clustered resources to Computer 1 in the cluster.</li>
<li>Computer 1 now runs Navithor server.</li>
<li>User installs Windows updates to Computer 2 and restarts the computer.</li>
<li>User moves all related  clustered resources to Computer 1.</li>
<li>User installs Windows updates to Computer 1 and restarts the computer.</li>
</ol>
<h4 id="end-result"><a class="header" href="#end-result">End result</a></h4>
<ol>
<li>Both computers have the latest security updates.</li>
<li>AGV's are running the internal logistics in the production.</li>
<li>Production was stopped 2 times for 30 seconds during the updating process.</li>
</ol>
<h4 id="exceptions"><a class="header" href="#exceptions">Exceptions</a></h4>
<p>No exceptions should occur in this use case.</p>
<h3 id="use-case-2-navithor-update"><a class="header" href="#use-case-2-navithor-update">Use case 2: Navithor update</a></h3>
<h4 id="situation-1"><a class="header" href="#situation-1">Situation</a></h4>
<p>New Navithor features have been developed to optimize client's production.</p>
<p>Navithor Server is running in a Failover cluster that consists of computers 1 and 2.</p>
<h4 id="user-actions-1"><a class="header" href="#user-actions-1">User actions</a></h4>
<ol>
<li>User takes a connection to a PC in the Failover cluster.</li>
<li>User moves all related clustered resources to Computer 1 in the cluster.</li>
<li>Computer 1 now runs Navithor server.</li>
<li>User updates Navithor server on computer 2.</li>
<li>User moves all related clustered resources to Computer 2.</li>
<li>User updates Navithor server on Computer 1.</li>
</ol>
<h4 id="end-result-1"><a class="header" href="#end-result-1">End result</a></h4>
<ol>
<li>Both computers have the latest Navithor server.</li>
<li>AGV's are running the internal logistics in the production.</li>
<li>Production was stopped 2 times for 30 seconds during the updating process.</li>
</ol>
<h4 id="exceptions-1"><a class="header" href="#exceptions-1">Exceptions</a></h4>
<p>No exceptions should occur in this case.</p>
<h3 id="use-case-3-computer-running-navithor-server-crashes"><a class="header" href="#use-case-3-computer-running-navithor-server-crashes">Use case 3: Computer running Navithor server crashes</a></h3>
<h4 id="situation-2"><a class="header" href="#situation-2">Situation</a></h4>
<p>Navithor server is running in a Failover cluster that consists computers 1 and 2. Clustered resources are running on Computer 1 and Computer 1 crashes.</p>
<h4 id="user-actions-2"><a class="header" href="#user-actions-2">User actions</a></h4>
<p>No actions needed.</p>
<h4 id="end-result-2"><a class="header" href="#end-result-2">End result</a></h4>
<ol>
<li>Navithor server runs on Computer 2</li>
<li>AGV's are running the internal logistics in the production.</li>
<li>Production was stopped for 30 seconds during the switch.</li>
</ol>
<h4 id="exceptions-2"><a class="header" href="#exceptions-2">Exceptions</a></h4>
<h5 id="computer-2-is-also-faulted"><a class="header" href="#computer-2-is-also-faulted">Computer 2 is also faulted.</a></h5>
<p>In this case the production will automatically continue when either one of the computers is fixed and Failover cluster is started.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="rebranding"><a class="header" href="#rebranding">Rebranding</a></h1>
<p>This document contains information on &quot;How to rebrand Navithor.</p>
<p>Updated 11.04.2022</p>
<h2 id="version-history-5"><a class="header" href="#version-history-5">Version History</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Version</th><th>Date</th><th>Author</th><th>Description</th></tr></thead><tbody>
<tr><td>1.0</td><td>02.01.2019</td><td>Joni Sundholm</td><td>First version</td></tr>
<tr><td>1.1</td><td>08.01.2021</td><td>Toni Liski</td><td>Minor clean up</td></tr>
<tr><td>1.2</td><td>11.06.2021</td><td>Aleksi Ålander</td><td>Renamed title</td></tr>
<tr><td>1.3</td><td>11.04.2022</td><td>Tero Laakso-Pitkäkoski</td><td>Section created for Web Client</td></tr>
</tbody></table>
</div>
<hr />
<h2 id="introduction"><a class="header" href="#introduction">Introduction</a></h2>
<p>This document explains how to rebrand Navithor in order to add a new logo on the application, a new icon and a new name for Navithor Client &amp; Server.</p>
<h2 id="navithor-client-rebranding"><a class="header" href="#navithor-client-rebranding">Navithor Client rebranding</a></h2>
<h3 id="changing-icons-and-company-logo"><a class="header" href="#changing-icons-and-company-logo">Changing icons and company logo</a></h3>
<p>Icons are loaded from &quot;Navithor client directory/Icons&quot;. All of these can be replaced with new icons with <strong>same size</strong>.</p>
<p>Company logo is called &quot;CLogo.png&quot; which can be either removed (no logo will be printed) or replaced.</p>
<p>Navithor Client executable icon can be changed by adding &quot;Client.ico&quot; to same directory as &quot;Navithor Client.exe&quot;.</p>
<h3 id="changing-name"><a class="header" href="#changing-name">Changing name</a></h3>
<p>NavithorClient.exe.config has a setting named ApplicationName. Setting the value will change the name of &quot;Navithor Client&quot; to the defined application name.</p>
<h2 id="navithor-server-rebranding"><a class="header" href="#navithor-server-rebranding">Navithor Server rebranding</a></h2>
<h3 id="changing-icon"><a class="header" href="#changing-icon">Changing icon</a></h3>
<p>Folder where Navithor server is located can have a file named <em>Server.ico</em>. If it exists it is used instead of the default Navitec icon.</p>
<h3 id="changing-name-1"><a class="header" href="#changing-name-1">Changing name</a></h3>
<p>NavithorServer.exe.config has a setting named ApplicationName. Setting the value will change the name of &quot;Navithor Server&quot; to the defined application name.</p>
<h3 id="changing-server-logo"><a class="header" href="#changing-server-logo">Changing server logo</a></h3>
<p>Navithor Server logo can be changed by adding a file named <em>Logo.png</em> in the server folder.</p>
<h2 id="navithor-web-client-rebranding"><a class="header" href="#navithor-web-client-rebranding">Navithor Web Client rebranding</a></h2>
<h3 id="logo-and-icon-change"><a class="header" href="#logo-and-icon-change">Logo and icon change</a></h3>
<p>When Web Client is included, Navithor Server installation folder will contain <em>static</em> folder. This folder contains three .png image files. These files can be replaced with new files with same names and dimensions. The files are:</p>
<ul>
<li><em>cropped-favicon-32x32.png</em> Favicon logo for the web browser</li>
<li><em>logo-white.png</em> Logo shown in the navigation menu</li>
<li><em>logo.png</em> Logo shown in the login view</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="machine-tool"><a class="header" href="#machine-tool">Machine Tool</a></h1>
<p>This document contains information on the &quot;Machine Tool&quot;</p>
<p>Updated 26.10.2020</p>
<h2 id="version-history-6"><a class="header" href="#version-history-6">Version History</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Version</th><th>Date</th><th>Author</th><th>Change</th></tr></thead><tbody>
<tr><td>1.0</td><td>02.01.2020</td><td>Joni Sundholm</td><td>Initial Document</td></tr>
<tr><td>1.1</td><td>26.10.2020</td><td>Luis Rebelo</td><td>Updated document formating</td></tr>
</tbody></table>
</div>
<hr />
<h2 id="introduction-1"><a class="header" href="#introduction-1">Introduction</a></h2>
<p>Machine Tool is used to create xml-type parameter files for different
kinds of machines. Created parameters are then common for all AGVs of
the same type. The parameters contain information about following data:</p>
<ul>
<li>
<p>Machine dimensions</p>
</li>
<li>
<p>Machine kinematic model</p>
</li>
<li>
<p>Obstacle free zone around the AGV</p>
</li>
<li>
<p>Battery information</p>
</li>
<li>
<p>Loading/unloading capability</p>
</li>
<li>
<p>Data configurations for AGVs input data</p>
</li>
<li>
<p>Resource types available</p>
</li>
<li>
<p>How resource types are rendered</p>
</li>
</ul>
<p>The parameter file is by default named as
&quot;<em>parameters_machineTypeName_machineTypeID_version.xml&quot;</em>. This file
is used by Navithor Server and Navithor Tools. Machine Tool can be
started from Servers main menu selection <em>Tools-&gt;Machine Tool</em> or as
standalone application if provided.</p>
<p><img src="./Images/media/image8.png" alt="" /></p>
<blockquote>
<p>Figure : Main view of Machine Tool. Red rectangle around the vehicle
shows the obstacle free zone.</p>
</blockquote>
<p>Starting from version 1.9, Machine Tool has been extended to support
multiple resource types. Available resource types can be configured by
clicking &quot;Edit resource types&quot; button. Opened window (Figure 7. Modify
resource types window) shows all available resource types for this
machine type. All resource types listed here will be embedded into
parameter file upon saving. Manual id field allows configuring which id
this resource type will have, leaving the default -1 causes id to be
autogenerated. Id 520 is reserved for unknown resource type.</p>
<p><img src="./Images/media/image9.png" alt="" /></p>
<blockquote>
<p>Figure : Modify resource types window</p>
</blockquote>
<p>On left side, there is button &quot;Edit load limits&quot;, which allows
configuring how many of each resource type machines with this machine
type are allowed to carry at once.</p>
<p><img src="./Images/media/image10.png" alt="" /></p>
<blockquote>
<p>Figure : Edit load limits window</p>
</blockquote>
<p>On right side, there are options to configure how resource type should
be rendered. These settings are purely visual.</p>
<p><img src="./Images/media/image11.png" alt="" /></p>
<blockquote>
<p>Figure : Resource type rendering options</p>
</blockquote>
<ul>
<li>
<p>Type: Changes which resource type rendering is being configured</p>
</li>
<li>
<p>Color: Changes color for resource type</p>
</li>
<li>
<p>Width: How wide resource is</p>
</li>
<li>
<p>Length: How long resource is</p>
</li>
<li>
<p>X Offset: Changes where resource center point is along x-axis</p>
</li>
<li>
<p>Y Offset: Changes where resource center point is along y-axis</p>
</li>
<li>
<p>Z Rotation: Changes rotation of z-axis (x,y plane rotation)s</p>
</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="mes-tester"><a class="header" href="#mes-tester">MES Tester</a></h1>
<p>This document contains information on how to use the Navitec FleetSimulator.</p>
<p>Updated 05.07.2021</p>
<h2 id="version-history-7"><a class="header" href="#version-history-7">Version History</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Version</th><th>Date</th><th>Author</th><th>Change</th></tr></thead><tbody>
<tr><td>1.0</td><td>05.07.2021</td><td>Tommi Karki</td><td>Created</td></tr>
</tbody></table>
</div>
<hr />
<h2 id="introduction-2"><a class="header" href="#introduction-2">Introduction</a></h2>
<p>MES Tester is a testing utility to monitor and verify functionality of the MES interface. There are 2 different modes of operation available: Client and Server.</p>
<p>In Server mode the MES Tester will host MES interface on the specific host and port. All of the TCP connections will be accepted and any successfully received and parsed MESMessages will be visualized. Sending a message will send MESMessage to all connected Clients.</p>
<p>In Client mode the MES Tester will create a TCP connection to the specified host and port. After successful connection possible periodic messages will be visualized. It is also possible to send MESMessages to the Server for handling, the possible reply will also be visualized.</p>
<h2 id="configuring-connection-1"><a class="header" href="#configuring-connection-1">Configuring connection</a></h2>
<p><img src="./Images/mestester3/connection-configuration.png" alt="Connection configuration" /></p>
<blockquote>
<p>Example configuration</p>
</blockquote>
<p>Connection can be configured by specifying host and port. In server mode the host is ignored but the MESCommunication will be hosted on specified port. In Client mode the connection will be attempted to the specified host and port.</p>
<hr />
<h2 id="how-to-use-search"><a class="header" href="#how-to-use-search">How to use search</a></h2>
<p><img src="./Images/mestester3/search.png" alt="Search UI" /></p>
<blockquote>
<p>Searching for messages with &quot;rack&quot; in name</p>
</blockquote>
<p>MES Tester supports 2 types of search for MESMessages:</p>
<ul>
<li>Name based search</li>
<li>Id based search</li>
</ul>
<p>Typing the entire ID of message will filter the selection to single result only. The ID has to be precise match, there is no support for partial id search. This means inputting &quot;2&quot; will give matches only for &quot;message with id 2&quot; and NOT for &quot;2&quot;, &quot;22&quot;, &quot;122&quot;.</p>
<p>Typing text into the search will start search based on the name of message. Currently there is no fuzzy search support but instead the search works on partial matches. Input of &quot;Rack&quot; would give results for &quot;DriveMachineToRack&quot;, &quot;GetRackSetup&quot;,  &quot;RackTransferRequest&quot;.</p>
<h2 id="viewing-messages"><a class="header" href="#viewing-messages">Viewing messages</a></h2>
<p><img src="./Images/mestester3/mainview.png" alt="Default view" /></p>
<blockquote>
<p>Received messages after server connection has been made</p>
</blockquote>
<p>In normal view the message fields are abbreviated to fit as many as possible into the view but if the message is long enough then it will not fit into the main view. To view full message with non-abbreviated names click on the message you want to view.</p>
<p><img src="./Images/mestester3/detailed-view.png" alt="Detailed view" /></p>
<blockquote>
<p>Tooltip that pops up after clicking on message.</p>
</blockquote>
<hr />
<h2 id="further-configuration"><a class="header" href="#further-configuration">Further configuration</a></h2>
<p>Clicking on &quot;Preferences&quot; will open up further configuration options. The values here will be stored in plaintext in the same directory of the MES Tester in the file 'configuration.json'. These configurations might include some sensitive information like API tokens which should be cleared after testing has been done on production environments.</p>
<h2 id="automatic-replies"><a class="header" href="#automatic-replies">Automatic replies</a></h2>
<p>To make testing more automatic, MES Tester will reply to specific requests with randomized replies. This is to mock the behaviour of actual Navithor Server.</p>
<p><img src="./Images/mestester3/randomized-reply.png" alt="Randomized reply" /></p>
<blockquote>
<p>Randomized reply to GetProductionAreaInformation (52) when querying for machine types</p>
</blockquote>
<h2 id="connected-clients-and-protocol-testing"><a class="header" href="#connected-clients-and-protocol-testing">Connected Clients and protocol testing</a></h2>
<p>When MES Tester is in Server mode it is possible to see connected client and run tests to ensure correct implementation of MES protocol. Click on 'Clients' button to open this view.</p>
<p><img src="./Images/mestester3/connected-clients.png" alt="Connected clients" /></p>
<blockquote>
<p>Connected clients UI. Clicking on button will send specified test message to client. Results of sent message(s) are not automatically analysed and has to be done manually.</p>
</blockquote>
<div style="break-before: page; page-break-before: always;"></div><h1 id="system-overview-and-user-instructions-for-client-ui"><a class="header" href="#system-overview-and-user-instructions-for-client-ui">System Overview and user instructions for Client UI</a></h1>
<p>This document contains an Overview of the Navithor Client/Server</p>
<p>Updated 13.10.2022</p>
<h2 id="version-history-8"><a class="header" href="#version-history-8">Version History</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Version</th><th>Date</th><th>Author</th><th>Change</th></tr></thead><tbody>
<tr><td>0.1</td><td>09.11.2012</td><td>Jouni Sievelä</td><td>Document created</td></tr>
<tr><td>1.0</td><td>29.06.2015</td><td>Joni Sundholm</td><td>Document updated, reflecting Navithor version 1.2.0.0</td></tr>
<tr><td>1.1</td><td>04.01.2016</td><td>Jouni Sievilä</td><td>Document updated, reflecting Navithor version 1.3</td></tr>
<tr><td>1.2</td><td>30.06.2016</td><td>Joni Sundholm</td><td>Document updated and renamed, reflecting Navithor version 1.5</td></tr>
<tr><td>1.3</td><td>05.09.2016</td><td>Joni Sundholm</td><td>Document updated, reflecting Navithor version 1.6</td></tr>
<tr><td>1.3.1</td><td>27.09.2016</td><td>Joni Sundholm</td><td>Hold release reasoning update -- Hold-state now allowed to be released to any destination. Navithor version 1.6.2.</td></tr>
<tr><td>1.4</td><td>06.03.2017</td><td>Joni Sundholm</td><td>Document updated, reflecting Navithor version 1.7</td></tr>
<tr><td>1.4.1</td><td>21.03.2017</td><td>Joni Sundholm</td><td>Minor updates to Client user instructions</td></tr>
<tr><td>1.4.2</td><td>06.10.2017</td><td>Joni Sundholm</td><td>Minor updates to production order list-production. Reflecting Navithor version 1.8</td></tr>
<tr><td>1.5</td><td>06.02.2018</td><td>Tommi Kärki</td><td>Multiple resource types added, reflecting Navithor version 1.9</td></tr>
<tr><td>1.5.1</td><td>16.03.2018</td><td>Tommi Kärki</td><td>Minor corrections to document.</td></tr>
<tr><td>1.5.2</td><td>15.05.2018</td><td>Joni Sundholm</td><td>Updated chapter 3.1.3. Charging manager. Added chapter 6. System Parameters</td></tr>
<tr><td>2.0</td><td></td><td>Tommi Kärki</td><td>Converted to markdown style</td></tr>
<tr><td>2.1</td><td>03.12.2019</td><td>Joni Sundholm</td><td>Document updated to reflect Navithor version 2.10</td></tr>
<tr><td>2.2</td><td>14.12.2020</td><td>Joni Sundholm</td><td>Document updated to reflect Navithor version 2.20</td></tr>
<tr><td>2.3</td><td>19.04.2021</td><td>Toni Liski</td><td>Renamed charging related parameters.</td></tr>
<tr><td>2.4</td><td>11.06.2021</td><td>Aleksi Ålander</td><td>Renamed title and minor corrections.</td></tr>
<tr><td>2.4.1</td><td>16.06.2021</td><td>Elena Sgonova</td><td>Updated images. Minor corrections.</td></tr>
<tr><td>2.5</td><td>30.06.2021</td><td>Simon Clement</td><td>Added charging behavior with parameter DriveToChargeIfNoProduction for single AGV systems</td></tr>
<tr><td>2.6</td><td>12.07.2021</td><td>Elena Sgonova</td><td>Added information on Alarms visualization configuration in Client</td></tr>
<tr><td>2.7</td><td>04.03.2022</td><td>Elena Sgonova</td><td>Added reference for Managing Battery Levels documents to Battery Monitor chapter</td></tr>
<tr><td>2.8</td><td>11.05.2022</td><td>Elena Sgonova</td><td>Updated Navithor Client screenshots</td></tr>
<tr><td>2.9</td><td>13.10.2022</td><td>Aleksi Ålander</td><td>Updated chapter about Alarms</td></tr>
</tbody></table>
</div>
<hr />
<h2 id="motivation"><a class="header" href="#motivation">Motivation</a></h2>
<p>This document will introduce Navithor Fleet Control System, its components and different features. Additionally Client user instructions are also find for basic understanding of controlling the Fleet Control System through Navithor Client. System parameters are important part of configuring the system for different types of production areas - most important parameters are described also in this document.</p>
<h2 id="introduction-3"><a class="header" href="#introduction-3">Introduction</a></h2>
<p>Navithor Fleet Control System is a software suite for controlling a
fleet of autonomous work machines. The machines are typically called as AGVs (Autonomous Guided Vehicles). The AGVs typically execute logistical transports of different kinds of goods. The role of the Navithor Fleet Control System is to control the drive tasks of the AGVs and give commands to move actuators onboard the AGVs to perform pickups or dropoffs of carried items. The fleet of AGVs can contain multiple different types of machines. The AGVs commonly are:</p>
<ul>
<li>Flat AGV
<ul>
<li>Actuator(s) on top, e.g. lifting table, pin or grabber unit</li>
<li>Normally Omni-, mechanum- or differential-driven AGVs</li>
</ul>
</li>
<li>Fork AGV
<ul>
<li>Fork - or grabber actuator</li>
<li>Normally steer-drive, fixed wheels on fork-end and turning drive wheel(s) in front, are used. Also omni-platforms are used.</li>
</ul>
</li>
<li>Tugger AGV
<ul>
<li>Quad steer-trailers are pulled behind</li>
<li>Normally steer-driven AGVs</li>
</ul>
</li>
</ul>
<p>The role of the AGV is to perform the movement commands and other task related actions. One AGV only knows the position of itself thus the coordinated movement of the fleet is managed by Navithor. The software also manages order assignment and battery charging control. The AGV is responsible for reporting it's status and position while connected to Navithor over WIFI. It also needs to follow given drive paths and execute stationary tasks when ordered or report failure if given command cannot be executed.</p>
<p>Navithor Software suite contains following individual executable programs:</p>
<ul>
<li>Navithor Server
<ul>
<li>Traffic Control</li>
<li>Mission Management</li>
<li>Battery Management</li>
<li>Production Management</li>
<li>Interfaces to other parts of the system
<ul>
<li>Database for storing data</li>
<li>Manufacturing Execution System (MES)</li>
<li>AGVs</li>
<li>Clients</li>
<li>Web Server</li>
</ul>
</li>
</ul>
</li>
<li>Navithor Client
<ul>
<li>Map view of production area</li>
<li>Access to system parameters</li>
<li>Area files upload, activation</li>
<li>AGV Control</li>
</ul>
</li>
<li>Navithor Tools
<ul>
<li>Creating and editing of production area map.</li>
</ul>
</li>
</ul>
<p>Components are described in more detail in section <a href="navithorServerAndClientMegaDocument.html#Software-Components">Software Components</a></p>
<h2 id="used-definitions"><a class="header" href="#used-definitions">Used definitions</a></h2>
<p>Before further introduction, following definitions are shortly described as they are referenced in this document later.</p>
<h3 id="navitrol-states"><a class="header" href="#navitrol-states">Navitrol states</a></h3>
<p>Navitrol state informs the current operation mode of the AGV. For example Standby (STBY) means the AGV is ready and waiting for commands.</p>
<div class="table-wrapper"><table><thead><tr><th>State</th><th>Description</th></tr></thead><tbody>
<tr><td>IDLE</td><td>AGV not operational yet - Navitrol in pre-operational state.</td></tr>
<tr><td>STBY</td><td>AGV is stationary and ready for tasks</td></tr>
<tr><td>AUTO</td><td>AGV is executing drive task</td></tr>
<tr><td>HOLD</td><td>AGV is stationary waiting for signal to release it from  HOLD-state to STBY. Navithor will not order any tasks while AGV is on hold-task</td></tr>
<tr><td>MANUAL</td><td>AGV is in manual control, Navithor will not command the AGV</td></tr>
<tr><td>FSTOP</td><td>AGV is fast stopped (emergency stop)</td></tr>
<tr><td>ACTUATOR_CONTROL</td><td>AGV is performing control or monitoring of the actuator</td></tr>
</tbody></table>
</div>
<p>Navithor receives AGVStatus-messages periodically from each enabled AGV in the system. Default report interval is 0.1 seconds. If status-messages are not received in defined timeout (parameter TrafficController_MACHINE_STATUS_TRUST_LIMIT_SECONDS) or if socket communication closes then UNKNOWN-state is forced in Navithor.</p>
<h3 id="agv-production-state"><a class="header" href="#agv-production-state">AGV production state</a></h3>
<div class="table-wrapper"><table><thead><tr><th>State</th><th>Description</th></tr></thead><tbody>
<tr><td>In production</td><td>AGV is controlled by Traffic Controller, all tasks are generated by Mission Manager</td></tr>
<tr><td>Not in production</td><td>AGV may be operated by Client user, Mission Manager does not generate orders</td></tr>
</tbody></table>
</div>
<p>When AGV is in production it executes production orders that have been created for the specific vehicle. Production order can be created from any interface to Navithor Server: MES-, Navitrol-, Client- or even database. When AGV is in production Navithor Client will not let give any operator drive commands to the AGV. AGV may still be operated from interfaces that are connected to Navitrol (e.g. Navitrol Monitor, Supervisor interface, WebUI) as the production state is purely Navithor definition.</p>
<h3 id="orders-and-tasks-in-system"><a class="header" href="#orders-and-tasks-in-system">Orders and Tasks in System</a></h3>
<p>As normal order handled by one AGV contains normally multiple executable tasks, e.g. drive, pickup, drive, drop off Navithor separates different levels of actions into following definitions:</p>
<h4 id="machine-order"><a class="header" href="#machine-order">Machine Order</a></h4>
<p>Machine Order is a single executable order for an AGV.
They are generated and controlled by Navithor Traffic Controller.
Traffic controller gives executable order from current active Task of machine.</p>
<div class="table-wrapper"><table><thead><tr><th>Order</th><th>Description</th></tr></thead><tbody>
<tr><td>Start drive</td><td>Starts a drive to location</td></tr>
<tr><td>Extend a drive</td><td>Extends ongoing drive to new location</td></tr>
<tr><td>Load</td><td>Start actuator control for loading resource on board</td></tr>
<tr><td>Unload</td><td>Start actuator control for unloading resource</td></tr>
<tr><td>Abort</td><td>Abort current order</td></tr>
<tr><td>Set speed</td><td>Sets target speed for AGV</td></tr>
<tr><td>Fast stop</td><td>Orders AGV to stop (speed reference set to 0)</td></tr>
<tr><td>Start hold</td><td>Orders AGV to go into Hold state (external signal required to release from HOLD)</td></tr>
<tr><td>Charge command</td><td>Orders AGV to start charging</td></tr>
<tr><td>Wait for production</td><td>AGV is idle and waiting for next Task</td></tr>
</tbody></table>
</div>
<p>Difference between Aborting a drive and Fast Stopping a drive is that Navitrol applies a slowdown ramp when drive is aborted to make the stopping smooth. Fast stopped AGV sets speed reference to 0 and stops as fast as possible. Fast stop also needs to be released manually via Release FSTOP-button.</p>
<h4 id="task"><a class="header" href="#task">Task</a></h4>
<p>Tasks are processes executed by the AGVs. One task may be for example to drive from A to B or set fork position to X to pickup pallet. Navithor MissionManager generates tasks from Production Orders or tasks can be triggered from Navithor Client by e.g. commanding AGV to drive to a X,Y-point (Goto XY).</p>
<div class="table-wrapper"><table><thead><tr><th>Task type</th><th>Description</th></tr></thead><tbody>
<tr><td>Wait for production</td><td>AGV is idle and waiting for next Task</td></tr>
<tr><td>Idle</td><td>AGV not in production and no given commands</td></tr>
<tr><td>Drive</td><td>Task with route, needs to be scheduled. Succeeds when target reached.</td></tr>
<tr><td>Load Resource</td><td>Stationary task that succeeds when resource has been successfully put onboard</td></tr>
<tr><td>Unload Resource</td><td>Stationary task that succeeds when resource has been successfully moved away from AGV</td></tr>
<tr><td>Hold</td><td>Stationary task that succeeds when hold release signal is received from any interface available</td></tr>
<tr><td>Charge battery</td><td>Stationary task that succeeds latest when battery level reaches full level</td></tr>
</tbody></table>
</div>
<h4 id="production-order"><a class="header" href="#production-order">Production Order</a></h4>
<p>Production order is a high level goal given or generated by Production Manager.
Production order will be split into one or multiple Tasks for AGVs to execute. Production Orders are stored in database.</p>
<h4 id="unhandled-order"><a class="header" href="#unhandled-order">Unhandled Order</a></h4>
<p>In resource based production Unhandled Orders are requests for item (resources) transfer. These items can be informed to the System and Navithor finds a valid AGV for the transfers. A Production Order is created for the AGV and the order execution completes when AGV has unloaded the item to a valid unload location. The valid unload location can be reasoned with configurations done in Navithor Tools and Navithor parameters affect the selection method.</p>
<h4 id="transfer-request"><a class="header" href="#transfer-request">Transfer Request</a></h4>
<p>Transfer Request is an order to move an item from one location to another or to valid destination within a group of given destinations. Difference between Transfer Request and Unhandled Order is that Transfer Request specifies the destination(s) and Unhandled Order does not. In both production types the AGV assign is done by Navithor.</p>
<h4 id="goto-order"><a class="header" href="#goto-order">GOTO Order</a></h4>
<p>System operator has possibility to send a drive command from Navithor Client or Web Client (Goto XY-button). This command is stored only in Server memory and the drive command is neither managed by MissionManager nor Production Manager like the all the order-types above. Goto-order is a drive task to a location along the route network. GOTO order does not automatically continue in case of automatic abort or AGV error that stops the AGV. A new GOTO order needs to be given in these cases.</p>
<h4 id="examples-of-order-execution"><a class="header" href="#examples-of-order-execution">Examples of order execution</a></h4>
<p>Example 1</p>
<ul>
<li>Client User gives a GOTO order for machine</li>
<li>Drive task with following data is created:
<ul>
<li>Machine - Selected AGV in Client</li>
<li>Target location - Clicked location on map</li>
<li>Drive route - List of drive segments that create a path from AGVs current location to target location</li>
</ul>
</li>
<li>Traffic controller will roughly generate following Machine orders:
<ul>
<li>Start drive</li>
<li>Set speed</li>
<li>Extend drive (until we reach drive target)</li>
</ul>
</li>
</ul>
<p>Example 2</p>
<ul>
<li>MES interface requests 1 Pallet to be moved from LoadA1 to UnloadB1</li>
<li>This will generate a transfer request</li>
<li>MES-interface signals also the resource to be at LOA location when it is available for</li>
<li>Production Manager attempts to find suitable machine to execute transfer request</li>
<li>Production order gets generated with following data
<ul>
<li>Machine (picked by Production Manager)</li>
<li>Source location (LoadA1)</li>
<li>Target location (UnloadB1)</li>
<li>Resource type (Pallet)</li>
<li>Resource amount (1)</li>
</ul>
</li>
<li>Traffic controller will roughly generate following Tasks
<ul>
<li>Drive task (to drive AGV to pickup location). Machine orders:
<ul>
<li>Start drive</li>
<li>Extend drive (until we reach drive target: LoadA1)</li>
</ul>
</li>
<li>Load Resource
<ul>
<li>Actuator control (Load resource onboard)</li>
</ul>
</li>
<li>Drive task (to drive AGV to target)
<ul>
<li>Start drive</li>
<li>Extend drive (until we reach drive target: UnloadB1)</li>
</ul>
</li>
<li>Unload Resource
<ul>
<li>Actuator control</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="production-area-related-definitions"><a class="header" href="#production-area-related-definitions">Production area related definitions</a></h3>
<h4 id="segment"><a class="header" href="#segment">Segment</a></h4>
<p>Segment is a set of points following each other to create a drivable
path. One segment can contain from 2 to unlimited amount of coordinate
points. All segments together in the production area form the route network.
Point interval is usually between 50 mm to 500 mm.</p>
<p>Segment is always directional: AGV is allowed to drive through the
segment in point index order. AGV cannot drive from the tail end of the
segment to the start. Speed direction of the segment (negative speed
denotes reversing) sets the required AGV pose for the segment.</p>
<p>Segments are generated automatically with Tools. Lane definitions affect how many segments will be created to a single route path. 0-4 Segments are possible.</p>
<h4 id="symbolic-point"><a class="header" href="#symbolic-point">Symbolic Point</a></h4>
<p>Symbolic Points are production locations used in production orders. Symbolic Points are edited and configured with Navithor Tools. There are multiple Symbolic Point types available in the system.</p>
<div class="table-wrapper"><table><thead><tr><th>Symbolic point type</th><th>Description</th><th>Usage</th></tr></thead><tbody>
<tr><td>Load</td><td>Loading location</td><td>Target for Loading actions</td></tr>
<tr><td>Unload</td><td>Unload location</td><td>Target for Unloading actions</td></tr>
<tr><td>LoadUnload</td><td>Loading and unloading location</td><td>Target for Loading and Unloading actions</td></tr>
<tr><td>WaitLoad</td><td>Wait location for Load tasks</td><td>Automatically driven to when AGV is empty and has no Production Orders</td></tr>
<tr><td>WaitUnload</td><td>Wait location for Unload tasks</td><td>Optional location before going to Unload target</td></tr>
<tr><td>Stop</td><td>Location where AGV can be commanded to stop at</td><td>Target for drive orders. Used mainly in <a href="navithorServerAndClientMegaDocument.html#hold-release-reasoning">Hold-Release production</a></td></tr>
<tr><td>NoStop</td><td>Location that is can be targeted and continued to next target without stopping</td><td>Symbolic point used to alter how scheduling works or forcing specific route to be used in Hold-release-production</td></tr>
<tr><td>Charge</td><td>Charging location</td><td>Location where AGV can charge battery</td></tr>
<tr><td>StopAndHold</td><td>Invisible stop point for Navithor - AGV stops when reaching this and waits for signal to continue</td><td>Force AGV to stop when driving past and transition to HOLD-state</td></tr>
<tr><td>Rack</td><td>LoadUnload point with multiple levels for pickup and drop-off</td><td>Warehouse production</td></tr>
</tbody></table>
</div>
<p>Using correct Symbolic Point Types is essential when setting up Production environment because they affect how Navithor Server generates Production Orders. Some actions are also restricted to certain Symbolic Point types only.</p>
<div class="table-wrapper"><table><thead><tr><th>Symbolic point action</th><th>Applicable Symbolic point types</th></tr></thead><tbody>
<tr><td>Wait</td><td>WaitUnload, WaitLoad, Wait, Charge(parameter)</td></tr>
<tr><td>Hold/Release</td><td>Stop, Load, Unload, LoadUnload, WaitUnload, WaitLoad, Wait, NoStop</td></tr>
<tr><td>Loading and unloading</td><td>Load, Unload, LoadUnload</td></tr>
</tbody></table>
</div>
<p>Symbolic point usage is explained later in <a href="navithorServerAndClientMegaDocument.html#production-manager">Production Manager</a> and <a href="navithorServerAndClientMegaDocument.html#scheduling-of-drive-tasks">Scheduling</a></p>
<h4 id="waypoint"><a class="header" href="#waypoint">Waypoint</a></h4>
<p>Waypoints are area definitions that are used for drive task scheduling
and traffic controlling. Waypoints are constructed from segments: one
waypoint can contain multiple segments and its area is calculated from
the segment points and from a parameter value defining the width of the
waypoint.</p>
<p><img src="./Images/media/image3.png" alt="" /></p>
<blockquote>
<p>Figure: Waypoint visualization</p>
</blockquote>
<p>Waypoints visualized in Client -&gt; AreaControl. Some Nodes are locked (orange), one Link (also
orange) is reserved and one Link is set forbidden by user.</p>
<p>There are two types of Waypoints in Navithor: Nodes and Links. Nodes are waypoints
that have crossing paths with other waypoint (i.e. intersections). Links
are waypoints connecting two nodes together with no crossing paths with
any other waypoint. Waypoints are generated automatically in Navithor Tools.</p>
<p>When traffic controller reserves path for an AGV to drive along Nodes,
they are always locked: by default no other AGV can enter or move in the same or
crossing nodes.</p>
<div class="table-wrapper"><table><thead><tr><th>Waypoint State</th><th>Description</th></tr></thead><tbody>
<tr><td>Free</td><td>No AGVs moving inside or entering waypoint</td></tr>
<tr><td>Reserved</td><td>Segment(s) owned by the waypoint are released for AGV(s) to drive (Link)</td></tr>
<tr><td>Locked</td><td>Segment(s) owned by the waypoint are released for a single AGV (Node)</td></tr>
<tr><td>Forbidden</td><td>No traffic allowed in waypoint (automatically set by traffic controller or manually by Client user)</td></tr>
</tbody></table>
</div><br>
<h4 id="production-zones"><a class="header" href="#production-zones">Production Zones</a></h4>
<p>Navithor supports multiple production zone types starting from release version 1.9.50.x.</p>
<div class="table-wrapper"><table><thead><tr><th>Zone name</th><th>Description</th></tr></thead><tbody>
<tr><td>One machine zone</td><td>AGV entering the zone (when drive path is given inside the zone or when AGV's navigation point is inside the bounds of the zone) has exclusive right to move inside this area. No other AGV can enter the area until it becomes empty</td></tr>
<tr><td>Distance Control Zone</td><td>Machines entering this zone are taken into distance control. By changing the drive speeds of the machines Navithor will pursue to gain constant distances between all the machines that are within the same zone and same drive path. This feature is targeted to be used in situations when AGVs needs to move very slowly in an assembly line production</td></tr>
<tr><td>Fire alarm zone</td><td>Supported by Navithor version 2.20 and above. Zone marks the area that needs to be clear in case of fire alarm. Navithor will drive AGVs out of the Zone automatically in case of alarm being raised for the specific Zone</td></tr>
<tr><td>Feature enable Zone</td><td>This zone contains multiple 'rules'. Navithor 2.20 version supports 'FC_Forbidden'-rule. That will mark Zone as forbidden to drive into/through on MES signal to Navithor</td></tr>
</tbody></table>
</div>
<h2 id="software-components"><a class="header" href="#software-components">Software Components</a></h2>
<p>Following diagram defines the relationships between software components.</p>
<p><img src="./Images/media/NavitecSoftware.png" alt="System structure" /></p>
<blockquote>
<p>Figure: System Structure</p>
</blockquote>
<h3 id="navithor-fleet-control-system-components"><a class="header" href="#navithor-fleet-control-system-components">Navithor Fleet Control System Components</a></h3>
<h4 id="navithor-server"><a class="header" href="#navithor-server">Navithor Server</a></h4>
<p>The Navithor Server is main software component of the system. It stores and manages all the data that is used for mission control. Navithor Server can be run as Windows application with a minimalistic user interface or it can be set up to run as a service.</p>
<h5 id="navithor-server-agents"><a class="header" href="#navithor-server-agents">Navithor Server Agents</a></h5>
<p>Navithor Server operates through many agents that take responsibility over the full production flow. They are:</p>
<ul>
<li>
<p>Production Manager</p>
<ul>
<li>Generates production orders for AGVs from input data
<ul>
<li>Unhandled Orders</li>
<li>Transfer Requests</li>
<li>Hold-release data</li>
</ul>
</li>
</ul>
</li>
<li>
<p>Charging manager</p>
<ul>
<li>Reasons who should be charged</li>
<li>Generates automatic charging requests</li>
</ul>
</li>
<li>
<p>Mission Manager</p>
<ul>
<li>Generates executable Tasks for AGVs from production orders</li>
<li>Reasons what should AGV do next if AGV is in production</li>
<li>Handles execution of Tasks</li>
</ul>
</li>
<li>
<p>Route Planner</p>
<ul>
<li>Finds minimum cost (time) routes for drive-tasks or alternative routes when traffic in priority route</li>
</ul>
</li>
<li>
<p>Traffic Controller</p>
<ul>
<li>Gives commands to AGV from current Task</li>
<li>Collision avoidance</li>
<li>Dynamic stop zones
<ul>
<li>Virtual safety stop zone around AGV</li>
</ul>
</li>
<li>Dynamic speed zones
<ul>
<li>Virtual warning zone around AGV</li>
</ul>
</li>
<li>Intersection locking</li>
<li>Segment reservation</li>
<li>Safe stop point assign
<ul>
<li>AGVs have no overlapping paths - AGVs allowed to drive even during communication losses</li>
</ul>
</li>
<li>Drive task deadlock detection
<ul>
<li>Ordering alternative routes</li>
<li>Ordering AGV out from deadlock zone</li>
</ul>
</li>
</ul>
</li>
<li>
<p>Scheduler</p>
<ul>
<li>Schedules drive tasks</li>
<li>Orders rerouting if needed</li>
</ul>
</li>
</ul>
<h5 id="interfaces"><a class="header" href="#interfaces">Interfaces</a></h5>
<ul>
<li>
<p>Manufacturing Execution System (MES) interface</p>
<ul>
<li>Data input for Production Manager (MES to Navithor)
<ul>
<li>Resource transfer-based production requires external MES Client to feed resource data and possibly transfer request data to Navithor</li>
</ul>
</li>
<li>Reporting (Navithor to MES)</li>
</ul>
</li>
<li>
<p>Database Interface</p>
<ul>
<li>Storing and retrieving production area state</li>
<li>Production order state</li>
<li>Transfer request state</li>
<li>Machine configuration</li>
<li>Resource configuration</li>
<li>Statistics data</li>
</ul>
</li>
<li>
<p>Client Interface (desktop)</p>
<ul>
<li>Communication between Server and Client</li>
<li>Controlling AGVS</li>
<li>Monitoring production</li>
<li>Triggering manual production</li>
</ul>
</li>
<li>
<p>Client interface (web client)</p>
<ul>
<li>Same functionalities as desktop interface</li>
</ul>
</li>
</ul>
<h5 id="navithor-server-user-interface"><a class="header" href="#navithor-server-user-interface">Navithor Server User interface</a></h5>
<p><img src="./Images/media/image5.png" alt="" /></p>
<blockquote>
<p>Figure: Navithor Server UI</p>
</blockquote>
<p>Navithor Server user interface. Interface is used for certain administrative tasks. Navithor Server can also be run as service without user interface.</p>
<p>Menu selections:</p>
<ul>
<li>Settings
<ul>
<li>Import old TCC (v1) parameter file
<ul>
<li>Used to convert old TCC parameter file to V2 format</li>
</ul>
</li>
<li>Reload production area
<ul>
<li>Manually command server to reload production area</li>
</ul>
</li>
</ul>
</li>
<li>Statistics
<ul>
<li>Enabled
<ul>
<li>Whether verbose statistics collection is enabled</li>
<li>Generates a ProductionAreaData order with logs</li>
</ul>
</li>
<li>Print statistics
<ul>
<li>Triggers statistical data to be saved to files. (Obsolete)</li>
</ul>
</li>
<li>Open directory
<ul>
<li>Open log folder</li>
</ul>
</li>
<li>Save logs
<ul>
<li>Copy current logs to separate folder</li>
</ul>
</li>
</ul>
</li>
<li>Tools
<ul>
<li>Database tool
<ul>
<li>Open Tool for configuring Database connection</li>
</ul>
</li>
<li>Open MES status tool
<ul>
<li>Open Tool for monitoring server side of MES communication</li>
</ul>
</li>
</ul>
</li>
<li>About
<ul>
<li>Show version information of Software and database/MES-interfaces</li>
</ul>
</li>
</ul>
<h4 id="navithor-client"><a class="header" href="#navithor-client">Navithor Client</a></h4>
<p><img src="./Images/clientUI/NavithorClient2.50.png" alt="" /></p>
<blockquote>
<p>Figure: Navithor Client</p>
</blockquote>
<p>Navithor Client is a Windows OS-based graphical user interface for
Navithor Fleet Control System. Its main features are:</p>
<ul>
<li>Monitoring the production of a fleet of autonomous machines controlled by Navithor Server</li>
<li>Commanding AGVs: driving, loading, unloading, creating production orders</li>
<li>Changing production area configuration (system administrator)
<ul>
<li>AGV configuration</li>
<li>Production area files configuration</li>
<li>System parameter configuration</li>
<li>Global settings</li>
</ul>
</li>
</ul>
<p>See chapter <a href="navithorServerAndClientMegaDocument.html#navithor-client-user-instructions">Navithor Client User Instructions</a> for more information.</p>
<h5 id="map-rendering---opengl"><a class="header" href="#map-rendering---opengl">Map Rendering - OpenGL</a></h5>
<p>Navithor Client uses OpenGL-rendering for all shown features in map
views.</p>
<p>For this reason it is not advised to use virtual Windows-environment for Navithor Client. Virtual environment has poor support for OpenGL-rendering thus CPU load will increase significantly when Navithor Client is running.</p>
<p>It is also not recommended to use Navithor Client over Windows remote desktop. Remote desktop has poor support for Modern OpenGL and will default to OpenGL 1.1. This can be circumvented by starting a Client on PC before establishing a remote connection. There are alternative remote access softwares without this restriction.</p>
<p>Some parts of Client use OpenGL 3.x feature for performance reasons. There is fallback support for older OpenGL but performance is heavily impacted.</p>
<h5 id="manufacturing-execution-system-mes-status-tool-server-side"><a class="header" href="#manufacturing-execution-system-mes-status-tool-server-side">Manufacturing Execution System (MES) Status Tool (Server side)</a></h5>
<p><img src="./Images/media/image13.png" alt="" /></p>
<blockquote>
<p>Figure: MES Tool</p>
</blockquote>
<p>MES communication interface can be tested and monitored with MES Status Tool. Status Tool shows ongoing communication between Server and MES client(s). Status tool can also be used to configure server MES port.</p>
<p>MES Status Tool can be accessed from Servers main menu selection <strong>Tools -&gt; MES
Tool.</strong> Also it can be requested from Navitec as a standalone executable for MES related signal testing.</p>
<h4 id="navithor-tools"><a class="header" href="#navithor-tools">Navithor Tools</a></h4>
<p><img src="./Images/media/image7.png" alt="" /></p>
<blockquote>
<p>Figure: Navithor Tools</p>
</blockquote>
<p>Navithor Tools is a standalone software for generating a Production Area. Production Area as a concept means single area where production takes place. Once the production area is defined in Navithor Tools it needs to be uploaded to Navithor's database or if no connection to database is available then files can be exported for later database upload through Navithor Client. The files that are required for a single production area are:</p>
<ul>
<li>
<p>Definition file</p>
<ul>
<li>Defines a production area (traffic areas)</li>
<li>Zones</li>
<li>Pairs machinetype, environment and segment files together</li>
<li>.xml-file</li>
</ul>
</li>
<li>
<p>Environment file(s)</p>
<ul>
<li>Environment model used by machines</li>
<li>Environment file is used in Navithor for visualization purposes only</li>
<li>.nte-file (binary)</li>
</ul>
</li>
<li>
<p>Route file(s)</p>
<ul>
<li>Also known as segment files</li>
<li>Route network</li>
<li>Segment properties i.e. omni heading</li>
<li>Symbolic point information
<ul>
<li>Id, Name, Location</li>
<li>Type</li>
<li>Tags</li>
<li>Allowed resources for Symbolic Point</li>
</ul>
</li>
<li>.xml-file</li>
</ul>
</li>
</ul>
<p>Machine type Parameter file(s)</p>
<ul>
<li>Generated with MachineTool and exported to Tools</li>
<li>Machine dimensions</li>
<li>Machine rendering information</li>
<li>Allowed resources for machine</li>
<li>Machine configuration (Navithor specific configuration)</li>
<li>.xml-file</li>
</ul>
<p>If multiple machine types are defined for the production area then the fileset would contain:</p>
<ul>
<li>1 * definition file</li>
<li>n * segment file</li>
<li>n * environment file</li>
<li>n * machine type file</li>
</ul>
<h4 id="navitrol"><a class="header" href="#navitrol">Navitrol</a></h4>
<p>Navitrol is the control software running in each AGV. There are three
different Navitrol solutions:</p>
<ul>
<li>
<p>Navitrol Positioning</p>
<ul>
<li>Navitrol provides corrected X, Y, H - information</li>
<li>Navithor connection disabled</li>
</ul>
</li>
<li>
<p>Navitrol Driving</p>
<ul>
<li>Drive orders from Navithor</li>
<li>Navithor connection enabled or disabled (external drive orders)</li>
</ul>
</li>
<li>
<p>Navitrol Standalone</p>
<ul>
<li>Navithor not required</li>
<li>Single machine system</li>
<li>Route finding</li>
<li>Hold-release reasoning production</li>
</ul>
</li>
</ul>
<h5 id="navitrol-monitor"><a class="header" href="#navitrol-monitor">Navitrol Monitor</a></h5>
<p>Navitrol Monitor is a diagnostics tool for Navitrol. It is used to
configure and diagnose AGV controlled by Navitrol.</p>
<h2 id="navithor-fleet-control-system-overview"><a class="header" href="#navithor-fleet-control-system-overview">Navithor Fleet Control System Overview</a></h2>
<p>Navithor Server contains multiple agents that have certain roles in the
fleet management system. The Main agents are <em>production</em> <em>manager</em>,
<em>mission</em> <em>manager</em>, <em>traffic</em> <em>controller</em>, <em>scheduler</em> and <em>route</em>
<em>planner</em>. The system is highly configurable for different kinds of
production environments. In this section the main tasks of the agents
are described.</p>
<h3 id="production-manager"><a class="header" href="#production-manager">Production Manager</a></h3>
<p>Production Manager has main responsibility over generation of production
orders for requesting AGVs. Production Manager uses external data
sources and symbolic point statuses to create new production orders.</p>
<h4 id="production-triggering-methods"><a class="header" href="#production-triggering-methods">Production triggering methods</a></h4>
<p>Production manager can handle multiple ways to run production.
Different methods are designed for different production
needs.</p>
<h4 id="production-orders-for-a-specific-machine"><a class="header" href="#production-orders-for-a-specific-machine">Production orders for a specific machine</a></h4>
<div class="table-wrapper"><table><thead><tr><th>Information</th><th>Required?</th><th>Purpose</th></tr></thead><tbody>
<tr><td>Target</td><td>Yes</td><td>Where AGV should drive last</td></tr>
<tr><td>Machine</td><td>Yes</td><td>Which AGV should execute this task</td></tr>
<tr><td>Pickup/Source</td><td>No</td><td>Where to pick up resource</td></tr>
<tr><td>ResourceType</td><td>No</td><td>Which resource type this order is for</td></tr>
<tr><td>ResourceAmount</td><td>No</td><td>For how many resources this production order is for</td></tr>
</tbody></table>
</div>
<p>Production orders are turned into Tasks by Mission Manager to be executed by the machine. There are mainly 2 different categories for production orders.</p>
<div class="table-wrapper"><table><thead><tr><th>Type of production order</th><th>Purpose</th><th>Completion requirement</th></tr></thead><tbody>
<tr><td>GOTO</td><td>Drive AGV to location</td><td>Machine arrives at target location</td></tr>
<tr><td>Resource linked</td><td>Move resources from Source to Target</td><td>Requested amount of resources has been moved to target</td></tr>
</tbody></table>
</div>
<p>If production order has linked resources AGV is first ordered to drive
to pick up location and perform a loading task there. Then it is ordered
to drive to target location and perform an unload task. If the resource
amount is bigger than the AGV can carry the cycle is repeated until all
resources are transported to target. Production order is finished when
last required unload task is performed.</p>
<p>This production method is good for systems where MES has worklist for
each AGV. Navithor's responsibility is to execute the orders and solve
traffic situations between the AGVs.</p>
<h4 id="hold-release-reasoning"><a class="header" href="#hold-release-reasoning">Hold release reasoning</a></h4>
<p>In 'Hold release reasoning' production the symbolic points are defined
as hold-locations with rules of where it is allowed to go from the
location. Figure below shows the hold-rules in Navithor Tools.</p>
<p><img src="./Images/media/image14.png" alt="" /></p>
<blockquote>
<p>Figure: Hold Rules</p>
</blockquote>
<p>Defining hold-rules in Navithor Tools. Tick 'Enable hold
state at symbolic point'-check box to set symbolic point as
hold-location. At least 'Default destination' must be defined for a
Hold-location and other selections are optional.</p>
<p>From the above picture, we can see that symbolic point (429) has 2 Hold-Release destinations, (130) and (158). By default when AGV is released from Hold at this location it will drive to (130) but if (130) is unavailable for one reason or another, the AGV will be ordered to drive to (158) instead.</p>
<p><img src="./Images/media/agvcandrivethroughstop.png" alt="" /></p>
<blockquote>
<p>Figure: Driving through a Stop-Point</p>
</blockquote>
<p>Hold Symbolic Points do not require stopping when driving past. By default, AGV's are allowed to drive through Hold locations to reach their target without going to HOLD-state. In Figure 13 the AGV would be allowed to drive through (5) to reach their destination (1). Defining (5) as StopAndHold instead of Hold location would force AGV to stop and transition to HOLD-state when driving through. It is also possible to add penalty for driving through Hold-Locations.</p>
<p>AGV will then remain in HOLD-state until state is released from specific inputs. Inputs can
be:</p>
<div class="table-wrapper"><table><thead><tr><th>Input source</th><th>Description</th></tr></thead><tbody>
<tr><td>Button</td><td>Press on AGV - UI onboard shows possible destinations from current location (maximum of 4 defined destinations) or physical buttons (e.g. 'Next', 'Alternative1', 'Alternative2', 'Alternative3'). Since Navithor version 1.6.2.0 it is possible to release HOLD-state to any of the symbolic points in production area. i.e. destinations are not limited to 4.</td></tr>
<tr><td>Timer</td><td>If timer is enabled AGV can release HOLD-state by itself. Timer triggers default destination.</td></tr>
<tr><td>MES</td><td>External release (e.g. panel at work station near symbolic point).</td></tr>
<tr><td>Navithor Client</td><td>User can send hold release commands from Symbolic Point Status-form when AGV is executing hold-task at the symbolic point (Client v. 1.5.1.0 onwards).</td></tr>
</tbody></table>
</div>
<p><img src="./Images/media/HoldNoAGVAtSymbol.png" alt="" /></p>
<blockquote>
<p>Figure: Symbolic Point Status-view when no AGV at location</p>
</blockquote>
<p>Hold Symbolic Point with no AGV at location. Symbolic Point (9) is configured as default destination. Default destination is highlighted (when hovering over Symbolic Point, optional setting on Client).</p>
<p><img src="./Images/media/HoldAGVAtSymbol.png" alt="" /></p>
<blockquote>
<p>Figure: Symbolic Point Status-view when AGV standing at location</p>
</blockquote>
<p>Hold Symbolic Point with AGV at location. Symbolic Point(8) is configured as default destination. Symbolic Point (7) is configured as first alternative destination.</p>
<p>When AGV is commanded to drive to any Symbolic Point with Hold enabled, it will go to HOLD-state. In the above picture(s) SteerDrive1 is waiting for ReleaseHold signal from any source. After receiving signal AGV will drive to next target.</p>
<div class="table-wrapper"><table><thead><tr><th>Signal</th><th>Target</th><th>Symbolic Point</th></tr></thead><tbody>
<tr><td>Release</td><td>Default</td><td>(9)</td></tr>
<tr><td>Release with timer</td><td>Default</td><td>(9)</td></tr>
<tr><td>Release Alt1</td><td>Alt1</td><td>(7)</td></tr>
<tr><td>Release Custom</td><td>Custom</td><td>Given with signal</td></tr>
</tbody></table>
</div>
<p>HoldRelease production also supports loading and unloading. This can be enabled by setting <strong>ProductionManager_PerformLoadOrUnloadAtSymPointWhenArrivingWithOrderRule</strong> to <em>True</em>. This also requires Symbolic Points to be of Load or Unload type instead of Stop type. With these settings, when AGV arrives at Symbolic Point it will perform Load or Unload Task before going into HOLD-state.</p>
<div class="table-wrapper"><table><thead><tr><th>Symbolic Point type</th><th>Result</th></tr></thead><tbody>
<tr><td>Stop</td><td>Stop does not support Load/Unload. AGV will go to HOLD-state without loading or unloading</td></tr>
<tr><td>Load</td><td>AGV will perform Load-task and transition to HOLD-state after finishing.</td></tr>
<tr><td>Unload</td><td>AGV will perform Unload-task and transition to HOLD-state after finishing.</td></tr>
<tr><td>LoadUnload</td><td>AGV will perform the valid operation based on resource onboard info. Always Unload-task if AGV has resources and Load-task if AGV is empty</td></tr>
</tbody></table>
</div>
<p>Parameter <strong>MissionManager_HoldReleaseRules</strong> can be used to make resource related checks after HOLD-state has been released.</p>
<p>Running production by Hold release reasoning makes it possible to have a fully operable production system without need for external signals (ie. PLC). Hold release reasoning is a good for production environments where AGVs run production in loop(s) with predetermined locations to stop at.</p>
<h5 id="custom-hold-release-target"><a class="header" href="#custom-hold-release-target">Custom hold release target</a></h5>
<p>AGV can be released from HOLD-state to any symbolic point in the
production area. When released the default and possible alternative
destinations of the current symbolic point are ignored. Releasing to
custom destination is supported in MES-interface and in Navitrol's AGV
supervisor interface.</p>
<h5 id="charging-requests-from-hold-rules"><a class="header" href="#charging-requests-from-hold-rules">Charging requests from Hold-rules</a></h5>
<p>In some production systems AGVs should be sent to charger only after a
certain part of the production is completed by the AGV. Navithor can be
set to generate charging requests based on hold rules only. A symbolic
point with a charging location as alternative destination can be set to
trigger charging requests if charging is needed.</p>
<p>When AGV is released from a symbolic point to default destination and
the symbolic point has also charging location as alternative destination
Navithor will act as follows:</p>
<ul>
<li>
<p>If charging is seen needed Navithor generates a charging request for
the AGV and sends it to a free charger that is near the actual
alternative target of the symbolic point.</p>
</li>
<li>
<p>Also production order is generated to the default destination of the
symbolic point so that the actual release target stays in memory</p>
<ul>
<li>If rule '<em>Pass production order to another machine when going to
charge'</em> is enabled from system parameters (Rules-page,
Production orders-group) the order is generated to another AGV
that is in chargers and does not have any orders to perform. If
no valid AGV is found the order is generated for the AGV itself.</li>
</ul>
</li>
<li>
<p>The generated production order is then executed when the AGV in the
charger (production order passed to another) or the AGV going the
charger is charged.</p>
</li>
</ul>
<h4 id="production-order-lists"><a class="header" href="#production-order-lists">Production order lists</a></h4>
<p>In some production systems the AGVs need to drive different production
loops and stop at symbolic points along the route. The symbolic points
may be common for different routes but the following destination from a
symbolic point depends on the route given to the AGV. Then it is not
possible to use fixed hold destinations. Triggering custom hold release
targets can be automated with Production Order Lists.</p>
<p>The different driving routes can be generated into production order list
templates saved in database. One list contains a set of symbolic points
that must be reached in correct order. A template can be activated
either from MES-interface, Navitrol or from Navithor Client. Activated
list is then assigned to an AGV waiting for production at a waiting
location. Production order to the first location in the production order
list is generated and AGV will be ordered to drive there. When arriving
to the first target location AGV may perform loading/unloading
operations if configured to do so and then AGV is ordered to HOLD-state.
When released to default destination, the destination is picked from the
production order list.</p>
<p>When using production order lists following configurations to production
area are required:</p>
<ul>
<li>
<p>Waiting locations should not be defined as Hold-location --
Production order lists are only assigned to AGVs that do not have
anything to do</p>
</li>
<li>
<p>All symbolic points that are used in production order lists should
be defined as Hold-locations -- the default destination will be
overridden with next item in the production order list</p>
</li>
<li>
<p>Activate production order list-production by setting system
parameter ProductionManager_POL_LIST_RULE_MODE to:</p>
<ul>
<li>
<p>1 = Activated lists are assigned to machines at any waiting
location</p>
<ul>
<li>
<p>No requirements for production order list destinations</p>
</li>
<li>
<p>Navithor assigns activated list to a machine that is waiting
for orders in a waiting location</p>
</li>
</ul>
</li>
<li>
<p>12 = Activated list is assigned to machine that is waiting at
the first destination of the activated list</p>
<ul>
<li>
<p>First destination in production order list should be a
waiting location (not a hold location)</p>
</li>
<li>
<p>Last destination in production order list should also be a
waiting location (Normally the first and last destinations
are the same)</p>
</li>
<li>
<p>Navithor assigns activated list to machine that is at the
first destination of the production order list</p>
</li>
</ul>
</li>
<li>
<p>0 = Production order list-production is disabled. Hold-release
reasoning is activated.</p>
</li>
</ul>
</li>
</ul>
<p><strong>When production order list -production is active hold-release
reasoning-production is disabled thus using default or an alternative
destination is not possible.</strong></p>
<p><img src="./Images/media/image17.png" alt="" /></p>
<blockquote>
<p>Production Order List-view in Navithor Client</p>
</blockquote>
<p>Production order list data can be seen from Navithor Client's
Production Order Lists -view (in Figure above). Template lists can be
created/edited /removed and activated to be executed by available AGV.
Active order lists are grouped in two views: orders not assigned to any
AGV are in waiting_assign-state. Active and assigned order lists are
shown with more detailed execution status.</p>
<p><img src="./Images/media/image18.png" alt="" /></p>
<blockquote>
<p>Creating a new Production Order List template</p>
</blockquote>
<p>Creating new production order list in Navithor Client</p>
<p>Pressing &quot;Add new template&quot;-button in Production Order Lists-view adds a
data input-control to the templates-view. Name, id and locations are the
required information for a new list. Destinations can be either selected
from a dropdown list or by clicking symbolic points in Client's map.</p>
<p>Navithor Server creates reports from completed or cancelled production
order lists. In Navithor Servers main folder see
&quot;\Picklists\reports&quot;-folder.</p>
<h4 id="symbolic-point-resource-statuses"><a class="header" href="#symbolic-point-resource-statuses">Symbolic Point Resource Statuses</a></h4>
<p>Running production based on symbolic point status (i.e. 'resource at
location'-triggered production) is designed for production environments
where AGVs transfer resources (e.g. pallets) from a number of loading
locations to a set (1-&gt;unlimited) of valid unloading locations. These
production locations should be able to report binary information about
their resource statuses to Navithor. Information from production
locations:</p>
<ul>
<li>
<p><strong>Empty/resource at location</strong> (Required information) -- e.g. a
light gate triggers 'resource at location' when pallet arrives at
the end of a conveyor at a loading location</p>
</li>
<li>
<p><strong>Enabled/disabled</strong> (optional information) -- e.g. a switch at the
location informing Navithor whether the location is available for
production use or not. Resources at disabled loading locations are
ignored and disabled unloading locations are not used for
production. If AGV is driving to a location that is being disabled,
drive task is aborted and alternative destination is selected if
found.</p>
</li>
</ul>
<p>Navithor will generate production orders for free AGVs working in the
same production zone. Good practice is to have a waiting location (a
symbolic point of type WaitLoad) where AGVs can line to a queue to wait
for orders. Navithor will command AGV's to drive to these waiting
locations when AGV's are empty and do not have a current task.</p>
<p>When 'resource at location' is triggered at some loading location a production
order is generated automatically to the AGV that is first in line
nearest to the loading location. Other AGVs in the same queue are
ordered to move forward.</p>
<p>Unload location for the resource is defined by Navithor -- valid
unloading location:</p>
<ul>
<li>
<p>Belongs to same production zone as the loading location</p>
</li>
<li>
<p>Is Enabled (symbolic points can be enabled/disabled from Client or
from external trigger)</p>
</li>
<li>
<p>Is not located within Forbidden waypoint</p>
</li>
<li>
<p>Is allowed to handle given resource type</p>
</li>
<li>
<p>Is within allowed distance (optional, configurable from parameters)</p>
</li>
<li>
<p>Is linked to loading location (optional, configurable from Tools)</p>
</li>
</ul>
<p>If multiple unloading locations are found valid, Navithor has several possible strategies for selecting the target unloading location (Parameter <code>ProductionManager_UnloadLocationAssingRule</code>):</p>
<ul>
<li>
<p><strong>balance</strong> - Unloading symbolic points are encumbered equally, i.e. equal priority between the locations. Balancing is based on the number of unload actions at the location.</p>
</li>
<li>
<p><strong>balance_amount</strong> - Unloading symbolic points are encumbered equally based on the amount of the resources on the symbolicpoint. With the single resource symbolicpoints the resource quantity is considered. Active transports to each unload location are counted in to current incount.</p>
</li>
<li>
<p><strong>focus</strong> - a single symbolic point is preferred, others are used
if priority location is not available</p>
<ul>
<li>Priority is based on symbolic point id: lower id is higher
priority</li>
</ul>
</li>
<li>
<p><strong>force focus</strong> - Single symbolic point use is forced, no other
symbolic point is selected</p>
<ul>
<li>
<p>Lowest <strong>Enabled</strong> symbolic point is the target</p>
</li>
<li>
<p>Switching between selectable symbolic point is done by
disabling/enabling symbolic points</p>
</li>
</ul>
</li>
<li>
<p><strong>buffer_balance</strong> - Prioritizes the location that has most buffer space. Valid mode if unloading symbolic points are Buffer lanes</p>
</li>
<li>
<p><strong>unload_over_loadunload</strong> - An unloading symbolic point is prioritized over Load/Unload symbolic points.</p>
</li>
<li>
<p><strong>shortest_distance</strong> - Nearest possible target is selected. Calculated distance is from the resource to possible targets.</p>
</li>
</ul>
<p>Load capacities are used to configure allowed resource types for symbolic points. This can be used to limit Symbolic Points to handle only specific types of resources. This can also be used to control automatically generated production logic. Load capacity configuration for Machine Types and defining Resource Type is done with <a href="./Machinetool.html">Machine Tool</a>. Configuring Symbolic Point load capacity is done with Tools.</p>
<p><img src="./Images/media/image20.png" alt="" /></p>
<blockquote>
<p>Resource types affecting target location selection</p>
</blockquote>
<h4 id="transfer-requests"><a class="header" href="#transfer-requests">Transfer requests</a></h4>
<p>Transfer requests are production orders without dedicated AGV to handle
the transfer of resource. Navithor will be responsible for assigning suitable AGV(s) to handle the transfer request. A transfer request-message (e.g. from MES) contains following data:</p>
<ul>
<li>
<p>Pick-up symbolic point (Load)</p>
</li>
<li>
<p>Target symbolic point (Unload)</p>
</li>
<li>
<p>Resource type</p>
</li>
<li>
<p>Amount of resources to transfer</p>
</li>
<li>
<p>Optional: Target Symbolic Point group instead of single Symbolic Point</p>
</li>
</ul>
<p>Transfer Request handling:</p>
<ol>
<li>Signal is received from outside source</li>
<li>Transfer Request is validated by Navithor Server to contain valid data</li>
<li>Suitable AGV for Transfer Request is selected</li>
<li>AGV starts driving to location</li>
<li>AGV waits at Pickup Location until there is a Resource of correct type at location. If Resource already exists at location the AGV will start Load operation</li>
<li>AGV loads Resource on board</li>
<li>AGV starts driving to Target Location</li>
<li>AGV arrives at Target Location and starts Unload operation</li>
<li>AGV finishes Unload and continues to next task (Charge, handling next transfer request, drive to wait...)</li>
</ol>
<p>Transfer request production method is designed for production
environments where loading locations are known to produce a certain
amount of resources that needs to be transported to a certain location
(or to a set of locations). Navithor handles allocation of needed AGVs
to perform the transfer. If multiple transfer requests from different
locations are active at the same time Navithor allocates AGVs based on
their minimum cost to each possible location.</p>
<p>Examples of the locations from where AGVs picks and to where AGV drops resources:</p>
<ul>
<li>A conveyor, table or floor position - Load, Unload or LoadUnload -type symbolic point</li>
<li>A shelf - Multiple shelf-positions.
<ul>
<li>See document * Using warehouse racking feature* for more information</li>
</ul>
</li>
<li>Buffer lane - Navitrol handles stopping to correct position (pallet detection) inside buffer lane. Buffer can be for picking up or unloading of resources
<ul>
<li>See document * Using Buffer Lanes* for more information</li>
</ul>
</li>
</ul>
<h4 id="traffic-controller"><a class="header" href="#traffic-controller">Traffic Controller</a></h4>
<h5 id="dynamic-speed-and-stop-zones"><a class="header" href="#dynamic-speed-and-stop-zones">Dynamic Speed and stop Zones</a></h5>
<p>While AGVs operate in the production area traffic controller constantly
calculates a safety zones around the AGV that needs to be clear of other
AGVs. Zones expand in the direction of movement and towards assigned
drive path.</p>
<p>There are two types of zones calculated for AGV's:</p>
<ol>
<li>
<p>Speed zones (green)</p>
<p>a.  When colliding with other AGVs stop zone, AGVs speed is reduced in steps.</p>
</li>
<li>
<p>Stop zones (gray)</p>
<p>b.  When colliding with other AGVs stop zone, AGV is stopped (drive is aborted, soft stop).</p>
</li>
</ol>
<h5 id="segment-release-overlapping"><a class="header" href="#segment-release-overlapping">Segment release overlapping</a></h5>
<p>When releasing segments for driving (locking/reserving waypoints)
segments needs to be clear to release meaning that no crossing segments
are released for some other AGV.</p>
<h5 id="safe-stopping-point-assign"><a class="header" href="#safe-stopping-point-assign">Safe stopping point assign</a></h5>
<p>Traffic controller will calculate a stopping point for the AGV to where
it is currently safe to drive i.e. no other AGVs are on the path. E.g.
if AGV is following another AGV safe stopping point is always just
behind the AGV ahead. If communication to AGVs is lost, they will never
have a path given through another AGV.</p>
<h5 id="waypoint-locking"><a class="header" href="#waypoint-locking">Waypoint locking</a></h5>
<p>Nodes (intersections) are locked for a single AGV when drive order is
given. Other AGVs cannot lock the Node until it is unlocked (AGV passed
the Node or stopped inside it).</p>
<h5 id="forbidden-waypoints"><a class="header" href="#forbidden-waypoints">Forbidden Waypoints</a></h5>
<p>Waypoints are set forbidden automatically in following situations:</p>
<ul>
<li>
<p>AGV within waypoint area goes offline</p>
</li>
<li>
<p>Position confidence of an AGV within waypoint area drops below parameter TrafficController_POSITION_CONF_MIN_BOUND-value.</p>
</li>
<li>
<p>Machine reports battery overtemperature</p>
</li>
<li>
<p>AGV within waypoint area goes in FSTOP state</p>
</li>
<li>
<p>AGV within waypoint area goes to REMOTE or MANUAL</p>
<ul>
<li>moving AGV manually stops other AGVs in AUTO if manually moved AGV goes within waypoint limits that are locked/reserved for other AGVs</li>
</ul>
</li>
</ul>
<p>It is also possible to set Waypoint forbidden manually from Navithor Client see <a href="navithorServerAndClientMegaDocument.html#area-control-view">Navithor Client User Instructions - Area Control view</a></p>
<h4 id="scheduling"><a class="header" href="#scheduling">Scheduling</a></h4>
<p>Drive tasks are scheduled waypoint by waypoint. Task may not be required
to be fully scheduled in order to AGV to execute it. E.g. target
location is mutual with some other AGV and driving there is not
possible. If path contains multiple waypoints and there are possible
locations where waiting is possible, AGV can be released to execute the
task. One way links are waypoints that are always considered as waiting
locations so production area with one way traffic is always more
efficient than production area without them.</p>
<h5 id="task-priorities"><a class="header" href="#task-priorities">Task priorities</a></h5>
<p>Navithor uses first come -- first served -principle as a basis for
deciding who has the right to go in competing traffic situations. As
this principle does not always result trouble free operation of the
system, priorities are also compared task by task taking into account
end location, mutual paths and others on path for example.</p>
<h5 id="deadlock-avoidance"><a class="header" href="#deadlock-avoidance">Deadlock avoidance</a></h5>
<p>When multiple AGVs are in a situation where none can execute their drive
orders, scheduler and traffic controller release the situation by
finding different routes or driving AGVs to locations that allow others
to perform their tasks.</p>
<h4 id="manufacturing-execution-system-mes"><a class="header" href="#manufacturing-execution-system-mes">Manufacturing Execution System (MES)</a></h4>
<p>Manufacturing Execution System-interface can trigger production in
multiple ways:</p>
<ol>
<li>
<p>Production order with resource to a specific AGV</p>
</li>
<li>
<p>Send AGV to a location (production order without resource)</p>
</li>
<li>
<p>Transfer requests from location to another -- Navithor will allocate
AGVs for execution, used together with (4)</p>
</li>
<li>
<p>Symbolic Point Resource Status-triggers -- Navithor will allocate
AGVs and find suitable unload location</p>
</li>
</ol>
<p>Items 1 and 2 are transformed straight into production orders and added
to execution list in added order. When triggering production with
transfer requests (3) AGVs are driven to requested loading location.
Resource at location-signal (4) is needed to be triggered to the
requested loading location when there is physical resource to
manipulate.</p>
<p>In smaller production areas Resource at location (4) signaling can be
used without transfer request (3). E.g. if there is always the same
unloading location(s) for a single loading location Navithor is able to
generate a production order from the triggered location to an available
an valid unloading location.</p>
<h2 id="navithor-client-user-instructions"><a class="header" href="#navithor-client-user-instructions">Navithor Client User Instructions</a></h2>
<h3 id="main-view"><a class="header" href="#main-view">Main view</a></h3>
<p><img src="./Images/clientUI/NavithorClient2.50_layout.png" alt="" /></p>
<blockquote>
<p>Figure: Navithor Client UI main components</p>
</blockquote>
<h3 id="user-interface-controls"><a class="header" href="#user-interface-controls">User interface controls</a></h3>
<h4 id="machines-view"><a class="header" href="#machines-view">Machines-view</a></h4>
<p><img src="./Images/clientUI/NavithorClient2.50_AGVList.png" alt="" /></p>
<blockquote>
<p>Figure: Machines-view lists all active AGVs and their operation statuses</p>
</blockquote>
<p>This part of the user interface shows all the machines that are defined
in the system. User can select any of the machines from the list.
Selecting a machine will open its control window to the left end of
Client form by default.</p>
<p><img src="./Images/clientUI/NavithorClient2.50_AGVStatus.png" alt="" /></p>
<blockquote>
<p>Figure: AGV's operational status</p>
</blockquote>
<p>AGV operational status can be visually seen from the Machines-list. First icon displays states that require attention (error state, position missing, connection broken). Second icon displays battery level and charging state. Third icon displays production status. See tables below for more detailed description.</p>
<p><strong>State icons</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Icon</th><th>Description</th></tr></thead><tbody>
<tr><td><img src="./Images/MachineListIcons/alert_critical_error.png" alt="" /></td><td>Errors active</td></tr>
<tr><td><img src="./Images/MachineListIcons/alert_no_comms.png" alt="" /></td><td>No communication</td></tr>
<tr><td><img src="./Images/MachineListIcons/alert_no_position.png" alt="" /></td><td>No position</td></tr>
</tbody></table>
</div>
<p><strong>Battery icons</strong></p>
<p>Battery icons levels represent levels defined by server parameters. See more in the document _ Managing Battery Levels_.</p>
<div class="table-wrapper"><table><thead><tr><th>Icon</th><th>Description</th></tr></thead><tbody>
<tr><td><img src="./Images/MachineListIcons/battery_state_none.png" alt="" /></td><td>Battery state unknown</td></tr>
<tr><td><img src="./Images/MachineListIcons/battery_state_full.png" alt="" /></td><td>Battery level full</td></tr>
<tr><td><img src="./Images/MachineListIcons/battery_state_high.png" alt="" /></td><td>Battery level high</td></tr>
<tr><td><img src="./Images/MachineListIcons/battery_state_low.png" alt="" /></td><td>Battery level low</td></tr>
<tr><td><img src="./Images/MachineListIcons/battery_state_alert.png" alt="" /></td><td>Battery level alert</td></tr>
<tr><td><img src="./Images/MachineListIcons/battery_state_charging.png" alt="" /></td><td>White lighting icon indicates charging state</td></tr>
</tbody></table>
</div>
<p><strong>Production status</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Icon</th><th>Description</th></tr></thead><tbody>
<tr><td><img src="./Images/MachineListIcons/state_unknown.png" alt="" /></td><td>Production status unknown</td></tr>
<tr><td><img src="./Images/MachineListIcons/not_in_production.png" alt="" /></td><td>AGV operational, not in production</td></tr>
<tr><td><img src="./Images/MachineListIcons/in_production.png" alt="" /></td><td>AGV operational, in production</td></tr>
<tr><td><img src="./Images/MachineListIcons/hold.png" alt="" /></td><td>AGV in Hold-state</td></tr>
<tr><td><img src="./Images/MachineListIcons/manual.png" alt="" /></td><td>AGV in manual control</td></tr>
</tbody></table>
</div>
<p>Clicking <img src="./Images/MachineListIcons/alert_critical_error.png" alt="" /> icon will open a view with error/warning descriptions:</p>
<p><img src="./Images/clientUI/NavithorClient2.20_AGVErrors.png" alt="" /></p>
<blockquote>
<p>Figure: AGV Error/Warning view</p>
</blockquote>
<br>
<h5 id="disablingenabling-agv-from-the-production-system"><a class="header" href="#disablingenabling-agv-from-the-production-system">Disabling/Enabling AGV from the production system</a></h5>
<p>Clicking a selected AGV with right mouse button will bring a selection for enabling/disabling the AGV, When disabling AGV it must not be in production. By default, waypoint which has recently disabled AGV will be set forbidden.</p>
<p>Disabling AGV will:</p>
<ul>
<li>Stop communication to AGV</li>
<li>Remove current task data</li>
<li>Set waypoint(s) machine occupies as forbidden
<ul>
<li>Parameter <strong>TrafficController_SetWPForbiddenWhenAGVDisabled</strong> defines if waypoints are set forbidden automatically or not. By default waypoints are set forbidden</li>
</ul>
</li>
<li>Remove AGVs status panel from the Active Machines-list</li>
<li>Adds AGVs status panel to Disabled Machines-list</li>
</ul>
<p>When enabling AGV, select the Disabled machines-tab page and click with
left mouse an AGV that is being enabled. This selects the AGV. Now with
right mouse button click the status control and Click &quot;Enable&quot;.</p>
<p>Enabling AGV will:</p>
<ul>
<li>
<p>Start communication to AGV</p>
</li>
<li>
<p>Create idle-task</p>
</li>
<li>
<p>Remove waypoints from forbidden state if still forbidden by the AGV</p>
</li>
</ul>
<h4 id="map-tabs"><a class="header" href="#map-tabs">Map tabs</a></h4>
<div class="table-wrapper"><table><thead><tr><th>Tab</th><th>Purpose</th></tr></thead><tbody>
<tr><td>Production view</td><td>General tab for production. State of entire production area is displayed visually</td></tr>
<tr><td>AreaControl</td><td>Tab to view and manage route network in more detail</td></tr>
</tbody></table>
</div>
<h4 id="map-controls"><a class="header" href="#map-controls">Map controls</a></h4>
<p>Map can be panned around by clicking on map and dragging.</p>
<p>Map can be zoomed with mouse wheel.</p>
<h5 id="production-area-view"><a class="header" href="#production-area-view">Production Area-view</a></h5>
<p><img src="./Images/clientUI/NavithorClient2.50_MapButtons.png" alt="" /></p>
<blockquote>
<p>Figure: Production Area-tab page of Map-view</p>
</blockquote>
<p>Selecting the Production tab shows environment model of the area (optional) and route segments. Symbolic
points have icon and line pointing to the route segment. Machines are
drawn to the map at the reported positions.</p>
<h5 id="area-control-tab"><a class="header" href="#area-control-tab">Area Control tab</a></h5>
<p><img src="./Images/clientUI/NavithorClient2.20_AreaView.png" alt="" /></p>
<blockquote>
<p>Figure: Area Control-tab page of Map view</p>
</blockquote>
<p>In area control view the user can monitor the current state of every
waypoint. Waypoints are either intersections (network <strong>node</strong>s) or
pathways between intersections (network <strong>link</strong>s). Following states are
defined for waypoints:</p>
<ul>
<li>
<p><strong>Free</strong>: waypoint is available for all traffic</p>
</li>
<li>
<p><strong>Reserved</strong>: waypoint (always a link) is reserved for one or
multiple machines for travelling</p>
</li>
<li>
<p><strong>Locked</strong>: waypoint (always a node) is locked for one machine. No
other machine can enter the node until the locker has either stopped
or exited the node.</p>
</li>
<li>
<p><strong>Forbidden</strong>: waypoint is not allowed for travelling.</p>
</li>
</ul>
<p>From the area control view the user can manually set a waypoint as
forbidden when needed. Traffic controller will not allow machines to use
forbidden waypoints as a part of their drive routes. Also if a machine
is about to travel to a waypoint that is set as forbidden its drive will
be aborted.</p>
<p>Clicking a waypoint in the map view adds the control of the selected waypoint into the list in the panel on the right side. If the clicked point overlaps with multiple waypoints, clicking it another time will select the next possibility. Once one Waypoint is selected, clicking the same waypoint with right mouse button will visualize the driving segments that belong to the waypoint. Right-clicking multiple times will loop through all the segments of the waypoint one by one.</p>
<p><img src="./Images/clientUI/NavithorClient2.20_AreaViewSelections.png" alt="" /></p>
<blockquote>
<p>Figure: Controls for selected Waypoints</p>
</blockquote>
<p>Setting a waypoint forbidden is done by clicking the waypoint from the
map view. Selected waypoint is then added top-most to the selections-list.
Now the waypoint can be set forbidden by clicking the 'Set
forbidden'-button of the highlighted panel. A waypoint will be in
forbidden-state until the user returns the waypoint into allowed state
by clicking 'Set Free'-button.</p>
<p>Waypoints that are set forbidden by traffic controller cannot be set
free by user. Reasons for area being set forbidden automatically are:</p>
<ul>
<li>Communication to AGV lost - Navithor may not know the exact position where AGV is during loss of communication</li>
<li>No status updates from Navitrol for time defined with parameter <strong>TrafficController_MACHINE_STATUS_TRUST_LIMIT_SECONDS</strong></li>
<li>Position confidence too low - Position confidence goes below <strong>TrafficController_POSITION_CONF_MIN_BOUND</strong>. By default the value is 30 (percent).</li>
<li>AGV controlled remotely (e.g. via Navitrol Monitor) and speed is higher than <strong>TrafficController_NEAR_ZERO_SPEED_LIMIT</strong></li>
<li>AGV not moving but position is jumping more than <strong>TrafficController_MACHINE_POS_MAX_CRAWL_BOUND</strong> metres between received status updates from Navitrol</li>
</ul>
<h4 id="alarms"><a class="header" href="#alarms">Alarms</a></h4>
<p><img src="./Images/media/alarms.png" alt="" /></p>
<blockquote>
<p>Figure: Alarms view</p>
</blockquote>
<p>Navithor shows all the alarms in the alarm list. Alarms can be either System Alarms or Entity Alarms. System alarms are system wide alarms eg. ProductionAreaNotOperational while Entity Alarms are either Machine or Symbolic Point specific eg. NoMachineConnection.</p>
<div class="table-wrapper"><table><thead><tr><th>Column</th><th>Description</th></tr></thead><tbody>
<tr><td>Level</td><td>Alarm level. Warning, Error or Fatal Error</td></tr>
<tr><td>Activation time</td><td>When alarm was activated</td></tr>
<tr><td>Duration</td><td>How long the alarm has been active</td></tr>
<tr><td>Origin</td><td>Origin that has triggered the error (Fleet control, Navigation software, Supervisor or Machine device)</td></tr>
<tr><td>Source</td><td>Name of the alarm source (ie. machine name or server)</td></tr>
<tr><td>Description</td><td>Alarm details</td></tr>
</tbody></table>
</div>
<p>Alarm view supports searching alarm text or identifier for specific keyword. Alarm view also supports filtering to specific Machine errors, Alarm Levels, Alarm Sources or Priorities only.</p>
<h5 id="alarms-visualization-configuration"><a class="header" href="#alarms-visualization-configuration">Alarms visualization configuration</a></h5>
<p><strong>Alarms view</strong></p>
<p>Navithor client supports setting a custom background and text color for displayed alarms. Different color options can be selected for different alarm levels and alarm sources.</p>
<p>To set a custom color navigate to Settings-&gt;Configuration-&gt;Preferences and scroll to the alarms visualization section.</p>
<p><img src="./Images/AlarmConfigurationOverride/visualization_1.png" alt="" /></p>
<blockquote>
<p>Figure: Alarms visualization settings</p>
</blockquote>
<p>Choose preferred custom colors and press Save. Changes will be applied immediately.</p>
<p><img src="./Images/AlarmConfigurationOverride/visualization_2.png" alt="" /></p>
<blockquote>
<p>Figure: Alarms view with custom color settings applied</p>
</blockquote>
<p><strong>Machine Control panel and Map view</strong></p>
<p>To enable the visualization of AGV errors navigate to Settings-&gt;Configuration-&gt;Preferences. In Preferences tab navigate to Highlight section.</p>
<p>Following parameters can be adjusted to set up AGV errors visualization:</p>
<ul>
<li><strong>Highlight machine on all errors</strong> - set to true to highlight AGV in the Machine Control panel with red color when there are any active errors for this AGV;</li>
<li><strong>Highlight machine on supervisor errors</strong> - set to true to highlight AGV in the Machine Control panel with red color when there are active supervisor errors for this AGV;</li>
<li><strong>Blink red alarm on low battery</strong> - set to true to highlight AGV in the Machine Control panel with blinking red color when there is active <em>AGV battery level low</em> alarm for this AGV;</li>
<li><strong>Size of the circle around the machine, that has an active error</strong> - set to 0 to hide the circle. Set to positive number to adjust the size of the circle.</li>
</ul>
<p>In case a fatal error occurred for AGV, the red arrow pointing to this AGV is always displayed on the map. If AGV is out of the view, the arrow points to the direction of AGV's position on the map. On pictures below are demonstrated examples of highlighting AGV in the Machine Control panel with red color and highlighting AGV on the map with a red circle and red arrow.</p>
<p><img src="./Images/media/ClientFatalError_View.png" alt="" /></p>
<blockquote>
<p>Figure: AGV with an active fatal error is inside the view</p>
</blockquote>
<p><img src="./Images/media/ClientFatalError_OutOfView.png" alt="" /></p>
<blockquote>
<p>Figure: AGV with an active fatal error is out of the view</p>
</blockquote>
<h4 id="production-buttons"><a class="header" href="#production-buttons">Production buttons</a></h4>
<p>Navithor Client has few buttons for fast executing certain operations:</p>
<p>Start Production-button will take all machines that are in auto-mode
into production. Machines should start executing production orders
automatically. Button will change background color based on current 'in
production'-status:</p>
<p><img src="./Images/media/image32.png" alt="" /></p>
<blockquote>
<p>Figure: None of the machines in auto-mode are in production</p>
</blockquote>
<p><img src="./Images/media/image33.png" alt="" /></p>
<blockquote>
<p>Figure: Some of the machines in auto-mode are in production</p>
</blockquote>
<p><img src="./Images/media/image34.png" alt="" /></p>
<blockquote>
<p>Figure: All machines in auto-mode are in production</p>
</blockquote>
<p>Stop Production will take all machines out of production.</p>
<p>Save logs will open Save Logs window where you can describe incident and store logs for later review.</p>
<p>FSTOP-button sends <em>FSTOP</em> (fast stop) command to all machines whether
they are selected or not. Releasing machine from fast stop-state is done
individually from Machine control-window.</p>
<h3 id="navithor-client-main-menu"><a class="header" href="#navithor-client-main-menu">Navithor Client Main Menu</a></h3>
<h4 id="login"><a class="header" href="#login">Login</a></h4>
<p>Login has two options: Login and logout. Selecting login will open the
login window.</p>
<p><img src="./Images/media/image36.png" alt="" /></p>
<blockquote>
<p>Figure: Login-view</p>
</blockquote>
<p>Enter correct username and password and press Login button. If username
is not found or password is incorrect the login will fail. Username and password can also be AD configured.</p>
<p>Selecting logout will log the current user out of the client.</p>
<h4 id="machines"><a class="header" href="#machines">Machines</a></h4>
<p>Machines menu item has following items:</p>
<ul>
<li>
<p>Release all from FSTOP - this sends release FastStop-commad to all
active AGVs</p>
</li>
<li>
<p>Clear all machine errors - this clears all errors and warnings of
AGVs from database</p>
</li>
</ul>
<h4 id="views"><a class="header" href="#views">Views</a></h4>
<p>Views menu item has following items:</p>
<ul>
<li>
<p>Production Orders - selection will open Production orders window (view production orders)</p>
</li>
<li>
<p>Production Order Lists - selection will open the Production Order List window (grayed out if feature not in use, configurable from parameters)</p>
</li>
<li>
<p>Inventory - selection will open Inventory window (view resources)</p>
</li>
<li>
<p>Battery Monitor - selection will open Battery Monitor window (hidden if Navithor not responsible for battery, configurable from parameters)</p>
</li>
<li>
<p>Show</p>
<ul>
<li>Grid lines - show or hide gridlines from map view</li>
<li>Machine
<ul>
<li>Resource type - Whether to show type of held resource below name</li>
<li>Affixes -- Whether to show affixes for held resource below name</li>
</ul>
</li>
<li>Symbolic point
<ul>
<li>Resource type - Whether to show type of held resource below name</li>
<li>Affixes - Whether to show affixes for held resource below name</li>
</ul>
</li>
<li>Area control - Enable or disable AreaControl tab</li>
</ul>
</li>
<li>
<p>OnHover - Options for when mouse is hovering over something</p>
<ul>
<li>Machine
<ul>
<li>Show info - Whether to show additional information or not</li>
</ul>
</li>
<li>Symbolic Point
<ul>
<li>Show info - Whether to show additional information or not</li>
<li>Draw line to possible destinations - Whether to draw line to possible destinations from symbolic point. These can be either default hold release locations or filtered based on allowed resource types</li>
<li>Highlight possible destinations -  Whether to highlight possible destinations from symbolic point. These can be either default hold release locations or filtered based on allowed resource types</li>
</ul>
</li>
</ul>
</li>
<li>
<p>Camera</p>
<ul>
<li>Follow selected machine - Whether to lock camera to selected machine or not</li>
</ul>
</li>
<li>
<p>Rendering</p>
<ul>
<li>Machine type resource rendering offsets apply to Symbolic Points - Whether to apply offsets defined for machine type to all symbolic points. Note: Only works when there is single machine type only</li>
<li>Symbolic Point Icons
<ul>
<li>PictureMinPixPerMeter</li>
<li>TextMinPixPerMeter</li>
</ul>
</li>
<li>MapRenderInterval - How often map should be refreshing in milliseconds. 100 =&gt; 10 fps. 18 =&gt; ~60 fps</li>
<li>MachineControlRenderInterval - How often machine panel should be refreshed in milliseconds</li>
</ul>
</li>
<li>
<p>Settings</p>
<ul>
<li>Configuration - Open configuration settings</li>
<li>Production settings - Open production settings</li>
<li>Affixes - Configure affixes</li>
</ul>
</li>
<li>
<p>Language - Change language. Note: Requires restart</p>
</li>
<li>
<p>About - Show version information</p>
</li>
</ul>
<h4 id="production-orders-view"><a class="header" href="#production-orders-view">Production Orders view</a></h4>
<p><img src="Images/media/productionOrdersView.png" alt="" /></p>
<blockquote>
<p>Figure: Production Orders view</p>
</blockquote>
<p>Overview for all current Production Orders. Supports ordering and filtering.</p>
<div class="table-wrapper"><table><thead><tr><th>Component</th><th>Description</th></tr></thead><tbody>
<tr><td>View columns</td><td>Change which columns to show</td></tr>
<tr><td>Sort by</td><td>Change in which order the production orders are shown</td></tr>
<tr><td>Filters</td><td>Filter shown orders</td></tr>
<tr><td>Continue</td><td>Continues selected order (from paused state)</td></tr>
<tr><td>Pause</td><td>Pauses execution of selected order</td></tr>
<tr><td>Delete</td><td>Deletes order</td></tr>
<tr><td>Create manual order</td><td>Open window to create manual Production Order</td></tr>
</tbody></table>
</div>
<p>All of the columns are not visible by default and depending on type of production order, some of columns might be empty.</p>
<div class="table-wrapper"><table><thead><tr><th>Column</th><th>Description</th></tr></thead><tbody>
<tr><td>Id</td><td>Id in database</td></tr>
<tr><td>PlannerId</td><td>Who planned this production order. Related to TransferRequests</td></tr>
<tr><td>Name</td><td>Name of production order</td></tr>
<tr><td>OrderType</td><td>Type of production order</td></tr>
<tr><td>Status</td><td>Status of production order</td></tr>
<tr><td>MachineName</td><td>Name of machine assigned to production order. Empty if no machine assigned</td></tr>
<tr><td>PickUpLocation</td><td>Where resource was picked up. Not used in HoldRelease production</td></tr>
<tr><td>TargetLoctation</td><td>Destination for production order</td></tr>
<tr><td>ResourceName</td><td>Name of resource related to production order</td></tr>
<tr><td>StartTime</td><td>When execution of this production order started</td></tr>
<tr><td>PlannedPickupTime</td><td>Estimation for resource pickup time. Can be empty</td></tr>
<tr><td>PlannedDeliveryTime</td><td>Estimation when resource will arrive at target. Can be empty</td></tr>
<tr><td>EstimateTotalExecutionTime</td><td>Estimation for total time required for order. Can be empty</td></tr>
</tbody></table>
</div>
<h5 id="manual-production-order-view"><a class="header" href="#manual-production-order-view">Manual Production Order view</a></h5>
<p><img src="Images/media/manualorder.png" alt="" /></p>
<blockquote>
<p>Figure: Creating manual Production Order for a specific AGV</p>
</blockquote>
<div class="table-wrapper"><table><thead><tr><th>Section</th><th>Option</th><th>Description</th></tr></thead><tbody>
<tr><td>Required</td><td>Machine</td><td>Which machine should execute order</td></tr>
<tr><td>Required</td><td>Pickup</td><td>Where to pick up resource. Defining this also requires filling Resources section</td></tr>
<tr><td>Required</td><td>Target</td><td>Where machine should drive. When only Machine and Target are given, GOTO order will be generated instead of resource transfer.</td></tr>
<tr><td>Optional</td><td>Scheduled start time</td><td>When to start executing this production order. Defaults to now</td></tr>
<tr><td>Optional</td><td>Priority</td><td>Numerical priority for order. Defaults to no priority over other orders</td></tr>
<tr><td>Optional</td><td>Planner</td><td>If planner ID is given, it can be used as order ID instead of ID generated by Navithor</td></tr>
<tr><td>Optional</td><td>Execution Flags</td><td>Special flags related to production order. Affects behaviour</td></tr>
<tr><td>Resources</td><td>Type</td><td>Which resource type to transfer from pickup</td></tr>
<tr><td>Resources</td><td>Quantity</td><td>How many of given resource type to transfer</td></tr>
<tr><td>Resources</td><td>Add</td><td>Adds selection to list. List can contain multiple resource types of varying quantities. How this will be actually executed depends on configuration. Most simple option is to make separate Production Order for each transfer</td></tr>
</tbody></table>
</div>
<p>Execution flag explanations:</p>
<div class="table-wrapper"><table><thead><tr><th>Execution Flag</th><th>Description</th></tr></thead><tbody>
<tr><td>None</td><td>No flag given</td></tr>
<tr><td>LoadWholeStack</td><td>When arriving at Pickup we will Load all resource objects at once</td></tr>
<tr><td>UnloadWholeStack</td><td>When arriving at Target we will Unload all resource objects at once</td></tr>
<tr><td>LoadFromBottom</td><td>Load resource object from bottom of stack</td></tr>
<tr><td>LoadFromTop</td><td>Load resource object from top of stack</td></tr>
<tr><td>UnloadToBottom</td><td>Unload resource object to bottom of stack</td></tr>
<tr><td>UnloadToTop</td><td>Unload resource object to top of stack</td></tr>
</tbody></table>
</div>
<p>Check section <a href="navithorServerAndClientMegaDocument.html#resource-manager">Resource manager</a> for more information about resource handling</p>
<h4 id="battery-monitor"><a class="header" href="#battery-monitor">Battery Monitor</a></h4>
<p><img src="./Images/clientUI/NavithorClient2.20_BattControl.png" alt="" /></p>
<blockquote>
<p>Figure: Battery Monitor</p>
</blockquote>
<p>Battery monitor window is for view of the current statuses of all
battery powered machines in the production system. Battery monitor is available if charging control is enabled in Navithor server. See the document ' Managing Battery Levels', chapter 'Enabling charging management' for more information.</p>
<p>Charging can be requested for machines that are in production by
clicking 'Request Charging' button of the machines data panel.</p>
<p>'Set battery level' button opens a numeric value box for setting the
time-based battery level (calculated by Navithor Server) to a given
level (0-100).</p>
<h3 id="configuration"><a class="header" href="#configuration">Configuration</a></h3>
<p>Configuration window has all the settings that are used for configuring Navithor Server and Client. Some tabs might be hidden without sufficient user rights.</p>
<div class="table-wrapper"><table><thead><tr><th>Tab</th><th>Description</th></tr></thead><tbody>
<tr><td>Client settings</td><td>Server connection configuration</td></tr>
<tr><td>Preferences</td><td>User preferences</td></tr>
<tr><td>Server settings</td><td>Configure Server settings</td></tr>
<tr><td>Parameters</td><td>Manage system parameters</td></tr>
</tbody></table>
</div>
<h4 id="client-settings"><a class="header" href="#client-settings">Client settings</a></h4>
<div class="table-wrapper"><table><thead><tr><th>Settings</th><th>Description</th></tr></thead><tbody>
<tr><td>Server IP-Address</td><td>IP address of the Navithor server</td></tr>
<tr><td>Server port</td><td>Port for regular communication with server</td></tr>
<tr><td>Server stream port</td><td>Port for file transfer with server</td></tr>
<tr><td>US units</td><td>Affects data shown in AGV Status panel. Changes speed from m/s to feet/sec and actuator position mm to inch</td></tr>
<tr><td>Disable log download prompt</td><td>If True, saving server logs does not bring a pop-up for log download possibility</td></tr>
</tbody></table>
</div>
<h4 id="preferences"><a class="header" href="#preferences">Preferences</a></h4>
<p>This tab allows to change visualization preferences like information to display, map rendering rate, environment and routes colors, text size and so on.</p>
<h4 id="server-settings"><a class="header" href="#server-settings">Server settings</a></h4>
<div class="table-wrapper"><table><thead><tr><th>Settings</th><th>Description</th></tr></thead><tbody>
<tr><td>Use Simulator</td><td>Whether to override machine configurations to connect to simulator instead. This require Fleet Simulator license</td></tr>
<tr><td>Simulator address</td><td>IP address for Fleet Simulator</td></tr>
<tr><td>Simulator port</td><td>Port for Fleet Simulator</td></tr>
<tr><td>Use Active Directory authentication</td><td>If true Login to Client is automatically against windows authentication based on active directory users. See <em>Using Active Directory for authentication</em>-document for more information</td></tr>
<tr><td>SFTP username</td><td>Username for the SFTP server running onboard machine</td></tr>
<tr><td>SFTP password</td><td>Password for the SFTP server running onboard machine</td></tr>
<tr><td>SFTP port</td><td>Port on which machine has SFTP server running (SSH port)</td></tr>
<tr><td>Safety signal interval</td><td>Time in milliseconds how often Navithor ends safety signals to AGVs</td></tr>
<tr><td>Client HeartBeat Timeout</td><td>Time in milliseconds how often Navithor server expects to receive heartbeats from Navithor Client(s)</td></tr>
<tr><td>PLC Adress</td><td>Deprecated</td></tr>
<tr><td>Use FSTP for file transfer</td><td>Deprecated. Always true</td></tr>
<tr><td>FStop-button text</td><td>Text entered here replaces &quot;FSTOP&quot;-button text</td></tr>
<tr><td>Fstop machine-button text</td><td>Text entered here replaces &quot;FSTOP machine&quot;-buttons text located in AGV control panel</td></tr>
<tr><td>Release FStop-button text</td><td>Text entered here replaces &quot;Release FSTOP&quot;-buttons text (same button as &quot;FSTOP machine&quot;</td></tr>
</tbody></table>
</div>
<h4 id="parameters"><a class="header" href="#parameters">Parameters</a></h4>
<p><img src="./Images/clientUI/NavithorClient2.20_SysParams.png" alt="" /></p>
<blockquote>
<p>Figure: System Parameters</p>
</blockquote>
<p>Since version 1.9.55.0 all system parameters are accessed from Client
user interface. This change is part of supporting running Server as a
service (without own user interface). All parameters are listed in this
view. All parameters are also grouped to one or multiple filter-groups. Parameters can also be searched by typing into &quot;Keyword search&quot;-text box.
For example all MES Interface-related parameters can be listed by
checking &quot;MES Interface&quot;-check box. Then typing &quot;status&quot; will further limit the matching parameters.</p>
<p>Clicking any row in parameter list will open a control on right side of
the list. This control has buttons and input-fields for editing the
selected parameter. Three value-fields are listed:</p>
<div class="table-wrapper"><table><thead><tr><th>Column</th><th>Description</th></tr></thead><tbody>
<tr><td>Name</td><td>Name of parameter</td></tr>
<tr><td>Default</td><td>This is the system default value for the parameter. It can be taken into use by pressing &quot;Reset to default&quot;-button</td></tr>
<tr><td>Stored</td><td>This is the value that is always read from default.tcc2-file (located under Server's main working folder) or from database when production area is loaded in Navithor Server. This value gets also written as current value for the parameter. I.e. at Server startup or after production area loading Stored value is equal current value. Current value can be reset to stored value by pressing &quot;Reset to stored&quot;-button</td></tr>
<tr><td>Current</td><td>This is the active value that system uses. Current value can be changed in parameter control by editing the &quot;New value&quot;-field(s) of the parameter and then pressing &quot;Apply change&quot;-button. This does not save anything to default.tcc2 or database.</td></tr>
</tbody></table>
</div>
<p>After parameter changes have been made and found good then the current
values needs to be saved in order to keep them after Server restart or
production area update. Pressing &quot;Save&quot;-button in the bottom-left corner of the window will save the current parameter values to file and also to database.</p>
<p>Pressing &quot;Reset to defaults&quot;-button will set all current values to
default values. Stored values will not be affected.</p>
<p>Pressing &quot;Revert&quot;-button will set all current values to stored
values.</p>
<h3 id="production-settings"><a class="header" href="#production-settings">Production settings</a></h3>
<p>Production settings window contains settings that are used for configuring production related parameters. Some tabs might be hidden without sufficient user rights.</p>
<div class="table-wrapper"><table><thead><tr><th>Tab</th><th>Description</th></tr></thead><tbody>
<tr><td>User management</td><td>Manage users</td></tr>
<tr><td>Area files</td><td>Manage active area files, machine type parameter files, TCParameter files. Upload files</td></tr>
<tr><td>Machines</td><td>Manage machines</td></tr>
</tbody></table>
</div>
<h4 id="user-management"><a class="header" href="#user-management">User management</a></h4>
<p><img src="./Images/clientUI/NavithorClient2.20_Users.png" alt="" /></p>
<blockquote>
<p>Figure: System Users</p>
</blockquote>
<p>Navithor version 2.20 contains major update to user management. This update makes it possible to create custom user roles that have specific user rights to the system. There are 4 roles pre-defined in the system:</p>
<div class="table-wrapper"><table><thead><tr><th>Userlevel</th><th>Description</th></tr></thead><tbody>
<tr><td>Operator</td><td>System operator, has access to everything except administrative functions</td></tr>
<tr><td>Admin</td><td>System Administrator. Access to everything</td></tr>
<tr><td>Production manager</td><td>Rights to view production but can't select machine or view some parts of settings</td></tr>
<tr><td>Guest</td><td>Has viewing rights only. Cannot affect production</td></tr>
</tbody></table>
</div>
<p>Roles can be edited or new ones can be created in Roles-tab page:</p>
<p><img src="./Images/clientUI/NavithorClient2.20_UserRoleConfiguration.png" alt="" /></p>
<blockquote>
<p>Figure: Configuring User roles</p>
</blockquote>
<p>Document * User management* contains more information about user management.</p>
<p>Navithor also supports Active Directory (AD) users. Document <em>Using Active Directory for authentication</em> contains more information of how to activate AD authentication.</p>
<h4 id="area-files"><a class="header" href="#area-files">Area Files</a></h4>
<p><img src="Images/media/settings_areafiles_main.png" alt="" /></p>
<blockquote>
<p>Figure: Area files</p>
</blockquote>
<p>User interface for viewing currently active files, changing active files, uploading new files to server. Tools can generate and upload all of the required files automatically when 'Upload to Database' is used.</p>
<div class="table-wrapper"><table><thead><tr><th>Term</th><th>Description</th></tr></thead><tbody>
<tr><td>Production area file bundle</td><td>Definition, Segment and Env file bundled together. Valid for single machine type</td></tr>
<tr><td>Definition file</td><td>Area definition file. Defines production area. Shared for all machine types</td></tr>
<tr><td>Segment file</td><td>File containing segments for single machine type. If there are multiple machine types the segments get combined to form route network. Also contains symbolic points definition and load capacities</td></tr>
<tr><td>Env file</td><td>File containing environment</td></tr>
<tr><td>Machine type parameter file</td><td>File containing definition for machine type. Also contains resource types and load capacities for machine type</td></tr>
<tr><td>Server parameter file</td><td>File containing production area parameters</td></tr>
<tr><td>Request server to reload files</td><td>For optimization reasons, server will not load the files in right away. Taking files into use requires either server restart or manual request from Client</td></tr>
<tr><td>Production Area</td><td>Single area of operation. Can contain multiple machine types</td></tr>
</tbody></table>
</div>
<h4 id="uploading-new-files"><a class="header" href="#uploading-new-files">Uploading new files</a></h4>
<p>Before uploading new area files ensure that server has machine types for the area. Otherwise upload will fail!</p>
<p>If you pick a wrong file by mistake select the file on 'Pending files' and press 'Delete' key to remove it.</p>
<p>Machine type</p>
<ul>
<li>Automatically created when Tools 'Upload to database' is used</li>
<li>Can be generated manually by uploading machine type parameters</li>
</ul>
<p>Uploading file bundle for production area</p>
<ol>
<li>Click 'Definition file' and choose definition file from file system. Only single definition file per upload</li>
<li>Click 'Environment file' and choose environment file from file system. Repeat for every machine type in production area</li>
<li>Click 'Segment file' and choose segment file from file system. Repeat for every machine type in production area</li>
<li>Click 'Upload'</li>
</ol>
<p>Generating machine type and uploading bundle at same time</p>
<ol>
<li>Click 'Machine type parameters' and choose Machine type parameter file from file system. Repeat for every machine type in production area.</li>
<li>Upload the rest of files</li>
</ol>
<h4 id="activating-file-bundle"><a class="header" href="#activating-file-bundle">Activating file bundle</a></h4>
<p><img src="Images/media/settings_areafiles_main.png" alt="" /></p>
<blockquote>
<p>Figure: Activating file bundle</p>
</blockquote>
<p>Active file bundles are colored green while inactive ones are white. Active file bundle refers to active set of files for specific machine type. This includes definition-, route- and environment-file.</p>
<p>Activating bundle can be done by double clicking row. If there was a bundle active for given machine type earlier, it will get deselected and be replaced by newly selected bundle.</p>
<p>Multiple active production areas are not supported. There will be a warning popup if this is attempted.</p>
<p>Changes are not applied immediately. To apply changes, click on &quot;Send request&quot;. This will tell server to reload entire production area.</p>
<p>If some column does not fit into screen, hover over cell to show text inside.</p>
<div class="table-wrapper"><table><thead><tr><th>Column</th><th>Explanation</th></tr></thead><tbody>
<tr><td>ProductionAreaname</td><td>Name of production area this bundle belongs to</td></tr>
<tr><td>MachineTypeName</td><td>Name of machine type this bundle belongs to</td></tr>
<tr><td>DefinitionFileName</td><td>Name of definition file. Should be shared among all machine types for production area</td></tr>
<tr><td>Version</td><td>Version of bundle for given production area. When working with multiple machinetypes, they should always use same version</td></tr>
<tr><td>SegmentFileName</td><td>Name of segment file for given machine type for Production Area</td></tr>
<tr><td>EnvFileName</td><td>Name of environment file for given machine type for Production Area</td></tr>
<tr><td>Created</td><td>When this bundle was created and uploaded</td></tr>
<tr><td>Active</td><td>Whether this bundle is active or not</td></tr>
</tbody></table>
</div>
<h4 id="file-management"><a class="header" href="#file-management">File management</a></h4>
<p><img src="Images/media/SettingsEraFiles.png" alt="" /></p>
<blockquote>
<p>Figure: Area files management</p>
</blockquote>
<p>Era file is a single binary file in Navithor database. These files are bound together to form a bundle. This tab gives fine control over individual files.</p>
<div class="table-wrapper"><table><thead><tr><th>Row color</th><th>Meaning</th></tr></thead><tbody>
<tr><td>White</td><td>Not selected</td></tr>
<tr><td>Blue</td><td>Selected row</td></tr>
<tr><td>Green</td><td>File that belongs to active bundle</td></tr>
<tr><td>Orange</td><td>File that is orphaned, does not belong to any bundle</td></tr>
<tr><td>Red</td><td>File that is pending removal</td></tr>
</tbody></table>
</div>
<p>Double clicking a row will mark specified file as &quot;To be deleted&quot;. File can be marked to be deleted also by selecting a row and pressing 'Delete' key on keyboard.</p>
<p>Clicking 'Delete selected' will command Server to delete these files permanently. There might be warnings when removing, read the warning carefully before proceeding.</p>
<p>Clicking 'Reset' will unmark files that were marked &quot;To be deleted&quot;</p>
<div class="table-wrapper"><table><thead><tr><th>Column</th><th>Explanation</th></tr></thead><tbody>
<tr><td>EraFileId</td><td>Id of Era file in database</td></tr>
<tr><td>EraFileTypeEnum</td><td>Type of era file</td></tr>
<tr><td>EraFileName</td><td>Name of era file</td></tr>
<tr><td>Version</td><td>Version of era file</td></tr>
<tr><td>IsOrphaned</td><td>Whether this file is orphaned, does not belong to any bundle</td></tr>
<tr><td>IsInUse</td><td>Whether bundle this file is associated with is in use</td></tr>
</tbody></table>
</div>
<p>Deleting files becomes important if SQL Database becomes too large. Normally old area versions are not needed in the system thus deleting the oldest files is a good routine to free up space from database and also keep the Area files-view clean.</p>
<h4 id="activating-parameters-for-machine-type"><a class="header" href="#activating-parameters-for-machine-type">Activating parameters for machine type</a></h4>
<p><img src="Images/media/SettingsEraMtParameters.png" alt="" /></p>
<blockquote>
<p>Figure: Machine type parameters</p>
</blockquote>
<p>Active machine type parameters are colored green while inactive ones are white.</p>
<p>Activating a machine type parameter file can be done by double clicking row. If there was a parameter file active for given machine type earlier, it will get deselected and be replaced by newly selected parameter file. Production area cannot be operational if there is no machine type parameter file as activated.</p>
<p>Changes are not applied immediately. To apply changes, click on &quot;Send request&quot;. This will tell server to reload entire production area.</p>
<h4 id="activating-system-parameters"><a class="header" href="#activating-system-parameters">Activating System parameters</a></h4>
<p>To select server parameter file to activate go to Area Files tab of Production settings window.</p>
<p><img src="Images/media/SettingsServerParameterFiles.png" alt="" /></p>
<blockquote>
<p>Figure: System parameter file selection</p>
</blockquote>
<p>Active server parameter file (System parameters) will be colored green while inactive ones are white. New entry to the list is created every time the system parameters have been changed and stored to database.</p>
<p>Activating a server parameter file can be done by double clicking row.</p>
<p>Changes are not applied immediately. Changing server parameter file requires Server restart to ensure all parameters get loaded in properly.</p>
<h2 id="controlling-machines"><a class="header" href="#controlling-machines">Controlling machines</a></h2>
<h3 id="selecting-a-machine"><a class="header" href="#selecting-a-machine">Selecting a machine</a></h3>
<p>A machine can be selected from the machine list or from the map by
clicking the machine name. Clicking machine again once machine is selected causes map to focus
on that specific machine.</p>
<p>Selecting a machine opens up Machine controls panel.</p>
<p>If machine does not have it's position initialized yet,
it might not be visible on the map.</p>
<h3 id="machine-controls"><a class="header" href="#machine-controls">Machine controls</a></h3>
<p>The machine controls show some live measurements from the machine. It
also has buttons for commanding the machine.</p>
<p><img src="./Images/media/image51.png" alt="" /></p>
<blockquote>
<p>Figure: AGV task control</p>
</blockquote>
<h3 id="statuses"><a class="header" href="#statuses">Statuses</a></h3>
<p><strong>Communication</strong>: Shows the communication status between Navithor and
Navitrol. Possible statuses are <em>Connecting</em>, <em>OK</em> and <em>Updating files</em>.</p>
<p><strong>Position confidence</strong>: Shows the position confidence level in
percentage received from navigation. If the machine position is not
initialized this is shown as well with an additional text &quot;not
initialized&quot;.</p>
<p><strong>Control</strong>: Shows the Auto / Manual state of the machine. Navithor can
only command machines that are in Auto-mode.</p>
<p><strong>State</strong>: Shows the navigation state, possible states are (IDLE, STBY,
AUTO, REMOTE, INI_POS, FSTOP, LOAD, UNLOAD, ACTUATOR_CONTROL, HOLD)</p>
<p><strong>Transport status</strong>: Shows the type of the resource the machine is
transporting.</p>
<p><strong>Battery level:</strong> Battery level in percentage. Visible if battery is
enabled in machine type parameters.</p>
<h3 id="commands"><a class="header" href="#commands">Commands</a></h3>
<h4 id="fstop-machine"><a class="header" href="#fstop-machine">FSTOP Machine</a></h4>
<p>Send <em>FSTOP</em> command to the selected machine. Machine state goes to
FSTOP.</p>
<h4 id="release-fstop"><a class="header" href="#release-fstop">Release FSTOP</a></h4>
<p>Send <em>release FSTOP</em> command to the selected machine. Releasing FSTOP
will also take the machine out of production.</p>
<h4 id="initialize-position-send-posinit"><a class="header" href="#initialize-position-send-posinit">Initialize position/ Send PosInit</a></h4>
<p><img src="./Images/media/image52.png" alt="" /></p>
<blockquote>
<p>Figure: Position init in map view with Scanner view from AGV received</p>
</blockquote>
<p>Position of a machine can be (re)initialized whenever it is in stand
by-state (STBY). Initialization can be done in two ways: either defining
navigation point and machine heading or setting machine position into
any of the predefined locations where position initialization is
enabled. Command flow is following:</p>
<p><strong>To initialize machine position anywhere in map:</strong></p>
<ol>
<li>
<p>Press 'Initialize position'-button</p>
</li>
<li>
<p>Click location on map near machine's navigation point</p>
</li>
<li>
<p>Move mouse away from clicked location to see current scanner view of
the machine transformed to the location first clicked and rotated to
the direction the mouse is now pointing from the clicked location</p>
</li>
<li>
<p>Click second time on the map when desired heading for the machine is
pointed</p>
<p>a.  If clicked location (list item 2) for the machine does not match the environment you can continue sequence by clicking the map again. Click mode changes between position and heading</p>
</li>
<li>
<p>Press 'Send Posinit'-button when the map shows the black arrow
indicating position and heading are set. Machine starts position
initialization sequence.</p>
</li>
</ol>
<p><strong>To symbolic point with position initialization enabled:</strong></p>
<p>When 'Initialize position'-button is pressed only symbolic points that
are defined as position init locations will remain visible and will show
index number for the location -- all other symbolic points are set
hidden. The user can initialize machines position into these locations
when he/she is sure that the machine is parked into the selected
position init location.</p>
<p><img src="./Images/media/image53.png" alt="" /></p>
<blockquote>
<p>Figure: Position intialization Symbolic Point</p>
</blockquote>
<h4 id="set-position-to-last-saved"><a class="header" href="#set-position-to-last-saved">Set position to last saved</a></h4>
<p>Pressing 'Set position to last saved' when machine's position is not
initialized results Navithor to get the last saved position from
database as the reference location for position initialization. Machines
position is saved to database in regular intervals (Server parameter
Machine_STATUS_STORE_INTERVAL_MS) and if machine was moving when
position was lost the last saved location may be at some distance from
actual location.</p>
<h4 id="return-to-route"><a class="header" href="#return-to-route">Return to route</a></h4>
<p>Sends command to Navitrol to use &quot;Return to route&quot; functionality. AGV will drive to closest route. Does not work with Fleet Simulator.</p>
<h4 id="goto-xy"><a class="header" href="#goto-xy">GOTO XY</a></h4>
<p>After pressing GOTO XY button, the user can select a point from the map
where he wants the machine to move. The machine starts driving to the
given point when it has been selected on the map. If the right mouse
button is pressed onto a location a GotoXY Route review-window will
appear. While window is visible the user can view the route that is
calculated for the machine with minimum travel time.</p>
<p>From the GotoXY Route review-window the user can either 'Execute route',
'Find next best' route or 'Close' the window. Clicking 'Find next
best'-button will result Navithor to find different route solution if
non-optimal route is needed.</p>
<p><img src="./Images/media/image54.png" alt="" /></p>
<blockquote>
<p>Figure: Goto XY with right mouse button - route selection</p>
</blockquote>
<p>GoToXY Route review</p>
<h4 id="abort"><a class="header" href="#abort">Abort</a></h4>
<p>Sends <em>abort</em> command to Navitrol. The machine stops driving and
Navitrol transits into STBY state. If the machine was in production mode
it is taken out of production.</p>
<h4 id="load-unload"><a class="header" href="#load-unload">Load /Unload</a></h4>
<p>Sends <em>load</em> or <em>unload</em> command to machine.</p>
<h4 id="take-machine-into-production"><a class="header" href="#take-machine-into-production">Take machine into production</a></h4>
<p>When AGV is taken into production it will start driving production
orders if they exist. When the machine is in production it is not
possible to send drive/load/unload-orders from Client. Aborting
machine's task is possible and it will take automatically the machine
out of production.</p>
<p>If production is triggered by hold-release reasoning, AGVs that occupy
hold symbolic point will be ordered to Hold-state by Navithor when taken
into production. If AGV is not parked to any hold location, it is driven
automatically to a wait location if wait location is found and is
reachable (waitLoad or wait if AGV is empty, waitUnload or wait).</p>
<p>Machine can be taken into production when it is driving a GOTO XY-drive.
Machine will execute the drive to the destination and next task is then
generated by Navithor based on production data.</p>
<h4 id="show-task-log"><a class="header" href="#show-task-log">Show task log</a></h4>
<p>Shows the log of the task control messages for a selected machine.</p>
<p><img src="./Images/media/image55.png" alt="" /></p>
<blockquote>
<p>Figure: Task log of AGV</p>
</blockquote>
<h2 id="quick-start-guide"><a class="header" href="#quick-start-guide">Quick Start Guide</a></h2>
<h3 id="setup-server"><a class="header" href="#setup-server">Setup server</a></h3>
<p>Start Navithor Server as application. If there is no ntconn defined the Server will generate popup for configuring one.</p>
<p><img src="Images/media/ntconnGeneration.png" alt="" /></p>
<blockquote>
<p>Figure: No database configured - missing configuration file</p>
</blockquote>
<p>Click on Use default. If everything goes well the Server will resume booting.</p>
<p><img src="Images/media/ntconnGeneration_DefaultFail.png" alt="" /></p>
<blockquote>
<p>Figure: Configuration file is read but making connection to Navithor database fails</p>
</blockquote>
<p>Default connection string was not valid. Click on Customize and follow instructions on <a href="navithorServerAndClientMegaDocument.html#configuring-database">Database configuration</a> section.</p>
<p><img src="Images/media/validntconn.png" alt="" /></p>
<blockquote>
<p>Figure: Database connection OK</p>
</blockquote>
<p>Valid database configuration. Server continues booting.</p>
<p>After server is up and running start Navithor Client.</p>
<h3 id="setting-up-client"><a class="header" href="#setting-up-client">Setting up Client</a></h3>
<p><img src="Images/media/quickstart_login.png" alt="" /></p>
<blockquote>
<p>Figure: Client login prompt shows only if Server is reached</p>
</blockquote>
<p>After starting client login prompt should pop up. If Server is located at same PC proceed to login with administrator credentials and proceed to <a href="navithorServerAndClientMegaDocument.html#configuring-production-area">Configuring production area</a>. Otherwise proceed to <a href="navithorServerAndClientMegaDocument.html#configuring-server-ip">Configuring Server ip</a>.</p>
<h4 id="configuring-server-ip"><a class="header" href="#configuring-server-ip">Configuring Server ip</a></h4>
<p>To configure Server IP select Cancel in Login form. This will allow using Navithor Client in offline mode for configuring server ip.</p>
<p><img src="Images/media/quickstart_ClientSettings.png" alt="" /></p>
<blockquote>
<p>Figure: Navigate to Settings-&gt;Configuration</p>
</blockquote>
<p><img src="Images/media/quickstart_ClientSettings_ServerIp.png" alt="" /></p>
<blockquote>
<p>Figure: Server IP address can be changed here</p>
</blockquote>
<p>Write Server IP and Port. Click Save changes.</p>
<p>Connectivity to server is always visible on bottom-left corner of Navithor Client. Updating connectivity status after changing ip may take few minutes. If the connection fails, then the possible reason is the firewall settings. By default Client-Server communication uses port 9000 for data signals and 9001 for file transfer. Both ports need to be allowed in firewall.</p>
<p><img src="Images/media/quickstart_server_disconnect.png" alt="" /></p>
<blockquote>
<p>Figure: Client bottom status bar when Server is not connected</p>
</blockquote>
<p><img src="Images/media/quickstart_server_connected.png" alt="" /></p>
<blockquote>
<p>Figure: Client bottom status bar when Server is connected</p>
</blockquote>
<h4 id="configuring-production-area"><a class="header" href="#configuring-production-area">Configuring production area</a></h4>
<p><img src="Images/media/quickstart_notConfiguredClient.png" alt="" /></p>
<blockquote>
<p>Figure: Area not operational error</p>
</blockquote>
<p>On fresh install there is no Production Area or machines yet. There should be errors about production area not being operational yet. If production area was already uploaded from NavithorTools proceed to <a href="navithorServerAndClientMegaDocument.html#configuring-machines">Configuring machines</a>.</p>
<p><img src="Images/media/quickstart_filesUploadedFromTools.png" alt="" /></p>
<blockquote>
<p>Figure: Area files view with buttons to upload individual files</p>
</blockquote>
<p>Active files can be verified by Navigating to Settings -&gt; Production settings -&gt; Area files. If there are no entries visible it means there are no files yet and they need to be uploaded first. Easiest way to upload files correctly is by using Navithor Tools to upload files to database. Otherwise continue to <a href="navithorServerAndClientMegaDocument.html#uploading-files-manually">Uploading files manually</a></p>
<h4 id="uploading-files-manually"><a class="header" href="#uploading-files-manually">Uploading files manually</a></h4>
<p>Navigate to Settings -&gt; Production settings -&gt; Area Files</p>
<p><img src="Images/media/quickstart_manualUpload_filesSelected.png" alt="" /></p>
<blockquote>
<p>Figure: List of files ready to be uploaded to Navithor database</p>
</blockquote>
<p>Click on 'Definition file' to pick Definition file for area.</p>
<p>Click on 'Environment file' to pick Environment file for machines to use.</p>
<p>Click on 'Segment file' to pick Segment file defining routenetwork.</p>
<p>Click on 'Machine type parameters&quot; to pick parameters for machine type.</p>
<p>Click 'Upload'.</p>
<p>Files should now appear on right. The files are not activated yet, double click row to activate.</p>
<p><img src="Images/media/quickstart_manualUpload_AfterUpload.png" alt="" /></p>
<blockquote>
<p>Figure: File bundles view with new entry after successful file set upload</p>
</blockquote>
<p>This warning will popup. This means that there are files active for Production Area but machine type does not have active parameters. Navigate to Machine type params.</p>
<p><img src="Images/media/quickstart_manualUpload_AfterActiveSelect.png" alt="" /></p>
<blockquote>
<p>Figure: A warning about missing machine type parameters</p>
</blockquote>
<p>Double click row to activate machine type parameters.</p>
<p><img src="Images/media/quickstart_manualUpload_activatingMachineTypeParams.png" alt="" /></p>
<blockquote>
<p>Figure: No machine type parameters active</p>
</blockquote>
<p>The selected row should now say &quot;True&quot; for 'IsActive'.</p>
<p><img src="Images/media/quickstart_manualUpload_activatingMachineTypeParams_after.png" alt="" /></p>
<blockquote>
<p>Figure: Machine type parameter file activated</p>
</blockquote>
<p>We have all of the files needed for Production Area configured but they are not loaded in yet. To load files in, click on 'Send request'. Production area is not yet fully operational, next step is configuring Machines. Proceed to <a href="navithorServerAndClientMegaDocument.html#configuring-machines">Configuring machines</a> to finish setting up.</p>
<h4 id="configuring-machines"><a class="header" href="#configuring-machines">Configuring machines</a></h4>
<p>Navigate to Settings -&gt; Production settings -&gt; Machines</p>
<p><img src="Images/media/quickstart_machine_empty.png" alt="" /></p>
<blockquote>
<p>Figure: Fresh Machines view</p>
</blockquote>
<p>Currently there shouldn't be any machines listed here yet. To create new machine click on 'Create'. Click on create multiple times if you need to add more than 1 machine.</p>
<p><img src="Images/media/quickstart_machine_added.png" alt="" /></p>
<blockquote>
<p>Figure: Creating machines</p>
</blockquote>
<p>Newly created machines are in 'pending' state, they are not stored to database yet. Fill in correct information for all Machines and click on 'Save' to save changes.</p>
<p>If you get error about missing production area, discard all changes and navigate back to Area files. Ensure there is active Production Area file bundle and that machine type has parameters. Afterwards Click on 'Request area reload' to command server to load files in.</p>
<p><img src="Images/media/quickstart_machine_saveerr.png" alt="" /></p>
<blockquote>
<p>Figure: Machines cannot be saved in case there is no active production area</p>
</blockquote>
<p>When saving was successful the background for row should be white.</p>
<p><img src="Images/media/quickstart_machine_saved.png" alt="" /></p>
<blockquote>
<p>Figure: Machine configured successfully</p>
</blockquote>
<p>After adding all of the machines click on 'Request area reload' one more time. The machine(s) should appear on very left on main view.</p>
<p><img src="Images/media/quickstart_productionAreaIsActive.png" alt="" /></p>
<blockquote>
<p>Figure: Main view after successful area- and machine-configuration</p>
</blockquote>
<p>Proceed to <a href="navithorServerAndClientMegaDocument.html#basic-testing">Basic testing</a> for basic testing.</p>
<h4 id="basic-testing"><a class="header" href="#basic-testing">Basic testing</a></h4>
<p>After setting up Production Area for first time it is good to do some basic testing. Click on Machine on MachineList to bring up machine controls. Active routes should be highlighted on blue. Initially the machine does not have a position and it need's to be set.</p>
<p><img src="Images/media/quickstart_basicTesting_MachineControl.png" alt="" /></p>
<blockquote>
<p>Figure: AGV selected</p>
</blockquote>
<p>Click on 'Initialize Position' and then click a spot on map where you think the machine is. After first click the AGV will start sending scanner data. Use the scanner data to figure out correct location for machine. Right click to reset and pick position again.</p>
<p><img src="Images/media/quickstart_basicTesting_posinit_step1.png" alt="" /></p>
<blockquote>
<p>Figure: Initializing position</p>
</blockquote>
<p>Set roughly correct heading for machine and click on map second time to initialize position.</p>
<p><img src="Images/media/quickstart_basicTesting_posinit_step2.png" alt="" /></p>
<blockquote>
<p>Figure: Position initialization done</p>
</blockquote>
<p>Most simple test is to give GOTO-order for machine. Click on 'Goto XY' in MachineControl and then click on some Symbolic Point.</p>
<p><img src="Images/media/quickstart_basicTesting_goto_givingOrder.png" alt="" /></p>
<blockquote>
<p>Figure: Giving Goto-order</p>
</blockquote>
<p>The AGV should start driving towards given Symbolic Point.</p>
<p><img src="Images/media/quickstart_basicTesting_goto_agvDriving.png" alt="" /></p>
<blockquote>
<p>Figure: AGV driving</p>
</blockquote>
<p>Congratulations. You have successfully setup basic Production Area and executed a simple production order. Next steps would be to <a href="navithorServerAndClientMegaDocument.html#changing-system-parameters">Configure system parameters</a> and start incorporating production logic.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="client-updater"><a class="header" href="#client-updater">Client Updater</a></h1>
<p>This document introduces Client Updater feature</p>
<p>Updated 30.04.2020</p>
<h2 id="version-history-9"><a class="header" href="#version-history-9">Version History</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Version</th><th>Date</th><th>Author</th><th>Change</th></tr></thead><tbody>
<tr><td>1.0</td><td>22.01.2020</td><td>Tommi Kärki</td><td>Document created</td></tr>
<tr><td>1.1</td><td>30.04.2020</td><td>Tommi Kärki</td><td>Added instructions how to take into use. Clarifications</td></tr>
<tr><td>1.2</td><td>11.06.2021</td><td>Aleksi Ålander</td><td>Renamed title</td></tr>
</tbody></table>
</div>
<hr />
<h2 id="introduction-4"><a class="header" href="#introduction-4">Introduction</a></h2>
<p>Client Updater is a feature which allows Navithor Server to send newest Client binaries automatically when outdated Client connects to Server. This streamlines updating Client binaries to newest version.</p>
<p>To take this Feature into use:</p>
<ul>
<li>Create a Directory &quot;ClientBinaries&quot; in Navithor Server installation directory (if missing).</li>
<li>Copy a .zip file containing latest Navithor Client version in ClientBinaries directory.</li>
<li>This .zip should follow a specific naming convention: &quot;NavithorClient_MAJOR.MINOR.BRANCH.REVISION.zip&quot; or &quot;NavithorClient_MAJOR_MINOR_BRANCH_REVISION.zip&quot;. For example: &quot;NavithorClient_2.17.0.0.zip&quot;</li>
<li>Next time Navithor Client connects to Server there will be a prompt to User about update.</li>
<li>It is required that both Navithor Server and Navithor Client have same version.</li>
</ul>
<h3 id="what-happens-if-you-connect-to-server-with-outdated-client"><a class="header" href="#what-happens-if-you-connect-to-server-with-outdated-client">What happens if you connect to Server with outdated client</a></h3>
<p>Case 1: If there are no binaries available then Server will inform Client. Outdated Client will not be able to connect to that Server. This situation requires either adding the matching Client binaries to correct directory or manually updating Client.</p>
<p>Case 2: Server finds the correct binary and sends it to Client. Client will notify user once download is completed. New version is downloaded to Client directory in .zip format. To take new Client into use simply unpack the .zip file to Client directory.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="setting-up-web-server-to-enable-web-client"><a class="header" href="#setting-up-web-server-to-enable-web-client">Setting up Web server to enable Web client</a></h1>
<p>This document contains information on how to install and configure Web Server for Navithor Web Client.</p>
<p>Updated 28.07.2022</p>
<h2 id="version-history-10"><a class="header" href="#version-history-10">Version history</a></h2>
<div class="table-wrapper"><table><thead><tr><th><strong>Version</strong></th><th><strong>Date</strong></th><th><strong>Author</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>1.0</td><td>15.01.2021</td><td>Tommi Kärki</td><td>Migrated from another document</td></tr>
<tr><td>1.1</td><td>15.04.2021</td><td>Tero Laakso</td><td>Instructions for easy installation</td></tr>
<tr><td>1.2</td><td>11.06.2021</td><td>Aleksi Ålander</td><td>Renamed title</td></tr>
<tr><td>1.3</td><td>04.02.2022</td><td>Tero Laakso-Pitkäkoski</td><td>Navithor Server.exe configuration moved to ServerSettings.json</td></tr>
<tr><td>1.4</td><td>28.07.2022</td><td>Elena Sgonova</td><td>Updated instructions with troubleshooting hints</td></tr>
</tbody></table>
</div>
<hr />
<h2 id="navithor-web-client-installation"><a class="header" href="#navithor-web-client-installation">Navithor Web Client installation</a></h2>
<p>Navithor Web Client installation package is delivered as a ZIP file, with content similar to this:
<img src="Images/navithorWebServer-required-files.png" alt="" /></p>
<p>Extract this package to the Navithor Server folder. Making sure that the index.html file is in same folder as Navithor Server executable.</p>
<h3 id="general-configurations"><a class="header" href="#general-configurations">General configurations</a></h3>
<p>Configure web server ports and encryption in <strong>ConfigFiles/ServerSettings.json</strong>. Default settings are listed below. If <em><strong>UseWebServer</strong></em> is false the other settings don't affect anything and Web Client can't be reached.</p>
<pre><code class="language-json">{  
    &quot;UseWebServer&quot;: true,  
    &quot;UseHttps&quot;: false,  
    &quot;WebClientPort&quot;: 1234,  
    &quot;WebSocketPort&quot;: 8083,  
    &quot;WebClientCertCommonName&quot;: &quot;MCSServer&quot;  
}  
</code></pre>
<p>After configurations are saved, start Navithor Server executable. First execution after Web Client configuration changes will run automatic HTTP server configurations. Server will ask for Administrator permissions to do so and it will restart once done. It is advisable to turn off <em><strong>RunAsService</strong></em> configuration while setting up Web Client or changing its settings.</p>
<p>If <em><strong>UseHttps</strong></em> is set to true, both the request-response communication and web socket communication will use SSL (https and wss). Using SSL requires that a valid certificate is configured to the system certificate manager, see next chapter. <em><strong>SSL is highly encouraged since otherwise username and password will go through the network in plaintext.</strong></em></p>
<h3 id="steps-to-configure-ssl"><a class="header" href="#steps-to-configure-ssl">Steps to configure SSL</a></h3>
<h4 id="ssl-certificate-generation"><a class="header" href="#ssl-certificate-generation">SSL certificate generation</a></h4>
<h5 id="generate-a-certificate-if-one-does-not-already-exist"><a class="header" href="#generate-a-certificate-if-one-does-not-already-exist">Generate a certificate if one does not already exist</a></h5>
<p>A tool for generating self-signed certificate is OpenSSL. A windows version can be downloaded from https://slproweb.com/products/Win32OpenSSL.html</p>
<p>The certificate is generated using the following steps:</p>
<ol>
<li>Navigate to openssl.exe folder (Default path: ...\Program Files\OpenSSL\bin)</li>
<li>From command line run the following command: <code>openssl req -x509 -newkey rsa:2048 -keyout key.pem -out cert.pem</code></li>
<li>Fill in needed information for your organization</li>
<li>From command line run the following command: <code>openssl pkcs12 -export -in cert.pem -inkey key.pem -out mycert.pfx</code></li>
</ol>
<h5 id="import-the-certificate-with-windows-certificate-manager"><a class="header" href="#import-the-certificate-with-windows-certificate-manager">Import the certificate with Windows Certificate Manager</a></h5>
<ol>
<li>Type &quot;<strong>manage computer certificates</strong>&quot; to windows search and click the search result to open &quot;certlm&quot;-window</li>
<li>Right click Personal-&gt;All tasks-&gt;Import.</li>
</ol>
<p><img src="Images/navithorWebServer-importCertificates.png" alt="" /></p>
<ol start="3">
<li>Browse for the created certificate.</li>
<li>Don't set password and just click next until the final.</li>
</ol>
<h4 id="navithor-ssl-configuration"><a class="header" href="#navithor-ssl-configuration">Navithor SSL configuration</a></h4>
<p>Set <em><strong>WebClientCertCommonName</strong></em> parameter in Navithor Server config file to match with the Common Name of the certificate you have imported (visible in &quot;certlm&quot;). Run Navithor Server, it will detect the changes in Web Client configuration and ask for elevated permissions to change the configuration.</p>
<h2 id="manual-setup"><a class="header" href="#manual-setup">Manual setup</a></h2>
<p>In environments where running Navithor Server as Administrator when doing the installation is not possible or something else prevents Navithor to automatically change the HTTP bindings to match the configuration, HTTP and SSL cert bindings require manual steps for the Web Client to work.</p>
<h3 id="steps-to-configure-ssl-1"><a class="header" href="#steps-to-configure-ssl-1">Steps to configure SSL</a></h3>
<p>After successfully importing the certificate following the steps in section &quot;SSL certificate generation&quot;, double click the created certificate from &quot;certlm&quot;-window: <em>Personal/Certificates</em>, select details page and click the thumbprint at the bottom of the list.</p>
<p><img src="Images/navithorWebServer-thumbprint.png" alt="" /></p>
<p>Copy the following commands to notepad and insert the certificate's <em>thumbprint</em> from details page to the <strong>certhash</strong> parameter. Also replace the <em>webClientPort</em> and <em>webSocketPort</em> with the configured <em>ports</em>.</p>
<p><code>netsh http add sslcert ipport=0.0.0.0:</code><em>webClientPort</em>
<code>certhash=</code><em>thumbprint</em>
<code>appid=</code><em>{06aabebd-3a91-4b80-8a15-adfd3c8a0b14}</em></p>
<p><code>netsh http add sslcert ipport=0.0.0.0:</code><em>webSocketPort</em>
<code>certhash=</code><em>thumbprint</em>
<code>appid=</code><em>{06aabebd-3a91-4b80-8a15-adfd3c8a0b14}</em></p>
<p>An example:</p>
<p>Run the following commands from command prompt as administrator:</p>
<p><code>netsh http add sslcert ipport=0.0.0.0:1234 certhash=0d33e372be476ebd58f1c9e651fadabab40898da appid={06aabebd-3a91-4b80-8a15-adfd3c8a0b14}</code></p>
<p><code>netsh http add sslcert ipport=0.0.0.0:8083 certhash=0d33e372be476ebd58f1c9e651fadabab40898da appid={06aabebd-3a91-4b80-8a15-adfd3c8a0b14}</code></p>
<h3 id="steps-to-create-correct-url-reservations"><a class="header" href="#steps-to-create-correct-url-reservations">Steps to create correct url reservations</a></h3>
<p>To use the web server, make sure that the correct urls are reserved for non-administrator users and accounts. Open command prompt with administrator privileges.</p>
<p>Copy the following commands to notepad and replace ports with the configured ports. Replace also the user parameter with the correct user. <strong>Leave the</strong> <strong>port 8082</strong> and protocol as is since it is an internal communication port between Navithor and web server. Use https if you wish to use SSL encryption with the web server, but only for client and websocket ports. Port 8082 should always have http.</p>
<p><code>netsh http add urlacl url=https://+:</code><em>webClientPort</em><code>/ user=</code><em>USER</em></p>
<p><code>netsh http add urlacl url=https://+:</code><em>webSocketPort</em><code>/mcsserver/ user=</code><em>USER</em></p>
<p><code>netsh http add urlacl url=http://+:8082/mcsserver/ user=</code><em>USER</em></p>
<p>An example:</p>
<p><code>netsh http add urlacl url=https://+:1234/ user=Everyone</code></p>
<p>Note that the user has to be defined in the same language than the operating system. For example, the user in Denmark should be &quot;Alle&quot; instead of Everyone.</p>
<h2 id="troubleshooting-2"><a class="header" href="#troubleshooting-2">Troubleshooting</a></h2>
<h3 id="general-notes"><a class="header" href="#general-notes">General notes</a></h3>
<p>Make sure url reservations were correct. Run <code>netsh http show urlacl</code> on command prompt and verify that correct ports and protocols were configured both in netsh and in the <strong>ConfigFiles/ServerSettings.json</strong>. Below an example without SSL.</p>
<p><img src="Images/navithorWebServer-example-no-ssl.png" alt="" /></p>
<pre><code class="language-json">{  
    &quot;UseWebServer&quot;: true,  
    &quot;UseHttps&quot;: false,  
    &quot;WebClientPort&quot;: 1234,  
    &quot;WebSocketPort&quot;: 8083,  
    &quot;WebClientCertCommonName&quot;: &quot;MCSServer&quot;  
}  
</code></pre>
<p>If <strong>useHttps</strong> is set to <em>true</em>, make sure that https is set on the netsh http reservations and check that the correct ports and certificate hash are shown in <code>netsh http show sslcert</code>. Below an example with SSL.</p>
<p><img src="Images/navithorWebServer-example-ssl-enabled1.png" alt="" /></p>
<p><img src="Images/navithorWebServer-example-ssl-enabled2.png" alt="" /></p>
<p>As always <em><strong>make sure that the firewalls do not block connections</strong></em> to the configured web server ports.</p>
<h3 id="fixing-wrong-configurations"><a class="header" href="#fixing-wrong-configurations">Fixing wrong configurations</a></h3>
<p>Fixing wrong configurations can only be done by first deleting the wrong reservation and then adding the configuration again. Deleting http reservation is done with command:</p>
<p><code>netsh http delete urlacl url=</code><em>protocol</em><code>://+:</code><em>port</em><code>/</code></p>
<p>An example:</p>
<p><code>netsh http delete urlacl url=https://+:1234/</code></p>
<h3 id="fixing-error-183-cannot-create-a-file-when-that-file-already-exists"><a class="header" href="#fixing-error-183-cannot-create-a-file-when-that-file-already-exists">Fixing Error: 183 Cannot create a file when that file already exists</a></h3>
<p>In case the error message &quot;SSL Certificate add failed, Error: 183 Cannot create a file when that file already exists&quot; is shown, run following commands:</p>
<p><code>netsh http delete sslcert ipport=0.0.0.0:</code><em>WebClientPort</em></p>
<p><code>netsh http delete sslcert ipport=0.0.0.0:</code><em>WebSocketPort</em></p>
<p>An example:</p>
<p><code>netsh http delete sslcert ipport=0.0.0.0:1234</code></p>
<p><code>netsh http delete sslcert ipport=0.0.0.0:8083</code></p>
<h3 id="fixing-websocket-not-receiving-data-from-server"><a class="header" href="#fixing-websocket-not-receiving-data-from-server">Fixing websocket not receiving data from server</a></h3>
<p>One sign of websocket not receiving data is when user can successfully log in and Web Client UI is loaded but dynamic data (i.e. AGVs or symbolic points statuses) is not being updated and <em>&quot;Offline mode - No server connection&quot;</em> message is displayed <strong>but the server is running</strong>. This happens in some browsers when using HTTPS protocol and browser does not trust self signed certificate.</p>
<p>Possible solution to this issue:</p>
<ol>
<li>
<p>Import a certificate to <em>Trusted Root Certification Authorities</em> with Windows Certificate Manager</p>
</li>
<li>
<p>Add an exception in the browser security settings. Server URL must contain websocket port as shown in the example:</p>
</li>
</ol>
<p><img src="Images/certificateIssues1.png" alt="" /></p>
<h2 id="running-web-server"><a class="header" href="#running-web-server">Running web server</a></h2>
<p>Web server is hosted in the Navithor server application. If all steps in this chapter are successfully done, then starting Navithor server will also start the webserver and the Web Client can be reached. And if not, the server launcher will get stuck at &quot;Initializing connections...&quot; state. In that case - see the previous subchapter: Troubleshooting</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="web-client-user-instructions"><a class="header" href="#web-client-user-instructions">Web Client User Instructions</a></h1>
<p>This document contains the user instructions for the Navithor Web Client</p>
<p>Updated 13.12.2022</p>
<h2 id="version-history-11"><a class="header" href="#version-history-11">Version history</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Version</th><th>Date</th><th>Author</th><th>Description</th></tr></thead><tbody>
<tr><td>0.1</td><td>15.04.2019</td><td>Vili Väyrynen</td><td>Screen shots</td></tr>
<tr><td>1.1</td><td>21.05.2019</td><td>M. Ashhal Tahir</td><td>First version</td></tr>
<tr><td>1.2</td><td>18.06.2019</td><td>Vili Väyrynen</td><td>Revised version</td></tr>
<tr><td>2.0</td><td></td><td>Tommi Kärki</td><td>Converted to markdown</td></tr>
<tr><td>2.1</td><td>09.12.2020</td><td>Luis Rebelo</td><td>Updated organization of chapters</td></tr>
<tr><td>2.2</td><td>10.12.2020</td><td>Luis Rebelo</td><td>Updated screenshots to latest version</td></tr>
<tr><td>2.3</td><td>25.01.2021</td><td>Luis Rebelo</td><td>Updated text formatting and screenshots descriptions</td></tr>
<tr><td>2.4</td><td>06.05.2021</td><td>Tero Laakso</td><td>Updated screenshots and descriptions for new functionalities</td></tr>
<tr><td>2.5</td><td>11.06.2021</td><td>Aleksi Ålander</td><td>Renamed title, minor formatting corrections.</td></tr>
<tr><td>2.6</td><td>16.06.2021</td><td>Elena Sgonova</td><td>Updated title of referred document to &quot;Web Client Handheld Interface&quot;</td></tr>
<tr><td>2.7</td><td>14.07.2021</td><td>Luis Rebelo</td><td>Specs for Web Client browser requirements</td></tr>
<tr><td>2.8</td><td>16.07.2021</td><td>Luis Rebelo</td><td>Updates to images</td></tr>
<tr><td>2.9</td><td>28.07.2021</td><td>Luis Rebelo</td><td>Updated with details on new settings</td></tr>
<tr><td>2.11</td><td>10.11.2021</td><td>Tero Laakso</td><td>Statistics view page section added</td></tr>
<tr><td>2.12</td><td>23.02.2022</td><td>Tero Laakso-Pitkäkoski</td><td>Added charts to statistics view section</td></tr>
<tr><td>2.13</td><td>27.07.2022</td><td>Elena Sgonova</td><td>Added Waypoints control section</td></tr>
<tr><td>2.14</td><td>11.08.2022</td><td>Elena Sgonova</td><td>Updated machine position initialization instructions</td></tr>
<tr><td>2.15</td><td>09.09.2022</td><td>Elena Sgonova</td><td>Updated details about Map view statistics</td></tr>
<tr><td>2.16</td><td>13.10.2022</td><td>Aleksi Ålander</td><td>Updated chapter about Alarms</td></tr>
<tr><td>2.17</td><td>31.10.2022</td><td>Elena Sgonova</td><td>Added details about AGV availability statistics</td></tr>
<tr><td>2.18</td><td>25.11.2022</td><td>Aleksi Ålander</td><td>Updated chapter about adding a new Production Order</td></tr>
<tr><td>2.19</td><td>13.12.2022</td><td>Aleksi Ålander</td><td>Added chapter about replacing existing resource at 'Source' station</td></tr>
</tbody></table>
</div>
<hr />
<h2 id="introduction-5"><a class="header" href="#introduction-5">Introduction</a></h2>
<p>This manual gives insight into the Web Client interface and provides various use cases for interacting with the Web Client, carrying out interactions with the AGVs and production environments.</p>
<p>Web Client is a simplified version of Navithor Client. The main benefits of the Web Client are that it can be accessed with mobile and desktop browsers and it allows multiple simultaneous connections.</p>
<p><strong>Web Client can be used to observe and control the production:</strong></p>
<ul>
<li>
<p>Observe</p>
<ul>
<li>
<p>Map</p>
</li>
<li>
<p>Orders and their status</p>
</li>
<li>
<p>Errors and events</p>
</li>
<li>
<p>Machine states</p>
</li>
<li>
<p>Symbolic point states</p>
</li>
</ul>
</li>
<li>
<p>Control</p>
<ul>
<li>
<p>Take machines in and out of production</p>
</li>
<li>
<p>Initialize machine positions</p>
</li>
<li>
<p>Add and remove</p>
<ul>
<li>
<p>Production orders</p>
</li>
<li>
<p>Resources</p>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="logging-to-the-web-client"><a class="header" href="#logging-to-the-web-client">Logging to the Web Client</a></h2>
<p>The Web Client can be accessed through any device having an internet connection and web browser.</p>
<p><strong>Steps of connection:</strong></p>
<ol>
<li>
<p>Open the web browser (Chrome or Firefox recommended)</p>
</li>
<li>
<p>Type URL to the Web Client in the format,
'<em><strong>protocol://ip_address:port'</strong></em></p>
<p>a.  The <em><strong>protocol</strong></em> in the URL is either &quot;http&quot; or &quot;https&quot;
depending if the connection was configured to be secure (https)
or not (http) during the installation of the Web Server.</p>
<p>b.  The <em><strong>ip_address</strong></em> is the IP address of the computer where
the Navithor Server is running</p>
<p>c.  The <em><strong>port</strong></em> is the one that is configured while setting up
the web server during the installation of the Navithor Server.</p>
<p>d.  A typical example of the URL would look like this:
<a href="https://192.168.1.46:1234/">https://192.168.1.46:1234</a></p>
</li>
</ol>
<p>The login page for Web Client prompts the user to enter username and password. (Note that users can only be added and removed using Navithor Client.)</p>
<p><img src="./Images/webClient/image3.png" alt="" /></p>
<blockquote>
<p>Figure : Login Page</p>
</blockquote>
<h2 id="web-client-pages"><a class="header" href="#web-client-pages">Web Client pages</a></h2>
<p>All pages can be accessed from the top bar of the website when using the Web Client on large windows and on small windows such as mobile screens pages can be accessed from a drop-down menu in the top right corner of the view.</p>
<p>Note that Web Client has been translated to German and the language options are located under the &quot;options&quot; icon:
<img src="./Images/webClient/image4.png" alt="" /></p>
<h3 id="overview-page"><a class="header" href="#overview-page">Overview page</a></h3>
<p>The overview page (figure <em>Overview page</em>) provides an overview of the production status of AGV fleet, amount of active production orders, errors and warnings. On the right-hand side of the interface list of events can be seen with date and time. More information of any of these categories can be found accessing the related pages.</p>
<p><img src="./Images/webClient/webclientOverview_eng_v3.png" alt="" /></p>
<blockquote>
<p>Figure : Overview page</p>
</blockquote>
<h3 id="map-page"><a class="header" href="#map-page">Map page</a></h3>
<p>The <strong>Map</strong>-page displays the map of the production environment consisting of all the routes, resources and AGVs.</p>
<p>An AGV can be selected to open an option window (figure <em>Map and an option window (on the left) to manage an AGV</em>) which can be used to directly control the AGV, manage resources on it etc.
More information about controlling an AGV can be found in the chapter &quot;<strong>Controlling AGVs</strong>&quot;.</p>
<p>Symbolic point can be accessed in similar manner to modify resources on them or enabling/ disabling them from a production.</p>
<p><img src="./Images/webClient/image6.png" alt="" /></p>
<blockquote>
<p>Figure : Map and an option window (on the left) to manage an AGV</p>
</blockquote>
<h4 id="pickup-orders"><a class="header" href="#pickup-orders">Pickup orders</a></h4>
<p>Pickup orders can be made by selecting a load symbolic point with resources and pressing the <strong>REQUEST PICKUP</strong> button. See subsection &quot;<strong>Requesting pickup</strong>&quot;.</p>
<h4 id="controlling-symbolic-points"><a class="header" href="#controlling-symbolic-points">Controlling symbolic points</a></h4>
<p>Symbolic points can be controlled in similar manner with the AGVs.<br />
First, select a symbolic point (for example from the <strong>Map</strong> page) to open editing view. This view shows the controls and current status of the selected symbolic point including name, MES relation, resources and active production orders.</p>
<p><img src="./Images/webClient/image19.png" alt="" /></p>
<blockquote>
<p>Figure : Symbolic point editing view</p>
</blockquote>
<h4 id="disabling-a-symbolic-point"><a class="header" href="#disabling-a-symbolic-point">Disabling a symbolic point</a></h4>
<p><strong>DISABLE</strong> button can be used to disable a symbolic point from production. Note that even when a symbolic point is out of production AGVs can drive there if the drive order is given manually.</p>
<h4 id="editing-resources"><a class="header" href="#editing-resources">Editing resources</a></h4>
<p>&quot;EDIT RESOURCES&quot; button lets the user to add, remove and edit resources on the symbolic point. Note that this button is available only for Load, Unload and Load/Unload symbolic points.</p>
<h4 id="requesting-pickup"><a class="header" href="#requesting-pickup">Requesting pickup</a></h4>
<p>Unhandled orders can be created using the <strong>REQUEST PICKUP</strong> button. Note that this button is available only for Load, Unload and Load/Unload symbolic points and it is disabled if there are currently no resources.</p>
<h4 id="respond-to-mes---option"><a class="header" href="#respond-to-mes---option">Respond to MES - option</a></h4>
<p><strong>Respond to MES</strong> checkbox determines if the symbolic point can be controlled using the MES-interface or not.</p>
<h4 id="controlling-agvs"><a class="header" href="#controlling-agvs">Controlling AGVs</a></h4>
<p>Selecting an AGV from the <strong>Map</strong> page opens AGV control window (figure <em>Map-page with AGV control window open on the left</em>).</p>
<p><img src="./Images/webClient/image20.png" alt="" /></p>
<blockquote>
<p>Figure : Map-page with AGV control window open on the left</p>
</blockquote>
<h4 id="fstop"><a class="header" href="#fstop">FSTOP</a></h4>
<p>The <strong>FSTOP</strong> (Also known as &quot;fast stop&quot;) button will stop the selected AGV and generates a message on top that says 'Release FSTOP command sent' as seen in figure <em>FSTOP active</em>. After this the AGV can take no further actions until the FSTOP is released.</p>
<p><img src="./Images/webClient/image21.png" alt="" /></p>
<blockquote>
<p>Figure :  FSTOP active</p>
</blockquote>
<p>The AGV can be released from the FSTOP using the <strong>RELEASE FSTOP</strong> button.
Pressing the button generates a message 'Release FSTOP command sent' and releases the AGV from the FSTOP (figure <em>Release FSTOP</em>). After this the AGV is free to be taken into production or to be controlled manually.</p>
<p><img src="./Images/webClient/image22.png" alt="" /></p>
<blockquote>
<p>Figure :  Release FSTOP</p>
</blockquote>
<h4 id="aborting-tasks"><a class="header" href="#aborting-tasks">Aborting Tasks</a></h4>
<p><strong>ABORT TASK</strong> button will stop the AGV and discard the task it was performing. Successful abort is confirmed with the message 'Abort command sent' on the top of the screen.</p>
<h4 id="request-charging"><a class="header" href="#request-charging">Request charging</a></h4>
<p><strong>REQUEST CHARGING</strong> button sends a request to the server to take the selected AGV to charging.</p>
<h4 id="release-hold"><a class="header" href="#release-hold">Release hold</a></h4>
<p><strong>RELEASE HOLD</strong> button can be used to release the AGV from a hold symbolic point to its next destination.</p>
<h4 id="taking-the-agv-in-and-out-of-production"><a class="header" href="#taking-the-agv-in-and-out-of-production">Taking the AGV in and out of production</a></h4>
<p>An AGV can be taken in and out of production using the <strong>In Production</strong> switch (figure <em>AGV out of production (left). AGV in production (right).</em>). Note that taking an AGV into production will hide most of the manual control options.</p>
<p><img src="./Images/webClient/image23.png" alt="" />
<img src="./Images/webClient/image24.png" alt="" /></p>
<blockquote>
<p>Figure : AGV out of production (left). AGV in production (right).</p>
</blockquote>
<p>Note that some controls are only available when the AGV is out of production.</p>
<h4 id="managing-resources-on-agv"><a class="header" href="#managing-resources-on-agv">Managing resources on AGV</a></h4>
<p><strong>EDIT RESOURCES</strong> button lets the user to edit or remove resources on the selecting AGV or add them if no resources are currently onboard (figure <em>Adding a New Resource</em>).</p>
<p><img src="./Images/webClient/image25.png" alt="" /></p>
<blockquote>
<p>Figure : Adding a New Resource</p>
</blockquote>
<p>In the figure a resource of type 'Half pallet' having a quantity of 1 is added to the AGV.</p>
<p>The user can select the resource from the drop-down list and pressing <strong>SAVE RESOURCES</strong> button saves the resource on the AGV as seen in the picture below.</p>
<p><img src="./Images/webClient/image26.png" alt="" /></p>
<blockquote>
<p>Figure : Resource Added</p>
</blockquote>
<p>The <strong>LOAD</strong>-button has four states:</p>
<ol>
<li>
<p>START LOAD</p>
</li>
<li>
<p>LOADING: ABORT</p>
</li>
<li>
<p>START UNLOAD</p>
</li>
<li>
<p>UNLOADING: ABORT</p>
</li>
</ol>
<p>The state is determined based on if the machine has an resource or not, or if it is currently loading or unloading.</p>
<p>The button can be used on load and/or unload symbolic point to manually order the AGV to load/unload a resource on that point. If the button is used, when there are not such points nearby. Resource is generated on or discarded from the AGV. Examples are presented in figure <em>Resource Loaded</em> and figure <em>Start Unload Button</em>.</p>
<p><img src="./Images/webClient/image27.png" alt="" /></p>
<blockquote>
<p>Figure : Resource Loaded</p>
</blockquote>
<p>Pressing the <strong>START LOAD</strong> button loads the resource on the AGV from the point 55.</p>
<p><img src="./Images/webClient/image28.png" alt="" /></p>
<blockquote>
<p>Figure : Start Unload Button</p>
</blockquote>
<p>Pressing the <strong>START UNLOAD</strong> button will unload the resource that was previously loaded onto the AGV at the location 55.</p>
<h4 id="goto-position"><a class="header" href="#goto-position">GOTO POSITION</a></h4>
<p>Pressing the <strong>GOTO POSITION</strong> button can be used to manually give a drive order to an AGV to move it to an arbitrary point. It prompts user to enter the destination. This can be done by clicking on the map or typing the symbolic point name into the text field (figure <em>GOTO Position example</em>).Once the destination is selected, pressing the <strong>GO TO SELECTED POSITION</strong> button starts the drive.</p>
<p><img src="./Images/webClient/image29.png" alt="" /></p>
<blockquote>
<p>Figure : GOTO Position example</p>
</blockquote>
<p>AGV driving to its destination point 55 can be seen in the figure <em>GOTO Position example</em>.
The path chosen by the AGV to drive to its destination location is highlighted in green (current drive segments) and blue (whole path).</p>
<p><img src="./Images/webClient/image30.png" alt="" /></p>
<blockquote>
<p>Figure : AGV Driving to Destination</p>
</blockquote>
<h4 id="initializing-position"><a class="header" href="#initializing-position">Initializing Position</a></h4>
<p>The position of AGV can be initialized using the <strong>SET POSITION</strong> button.
The scanner measurements are rendered in green (figure <em>AGV Driving to Destination</em>) and the AGV should be positioned in such manner that those measurements match the environment.</p>
<p>Position initialization can be done by:</p>
<ul>
<li>manually dragging the AGV to the right position;</li>
<li>selecting a symbolic point that has position initialization enabled;</li>
<li>clicking anywhere on the map.</li>
</ul>
<p>Use rotation handle to adjust the heading of AGV.</p>
<p><img src="./Images/webClient/image31.png" alt="" /></p>
<blockquote>
<p>Figure : Initializing AGV Position</p>
</blockquote>
<h4 id="disabling-and-enabling-machines"><a class="header" href="#disabling-and-enabling-machines">Disabling and Enabling Machines</a></h4>
<p>If a certain AGV is not in use, it can be removed from the production map by disabling it.<br />
An AGV can be disabled using <strong>DISABLE</strong> button. It opens a small window that asks the user to confirm disabling the machine as seen in the figure <em>AGV Driving to Destination</em>.</p>
<p><img src="./Images/webClient/image32.png" alt="" /></p>
<blockquote>
<p>Figure : Disabling AGV</p>
</blockquote>
<p>Pressing the <strong>CONFIRM</strong> button removes the AGV from the map.</p>
<p>The AGV can be enabled again from the Fleet page's <strong>Disabled machines</strong> section.<br />
Hovering the AGV on the disabled machine makes the <strong>ENABLE MACHINE</strong> button visible.<br />
The button will enable the AGV once again.<br />
Pressing the enable machine button will enable the machine back in the production map.</p>
<h4 id="return-to-route-1"><a class="header" href="#return-to-route-1">Return to Route</a></h4>
<p>Return to route feature can be used when an AGV is a bit off the route.
It generates a path back to the nearest route so it can resume production.<br />
This can be done by pressing the <strong>RETURN TO ROUTE</strong> button.</p>
<h4 id="machines-zones"><a class="header" href="#machines-zones">Machines Zones</a></h4>
<p>The map contains a layer that allows the user to see the machine zones and their names.<br />
In the example below we can see a fire alarm zone.</p>
<p><img src="./Images/webClient/mapWithZones_eng_v2.png" alt="" /></p>
<blockquote>
<p>Figure : Map with zones</p>
</blockquote>
<p>Zones can be hidden by opening map settings and switching the zone off.</p>
<p><img src="./Images/webClient/mapSettings_eng_v2.png" alt="" /></p>
<blockquote>
<p>Figure : Map settings</p>
</blockquote>
<h4 id="waypoints"><a class="header" href="#waypoints">Waypoints</a></h4>
<p>The map contains a layer that allows the user to see waypoints and their state. Map displays by default forbidden waypoints only.</p>
<p>To show all waypoints, open map settings and enable &quot;Show all waypoints&quot; switch. If the switch button is not visible, user does not have enough rights to view all waypoints.</p>
<p><img src="./Images/webClient/waypoints1.png" alt="" />
&gt;Figure: Map settings and &quot;Show all waypoints&quot; switch</p>
<p>Waypoint can be set free or forbidden.</p>
<p>To change the waypoint state select a waypoint by clicking it and in the opened waypoint control window press button <strong>SET FREE</strong> or <strong>SET FORBIDDEN</strong>. If a button is not visible, user does not have enough rights to change the state of waypoints.</p>
<p><img src="./Images/webClient/waypoints2.png" alt="" />
&gt;Figure: Waypoint control window and selected waypoint status</p>
<h3 id="fleet-page"><a class="header" href="#fleet-page">Fleet page</a></h3>
<p>The <strong>AGV fleet</strong> page can be accessed by selecting the <strong>Fleet</strong>.<br />
As seen in the figure &quot;Fleet page&quot; the page displays information regarding all the AGVs present in the fleet.
From here it is possible to take the whole group of enabled AGVs into production and to stop the production, by using <strong>START PRODUCTION</strong> and <strong>STOP PRODUCTION</strong> buttons.
The view contains basic information of each vehicle such as the name, its type, the task it is carrying out and its current state.<br />
Clicking the name of an AGV takes the user to Map page and shows the selected machine.</p>
<p>Additionally, the <strong>disabled machines can be enabled here</strong> -&gt; Hovering a mouse over a disabled machine row reveals an &quot;Enable machine&quot;-button.</p>
<p><img src="./Images/webClient/fleet-view-en.png" alt="" /></p>
<blockquote>
<p>Figure : Fleet page</p>
</blockquote>
<h3 id="locations"><a class="header" href="#locations">Locations</a></h3>
<p><strong>The Locations / Production locations</strong> page (figure <em>Production locations</em>), displays a table of all production locations present in the current production environment. The table can be sorted and filtered for easier access.
Additionally, the name of a point can be clicked to view it on the map page.</p>
<p><img src="./Images/webClient/image8a.png" alt="" /></p>
<blockquote>
<p>Figure : Production locations</p>
</blockquote>
<h3 id="orders"><a class="header" href="#orders">Orders</a></h3>
<p><strong>Orders / Production Orders</strong> page , displays a list of production orders in the system. Orders are divided into two tables: database orders and transfer requests in one table, and pickup requests for resources in other table. Following figure shows the information present in tables.</p>
<p>Additionally, there is two more options that allows an user to make new production orders and a new transfer requests. Making these orders is explained further in the next chapter.</p>
<p><img src="./Images/webClient/image9a.png" alt="" /></p>
<blockquote>
<p>Figure : Production orders page</p>
</blockquote>
<h4 id="creating-and-editing-orders-and-request"><a class="header" href="#creating-and-editing-orders-and-request">Creating and editing orders and request</a></h4>
<p><strong>Production orders</strong> and <strong>transfer requests</strong> can be created and edited in &quot;Production Orders&quot; page. However, <strong>unhandled orders</strong> can only be created from the &quot;Map&quot; page.</p>
<p>The orders of any type can be deleted by selecting the <strong>Edit</strong> button and then pressing <strong>DELETE</strong> button.</p>
<h4 id="production-orders"><a class="header" href="#production-orders">Production Orders</a></h4>
<p>To make a new production order, navigate to the production orders interface. At the production orders pressing the blue button titled as <strong>NEW PROD. ORDER</strong> opens the production order creation window.</p>
<p><img src="./Images/webClient/image13.png" alt="" /></p>
<blockquote>
<p>Figure : Production orders view with the &quot;New Production Order&quot; button highlighted</p>
</blockquote>
<p><img src="./Images/webClient/image14.png" alt="" />
<img src="./Images/webClient/image15.png" alt="" /></p>
<blockquote>
<p>Figure : Creation form for production orders - Unfilled on the left and a filled one on the right.</p>
</blockquote>
<p>The 'Source' is the symbolic point containing a resource. Selecting the source from a drop-down list will allow the user to see which resource(s) are currently on that symbolic point. In figure <em>Production Order Status</em> the resource is named 'Pallet'. If the 'Source' location does not have any resource currently, it is not possible to create a production order from this location.</p>
<p>In addition to the 'Source' location and the resouce to be picked up, user can select the end destination of the order called as 'Target', using a drop-down list.
The drop-down list shows all valid destinations that can be either single symbolic points or symbolic point groups. The name also indicates if the symbolic point belongs to a group.
The screenshot below shows an example of the different type of targets.</p>
<p><img src="./Images/webClient/allowedOrderTargets.png" alt="" /></p>
<blockquote>
<p>Figure : Drop-down list shows all allowed destinations</p>
</blockquote>
<p>Explanation of the example destinations:</p>
<ul>
<li>From Warehouse (402)
<ul>
<li>Symbolic point with name <em>From Warehouse</em> and ID 402</li>
</ul>
</li>
<li>Packaging
<ul>
<li>Symbolic point group with name <em>Packaging</em></li>
</ul>
</li>
<li>Packaging : Packaging 1 (101)
<ul>
<li>Symbolic point with name <em>Packaging 1</em> and ID 101 that belongs to group <em>Packaging</em></li>
</ul>
</li>
<li>Packaging : Packaging 2 (102)
<ul>
<li>Symbolic point with name <em>Packaging 2</em> and ID 102 that belongs to group <em>Packaging</em></li>
</ul>
</li>
</ul>
<p>Finally the user can select the 'Machine' that should execute the order. Production order always requires selecting a machine, if you want to let the fleet control decide the best machine instead, create instead a 'Transfer Request'.</p>
<p><strong>Note</strong>: If a symbolic point group is selected as a target instead of a single symbolic point, a <em>Transfer Request</em> is created instead of a <em>Production Order</em> to handle symbolic point group correctly. If machine targets a group, the fleet control will decide which symbolic point to target within the group following rules explained in document <em>Symbolic Point Groups</em>.</p>
<p>Once the <strong>SAVE</strong> button is pressed the production order will be created. If the order was successfully created, the Web Client will display the information as shown below and the new order can be seen in the list of orders.</p>
<p><img src="./Images/webClient/orderCreationSuccess.png" alt="" /></p>
<blockquote>
<p>Figure : Order was created successfully</p>
</blockquote>
<p>Whenever the selected machine is available, the execution of the production order will begin.
The resource 'Pallet' is going to be moved from source (141) to target (20). The status of the production order changes to 'Executing' and the assigned machine is 'AGV6' as shown below.</p>
<p><img src="./Images/webClient/image16.png" alt="" /></p>
<blockquote>
<p>Figure : Production Order Status</p>
</blockquote>
<p>If creating of the order fails, the Web Client displays this and gives a short description what went wrong.</p>
<p><img src="./Images/webClient/orderCreationFail.png" alt="" /></p>
<blockquote>
<p>Figure : Creating the order failed</p>
</blockquote>
<h4 id="replacing-existing-resource-at-the-source"><a class="header" href="#replacing-existing-resource-at-the-source">Replacing existing resource at the 'Source'</a></h4>
<p>It is possible to allow replacing the resource type at the 'Source' location by modifying <em>json_storage.json</em> file.
<code>AllowReplacingCurrentLoadAtPickup</code> key should be added under <code>OrdersView</code> and the value set to true as shown below:</p>
<pre><code>{
  ...
    &quot;OrdersView&quot;: {
      &quot;Active&quot;: true,
      &quot;AllowReplacingCurrentLoadAtPickup&quot;: true
    },
   ...
}
</code></pre>
<p>When this setting is enabled, the dropdown list displaying all resource(s) on the 'Source' symbolic point displays instead all allowed resource types for this symbolic point as a dropdown menu regardless of what the current resource is at the symbolic point. If the order is sent with a resource type that is different than the current resource type, Server will replace the resource with a new resource that has the correct type and the selected AGV can normally execute the order.</p>
<p>Even if this setting is enabled, it is not possible to create a production order from 'Source' location that does not currently have any resource.</p>
<h4 id="transfer-requests-1"><a class="header" href="#transfer-requests-1">Transfer requests</a></h4>
<p>A transfer request can be created by pressing the blue button titled as
<strong>NEW TRANSFER REQ.</strong>. Pressing the button opens a form presented in
picture. The form prompts the user to enter the 'Source' known as the
place where the resource is located. After selecting the source, the
resource type gets visible. Then the user can enter the 'Target' where
the intended resource needs to be transferred, once the target is
selected the request can be saved.</p>
<p><img src="./Images/webClient/image17.png" alt="" /></p>
<blockquote>
<p>Figure : Transfer Request creation form</p>
</blockquote>
<p>The transfer requests always have 'Order Status' as 'Transfer request'
(figure <em>Transfer Request Status</em>). and the transfer request is assigned to whichever machine
is available at that moment.</p>
<p><img src="./Images/webClient/image18.png" alt="" /></p>
<blockquote>
<p>Figure : Transfer Request Status</p>
</blockquote>
<p>The resource 'Half pallet' is moved from location of 77 to 107</p>
<h3 id="resources"><a class="header" href="#resources">Resources</a></h3>
<p><strong>Resources page</strong> presents a table of all resources
currently in the production and their current holders. Note that current
holder can be viewed on Map-page by clicking the name of the holder. The
list represents information about resources such as their ID, quantity,
type and their current location. Furthermore, resources can be sorted
based on their types.</p>
<p><img src="./Images/webClient/image10a.png" alt="" /></p>
<blockquote>
<p>Figure : Resources page</p>
</blockquote>
<h3 id="alarms-1"><a class="header" href="#alarms-1">Alarms</a></h3>
<p><strong>Alarms</strong> option on the page selection opens the <strong>'Alarms'</strong> interface (figure <em>Alarms page</em>) that presents a list of all errors and warnings that are currently active. These errors and warnings can be sorted based on error level, source, origin, time of occurrence or description.</p>
<p><img src="./Images/webClient/webClientAlarms.png" alt="" /></p>
<blockquote>
<p>Figure : Alarms page</p>
</blockquote>
<p><strong>Alarms</strong> page has also filters to show only errors and warnings that have selected error level or are related only to a selected machine. There is also an option to filter alarms based on a text search.</p>
<p>It is possible to optionally hide or display fields Date occurred, Time occurred and Duration from parameters on the server side using <em>json_storage.json</em> file. Add <code>VisibleAlarmsTableFields</code> key inside <code>AlarmsView</code> key in the following format:</p>
<pre><code>{
  ...
    &quot;AlarmsView&quot;: {
      &quot;VisibleAlarmsTableFields&quot;: {
        &quot;Date&quot;: true,
        &quot;Time&quot;: true,
        &quot;Duration&quot;: true
     },
    &quot;Active&quot;: true
  },
   ...
}
</code></pre>
<h3 id="events"><a class="header" href="#events">Events</a></h3>
<p>On <strong>Events</strong> interface (figure <em>Events page</em>) consists of list of events that have
occurred during the production. The events are listed with respect to
their occurrence with time stamp mentioned for each event.</p>
<p><img src="./Images/webClient/image12.png" alt="" /></p>
<blockquote>
<p>Figure : Events page</p>
</blockquote>
<h3 id="statistics"><a class="header" href="#statistics">Statistics</a></h3>
<p><strong>Statistics</strong> view contains the production statistics. <strong>Statistics_UseStatisticsDatabase</strong> server parameter is required to set true for the Statistics view to be visible. View shows statistical information from the system performance. This information is gathered as AGVs connected to the fleet control operate.</p>
<p>Order statistics data can be filtered by a given date and timeframe, by machines, by order source and target locations.</p>
<p>Statistics view includes following charts:</p>
<p><img src="./Images/webClient/statistics/Orders.png" alt="" /></p>
<blockquote>
<p>Figure : Production order executions and average times</p>
</blockquote>
<p><img src="./Images/webClient/statistics/OrderList.png" alt="" /></p>
<blockquote>
<p>Figure : Executed orders in a list</p>
</blockquote>
<p><img src="./Images/webClient/statistics/AGVStates.png" alt="" /></p>
<blockquote>
<p>Figure : Time distribution of machine states</p>
</blockquote>
<p><img src="./Images/webClient/statistics/AGVErrors.png" alt="" /></p>
<blockquote>
<p>Figure : Machine error counts</p>
</blockquote>
<p><img src="./Images/webClient/statistics/Availability.png" alt="" /></p>
<blockquote>
<p>Figure : Time distribution of AGV being in the error state compared to orders execution time</p>
</blockquote>
<h4 id="agv-availability-statistics"><a class="header" href="#agv-availability-statistics">AGV availability statistics</a></h4>
<p>AGV availability statistics chart shows the percentage of time AGVs spend in the error state during orders execution.</p>
<p>Standard statistics filters are applied to database records used for availability calculation, such as filter by time frame, AGV, source and target locations. In addition, availability can be adjusted to include/exclude certain alarms and time AGVs wait before order execution.</p>
<h5 id="configuring-availability-calculation"><a class="header" href="#configuring-availability-calculation">Configuring availability calculation</a></h5>
<p>Availability calculation parameters can be preconfigured on the server side using <em>json_storage.json</em> file. Add <code>StatisticsView</code> key to the file in the following format:</p>
<pre><code>{
  ...
	  &quot;StatisticsView&quot;: {
    	&quot;ShowAvailabilitySettings&quot;: true,
	  &quot;IncludeWaitingTime&quot;: false,
	  &quot;AlarmsExcludedFromAvailabilityCalculation&quot;: [1, 2, 3],
	  &quot;MinimumAlarmDurationSec&quot;: 2,
	  &quot;HighlightInGreenThreshold&quot;: 98,
    },
   ...
}
</code></pre>
<div class="table-wrapper"><table><thead><tr><th>Parameter</th><th>Type</th><th>Purpose</th></tr></thead><tbody>
<tr><td>ShowAvailabilitySettings</td><td>boolean</td><td>Show or hide Availability parameters section on the AGV availability page. If hidden, users will not be able to include or exclude waiting for execution time and alarms from the calculation</td></tr>
<tr><td>IncludeWaitingTime</td><td>boolean</td><td>Include or exclude time AGVs wait before order execution from the total orders execution time calculation</td></tr>
<tr><td>AlarmsExcludedFromAvailabilityCalculation</td><td>array</td><td>IDs of alarms to exclude from the total alarms active time calculation</td></tr>
<tr><td>MinimumAlarmDurationSec</td><td>integer</td><td>The minimum time in seconds an alarm has to be active to include it in it the total alarms active time calculation</td></tr>
<tr><td>HighlightInGreenThreshold</td><td>integer</td><td>Threshold to highlight availability percentage in green color</td></tr>
</tbody></table>
</div>
<h3 id="map-statistics"><a class="header" href="#map-statistics">Map statistics</a></h3>
<p>When statistics is enabled, it is also possible to view statistics data associated with AGV positions. Currently available information includes:</p>
<ul>
<li>AGV position confidence heatmap</li>
<li>AGV wi-fi signal strength heatmap</li>
<li>AGV alarms and positions where alarms occurred</li>
</ul>
<h4 id="heatmaps"><a class="header" href="#heatmaps">Heatmaps</a></h4>
<p>Heatmap data is combined for all AGVs and is rewritten whenever another AGV moves over the same position for which the information is displayed.
To display a heatmap, open Map view, go to Map settings and select a heatmap from the list.</p>
<p><img src="./Images/webClient/statistics_heatmap.png" alt="" /></p>
<blockquote>
<p>Figure : Position confidence heatmap example</p>
</blockquote>
<h4 id="agv-alarms"><a class="header" href="#agv-alarms">AGV alarms</a></h4>
<p>AGV alarms which are stored in the statistics database can be viewed on the map.
To display AGV alarms on the map, open Map view, go to Map settings and enable &quot;Show statistics&quot; switch.</p>
<p>AGV alarms map statistics data can be filtered by a given date and timeframe, by machines, by alarm description text.</p>
<p><img src="./Images/webClient/statistics_alarms.png" alt="" /></p>
<blockquote>
<p>Figure : AGV alarms displayed on the map</p>
</blockquote>
<h3 id="handheld-interface"><a class="header" href="#handheld-interface">Handheld Interface</a></h3>
<p>On the handheld interface page have a list of the <strong>Location Groups</strong> present on the current production area.</p>
<p>For more information on the Handheld Interface refer to the <em>Web Client Handheld Interface</em> document.</p>
<p><img src="./Images/webClient/locationGroups_eng_v2.png" alt="" /></p>
<blockquote>
<p>Figure : Handheld interface page</p>
</blockquote>
<h2 id="web-client-requirements"><a class="header" href="#web-client-requirements">Web Client Requirements</a></h2>
<p>The Navithor Web Client has the need for a 'recent' web browser as it uses some of the latest web technologies.</p>
<p>Requirements for the use of the Navithor Web Client:</p>
<ul>
<li>
<p>Supported Operating Systems:</p>
<ul>
<li>Linux</li>
<li>Windows 7, 8, 10</li>
<li>Mac OS 10.15 +</li>
<li>Android 8 +</li>
</ul>
</li>
<li>
<p>Supported Browsers:</p>
<ul>
<li>Google Chrome 80 +</li>
<li>Firefox 68 +</li>
<li>Microsoft Edge 90 +</li>
</ul>
</li>
<li>
<p>Minimum Hardware Requirements:</p>
<ul>
<li>2 Gig of RAM
<ul>
<li>Bigger production area will require more available RAM</li>
</ul>
</li>
<li>1.2 Ghz dual core CPU</li>
</ul>
</li>
</ul>
<p>Older operating systems like Windows CE, Windows Embedded CE 6.0, Windows Embedded Compact 7 are not supported.</p>
<p>No version of Internet Explorer is supported.</p>
<h2 id="web-client-login-timeout-settings"><a class="header" href="#web-client-login-timeout-settings">Web Client Login timeout settings</a></h2>
<p>For the use cases where operators have the need to use the Web Client for long periods of time we can change the login timeout in order to allow the  instances to remain active for longer without the need for re-logging in.</p>
<p>To access the setting we go to the &quot;Settings&quot; menu and then to the &quot;Server Settings&quot; tab.</p>
<p><img src="./Images/webClient/timeOutSettingsMenu_eng_v1.png" alt="" /></p>
<blockquote>
<p>Figure : Configuration menu</p>
</blockquote>
<p>The value is in hours and it can be set between minimum 1 hour to maximum 87000 hours.</p>
<p><img src="./Images/webClient/timeOutSettingsWindow_eng_v1.png" alt="" /></p>
<blockquote>
<p>Figure : Timeout setting in menu</p>
</blockquote>
<p>After saving the value the Navithor Server needs to be restarted for the setting to applied.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="best-practices-for-creating-production-area"><a class="header" href="#best-practices-for-creating-production-area">Best Practices for Creating Production Area</a></h1>
<p>This document contains information on best practices for creating production area in Navithor.</p>
<p>Updated 09.04.2021</p>
<h2 id="version-history-12"><a class="header" href="#version-history-12">Version History</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Version</th><th>Date</th><th>Author</th><th>Change</th></tr></thead><tbody>
<tr><td>1.0</td><td>24.08.2020</td><td>Ashhal Tahir</td><td>First version</td></tr>
<tr><td>1.1</td><td>10.12.2020</td><td>Aleksi Ålander</td><td>Document updated</td></tr>
<tr><td>1.2</td><td>08.03.2021</td><td>Elena Sgonova</td><td>Converted to markdown</td></tr>
<tr><td>1.3</td><td>09.04.2021</td><td>Aleksi Ålander</td><td>Small additions</td></tr>
<tr><td>1.4</td><td>11.06.2021</td><td>Aleksi Ålander</td><td>Renamed title</td></tr>
</tbody></table>
</div>
<hr />
<h2 id="glossary"><a class="header" href="#glossary">Glossary</a></h2>
<div class="table-wrapper"><table><thead><tr><th><strong>Term</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>Waypoint</td><td>One traffic area that is scheduled based on driving times and other reservations. Waypoint is called either Node (intersection) or Link (pathway connecting two intersections)</td></tr>
<tr><td>Segment</td><td>One part of driving route. Created automatically by Tools from route network. Directional: Segment IDs that are even numbered are for forward driving and odd numbers are for reversing</td></tr>
<tr><td>Overlapping reservation</td><td>Driving route has points that collides with other active driving route or stationary task</td></tr>
<tr><td>Blocking reservation</td><td>AGV that ends it driving task or is performing a stationary task in a location that is on the path of another AGV</td></tr>
</tbody></table>
</div>
<h2 id="introduction-6"><a class="header" href="#introduction-6">Introduction</a></h2>
<p>The purpose of this document is to provide instructions and practices for creating production area that will allow the AGVs to have minimum number of deadlocks as possible and have a good production flow.</p>
<p>The document starts by describing basic functions and terms used by the Scheduler.
In addition to this, scheduler settings and parameters that affect the scheduling of the AGVs are explained.</p>
<p>The second part of the document covers guidelines for defining routes that would provide the best flow of traffic.
This includes starting from the basics of defining route segments, lane directions and orientations, route properties and correct use of different types of symbolic points (SPs), one-machine-zones and segment splitting.</p>
<p>All this will depend on the type of production logic being used. The last chapter of the document covers topics that should be considered, when planning the layout for the production to make sure the production flow would be as smooth as possible. This should be done always in advance before the integration of the project.</p>
<h2 id="navithor-scheduler"><a class="header" href="#navithor-scheduler">Navithor Scheduler</a></h2>
<h3 id="scheduler-description"><a class="header" href="#scheduler-description">Scheduler description</a></h3>
<p>Part of the best scheduling practices is to understand the Navithor scheduler and set the correct settings
for a production. Navithor scheduler is used to create timetables for each drive task. It manages:</p>
<ul>
<li>Entry and exit times to waypoints;</li>
<li>Entering order - linking to other drive tasks that need same Waypoint or overlapping Waypoint(s).</li>
</ul>
<p>Navithor scheduler takes in different inputs and provides corresponding outputs. The inputs and outputs to Navithor scheduler are described below:</p>
<ul>
<li>Input:
<ul>
<li>Drive route containing one or many driving segments;</li>
<li>Other tasks: drive - or stationary tasks.</li>
</ul>
</li>
<li>Output:
<ul>
<li>Scheduled drive task that is allowed to be driven;</li>
<li>Partially scheduled drive task that is allowed to be started but may not be finished due to blockings;</li>
<li>Re-routed drive task:
<ul>
<li>Constant failure of scheduling increases AGV's Deadlock-state;</li>
<li>Alternative routes may be generated and scheduled;</li>
<li>Yielding path may be added to a drive task to give way to other reservations.</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="waypoint-reservations"><a class="header" href="#waypoint-reservations">Waypoint Reservations</a></h3>
<ul>
<li>Scheduler performs scheduling of all tasks dynamically when traffic situations change or AGV is not driving according to schedule;</li>
<li>Scheduler performs scheduling for each route waypoint marking them as scheduled when succeeding. ONLY scheduled waypoints can be driven by AGV;</li>
<li>Navithor Tools creates Waypoints automatically based on AGV dimensions and route lane configurations.</li>
</ul>
<p><img src="./Images/bestProductionPractices/waypointReservations1.png" alt="" /></p>
<blockquote>
<p>AGV dimensions and overlaps highlighted</p>
</blockquote>
<p>Other AGVs may use the red-marked areas at the same time if parameter <strong>Node_RESERVERS_MAXIMUM_COUNT</strong> is more than 1 AND</p>
<ul>
<li>AGVs use the same route through the area and it does not contain direction changes OR</li>
<li>AGVs drive route does not contain drive segments that would overlap with other AGVs current drive segments</li>
</ul>
<p>Otherwise the reservations cannot be timewise overlapping. Parameter <strong>Scheduler_DELTA_T</strong> is inserted between all reservations that cannot be scheduled to occupy the waypoint at the same time.</p>
<p><img src="./Images/bestProductionPractices/waypointReservations2.png" alt="" /></p>
<blockquote>
<p>Drive segment highlighted</p>
</blockquote>
<ul>
<li>Waypoint type (Node or Link) affect how it is being compared to other reservations.
Link has only two other Waypoints that have overlapping segments with its segments (the Nodes that connect to each end of the link).
For this reason the scheduling of Link is simpler than scheduling of Node;</li>
<li>Route layout design is the key for good traffic flow:
<ul>
<li>Minimizing route overlaps (red-marked areas in previous slide)
<ul>
<li>In dense route networks minimizing overlaps is more important than minimizing driving distances between stations.
I.e. route with less overlap is usually faster than shorter route but with high likelihood for traffic and thus waiting;</li>
</ul>
</li>
<li>Favouring one-way traffic;</li>
<li>Reservation for one-way Waypoint can be done even if full scheduling fails. One-way Links can be used as waiting queues.</li>
</ul>
</li>
</ul>
<p><img src="./Images/bestProductionPractices/waypointReservations3.png" alt="" /></p>
<p>Nodes are marked with bold green path and Links are paths that look as original network. Cutting marks are showing the points where segments will start and end and also where Waypoints change.</p>
<h3 id="parameters-affecting-waypoint-scheduling"><a class="header" href="#parameters-affecting-waypoint-scheduling">Parameters affecting Waypoint scheduling</a></h3>
<ul>
<li>
<p><strong>Scheduler_LEAVE_WAYPOINTS_AHEAD_FREE_COUNT</strong> - affects how far in route AGVs are allowed to be scheduled in case full scheduling is not possible. Other scheduling rules may apply to the last valid Waypoint that is allowed to be marked as scheduled. A good value for this parameter depends on route network type: dense network with lot of small Nodes should have value &gt;= 2 otherwise &gt;= 1. Also if AGV is tugger-type with simulated trailers then this parameter should also be &gt;=2, in some cases even 4-5.</p>
</li>
<li>
<p><strong>Scheduler_LEAVE_FREE_WAYPOINTS_BETWEEN_CROSSING_TRAFFIC</strong> - Affects how many waypoints needs to be left unscheduled if last successfully scheduled waypoint is Node and it has overlapping route with other tasks. The value for this parameter should be &gt;= 1. For tugger-type AGVs the value should be &gt;= 2.</p>
</li>
<li>
<p><strong>Scheduler_TRIGGER_WP_FREE_DIST_TO_EXIT</strong> - Affects the moment when AGV releases waypoint reservation when it is driving from one waypoint to another. Larger parameter values allow other AGVs to enter the Waypoint sooner. Default is 1 meter.</p>
</li>
<li>
<p><strong>Scheduler_DELTA_T</strong> - time that is added between all reservations for the same or overlapping waypoint when common reservation is not possible. Default is 1 second.</p>
</li>
<li>
<p><strong>Scheduler_SAFE_SIDE_DISTANCE_BOUND</strong> - Used for possible crossing reservation check. A rough minimum distance between two AGVs that is used for checking if AGVs are on each others way. Default value is 1.2 meters but normally this is reduced to 0.3-0.5.</p>
</li>
<li>
<p><strong>Scheduler_NODE_RESERVERS_MAX_COUNT</strong> - Affects how many AGVs are allowed to reserve one Node at the same time. Default is 1 but normally 2 is set. More than 2 does not have much affect as Nodes tend to be so small that it is physically not possible for more than 2 AGVs occupy one Node at the same time.</p>
</li>
<li>
<p><strong>Scheduler_ALLOW_WP_MULTI_LOCK_TIME_LIMIT_SECS</strong> - Affect the possibility for multiple AGVs reserving same Waypoint or overlapping Waypoints. Scheduled entry times needs to be within this limit. Default value is 10 seconds but it can be increased to e.g. 20 seconds.</p>
</li>
<li>
<p><strong>Scheduler_BLOCKED_MIN_WAIT_TIME_MINUTES</strong> - Time that is added to a blocking reservations end time and other blocking situations when times cannot be calculated due to unknown outcome. Default value is 48 seconds but this can be reduced to e.g. 30 or even 20 seconds if production flow is fast in each station.</p>
</li>
<li>
<p><strong>Scheduler_DEADLOCK_WAIT_TIME_MINUTES</strong> - This parameter is used for triggering a deadlock-alert that will also increase Deadlock-state of an AGV. Default value is 1 minute and 30 seconds but this can be reduced to e.g. 30-40 seconds for faster deadlock handling.</p>
</li>
<li>
<p><strong>Scheduler_DRIVE_TASK_SCHEDULING_MODE</strong> - This is explained further in scheduling rules section.</p>
</li>
</ul>
<h3 id="scheduling-rules"><a class="header" href="#scheduling-rules">Scheduling Rules</a></h3>
<p>1.  Parameter <strong>Scheduler_DRIVE_TASK_SCHEDULING_MODE</strong> has rules for scheduling. Following rules can be enabled or disabled:</p>
<ul>
<li>none = 0;</li>
<li>yieldingEna = 1 &lt;&lt; 0;</li>
<li>stopOnLinksOnly = 1 &lt;&lt; 1;</li>
<li>schedToNonOverlapping = 1 &lt;&lt; 2;</li>
<li>reqStopPointsForSchedEndRwp = 1 &lt;&lt; 3;</li>
<li>acceptPartialSchedulingAlways = 1 &lt;&lt; 4; <em>// When not fully scheduled, ignore checks about overlapping tasks. This makes sense only when route network is oneway</em></li>
<li>cutDriveToNextNoStop = 1 &lt;&lt; 5;</li>
<li>cutDriveToNextNoStopAlways = 1 &lt;&lt; 6;</li>
<li>cutDriveToWaitUnloadOnPath = 1 &lt;&lt; 7;</li>
</ul>
<p>The parameter is currently presented as an integer. Default value is 1. Following rules can be enabled or disabled:</p>
<ul>
<li><strong>cutDriveToNextNoStop</strong>-rule is usually advised and also <strong>schedToNonOverlapping</strong>-rule is useful if route network is not too dense.</li>
</ul>
<p>For example, if parameter value is set to 37 then these rules are enabled: <strong>yieldingEna</strong>, <strong>schedToNonOverlapping</strong> and <strong>cutDriveToNextNoStop</strong>. This is because 37 == 0010 0101. Windows Calculator has build-in programmer mode for converting values between number formats.</p>
<ul>
<li><strong>Yielding enable/disable - yieldingEna</strong></li>
</ul>
<p>Yielding is used in scheduling situations when two AGVs cannot fulfil priority rules for using common routes. Lower priority AGV may be ordered to yield another AGV in cases when both AGVs are on path of each other or if lower AGVs current position and destination point blocks higher AGV from reaching its target point.</p>
<p>Yielding means AGVs route is tried to be manipulated so that it will drive away from current drive path so that it will not be in way of the AGV that requires free path to target. Once AGV reaches created yielding point it will wait until higher priority AGV has passed location where yielding AGV left its original route.</p>
<p>2.  Parameter <strong>Scheduler_YIELD_DISTANCE_SECONDS</strong> affects how far is yielding point created after leaving original route. A route back to original path is required to be available for successful yield. If yielding route cannot be calculated, then scheduling needs to define the situation either as blocking or favor lower priority AGV. Disabling this rule affects scheduling results. Some situations may favor lower priority AGVs but in cases when both AGVs block each other the scheduling will fail. Failure for scheduling leads eventually re-planning of route and finally to drive-tasks out of way of others if allowed by parameter <strong>Scheduler_NeverAllowForceMove</strong>.</p>
<p>3.  <strong>Stop on Links Only - stopOnLinksOnly</strong> - If full scheduling of drive task is not possible (e.g. due to common target location with another AGV or stationary AGV on path) this rule is checked when possible stopping location is looked along successfully scheduled path. If this rule is enabled only Link-type traffic areas (Waypoints) are allowed as stopping locations. This rule is disabled by default and is advised to be enabled only in areas with lots of long straight paths without overlapping paths.</p>
<p>4.  <strong>Schedule to Non-Overlapping Waypoint - schedToNonOverlapping.</strong> If full scheduling of drive task fails, this rule allows advancing to a waypoint that has been scheduled and is not overlapping with other reservations. By default, this rule is disabled. Enabling this rule gives more possibilities for advancing drive tasks when full scheduling fails. Enabling is safe in one-way oriented route networks but in bi-directional route networks this rule may cause more blockings.</p>
<p>5.  Require Pre-calculated StoppingPoint for Last successfully Scheduled Waypoint - <strong>reqStopPointnForSchedEndRwp</strong></p>
<ul>
<li>If full scheduling of drive task is not possible this rule will affect which of the scheduled waypoints are allowed to be driven into. If rule is enabled only waypoints that have pre-calculated stopping points (small dots along paths in Client's map when zoomed in close to routes). Stopping points are only possible in routes that do not cross with other routes thus are safe for stopping.</li>
<li>Enabling this rule prevents stopping mostly to intersection areas thus the effect is more or less the same as with <strong>stopOnLinksOnly</strong>. The difference is that some intersection nodes may have pre-calculated stopping points and this rule is then more balanced.</li>
</ul>
<p>6. Accept Partial Scheduling Always - <strong>acceptPartialSchedulingAlways</strong> - If full scheduling of drive task fails, this rule allows driving of all the waypoints that were successfully scheduled. Enabling this rule is not advised but it can work in special route networks with one-way traffic and OneMachineZones defined to prevent driving to a location where AGV will block others needing way out.</p>
<p>7. Cut Drive Task to Next NoStop-Symbolic Point - <strong>cutDriveToNextNoStop</strong></p>
<ul>
<li>
<p>If this rule is enabled Scheduler will check the drive path for next NoStop-Symbolic Point that is further than <strong>Scheduler_LEAVE_WAYPOINTS_AHEAD_FREE_COUNT</strong> waypoints ahead and also not too near current Target location. The drive task is cut to the NoStop-location and rest of the waypoints are cleared from the task. Now the drive task is only scheduled to the NoStop. This will help in many situations when traffic situations in future waypoints are not interesting when the original route is given to Scheduler.</p>
</li>
<li>
<p>When the AGV is executing the drive task to the NoStop-location and final DriveExtension-message is given to reach the NoStop-location the drive task is again dynamically extended to the target location and the task extension will be scheduled.</p>
</li>
<li>
<p>When scheduling again the task it may be possible that the task will be cut again to a next NoStop-location on path. Finally, the AGV has the route to the target location of the production order.</p>
</li>
<li>
<p>Enabling this rule is safe and this has been found very effective in many areas where driving distances are long. This rule gives also more control where AGVs can advance in their drive tasks. Commonly the NoStop-Symbolic Points are set to be in one-way paths where it is safe driving to.</p>
</li>
</ul>
<p>8. <strong>cutDriveToNextNoStopAlways</strong> - Similar to rule above, but the maximum distance to the current NoStop before the drive order can be extended to the next symbolic point can be limited with parameter <strong>MissionManager_DIST_FROM_NOSTOP_TO_EXTEND_IF_DRIVE_CUT_ALWAYS</strong>. If there is any pivot points along the route, the scheduler tries to first finish the pivot before extending the drive to next target to avoid blocking routes earlier than necessary. This rule should be used only if recommended by Navitec and instead use the rule <strong>cutDriveToNextNoStop</strong>.</p>
<p>9. Cut Drive Task to WaitUnload-Symbolic Point on the path - <strong>cutDriveToWaitUnloadOnPath</strong> - Drive order is cut first always to WaitUnload location, if it is along the way. When machine is close to the WaitUnload, the drive order can be extended to the end location.</p>
<p>10. Disabling Scheduler
Disabling scheduler means all tasks are set scheduled from start to end without any checking for overlapping reservation. Disabling is done by setting parameter <strong>Scheduler_DRIVE_TASK_SCHEDULING_MODE</strong> to negative value. When disabled traffic controlling is based on segment overlap checks and OneMachineZone-checks. Disabling scheduler is only advised in route networks with working OneMachineZone-design. Segment overlap check can be disabled with parameter <strong>TrafficControl_SEGMENT_OVERLAP_CHECK_MODE</strong>.</p>
<h3 id="scheduler-driving-rules-and-priorities"><a class="header" href="#scheduler-driving-rules-and-priorities">Scheduler driving rules and priorities</a></h3>
<ul>
<li>All Driving tasks are scheduled FIFO. Automatically generated production orders have common priority unless location priorities are used and thus priority order of all tasks depend on order of the scheduled tasks;</li>
<li>Priority is taken into account when overlapping and/or blocking reservations are being scheduled. Priority affects the entry order to a Waypoint, but priority is ignored in these cases (roughly):
<ul>
<li>Calculated entry times are not overlapping, and reservations are not blocking each other;</li>
<li>One AGV is blocking other or will block with its route.</li>
</ul>
</li>
<li>As all system parameters are global some traffic areas may need One Machine Zones to better traffic management. One Machine Zones have also FIFO entry rules;</li>
<li>If route cannot be fully scheduled due to other AGV blocking, then scheduler is allowed to reroute AGVs to their targets or move them away from the current path.</li>
</ul>
<h3 id="scheduler-rerouting"><a class="header" href="#scheduler-rerouting">Scheduler Rerouting</a></h3>
<ul>
<li>Rerouting is done for drive tasks that are not progressing i.e. AGVs deadlock-state is increasing. Following parameter affect if alternative routes can be used:
<ul>
<li><strong>RoutePlanner_SECONDARY_ROUTES_SELECTION_MAX</strong> - how many alternative routes are calculated by Route Planner. Default is 0 but this can be increased to e.g. 5 if rerouting is needed;</li>
<li><strong>RoutePlanner_MAX_ROUTE_LOOPS_COUNT</strong> - how many times same waypoint with same segments is allowed to be in the route. Default is 0. Increasing to 1 is needed in cases when loops are really needed for deadlock handling;</li>
<li><strong>RoutePlanner_MAX_SECONDARY_ROUTE_DISTANCE_DIFF</strong> - how much in difference the new route can be compared to the original. Default is 1.5 but this can be increased to e.g. 5 when secondary routes are used;</li>
<li><strong>RoutePlanner_MAX_SECONDARY_ROUTE_ADDITIONAL_DISTANCE_METERS</strong> - how much longer in meters the secondary route is allowed to be compared to the original. Default is 100 meters but this can be increased to what ever is sensible in the production area;</li>
</ul>
</li>
<li>If AGVs deadlock-state goes over parameter <strong>Scheduler_MachineDeadlockStateLimit</strong> then AGV is tried to be moved to a location that is not on path of others. Parameter <strong>Scheduler_NeverAllowForceMove</strong> can be set to true is this action is not desired.</li>
</ul>
<h3 id="scheduler-giving-penalty-to-routes"><a class="header" href="#scheduler-giving-penalty-to-routes">Scheduler Giving Penalty to Routes</a></h3>
<ul>
<li>Fastest route is calculated based on the route lengths and defined route speeds;</li>
<li>There are several different parameters to give penalty for the estimated driving time. Positive value means penalty is added to the driving time, negative values means the rule makes the driving time estimate lower (route planner favors routes with this rule);</li>
<li>Penalties for driving through certain symbolic points:
<ul>
<li><strong>RoutePlanner_STOP_LOC_PASSING_PENALTY_SEC</strong>;</li>
<li><strong>RoutePlanner_NOSTOP_LOC_PASSING_PENALTY_SEC</strong>;</li>
<li><strong>RoutePlanner_LOAD_LOC_PASSING_PENALTY_SEC</strong>;</li>
<li><strong>RoutePlanner_UNLOAD_LOC_PASSING_PENALTY_SEC</strong>;</li>
<li><strong>RoutePlanner_WAIT_LOC_PASSING_PENALTY_SEC</strong>;</li>
<li><strong>RoutePlanner_CHARGE_LOC_PASSING_PENALTY_SEC</strong>;</li>
</ul>
</li>
<li>Other penalty parameters:</li>
<li><strong>RoutePlanner_SEGMENT_DRIVE_BWD_TIME_PENALTY_SECS</strong> - Affects how much extra time penalty is added to segments that are reversing;</li>
<li><strong>Scheduler_SEGMENT_COST_GAIN</strong> - Cost penalty gain added to route points with high curvature. 1.00 means curves have no penalty compared to straight waypoints, values under 1 means that curves have a penalty;</li>
<li><strong>Waypoint_BLOCKED_PENALTY_SEC</strong> - Penalty added when planning route through blocked waypoint;</li>
<li><strong>RoutePlanner_SEGMENT_DRIVE_BLOCKED_TIME_PENALTY_SECS</strong> - Affects how much time penalty is added to segments that are set forbidden for drive through (e.g. AGV stationary at segment).</li>
</ul>
<h3 id="dynamic-virtual-safety-bounds"><a class="header" href="#dynamic-virtual-safety-bounds">Dynamic Virtual Safety Bounds</a></h3>
<p>Navithor Fleet Control System controls AGVs in a safe way by not allocating routes for AGVs if the routes are overlapping. As an additional safety feature Navithor also calculates dynamic safety- and speed bounds online.</p>
<p>These bounds are used to prevent collisions and are used also to limit speeds when two AGVs are moving very close to each other.</p>
<p>This is a feature that is strictly independent from Navitrol and is available only in Navithor Fleet Control. AGV (Navitrol) does not have the information of the virtual bounds and thus it cannot be used to checked against live laser data.</p>
<p>The feature uses two separate bounds that create polygon around the AGV in Navithor Fleet Control System:</p>
<ul>
<li>Safety bounds;</li>
<li>Speed warning bounds.</li>
</ul>
<p><img src="./Images/bestProductionPractices/safetyBounds1.png" alt="" /></p>
<p>Gray polygon around AGV defines safe bounds that should not be violated by another AGVs safety bounds.</p>
<ul>
<li>Safety bound takes turns in the route into account and expands in the direction of the turns;</li>
<li>Safety bounds grow bigger with higher speeds, depending on the parameters.</li>
</ul>
<p>Violation of safety bounds between two AGVs causes abort-signal to be commanded to the AGVs.</p>
<p>Violation check is done between safety bounds of two AGVs that are near each other.</p>
<p>Navithor Traffic Controller performs cross-checks of safety bound violations during each process cycle (5Hz).</p>
<p><img src="./Images/bestProductionPractices/safetyBounds2.png" alt="" /></p>
<p>Speed warning bounds is the second type of safety bounds</p>
<ul>
<li>Green polygon around AGV defines virtual speed warning bounds.</li>
</ul>
<p>Speed warning zones are checked against the gray safety bounds of other AGVs close by.</p>
<p>Violation of speed bounds causes speed reductions in steps:</p>
<ul>
<li>First reduction is to 50% speed of max speed of current route;</li>
<li>Second reduction is to 25% speed of max speed of current route.</li>
</ul>
<p>Speed warning bounds expand when speed increases, if default calculation mode is used</p>
<ul>
<li>All violations that causes speed reductions also make bounds smaller thus further reductions may be avoided.</li>
</ul>
<p>Parameters that should be enabled to use the dynamic virtual safety zones:</p>
<p><strong>TrafficController_Safetybounds_calculation_mode -&gt; DynamicBounds</strong></p>
<ul>
<li>Defines which algorithm is used for safety speed and speed bound calculations. Dynamic bounds is the recommended mode, as in this mode the bounds increase based on speed, position confidence, frame heading and takes curves into account. Default mode does not work correctly with different frame headings on the routes (omni-AGVs) but for steer-drive and differentially driven AGVs the default-mode works as good as Dynamic Bounds-mode.</li>
</ul>
<p><strong>ServiceInterface_SendSafetyAreaBoundsToClient -&gt; True</strong></p>
<ul>
<li>Parameter to enable/disable sending of safety bounds to Navithor Clients. If Clients are used in WIFI network with poor data transfer rates, then this is one way to limit data from Navithor Server to Clients.</li>
</ul>
<h2 id="guidelines-for-routing"><a class="header" href="#guidelines-for-routing">Guidelines for Routing</a></h2>
<h3 id="one-way-streets-are-easier-to-schedule"><a class="header" href="#one-way-streets-are-easier-to-schedule">One-way streets are easier to schedule</a></h3>
<p>One-way streets are easier to schedule efficiently, because there is no fear of other machines needing to wait for another machine that is driving to the opposite direction.</p>
<p>For example a layout with multiple aisles or grid like route network is more efficient, if as many routes as possible are driven as one-way only.</p>
<p>Exception to this rule is that, two-way street is still better than having two separate one-way streets (that overlap each other) going opposite directions.</p>
<p>This is because the two overlapping routes may create two very long intersection areas that are not managed as well as a single two-way intersection or pathway</p>
<ul>
<li>Bad (two different routes):</li>
</ul>
<p><img src="./Images/bestProductionPractices/routing1.png" alt="" /></p>
<ul>
<li>Good (one route, both lanes allowed):</li>
</ul>
<p><img src="./Images/bestProductionPractices/routing2.png" alt="" /></p>
<h3 id="plan-routes-and-intersection-areas-so-that-there-would-be-as-little-overlaps-as-possible"><a class="header" href="#plan-routes-and-intersection-areas-so-that-there-would-be-as-little-overlaps-as-possible">Plan routes and intersection areas so that there would be as little overlaps as possible</a></h3>
<ul>
<li>Try to minimize the routes marked red when hovering over route that can be tuned;</li>
<li>If pivot point is not really needed then a tight curve is better option:</li>
<li>Positioning on the route is more precise;</li>
<li>Wheels (with omni AGV) do not turn on spot.</li>
<li>With Omni-AGVs utilize possibility to have frame heading different than route heading:</li>
</ul>
<p>AGV Driving along green arrow blocks oncoming traffic (red arrow):</p>
<p><img src="./Images/bestProductionPractices/routing3.png" alt="" /></p>
<p>Using frame heading to turn AGVs frame towards 'North' in the pictures makes lane on left possible for parallel driving:</p>
<p><img src="./Images/bestProductionPractices/routing4.png" alt="" /></p>
<p><img src="./Images/bestProductionPractices/routing5.png" alt="" /></p>
<h3 id="create-as-clean-intersection-areas-as-possible"><a class="header" href="#create-as-clean-intersection-areas-as-possible">Create as clean intersection areas as possible</a></h3>
<ul>
<li>Least amount of intersection route-nodes possible;</li>
<li>Least amount of route links possible;</li>
<li>&quot;Spider-web&quot; intersections:</li>
</ul>
<p>Bad:</p>
<p><img src="./Images/bestProductionPractices/routing6.png" alt="" /></p>
<ul>
<li>Too many route options between different stations -&gt; Unpredictable behavior;</li>
<li>Extra route options do not solve any routing related issues.</li>
</ul>
<p>Good:</p>
<p><img src="./Images/bestProductionPractices/routing7.png" alt="" /></p>
<ul>
<li>All destinations are reachable from every station and always same routes are used -&gt; Predictable behavior</li>
</ul>
<h3 id="using-nostop-symbolic-points-to-cut-drive-tasks"><a class="header" href="#using-nostop-symbolic-points-to-cut-drive-tasks">Using NoStop symbolic points to cut drive tasks</a></h3>
<ul>
<li>Add always to one-way streets;</li>
<li>Should not be placed too near intersections nor on two-way streets.</li>
</ul>
<p>NoStop points can be used to improve scheduling performance over intersections or long routes. NoStop points become active when scheduling rules has the flag <em>cutDriveToNextNoStop</em> (1 &lt;&lt; 5) or <em>cutDriveToNextNoStopAlways</em> (1 &lt;&lt; 6) enabled.</p>
<p>When either of these flags is enabled Navithor will schedule the drive only to the next NoStop location.
This means that other drives happening beyond the NoStop location are not affected by the schedule of the drive cut to a NoStop point.</p>
<p>This often means that especially long drives and traffic in intersection areas become smoother. An example is shown below.</p>
<blockquote>
<p>AGV3 does not need to care about AGV1's drive to the intersection as the drive is cut to the NoStop point 601.</p>
</blockquote>
<p><img src="./Images/bestProductionPractices/routing8.png" alt="" /></p>
<p>NoStop points should be always used only on one-way routes and they should not be placed in intersection areas.</p>
<p>Placing a NoStop point on a two-way route creates certain deadlock situations when two AGV's drive the route against each other but the scheduler does not care about this since the drive is cut to a NoStop location.</p>
<p>An example of a poorly placed NoStopping location is shown below. In this case AGV on the left is trying to drive to the area on the right and AGV on the right is driving to the area on the left.</p>
<p>The only way to drive between these two areas is through the two-way route.
As both drives are cut to a NoStop location in the middle, they will end up in a deadlock in the two-way street.</p>
<p>If there is no NoStop point on the two-way route section, the two AGVs are not allowed to drive on the two-way route section simultaneously.</p>
<p><img src="./Images/bestProductionPractices/routing9.png" alt="" /></p>
<blockquote>
<p>NoStop on two-way route leading to a deadlock</p>
</blockquote>
<p><img src="./Images/bestProductionPractices/routing10.png" alt="" /></p>
<blockquote>
<p>Without a NoStop a two-way route works better</p>
</blockquote>
<p>In intersection areas it is good to check that the NoStop point is set far enough from the intersection so that when an AGV arrives to the NoStop location it is not overlapping with the route points in the intersection.</p>
<p>Checking this is easiest in Tools when hovering on the route sections.</p>
<p>Below the left one has the NoStop point far enough (not covered by the red line) and the right one is too close and will let the AGV drive too close to the intersection without checking overlaps correctly.</p>
<p><img src="./Images/bestProductionPractices/routing11.png" alt="" /></p>
<p>In case there are overlapping sections in long one-way routes that are to be driven in different directions it makes sense to make NoStop locations before the overlapping area.</p>
<p>Without the NoStop points in case there is something delaying the AGV that is supposed to enter the overlapping area first the other AGV will need to wait still until the delayed AGV has driven past the overlapping area.</p>
<p>With the NoStop points set before the overlapping area whichever AGV first reaches the overlapping section will drive over it first.</p>
<p><img src="./Images/bestProductionPractices/routing12.png" alt="" /></p>
<h3 id="one-machine-zones"><a class="header" href="#one-machine-zones">One Machine Zones</a></h3>
<ul>
<li>When they should be used and when to avoid using them?</li>
</ul>
<p>One machine zones can be used to prevent causing deadlocks in some routes that the scheduler may not handle correctly. Whether or not it is required to use one machines zones in certain places depends entirely on the parameters that are set for the scheduler. Below are a few examples of where one machine zones could be used.</p>
<p><img src="./Images/bestProductionPractices/routing13.png" alt="" /></p>
<p>Dead end that is split into multiple intersections. AGV may be allowed to drive into the dead end to block another one without this one machine zone if for example <strong>Scheduler_LEAVE_WAYPOINTS_AHEAD_FREE_COUNT</strong> would be 1 or 2.</p>
<p><img src="./Images/bestProductionPractices/routing14.png" alt="" /></p>
<p>One machine zone is defined to prevent AGV to drive to block the intersection while there is an another AGV waiting inside or just outside of it. AGVs are only allowed to drive inside zone if their path inside the zone is free from collisions. Thus one machine zones can also be used to mark areas that should be left clear of traffic.</p>
<h3 id="splitting-segments"><a class="header" href="#splitting-segments">Splitting segments</a></h3>
<ul>
<li>Enable segment splitting from Tools:</li>
</ul>
<p><img src="./Images/bestProductionPractices/routing15.png" alt="" /></p>
<p>The length of the split segments (in meters) can be configured in the <em>defaultParams.xml</em> file located in the Navithor Tools executables directory:</p>
<p><em>&lt;SegmentSplitParams&gt;</em><br>
<em>&lt;MaxSegmentLength&gt;4&lt;/MaxSegmentLength&gt;</em><br>
<em>&lt;/SegmentSplitParams&gt;</em></p>
<p>Segment splitting makes the calculated segment overlaps more reliable in the sense that with split segments, we don't end up in a situation where a very long segment is overlapping with a segment tens of meters from it, because it is split into smaller parts.
Because of the way the segment overlaps are defined, two segments are considered overlapping if any of their points overlap (the AGV outlines when standing on the respective points overlap), very long segments overlap with all segments at the start and end point of the segment.
This means that if an AGV is driving down a long segment connected by intersections at both ends, both intersections would be considered overlapped until the AGV has reached the end and leaves the long segment.</p>
<p>When the option in the figure above is checked, segments will be automatically split when uploading / exporting the production area.</p>
<ul>
<li>Enable using overlaps from Server parameters:</li>
</ul>
<p><img src="./Images/bestProductionPractices/routing16.png" alt="" /></p>
<p>Set the <strong>TrafficController_UseMachineSegmentOverlap</strong> parameter to true in Settings-&gt;Configuration-&gt;Parameters in Navithor Client. This parameter enables using the calculated segment overlaps in the scheduling.</p>
<p>Navithor can also consider overlaps separately for machines that are carrying a resource and for machines that are empty. This option should be used, if machines are carrying resources that have bigger dimensions than the machine itself. Navithor calculates the overlaps based on the biggest resource dimensions on the system, so smaller resources than the biggest one might have slightly bigger overlaps than necessary.</p>
<ul>
<li>Resource based overlaps:</li>
</ul>
<p><img src="./Images/bestProductionPractices/routing17.png" alt="" /></p>
<h3 id="splitting-waypoints-with-fake-intersections"><a class="header" href="#splitting-waypoints-with-fake-intersections">Splitting waypoints with fake intersections</a></h3>
<p><img src="./Images/bestProductionPractices/routing18.png" alt="" /></p>
<p>If long routes overlap, but do not intersect, like in the figure to the left, the whole route segment will become one waypoint from the intersection to the end of the route.
This means that an AGV that is driving the outgoing segment will also reserve the whole intersection.
In order to avoid this, fake intersections can be drawn to split the long route waypoints.
In the figure to the right, there would be a separate waypoint where the fake intersection splits the route, hence the intersection will not be reserved after that point.</p>
<p>Fake intersections are created by:</p>
<ul>
<li>Creating intersections by drawing short routes that extend from the main route;</li>
<li>Define these routes as Disabled by checking the Disable Lane and clicking on both lanes. The routes should be grey when disabled.</li>
</ul>
<p><img src="./Images/bestProductionPractices/routing19.png" alt="" /></p>
<h2 id="planning-good-flow-for-production"><a class="header" href="#planning-good-flow-for-production">Planning good flow for production</a></h2>
<h3 id="define-production-layout-and-concept-before-integration"><a class="header" href="#define-production-layout-and-concept-before-integration">Define production layout and concept before integration</a></h3>
<ul>
<li>What has to be done and where? I.e. Picking up resources and bringing them somewhere, or is the production logic based on picking list or hold-release reasoning?</li>
<li>Define signals that should be used. What messages in MES cover this?</li>
<li>How the traffic should be handled? Is there any bottlenecks that might cause problems?</li>
<li>Is there any special conditions to consider, like doors or traffic lights that have to be monitored or controlled along the routes?</li>
<li>Where should the machines be waiting, when they have nothing else to do? Where should the chargers be located?</li>
<li>Plan enough waiting and charge locations to support the whole fleet!</li>
<li>Wait-symbolic points should be on one-way streets or dead ends if possible. If on two-way streets or intersections, machine would block others.</li>
</ul>
<h3 id="how-to-use-allowed-destinations"><a class="header" href="#how-to-use-allowed-destinations">How to use allowed destinations</a></h3>
<ul>
<li>Limit driving from wait locations to unwanted destinations;</li>
<li>Resource types can be also used to limit.</li>
</ul>
<p>Parameter: <strong>MissionManager_WAITINGLOC_ALLOWED_DEST_LINK_MODE</strong></p>
<ul>
<li>
<p><strong>Option: LinkToLoadingTarget</strong></p>
<ul>
<li>WaitLoad locations can be linked to allowed Load locations;</li>
<li>If AGV has been assigned to a WaitLoad location and it is waiting for production, it can be assigned and order only from Load locations that are on the Allowed destinations list for the assigned WaitLoad. The normal rules for order to be valid are still checked in addition to this;</li>
<li>The normal rules for order to be valid are still checked in addition to this;</li>
<li>If no Allowed destinations have been defined, the possible Load location are not restricted;</li>
<li>If AGV has not been yet assigned to a Wait location, no restriction is set. Maximum distance to a valid order can be set with If no Allowed destinations have been defined, the possible Load location are not restricted <strong>ProductionManager_MaxDistToAllowLoadingIfNotAtWait</strong> (meters through segments);</li>
<li>A generic parameter to restrict maximum distance from WaitLoad to Load locations: <strong>MissionManager_MAX_WAIT_DIST_FROM_TARGET_BOUND</strong> (meters through segments, default 200).</li>
</ul>
</li>
<li>
<p><strong>Option: LinkToUnloadingTarget</strong></p>
<ul>
<li>WaitUnload locations can be linked to possible Unload locations;</li>
<li>If AGV has active production order into Unload location that is currently reserved or blocked, AGV is allowed to drive instead into WaitUnload that has the target location as allowed destination;</li>
<li>Depending on parameters, assigning production order can be allowed to a target that is currently reserved or blocked, if there is an available and valid WaitUnload location. It can be also defined that this is not allowed;</li>
<li><strong>TrafficControl_WAIT_LOCATION_ALLOWED_DIST_OFFSET</strong> (meters through segments, default 0) defines minimum distance needed between (un)load location and wait location to allow driving to the wait instead of target. Negative values means AGV can drive to wait location that is further away than the target location;</li>
<li>A generic parameter to restrict maximum distance from WaitUnload to Unload locations: <strong>MissionManager_MAX_WAIT_DIST_FROM_TARGET_BOUND</strong> (meters through segments, default 200).</li>
</ul>
</li>
<li>
<p><strong>Option: LinkUnloadToWaitLoad</strong></p>
<ul>
<li>Unload locations can be linked to allowed WaitLoad locations. If previous target of AGV was unload location and it has allowed destinations defined, allow driving only to these wait locations;</li>
<li>If no wait locations available, stays on this symbolic point and waits for production;</li>
<li>If unhandled order becomes available within distance defined by <strong>ProductionManager_MaxDistToAllowLoadingIfNotAtWait</strong> (meters through segments), order can be assigned to the AGV;</li>
<li>If AGV is driven away from symbolic point, allowed destinations don't restrict it anymore and it can select a wait location within distance defined by <strong>ProductionManager_MaxDistToValidLocations</strong> (meters through segments);</li>
<li>If no WaiLoad locations selected in allowed destinations for the unload location, next WaitLoad location is selected with normal rules (can be limited with <strong>ProductionManager_MaxDistToValidLocations</strong> (meters through segments).</li>
</ul>
</li>
<li>
<p><strong>Option: LinkWaitToWait</strong></p>
<ul>
<li>Other wait locations can be linked wait locations.</li>
<li>If change wait is enabled by <strong>MissionManager_ChangeWaitTriggerRules</strong> and the location has allowed destinations, then the allowed destinations define which wait locations are possible from that location.</li>
</ul>
<p><img src="./Images/bestProductionPractices/routing20.png" alt="" /></p>
</li>
</ul>
<p><strong>Summary of allowed destination options:</strong></p>
<ul>
<li>Link Load location to allowed Unload locations;</li>
<li>Link WaitLoad location to allowed Load locations;</li>
<li>Link WaitUnload location to allowed Unload locations;</li>
<li>Link Unload location to allowed WaitLoad locations.</li>
<li>Link Wait locations to any Wait locations</li>
</ul>
<p>Does not work on stop or no-stop locations!</p>
<p>Can't be used to &quot;link&quot; any other symbolic points to stopping points, stopping points to other points or several stopping points into each other.</p>
<h3 id="route-rules"><a class="header" href="#route-rules">Route rules</a></h3>
<ul>
<li>Limit driving certain routes on special situations;</li>
</ul>
<p>Route rules can be used to make sure that the AGVs do not drive in unwanted route sections unless it is allowed by rules. There are 5 different possible route rules:</p>
<ul>
<li>No resource onboard;</li>
<li>Resource on board;</li>
<li>Fire alarm active;</li>
<li>Drive only when target within segments;</li>
<li>Fire alarm inactive.</li>
</ul>
<p>The first two resource rules are mutually exclusive. This means that if both rules are set on a route section this route can never be driven.
The same applies also for the two fire alarm rules.
However, drive only when target within segments rule can be set on a route that already has another rule defined on it.</p>
<p>Drive only when target within segments rule can be used to block driving through a route section.
This means that an AGV can enter a section marked with this rule only if the end target of the mission is within the section.
For example, in the picture below the highlighted section cannot be driven through even if the route is shorter than the alternative.</p>
<p><img src="./Images/bestProductionPractices/routing21.png" alt="" /></p>
<p>The resource rules are used to allow driving on specific route sections only when the AGV is either empty or carrying an item.
This is useful when the item the AGV moves is larger than the AGV.
In such cases it is often necessary to maneuver the AGV differently based on the load status or allow certain route sections only when AGV is empty.
In the example below the AGV carries item's that are multiple meters longer than the AGV body.
When the AGV is empty it can drive a simple turn to the main aisle but when it is carrying the long item it needs to drive slower and turn closer to the corner as it would not fit otherwise.</p>
<p><img src="./Images/bestProductionPractices/routing22.png" alt="" /></p>
<p><img src="./Images/bestProductionPractices/routing23.png" alt="" /></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="logs"><a class="header" href="#logs">Logs</a></h1>
<p>This document contains information about logs created by Navithor.</p>
<p>Updated 04.02.2022</p>
<h2 id="version-history-13"><a class="header" href="#version-history-13">Version History</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Version</th><th>Date</th><th>Author</th><th>Change</th></tr></thead><tbody>
<tr><td>1.0</td><td>12.05.2021</td><td>Elena Sgonova</td><td>Document created</td></tr>
<tr><td>1.1</td><td>06.06.2021</td><td>Elena Sgonova</td><td>Updated name of referred document</td></tr>
<tr><td>1.2</td><td>04.02.2022</td><td>Tero Laakso-Pitkäkoski</td><td>Navithor Server.exe configuration moved to ServerSettings.json</td></tr>
</tbody></table>
</div>
<hr />
<h2 id="introduction-7"><a class="header" href="#introduction-7">Introduction</a></h2>
<p>Following topics will be considered in this document:</p>
<ul>
<li>What kind of logs Navithor is saving;</li>
<li>How to affect the length and number of logs;</li>
<li>How to use visual replay;</li>
<li>How to save and download logs.</li>
</ul>
<h2 id="logs-produced-by-navithor"><a class="header" href="#logs-produced-by-navithor">Logs produced by Navithor</a></h2>
<p>Some Navithor logs are written into a single file, some - into multiple files. They can have text or binary format. Most of the logs are written also into the log package that can be saved and downloaded by the operators. More details about the log package can be found in the chapter &quot;Logs saving and downloading&quot;.</p>
<h3 id="start-log"><a class="header" href="#start-log">Start log</a></h3>
<p>Navithor Server prints events from the start up process. Start log is used to solve issues, if server does not start correctly.</p>
<ul>
<li>Saved automatically to <em>Navithor Server/startInfo.log</em>;</li>
<li>History saved into <em>Navithor Server/LogsBackups/</em>;
<ul>
<li>File name has a timestamp: <em>2020_02_18_19_30_22_startInfo.log</em>;</li>
</ul>
</li>
<li>Copied always into the log package;</li>
<li>No parameters that affect the amount of logs.</li>
</ul>
<p>Example fragment of Start log:</p>
<pre><code>8/01/2021 8:21:18 - Started Navithor Server version: 2.21.0.90
8/01/2021 8:21:18 - StartupLog created
8/01/2021 8:21:18 - After logger is setup
8/01/2021 8:21:18 - After Application is setup
8/01/2021 8:21:18 - After event linking
8/01/2021 8:21:18 - After program creation
8/01/2021 8:21:19 - 0 - Starting Navithor Server, please wait
8/01/2021 8:21:20 - 1 - Starting Navithor Server, please wait. Directory: C:\Users\admin\Desktop\Navithor_Server_2.21.0.90\NavithorServer_2.21.0.90
8/01/2021 8:21:20 - 2 - Starting Navithor Server, please wait
8/01/2021 8:21:20 - 3 - Starting Navithor Server, please wait
8/01/2021 8:21:20 - 4 - Starting Navithor Server, please wait
8/01/2021 8:21:20 - 5 - Starting Navithor Server, please wait. Initializing logger.
8/01/2021 8:21:20 - 6 - Setting up database...
8/01/2021 8:21:20 - 7 - Setting database... Reading config file
8/01/2021 8:21:21 - 8 - Setting database... Setup database. File successfully read
</code></pre>
<h3 id="area-information-log"><a class="header" href="#area-information-log">Area information log</a></h3>
<p>This file is used to check how the current production area is configured.</p>
<ul>
<li>Current area information can be found in <em>Navithor Server/Logs/Production/ProductionAreaData.txt</em>;</li>
<li>No history saved;</li>
<li>Copied always into the log package as <em>areaInfo.txt</em>;</li>
<li>No parameters that affect the amount of logs.</li>
</ul>
<p>Area information log contains information about:</p>
<ul>
<li>Navithor Server version;</li>
<li>Database version;</li>
<li>MES interface version;</li>
<li>Name and version of the area files;</li>
<li>Detailed information about the area files, i.e. waypoint, segment and symbolic point data, machine load capacities etc.;</li>
<li>Machines defined in DB;</li>
<li>Resource types;</li>
<li>Area loading log which can be checked in case area loading fails.</li>
</ul>
<h3 id="parameter-files"><a class="header" href="#parameter-files">Parameter files</a></h3>
<ul>
<li>Active parameters are written in readable format to <em>Navithor Server/Logs/active.TCC.AREA_NAME.txt</em>;</li>
<li>The same parameters are also written in binary format to <em>Navithor Server/AREA_NAME.tcc2</em>;
<ul>
<li>This .tcc2 file can be uploaded to another Navithor Server instance, for example from simulation to production server or vice versa;</li>
<li>One file exists for each area used previously with the last parameters used on that area, so there can be multiple files;</li>
</ul>
</li>
<li>Both files are copied always into the log package;</li>
<li>No parameters affect writing of the files.</li>
</ul>
<h3 id="mes-logs"><a class="header" href="#mes-logs">MES logs</a></h3>
<p>MES logs can be used for troubleshooting of common issues, for example:</p>
<ul>
<li>Sending data too frequently. It is quite common mistake that data is sent even 100 times a second;</li>
<li>Data is sent in bad format;</li>
<li>MES Client disconnecting and reconnecting frequently;</li>
<li>Something unintended happened in the production;</li>
</ul>
<p>There are separate files for connection status and message logging:</p>
<ul>
<li>Connection status: <em>Navithor Server/Logs/MesLogs/StatusLogs/</em>;</li>
<li>Messages: <em>Navithor Server/Logs/MesLogs/MessageLogs/</em>.</li>
</ul>
<p>To enable MES logging set parameter <strong>MES_EnableMesLogging_Rule</strong> to True.</p>
<p>Maximum file size for one file is defined by <strong>MES_MesMaxSize</strong> (megabytes). The size of the log files affect the amount of actual time the message logs contain. The length of the file is limited by the size and not by any period of time.</p>
<ul>
<li>For message logs a history of 7 files is saved;</li>
<li>For status logs a history of 30 files is saved (usually this is 30 days). The file is changed to a new one either by day changing or size limit.</li>
</ul>
<p>Set <strong>MES_LogRawBytes</strong> to True in order to see all the bytes received in MES logs.</p>
<p>Automatic logging can be triggered by setting <strong>MES_AutomaticLoggingOnDisconnect</strong> to a Timespan value different from 0.  Timespan defines a required delay for MES client being disconnected for triggering logs writing.</p>
<p>Example fragment of MES log:</p>
<pre><code>2021-01-08 10:00:19.366 +01:00 [INF]   |     IN     |  MessageID: 24 - TagStatus SenderID: 1001  ReceiverID: 1000  TagID:175  Stat:4  TagType:1  Type:TagStatus
2021-01-08 10:00:19.366 +01:00 [INF]   |    OUT     |  MessageID: 200 - AckOrReject SenderID: 1000  ReceiverID: 1001  AckReje:0  MessId:24  RespId:0  RespTimeOut:1000  Type:AckOrReject
</code></pre>
<h3 id="text-logs"><a class="header" href="#text-logs">Text logs</a></h3>
<p>Detailed log of software events and errors. Used when other means are not enough to solve the issue.</p>
<ul>
<li>Text logs are saved in <em>Navithor Server/Logs/NavithorLog.txt.*</em>. Path can be configured in <em>Navithor Server/log4net.config</em> file;</li>
<li>History of files is saved, typically covers production from one to few hours;</li>
<li>10 last text logs are included in log package (not configurable);</li>
<li>Amount of logs can be configured in <em>Navithor Server/log4net.config</em> with parameters <strong>maxSizeRollBackups</strong> and <strong>maximumFileSize</strong>. Parameter <strong>maxSizeRollBackups</strong> defines how many <em>NavithorLog.txt.*</em> files is kept simultaneously in the Navithor <em>Server/Logs</em> folder.</li>
</ul>
<p>Example settings in <em>log4net.config</em>:</p>
<pre><code>&lt;maxSizeRollBackups value=&quot;10&quot; /&gt;
&lt;maximumFileSize value=&quot;30MB&quot; /&gt;
</code></pre>
<p>Changes in in <em>Navithor Server/log4net.config</em> require restarting Navithor server.</p>
<h3 id="audit-log"><a class="header" href="#audit-log">Audit log</a></h3>
<blockquote>
<p>The audit log is still in development - it does not yet record every single input from Navithor Client!</p>
</blockquote>
<p>Audit log records manual inputs from Navithor Client. It can be used to check if for example resources were manipulated manually, or if AGVs were driven manually.</p>
<ul>
<li>Audit logs are saved in <em>Navithor Server/audit_logs.log</em>;</li>
<li>Copied always into the log package;</li>
<li>No parameters that affect the audit log.</li>
</ul>
<p>Example fragment of Audit log:</p>
<pre><code>{
    &quot;auditId&quot;: 1459,
    &quot;userId&quot;: 0,
    &quot;userName&quot;: &quot;Unknown user&quot;,
    &quot;actionType&quot;: &quot;ResourceCreated&quot;,
    &quot;description&quot;: &quot;Resource created to AT2 G Nord_3 (10057) Type: 10018&quot;,
    &quot;occuredTime&quot;: &quot;2021-01-08T09:05:14.58&quot;
  },
  {
    &quot;auditId&quot;: 1458,
    &quot;userId&quot;: 2,
    &quot;userName&quot;: &quot;Unknown user&quot;,
    &quot;actionType&quot;: &quot;RequestAreaReload&quot;,
    &quot;description&quot;: &quot;Area reload requested&quot;,
    &quot;occuredTime&quot;: &quot;2021-01-08T08:39:04.8&quot;
  },
</code></pre>
<h3 id="binary-logs"><a class="header" href="#binary-logs">Binary logs</a></h3>
<p>Binary logs are used for the visual replay.</p>
<ul>
<li>Binary logs are saved to <em>Navithor Server/Logs/BinaryLogs/</em>. Older files are compressed and saved under <em>/Logs/BinaryLogs/Archive/</em> with a timestamp on the name;</li>
<li>Saving of logs and their size can be configured with parameters:
<ul>
<li><strong>VisualReplay_Enabled</strong> – Set to True to enable saving of binary logs for Visual Replay;</li>
<li><strong>VisualReplay_MaximumFileSizeInBytesBeforeSwap</strong> – Maximum file size in bytes for a single binary log file;</li>
<li><strong>VisualReplay_MaximumFileCountBeforeMoveToArchive</strong> – Maximum amount of files to keep in working directory before moving to archive;</li>
<li><strong>VisualReplay_MaximumZippedFilesInArchive</strong> – Maximum amount of files to keep in archive before deleting oldest.</li>
</ul>
</li>
</ul>
<p>To be able to save binary logs static data file <em>Navithor Server/Logs/BinaryLogs/staticDataCache.ntstatic</em> is required. The file is included automatically in the log package. If it is not available, it can be generated by using exact same area files and machines in database.</p>
<h4 id="visual-replay"><a class="header" href="#visual-replay">Visual replay</a></h4>
<p>Visual Replay is a feature that allows logs to be played back on Navithor Client. All incoming events to Navithor Client are saved to a binary log and played back like they happened in the real time. This feature is similar to Navitrol log playback in Navitrol Monitor.</p>
<p><img src="./Images/Logs/visualreplay.png" alt="" /></p>
<blockquote>
<p>Figure: Visual replay control window.</p>
</blockquote>
<p>Available features:</p>
<ul>
<li>Replay all events back and forth;</li>
<li>Viewing map;</li>
<li>Opening task log. <strong>Note:</strong> new messages will appear with delay and old messages will not be cleared;</li>
<li>Viewing production orders;</li>
<li>InventoryForm (view only);</li>
<li>AreaControl (view waypoints);</li>
<li>Viewing AGV event pop-ups;</li>
<li>Machine diagnostics;</li>
<li>Showing alarms;</li>
<li>Selecting machine zooms to machine.</li>
</ul>
<p>Disabled features:</p>
<ul>
<li>Start and Stop production;</li>
<li>Creating production orders or transfer requests;</li>
<li>Resetting alarms does nothing;</li>
<li>Changing Server settings;</li>
<li>Changing TC parameters;</li>
<li>Changing production area files;</li>
<li>Modifying machines;</li>
<li>Login - login form can be opened but cannot log in.</li>
</ul>
<h3 id="statistics-1"><a class="header" href="#statistics-1">Statistics</a></h3>
<p>Statistics are stored either to a separate database or to text files in the <em>ProductionData</em> folder. Currently it is a raw data and there is no tool to display the statistics in a nice way. Development for this feature is planned.</p>
<ul>
<li>Statistics database default name is <em>NTDB_Statistics</em>. Statistics text files are located in <em>Navithor server/ProductionData</em> folder;</li>
<li>Statistics files are not included into the log package.</li>
</ul>
<p>Statistics gathered from production:</p>
<ul>
<li>Error logging;</li>
<li>Production order events;</li>
<li>Resource transfer log;</li>
<li>Machine visited statistics (which symbolic points machine visited);</li>
<li>Resource and location status for every symbolic point;</li>
<li>Battery level, communication status, machine state and position confidence for every machine.</li>
</ul>
<p>To enable writing of statistics go to Navithor Server-&gt;Statistics and check Enabled option.</p>
<p>To set statistics output format(s) set following parameters in Navithor Client:</p>
<ul>
<li>Set <strong>Statistics_UseStatisticsDatabase</strong> to True to enable writing statistics to the database;</li>
<li>Set <strong>Statistics_UseFleetControlStatisticsTextLogger</strong> to True to enable writing statistics to the text files. There are other statistics text file related parameters:
<ul>
<li><strong>Statistics_TextLoggerCSVSeparator</strong>;</li>
<li><strong>Statistics_TextLoggerFormat</strong>;</li>
<li><strong>Statistics_DaysToKeepFileLogs</strong>.</li>
</ul>
</li>
</ul>
<p><strong>Note:</strong> After statistics writing is enabled with parameters Navithor server restart is required.</p>
<p>For more details on statistics see the document * Statistics*.</p>
<h2 id="logs-saving-and-downloading"><a class="header" href="#logs-saving-and-downloading">Logs saving and downloading</a></h2>
<p>Different sources for triggering logs are:</p>
<ul>
<li>Navithor Client;</li>
<li>Navithor Server;</li>
<li>MES interface;</li>
<li>Automatic events, for example:
<ul>
<li>Events after startup;</li>
<li>Exceptions;</li>
<li>Events triggered when TC thread getting busy;</li>
<li>MES client disconnected event;</li>
</ul>
</li>
<li>From Client and MES it is possible to trigger Navitrol log dump to one or more AGVs and then Navithor can download the logs.</li>
</ul>
<p>All different log files except statistics are combined into an archive - log package. Log package includes also area files, active parameters and machine type parameters. These files can be used to set up a simulation.</p>
<p><img src="./Images/Logs/logspackage.png" alt="" /></p>
<blockquote>
<p>Figure: Log package.</p>
</blockquote>
<p>All logs can be downloaded with Download Manager in Navithor Client 2.21.0.0.</p>
<p><img src="./Images/Logs/downloadmanager.png" alt="" /></p>
<blockquote>
<p>Figure: Download manager.</p>
</blockquote>
<h2 id="configuring-amount-of-automatically-saved-logs"><a class="header" href="#configuring-amount-of-automatically-saved-logs">Configuring amount of automatically saved logs</a></h2>
<p>Following parameters in the <em>ConfigFiles/ServerSettings.json</em> file can be used to limit amount of folders and logs:</p>
<ul>
<li><strong>RemoveLogsEnabled</strong> - set to True to enable automatic removal of logs when reaching a threshold which is set by parameters:
<ul>
<li><strong>RemoveLogsKeepDays</strong> - amount of days to keep logs;</li>
<li><strong>RemoveLogsMaxFolders</strong> - amount of folders to keep logs.</li>
</ul>
</li>
</ul>
<p>Example:</p>
<pre><code class="language-json">{
  &quot;RemoveLogsEnabled&quot;: true,
  &quot;RemoveLogsKeepDays&quot;: 30,
  &quot;RemoveLogsMaxFolders&quot;: 25
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="visual-replay-1"><a class="header" href="#visual-replay-1">Visual Replay</a></h1>
<p>This document introduces Visual Replay feature.</p>
<p>Updated 8.1.2021</p>
<h2 id="version-history-14"><a class="header" href="#version-history-14">Version History</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Version</th><th>Date</th><th>Author</th><th>Change</th></tr></thead><tbody>
<tr><td>1.0</td><td>01.04.2020</td><td>Tommi Kärki</td><td>Document created</td></tr>
<tr><td>1.1</td><td>08.01.2021</td><td>Toni Liski</td><td>Minor spellchecking</td></tr>
<tr><td>1.2</td><td>11.06.2021</td><td>Aleksi Ålander</td><td>Renamed title</td></tr>
</tbody></table>
</div>
<hr />
<h2 id="introduction-8"><a class="header" href="#introduction-8">Introduction</a></h2>
<p>Visual Replay is a feature that allows logs to be played back on Navithor Client. Navithor Server and Client have been supporting the visual replay since the version 2.18.0.0.</p>
<h3 id="visual-replay-log-files"><a class="header" href="#visual-replay-log-files">Visual Replay log files</a></h3>
<p>Currently Visual Replay requires specific binary log files to work. There is no support to read in plain text .log file.</p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Purpose</th></tr></thead><tbody>
<tr><td>.ntstatic</td><td>Area information</td></tr>
<tr><td>.ntlog</td><td>Binary log file used by VisualReplay. Compressed</td></tr>
<tr><td>.ntlogtmp</td><td>Ongoing binary log file. Uncompressed</td></tr>
</tbody></table>
</div>
<h3 id="configuring-visual-replay"><a class="header" href="#configuring-visual-replay">Configuring Visual Replay</a></h3>
<p>By default Visual Replay log generation is enabled. To disable, change parameter <strong>VisualReplay_Enabled</strong> to <strong>false</strong>. Relevant parameters can be found by searching 'VisualReplay' on Navithor Client -&gt; Settings -&gt; TCParams</p>
<p>Configuration options mainly affect how many files will be stored and how long files will be archived.</p>
<h3 id="opening-visual-replay"><a class="header" href="#opening-visual-replay">Opening Visual Replay</a></h3>
<p><img src="./Images/visualReplay/openingPlayback.gif" alt="" /></p>
<blockquote>
<p>Opening visual replay.</p>
</blockquote>
<p>Visual Replay can be opened by clicking &quot;Playback&quot; at Navithor Client top bar.</p>
<h2 id="visual-replay-ui"><a class="header" href="#visual-replay-ui">Visual Replay UI</a></h2>
<p><img src="./Images/visualReplay/visualReplay_MainMenuNoProductionAreaData.png" alt="" /></p>
<blockquote>
<p>Visual replay main screen. No production area information available.</p>
</blockquote>
<h3 id="loading-ntstatic"><a class="header" href="#loading-ntstatic">Loading .ntstatic</a></h3>
<p>Before any binary log files can be played back Client requires information about production area. This information is stored inside .ntstatic file.</p>
<p>This file is automatically generated every time you connect to Navithor Server. Next time you open Navithor Client, the .ntstatic is automatically available for previous production area.</p>
<p>To load in different production area, Click on &quot;Browse .ntstatic&quot; and choose desired .ntstatic file. Generally it does not harm anything to always load the .ntstatic file before browsing the logs.</p>
<h3 id="loading-binary-log-files"><a class="header" href="#loading-binary-log-files">Loading binary log files</a></h3>
<p><img src="./Images/visualReplay/visualReplay_MainMenuDataAvailable.png" alt="" /></p>
<blockquote>
<p>Visual replay main screen. Production area information available. Log data not loaded in.</p>
</blockquote>
<p>After .ntstatic has been loaded Playback information should show which production area is loaded in.</p>
<p>Next step is browsing for binary log files. These are either .ntlog or .ntlogtmp files. It is possible to mix and match these files, only difference is whether file is compressed or not.</p>
<p>Server generates these under Logs/BinaryLogs folder automatically and they can be fetched by using SaveLogs functionality or Download Manager on Client.</p>
<p>To select log files click on &quot;Browse logs&quot; to open file dialog. It's possible to open multiple files at once. Keep in mind though that processing binary log files takes time and playback will not be available before all files are loaded in.</p>
<h3 id="enabling--disabling-playback-mode"><a class="header" href="#enabling--disabling-playback-mode">Enabling / disabling playback mode</a></h3>
<p><img src="./Images/visualReplay/visualReplay_MainMenuLogsLoadedIn.png" alt="" /></p>
<blockquote>
<p>Visual Replay. Production area data and binary logs loaded in.</p>
</blockquote>
<p>After both production area info and binary log file are loaded in <em>Enable/Disable</em> playback becomes available.</p>
<p>Clicking on <em>Enable</em> will change Client to function in Playback mode. This will disconnect Client from Server and use data on binary log files exclusively.</p>
<p>Likewise, clicking on <em>Disable</em> will change Client back to normal mode. If Server is available then Client will prompt to login.</p>
<h3 id="controlling-playback"><a class="header" href="#controlling-playback">Controlling playback</a></h3>
<p><img src="./Images/visualReplay/visualReplay_PlaybackModeEnabled.png" alt="" /></p>
<blockquote>
<p>Navithor Client in playback mode. Notice how server connection is Disconnected and user is SuperAdmin (fake user).</p>
</blockquote>
<p>Initially the playback will be in paused state. To start playing back log files click on <em>Resume</em> button.</p>
<p>To pause playback click on <em>Pause</em> button. This will stop reading new data from playback while Client will remain usable.</p>
<p>Clicking <code>|&lt;&lt;</code> will jump time 30s backwards.</p>
<p>Clicking <code>&gt;&gt;|</code> will jump time 30s forwards.</p>
<p>Clicking and dragging on trackbar will <strong>PAUSE</strong> playback data sending while trackbar is being dragged. Playback will be unpaused after trackbar is no longer dragged.</p>
<p>Time shown on CurrentTime and EndTime are in Server time. These time stamps can be used to further investigate issues on text log.</p>
<h2 id="consideration-on-playback-mode"><a class="header" href="#consideration-on-playback-mode">Consideration on Playback mode</a></h2>
<p>Playback is a new feature so some things might not work the same was in Live mode. For example anything that attempts to modify state, like adding resource to symbolic point, can cause unexpected behaviour. General rule-of-thumb is to NOT attempt to modify anything in Playback mode.</p>
<p><strong>Available features:</strong></p>
<ul>
<li>Opening task log
<ul>
<li>New messages will appear with delay. Old messages not cleared.</li>
<li>Timestamps can be out of sync</li>
</ul>
</li>
<li>Viewing production orders</li>
<li>AreaControl (view waypoints)
<ul>
<li>If AreaControl was disabled when playback was enabled -&gt; ClearLogs and load logs files again.</li>
</ul>
</li>
<li>Viewing map</li>
<li>Viewing pop-ups that happen when AGV is given a Task</li>
<li>InventoryForm
<ul>
<li>View only</li>
<li>Attempts to modify will disable modification buttons </li>
</ul>
</li>
<li>Machine diagnostics</li>
<li>Alarms
<ul>
<li>Resetting alarms does nothing </li>
</ul>
</li>
</ul>
<p><strong>Disabled features:</strong></p>
<ul>
<li>Changing Server settings</li>
<li>Changing TC parameters</li>
<li>Changing production area files</li>
<li>Modifying machines</li>
<li>Login
<ul>
<li>Can be opened but cannot Login</li>
</ul>
</li>
<li>Start and Stop production
<ul>
<li>Might cause undefined behaviour</li>
</ul>
</li>
</ul>
<p><strong>Planned feature support:</strong></p>
<ul>
<li>
<p>Selecting machine zooms to machine</p>
</li>
<li>
<p>View affixes</p>
</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="download-manager"><a class="header" href="#download-manager">Download Manager</a></h1>
<p>This document introduces Download Manager feature</p>
<p>Updated 20.10.2020</p>
<h2 id="version-history-15"><a class="header" href="#version-history-15">Version History</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Version</th><th>Date</th><th>Author</th><th>Change</th></tr></thead><tbody>
<tr><td>1.0</td><td>20.10.2020</td><td>Toni Liski</td><td>Document created</td></tr>
<tr><td>1.1</td><td>11.06.2021</td><td>Aleksi Ålander</td><td>Renamed title</td></tr>
</tbody></table>
</div>
<hr />
<h2 id="introduction-9"><a class="header" href="#introduction-9">Introduction</a></h2>
<p>Download Manager is a feature which allows user to download log files and other production files from the server
without a need to access server over the file explorer, for instance. Download Manager is embedded inside Navithor
Client and can be opened from View -&gt; Download Manager menu bar.</p>
<h3 id="changes-to-log-saving-and-downloading-functions"><a class="header" href="#changes-to-log-saving-and-downloading-functions">Changes to log saving and downloading functions</a></h3>
<p>Together with Download Manager, some changes for saving and downloading logs were made. Now, when user requests
saving logs from the client, all the corresponding log files are gathered and .zip archive is created automatically.
Progress bar indicates the log saving process.</p>
<p>If user has sufficient user rights (see Section User rights), prompt will appear and ask if user wants to download
log file from the server. By pressing Yes, Download Manager form is launched, and downloading of the log file is 
started automatically. Progress can be seen in progress bar and with the transferred bytes.</p>
<p>Without sufficient user rights, the prompt will just indicate about a successful or unsuccessful saving.</p>
<h2 id="download-manager-1"><a class="header" href="#download-manager-1">Download Manager</a></h2>
<p><img src="./Images/downloadManager/download_manager01.png" alt="Download manager" /></p>
<blockquote>
<p>Download Manager main screen.</p>
</blockquote>
<p>Download Manager can be used to download log files or other production files, such as statistics, from the server.
With sufficient user rights (see chapter User rights), Download Manager can be opened from View -&gt; Download manager
menu bar. With a normal access, user can see log file listing of server log folder. Listed are automatically
saved log files and user saved log files. Log file can be selected and downloaded to local folder which is specified.
After changing the local <em>destination folder</em>, client remembers the selection and same folder will be used next time.
By pressing <em>Download</em> button, download starts. Progress bar and transferred bytes are indicating the progress of the 
transfer. A prompt will appear after successful or unsuccessful transfer.</p>
<h3 id="advanced-features"><a class="header" href="#advanced-features">Advanced features</a></h3>
<p>When user is granted with <em>ManageServerLogFiles</em> user right (see next Chapter), advanced features will be enabled.
The dropdown list will appear, and user is able to select different file types from the list. Available types are</p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Purpose</th></tr></thead><tbody>
<tr><td>Log Archive</td><td>Auto saved and User saved log file archives.</td></tr>
<tr><td>Binary Logs</td><td>Current and archived binary log files from BinaryLogs folder in server.</td></tr>
<tr><td>Current log files</td><td>All TC parameter files, NavithorLog files, startInfo and audit logs. Current Navithor.log file is not available as it is locked by the server.</td></tr>
<tr><td>MES Logs</td><td>All MES log files from MesLogs folder in server.</td></tr>
<tr><td>Production area files</td><td>Production area files from server log folder.</td></tr>
<tr><td>Statistics</td><td>Production statistic files from ProductionData folder in server.</td></tr>
</tbody></table>
</div>
<p>All different file types can be downloaded just as normal log archives.</p>
<h3 id="user-rights"><a class="header" href="#user-rights">User rights</a></h3>
<p>For Download Manager two new user rights have been added:</p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Purpose</th></tr></thead><tbody>
<tr><td>ViewDownloadManager</td><td>User is able to open Download Manager and download logs</td></tr>
<tr><td>ManageServerLogFiles</td><td>User is able to open Download Manager with advanced access to all server log files and production files</td></tr>
</tbody></table>
</div>
<p>If user is granted rights for <em>ManageServerLogFiles</em>, system will automatically grant right for <em>ViewDownloadManager</em> as well.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="using-active-directory-for-authentication"><a class="header" href="#using-active-directory-for-authentication">Using Active Directory for authentication</a></h1>
<p>This document contains information on how to configure Active Directory for user authentication.</p>
<p>Updated 11.06.2021</p>
<h2 id="version-history-16"><a class="header" href="#version-history-16">Version History</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Version</th><th>Date</th><th>Author</th><th>Change</th></tr></thead><tbody>
<tr><td>1.0</td><td>22.08.2018</td><td>Antti Parkkonen</td><td>First version</td></tr>
<tr><td>1.1</td><td>10.05.2019</td><td>Antti Parkkonen</td><td>Document updated for Navithor version 2.0</td></tr>
<tr><td>1.2</td><td>11.06.2021</td><td>Aleksi Ålander</td><td>Renamed title</td></tr>
</tbody></table>
</div>
<hr />
<h2 id="preconditions"><a class="header" href="#preconditions">Preconditions</a></h2>
<p>Our implementation of authentication against Active Directory (AD)
expects that the client and server both have a connection to the AD
domain controller and that users, who are members of configured security
groups will have operator, production manager or administrative access
when using the Navithor fleet control system.</p>
<p>This means that in order to use AD authentication:</p>
<ul>
<li>
<p>Connection to AD domain controller is available from client and
server.</p>
</li>
<li>
<p>Security groups for fleet control operators, production managers and
admins have been created in AD</p>
</li>
<li>
<p>At least one user is a member of the admins group.</p>
</li>
</ul>
<h2 id="taking-ad-authentication-in-use"><a class="header" href="#taking-ad-authentication-in-use">Taking AD authentication in use.</a></h2>
<p>AD authentication is configured from Navithor Client. An example
screenshot of the full configuration including security groups for
admins and operators is shown in the last page of this document.
Configuration is done following these steps:</p>
<p>1. Log on to Navithor Client as an admin using Navithor authentication.</p>
<p>2. Open settings and go to Users tab.</p>
<p>3. Click on Configure Active Directory groups.</p>
<p>4. This opens up a window with input boxes for configurable groups.</p>
<p>5. Type in the full name of the security groups to the input boxes and
click Save.</p>
<p>6. If there were no errors, the group configuration closes without
errors.</p>
<p>7. Go to Server settings tab in settings window.</p>
<p>8. Double click on the value column on row Use Active Directory
authentication, type True and press Enter.</p>
<p>9. Click on Save settings. If saving fails, it implies that there is a
connection problem between the Active Directory domain controller and
Navitec software products.</p>
<h2 id="about-implementation"><a class="header" href="#about-implementation">About implementation</a></h2>
<p>The implementation has been tested on 1 level of nested groups, but in
theory even more layers should work also. For example, if the
organization relies on role-based access management, the security group
<em>Production supervisors</em> can be a member of the fleet control admins
security group and all members of the production supervisors group gain
administrative access to Navithor.</p>
<p>Authentication is implemented so that the highest available privileges
will be given to the user in case of multiple roles. This means that if
a domain user is a member of both admins group and operators group the
domain user will always be granted administrator's privileges.</p>
<p><img src="./Images/activeDirectory-example.png" alt="" /></p>
<blockquote>
<p>Example configuration for Active Directory authentication.</p>
</blockquote>
<div style="break-before: page; page-break-before: always;"></div><h1 id="user-management-1"><a class="header" href="#user-management-1">User management</a></h1>
<p>Introduction to user Management concepts and quick guide how to setup.</p>
<p>Updated 16.06.2021</p>
<h2 id="version-history-17"><a class="header" href="#version-history-17">Version History</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Version</th><th>Date</th><th>Author</th><th>Change</th></tr></thead><tbody>
<tr><td>1.0</td><td>29.04.2020</td><td>Tommi Kärki</td><td>Document created</td></tr>
<tr><td>1.1</td><td>11.06.2021</td><td>Aleksi Ålander</td><td>Minor formating corrections.</td></tr>
<tr><td>1.2</td><td>16.06.2021</td><td>Elena Sgonova</td><td>Updated titles of referred documents</td></tr>
</tbody></table>
</div>
<hr />
<h2 id="terminology"><a class="header" href="#terminology">Terminology</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Term</th><th>Explanation</th></tr></thead><tbody>
<tr><td>User</td><td>A user in Navithor Fleet Control. Can be a Navithor user or Active Directory user.</td></tr>
<tr><td>Navithor User</td><td>User in Navithor Fleet Control, managed by Navithor</td></tr>
<tr><td>Active Directory User</td><td>User in Active Directory, managed by Active Directory instead of Navithor</td></tr>
<tr><td>UserRole</td><td>User can belong to one or many Roles, each Role grants 0 to many Rights.</td></tr>
<tr><td>UserRights</td><td>Right to view or manage something. For example: &quot;Give GOTO command&quot; or &quot;Edit server settings&quot;.</td></tr>
</tbody></table>
</div>
<h2 id="introduction-10"><a class="header" href="#introduction-10">Introduction</a></h2>
<p>Navithor Client allows users, for example, to change server configuration and give manual commands to AGV's. Some of the actions can cause production to halt and thus should be restricted to certain users only. The User roles allow restricting these potentially harmful actions.</p>
<p>Basic concept is that each action or view is behind a UserRight and if user is missing this UserRight then the view isn't visible or action is not allowed. These UserRights are granted to UserRole (for example: operator, administrator). The user can have multiple UserRoles.</p>
<p>Practical example:</p>
<div class="table-wrapper"><table><thead><tr><th>Role name</th><th>Actions allowed</th></tr></thead><tbody>
<tr><td>ConfigurationAdmin</td><td>Change Server Settings, Server Parameters, AreaFiles and Machines</td></tr>
<tr><td>SeniorOperator</td><td>View waypoints, Change resource status, Give any command to AGV, Abort task, Enable/Disable production</td></tr>
<tr><td>JuniorOperator</td><td>Abort task, Give GOTO command, Give Load/Unload</td></tr>
<tr><td>UserAdmin</td><td>Create user, Delete user, Modify User, Modify Active Directory mapping</td></tr>
</tbody></table>
</div>
<p>User that has both SeniorOperator and ConfigurationAdmin would be able to:</p>
<p>Change Server Settings, Server Parameters, AreaFiles and Machines, View waypoints, Change resource status, Give any command to AGV, Abort task, Enable/Disable production.</p>
<p>Granting Admin Rights gives full access to system and should be given sparingly.</p>
<h2 id="difference-between-userlevel-old-and-userroles-new"><a class="header" href="#difference-between-userlevel-old-and-userroles-new">Difference between UserLevel (old) and UserRoles (new)</a></h2>
<p>UserLevel</p>
<ul>
<li>User is at single UserLevel</li>
<li>Each UserLevel has non-configurable Rights</li>
</ul>
<p>UserRoles</p>
<ul>
<li>Ability to create new Role with any name</li>
<li>Rights each Role grants are configurable</li>
<li>Better integration to ActiveDirectory</li>
<li>More fine-grained control</li>
</ul>
<h2 id="default-user-roles"><a class="header" href="#default-user-roles">Default user roles</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Role name</th><th>Explanation</th></tr></thead><tbody>
<tr><td>Administrator</td><td>Admin. Can do anything.</td></tr>
<tr><td>Operator</td><td>Unable to configure system. Can command AGV. Can change symbolic point state</td></tr>
<tr><td>Production Manager</td><td>Can view production. Unable to give commands to AGV. Unable to configure system. Unable to change symbolic point state.</td></tr>
<tr><td>Guest</td><td>View main window, production orders, resources only. No access to other views or any configuration.</td></tr>
</tbody></table>
</div>
<p>Refer to ** Default roles and user rights matrix** documentation for more details about available user Rights and default roles.</p>
<h2 id="managing-users"><a class="header" href="#managing-users">Managing users</a></h2>
<p>User management can be accessed by Production Settings -&gt; User Management -&gt; Users. Requires &quot;Manage users&quot; Rights.</p>
<p><img src="./Images/userRoles/viewUsers.png" alt="" /></p>
<blockquote>
<p>Manage Users view</p>
</blockquote>
<h3 id="creating-new-user"><a class="header" href="#creating-new-user">Creating new user</a></h3>
<p>New user can be created by clicking &quot;Create user&quot;. This will open a pop-up where you can fill out details.</p>
<p><img src="./Images/userRoles/createNewUser.png" alt="" /></p>
<blockquote>
<p>Create new user view</p>
</blockquote>
<h3 id="deleting-user"><a class="header" href="#deleting-user">Deleting user</a></h3>
<p>Select an user to delete and then click on Delete user.</p>
<h3 id="reset-password"><a class="header" href="#reset-password">Reset password</a></h3>
<p>Select an user and click on Change password. Form to input new password will popup. Note: Anyone with &quot;Manage users&quot; Rights can reset anyone's password, caution when granting this Rights is advised.</p>
<p><img src="./Images/userRoles/changePassword.png" alt="" /></p>
<blockquote>
<p>Change password view</p>
</blockquote>
<h3 id="adding-or-removing-a-role-to-user"><a class="header" href="#adding-or-removing-a-role-to-user">Adding or removing a Role to user</a></h3>
<ol>
<li>Select an user</li>
<li>Click on Role to preview Rights user would gain when Role is added or what Rights user would lose</li>
<li>Press spacebar or click on Role again to assign Role or unassign Role</li>
</ol>
<p><img src="./Images/userRoles/rightsGained.png" alt="" /></p>
<blockquote>
<p>User belongs to Role and has Rights</p>
</blockquote>
<p><img src="./Images/userRoles/gainRights.png" alt="" /></p>
<blockquote>
<p>User would gain Rights</p>
</blockquote>
<p><img src="./Images/userRoles/alreadyHave.png" alt="" /></p>
<blockquote>
<p>User already has this Rights</p>
</blockquote>
<p><img src="./Images/userRoles/unrelatedRights.png" alt="" /></p>
<blockquote>
<p>User does not have Rights and Rights is unrelated to selected Role</p>
</blockquote>
<h2 id="managing-userroles"><a class="header" href="#managing-userroles">Managing UserRoles</a></h2>
<p>User Role management can be accessed by Production Settings -&gt; User management -&gt; Roles. Requires &quot;Manage users&quot; Rights.</p>
<p><img src="./Images/userRoles/viewUserRoles.png" alt="" /></p>
<blockquote>
<p>Manage user roles view</p>
</blockquote>
<h3 id="create-a-new-userrole"><a class="header" href="#create-a-new-userrole">Create a new UserRole</a></h3>
<p>Click on &quot;Create Role&quot;.</p>
<h3 id="delete-userrole"><a class="header" href="#delete-userrole">Delete UserRole</a></h3>
<p>Click on &quot;Delete Role&quot;.</p>
<h3 id="adding-or-removing-rights-from-userrole"><a class="header" href="#adding-or-removing-rights-from-userrole">Adding or Removing Rights from UserRole</a></h3>
<ol>
<li>Click on UserRole</li>
<li>Click on checkbox for Rights you want to allow or remove.</li>
</ol>
<p>Hovering mouse over Rights name will show more detailed description.</p>
<h2 id="configuring-active-directory-mapping"><a class="header" href="#configuring-active-directory-mapping">Configuring Active Directory Mapping</a></h2>
<p>Only users managed by Navithor can be directly added to UserRoles. Active Directory users and roles they belong to are managed by mapping Active Directory Group to Navithor UserRole.</p>
<p>Menu can be accessed by Production Settings -&gt; User Management -&gt; Active Directory. Requires &quot;Configure Active Directory&quot; Rights.</p>
<p>Navithor does not read possible Active Directory Groups and they need to be filled out manually. Adding new entry can be achieved by typing anything into empty textbox, this will also generate a new blank entry automatically.</p>
<p><img src="./Images/userRoles/activeDirectoryMapping.png" alt="" /></p>
<blockquote>
<p>Mapping Active Directory Group to NavithorRole</p>
</blockquote>
<p>Active Directory mapping comes with preconfigured defaults, but these can be changed or deleted.</p>
<div class="table-wrapper"><table><thead><tr><th>Active Directory Group</th><th>UserRole</th><th>Notes</th></tr></thead><tbody>
<tr><td>Administrators</td><td>Admin</td><td>Default name of admin Role on Active Directory, automatically mapped to Admin on Navithor.</td></tr>
<tr><td>Guests</td><td>Guest</td><td>Default guest users on Active Directory.</td></tr>
<tr><td>Domain User</td><td>Guest</td><td>Any user in Active Directory.</td></tr>
<tr><td>Operators</td><td>Operator</td><td>Operators group doesn't exist by default.</td></tr>
<tr><td>Production managers</td><td>Production manager</td><td>Production managers group doesn't exist by default.</td></tr>
</tbody></table>
</div>
<h3 id="more-about-active-directory"><a class="header" href="#more-about-active-directory">More about Active Directory</a></h3>
<ul>
<li>Mapping a UserRole into non-existing Active Directory Group is allowed but doesn't do anything</li>
<li>Custom Active Directory Groups cannot be nested. They need to exist on top-level.</li>
<li>Logging with Active Directory is not enabled by default.</li>
<li>Navithor supports hybrid mode for Login. Users can always login with Navithor User credentials if needed. Active Directory users are automatically authenticated using currently logged in user in Windows.</li>
</ul>
<p>Active Directory is covered more in detail in <em>Using Active Directory for authentication</em> document.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="default-roles-and-user-rights-matrix"><a class="header" href="#default-roles-and-user-rights-matrix">Default roles and user rights matrix</a></h1>
<p>This document contains information on &quot;Roles and user Rights&quot;.</p>
<p>Updated 09.11.2022</p>
<h2 id="version-history-18"><a class="header" href="#version-history-18">Version History</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Version</th><th>Date</th><th>Author</th><th>Change</th></tr></thead><tbody>
<tr><td>1.0</td><td>21.04.2020</td><td>Tommi Kärki</td><td>Added rights matrix</td></tr>
<tr><td>1.1</td><td>27.04.2020</td><td>Tommi Kärki</td><td>Added user rights</td></tr>
<tr><td>1.2</td><td>20.05.2020</td><td>Tommi Kärki</td><td>Updated document</td></tr>
<tr><td>1.3</td><td>26.10.2020</td><td>Luis Rebelo</td><td>Updated document formating</td></tr>
<tr><td>1.4</td><td>11.06.2021</td><td>Aleksi Ålander</td><td>Renamed title</td></tr>
<tr><td>1.5</td><td>29.10.2021</td><td>Toni Liski</td><td>Added new role for Releasing waypoints</td></tr>
<tr><td>1.6</td><td>09.11.2022</td><td>Toni Liski</td><td>Added new roles for coupled drive dialog, production break and sleep mode</td></tr>
</tbody></table>
</div>
<hr />
<h2 id="views-1"><a class="header" href="#views-1">Views</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Rights</th><th>Operator</th><th>Production Manager</th><th>Guest</th><th>Admin</th><th>Explanation</th></tr></thead><tbody>
<tr><td>ViewProductionOrder</td><td><strong>YES</strong></td><td><strong>YES</strong></td><td><strong>YES</strong></td><td><strong>YES</strong></td><td>View production orders</td></tr>
<tr><td>ManageProductionOrder</td><td><strong>YES</strong></td><td>NO</td><td>NO</td><td><strong>YES</strong></td><td>Same as above + ability to pause, delete and create new production orders.</td></tr>
<tr><td>ViewInventoryForm</td><td><strong>YES</strong></td><td><strong>YES</strong></td><td><strong>YES</strong></td><td><strong>YES</strong></td><td>View inventory form for resources overview and listing</td></tr>
<tr><td>ManageInventoryForm</td><td><strong>YES</strong></td><td>NO</td><td>NO</td><td><strong>YES</strong></td><td>Same as above + ability to create transferRequests for resources and move resources</td></tr>
<tr><td>ViewMachineDiagnostics</td><td><strong>YES</strong></td><td><strong>YES</strong></td><td>NO</td><td><strong>YES</strong></td><td>View machine diagnostics window</td></tr>
<tr><td>ViewPickLists</td><td><strong>YES</strong></td><td><strong>YES</strong></td><td>NO</td><td><strong>YES</strong></td><td>View picklists (type of production)</td></tr>
<tr><td>ManagePickLists</td><td><strong>YES</strong></td><td>NO</td><td>NO</td><td><strong>YES</strong></td><td>Same as above + create new picklists, start picklists and delete picklists</td></tr>
<tr><td>ViewBatteryLevels</td><td><strong>YES</strong></td><td><strong>YES</strong></td><td>NO</td><td><strong>YES</strong></td><td>View battery levels window</td></tr>
<tr><td>ManageBatteryLevels</td><td><strong>YES</strong></td><td>NO</td><td>NO</td><td><strong>YES</strong></td><td>Same as above + manually command charge and manually set battery level</td></tr>
<tr><td>ViewWaypoints</td><td><strong>YES</strong></td><td><strong>YES</strong></td><td>NO</td><td><strong>YES</strong></td><td>Access waypoints tab</td></tr>
<tr><td>ViewOwnRights</td><td><strong>YES</strong></td><td><strong>YES</strong></td><td>NO</td><td><strong>YES</strong></td><td>View what rights this User has</td></tr>
<tr><td>ViewDownloadManager</td><td><strong>YES</strong></td><td><strong>YES</strong></td><td>NO</td><td><strong>YES</strong></td><td>Open Download Manager to download logfiles</td></tr>
<tr><td>ViewCouplingDialog</td><td>NO</td><td>NO</td><td>NO</td><td><strong>YES</strong></td><td>Open Coupling Drive dialog to command coupling manually</td></tr>
</tbody></table>
</div>
<h2 id="control-production"><a class="header" href="#control-production">Control production</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Rights</th><th>Operator</th><th>Production Manager</th><th>Guest</th><th>Admin</th><th>Explanation</th></tr></thead><tbody>
<tr><td>SelectMachine</td><td><strong>YES</strong></td><td><strong>YES</strong></td><td><strong>YES</strong></td><td><strong>YES</strong></td><td>Select machine</td></tr>
<tr><td>ManageResources</td><td><strong>YES</strong></td><td>NO</td><td>NO</td><td><strong>YES</strong></td><td>Edit resource types, create new resources, delete resources</td></tr>
<tr><td>ToggleIgnoreMESForLocation</td><td><strong>YES</strong></td><td>NO</td><td>NO</td><td><strong>YES</strong></td><td>Toggle whether MES is ignored for location</td></tr>
<tr><td>ForbidOrFreeWaypoint</td><td><strong>YES</strong></td><td>NO</td><td>NO</td><td><strong>YES</strong></td><td>Set waypoint forbidden or freed</td></tr>
<tr><td>EnableDisableSymbolicPoint</td><td><strong>YES</strong></td><td>NO</td><td>NO</td><td><strong>YES</strong></td><td>Enable or disable symbolic point</td></tr>
<tr><td>ControlHoldRelease</td><td><strong>YES</strong></td><td>NO</td><td>NO</td><td><strong>YES</strong></td><td>Release AGV from Hold</td></tr>
<tr><td>FSTOPALL</td><td><strong>YES</strong></td><td>NO</td><td>NO</td><td><strong>YES</strong></td><td>FSTOP every AGV at once</td></tr>
<tr><td>TakeMachineOutOrIntoProduction</td><td><strong>YES</strong></td><td>NO</td><td>NO</td><td><strong>YES</strong></td><td>Take machine into production or out of production</td></tr>
<tr><td>StartOrStopProduction</td><td><strong>YES</strong></td><td>NO</td><td>NO</td><td><strong>YES</strong></td><td>Start or stop production for all machines</td></tr>
<tr><td>ReleaseAnyWaypoint</td><td>NO</td><td>NO</td><td>NO</td><td><strong>YES</strong></td><td>Allows user to release any waypoint</td></tr>
<tr><td>StartOrStopProductionBreak</td><td>NO</td><td>NO</td><td>NO</td><td><strong>YES</strong></td><td>Allows user to start the production break</td></tr>
<tr><td>SleepAllMachines</td><td>NO</td><td>NO</td><td>NO</td><td><strong>YES</strong></td><td>Allows user to set all machines into sleep mode</td></tr>
</tbody></table>
</div>
<h2 id="machine-commands-override"><a class="header" href="#machine-commands-override">Machine commands override</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Rights</th><th>Operator</th><th>Production Manager</th><th>Guest</th><th>Admin</th><th>Explanation</th></tr></thead><tbody>
<tr><td>OverrideFullControlOfMachine</td><td><strong>YES</strong></td><td>NO</td><td>NO</td><td><strong>YES</strong></td><td>Read below</td></tr>
</tbody></table>
</div>
<h2 id="individual-machine-commands"><a class="header" href="#individual-machine-commands">Individual machine commands</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Rights</th><th>Operator</th><th>Production Manager</th><th>Guest</th><th>Admin</th><th>Explanation</th></tr></thead><tbody>
<tr><td>FSTOPMachine</td><td><strong>YES</strong></td><td>NO</td><td>NO</td><td><strong>YES</strong></td><td>FSTOP a single machine</td></tr>
<tr><td>GiveGOTOCommand</td><td><strong>YES</strong></td><td>NO</td><td>NO</td><td><strong>YES</strong></td><td>Give GOTO order to machine</td></tr>
<tr><td>InitializeMachinePosition</td><td><strong>YES</strong></td><td>NO</td><td>NO</td><td><strong>YES</strong></td><td>Initialize machine position</td></tr>
<tr><td>GiveReturnToRouteCommand</td><td><strong>YES</strong></td><td>NO</td><td>NO</td><td><strong>YES</strong></td><td>Give return to route command</td></tr>
<tr><td>GiveLoadUnloadCommand</td><td><strong>YES</strong></td><td>NO</td><td>NO</td><td><strong>YES</strong></td><td>Command AGV to Load or Unload manually</td></tr>
<tr><td>EnableDisableMachine</td><td><strong>YES</strong></td><td>NO</td><td>NO</td><td><strong>YES</strong></td><td>Enable or disable AGV</td></tr>
<tr><td>AbortMachineTask</td><td><strong>YES</strong></td><td>NO</td><td>NO</td><td><strong>YES</strong></td><td>Abort current machine Task</td></tr>
<tr><td>SleepMachine</td><td>NO</td><td>NO</td><td>NO</td><td><strong>YES</strong></td><td>Command single AGV to sleep mode</td></tr>
</tbody></table>
</div>
<h2 id="configuration-1"><a class="header" href="#configuration-1">Configuration</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Rights</th><th>Operator</th><th>Production Manager</th><th>Guest</th><th>Admin</th><th>Explanation</th></tr></thead><tbody>
<tr><td>ManageClientSettings</td><td><strong>YES</strong></td><td><strong>YES</strong></td><td><strong>YES</strong></td><td><strong>YES</strong></td><td>Change Client settings. Due to technical constraints this has to be always enabled for now.</td></tr>
<tr><td>ManageServerSettings</td><td>NO</td><td>NO</td><td>NO</td><td><strong>YES</strong></td><td>Change certain server settings</td></tr>
<tr><td>ManageUsers</td><td>NO</td><td>NO</td><td>NO</td><td><strong>YES</strong></td><td>Create, delete and modify users</td></tr>
<tr><td>ConfigureActiveDirectory</td><td>NO</td><td>NO</td><td>NO</td><td><strong>YES</strong></td><td>Requires ManageUsers to function. Map Active Directory Group to Navithor role</td></tr>
<tr><td>ManageAreaFiles</td><td>NO</td><td>NO</td><td>NO</td><td><strong>YES</strong></td><td>Manually upload area files, reload production area files, change active files</td></tr>
<tr><td>ManageParameters</td><td>NO</td><td>NO</td><td>NO</td><td><strong>YES</strong></td><td>Change server parameter</td></tr>
<tr><td>ManageMachineConfiguration</td><td>NO</td><td>NO</td><td>NO</td><td><strong>YES</strong></td><td>Create, delete machines. Configure IP addresses. Also possible to enable/disable machines</td></tr>
<tr><td>ManageServerLogFiles</td><td>NO</td><td>NO</td><td>NO</td><td><strong>YES</strong></td><td>Get full access for all log and production files in Download Manager</td></tr>
</tbody></table>
</div>
<h2 id="cross-effect-from-rights"><a class="header" href="#cross-effect-from-rights">Cross-effect from rights</a></h2>
<p>To access functionality provided by certain rights, the user also needs access to that specific user interface. This access is automatically granted.</p>
<div class="table-wrapper"><table><thead><tr><th>Enabled rights</th><th>Also grants</th></tr></thead><tbody>
<tr><td>Admin</td><td>Everything</td></tr>
<tr><td>CommandMachineFull</td><td>FSTOPMachine</td></tr>
<tr><td>CommandMachineFull</td><td>GiveGOTOCommand</td></tr>
<tr><td>CommandMachineFull</td><td>InitializeMachinePosition</td></tr>
<tr><td>CommandMachineFull</td><td>GiveReturnToRouteCommand</td></tr>
<tr><td>CommandMachineFull</td><td>GiveLoadUnloadCommand</td></tr>
<tr><td>CommandMachineFull</td><td>AbortMachineTask</td></tr>
<tr><td>CommandMachineFull</td><td>FSTOPMachine</td></tr>
<tr><td>CommandMachineFull</td><td>SelectMachine</td></tr>
<tr><td>CommandMachineFull</td><td>SleepMachine</td></tr>
<tr><td>FSTOPMachine</td><td>SelectMachine</td></tr>
<tr><td>GiveGOTOCommand</td><td>SelectMachine</td></tr>
<tr><td>InitializeMachinePosition</td><td>SelectMachine</td></tr>
<tr><td>GiveReturnToRouteCommand</td><td>SelectMachine</td></tr>
<tr><td>GiveLoadUnloadCommand</td><td>SelectMachine</td></tr>
<tr><td>AbortMachineTask</td><td>SelectMachine</td></tr>
<tr><td>ReleaseAnyWaypoint</td><td>ViewWaypoints</td></tr>
<tr><td>ReleaseAnyWaypoint</td><td>ManageForbiddenWaypoints</td></tr>
<tr><td>ManageForbiddenWaypoints</td><td>ViewWaypoints</td></tr>
<tr><td>ManageServerLogFiles</td><td>ViewDownloadManager</td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="symbolic-point-groups"><a class="header" href="#symbolic-point-groups">Symbolic Point Groups</a></h1>
<p>This document contains information on symbolic point groups.</p>
<p>Updated 15.12.2020</p>
<h2 id="version-history-19"><a class="header" href="#version-history-19">Version History</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Version</th><th>Date</th><th>Author</th><th>Description</th></tr></thead><tbody>
<tr><td>1.0</td><td>25.09.2018</td><td>Joni Sundholm</td><td>First version.</td></tr>
<tr><td>1.1</td><td>15.12.2020</td><td>Evgenii Kuzminskii</td><td>Added chapter &quot;Interaction with symbolic point groups&quot;.</td></tr>
<tr><td>1.2</td><td>11.06.2021</td><td>Aleksi Ålander</td><td>Renamed title</td></tr>
</tbody></table>
</div>
<hr />
<h2 id="introduction-11"><a class="header" href="#introduction-11">Introduction</a></h2>
<p>Symbolic point groups were created to allow giving transfer requests
from and to a group of symbolic points through MES. Giving an order sets
the allowed load and unload locations for the request, and then Navithor
selects the best unload location based on unload location assign rules
as usual.</p>
<h2 id="managing-symbolic-point-groups"><a class="header" href="#managing-symbolic-point-groups">Managing Symbolic Point Groups</a></h2>
<p>Symbolic point groups can be added in Navithor tools. When creating a
group, it must be given a unique Name and ID. They can be easily managed
by selecting the group you wish to manage and then adding or removing
points by selecting the desired mode and then clicking on symbolic
points. The selected group is visualized by a blue circle around the
members of the group as shown in figure <strong>Managing symbolic point groups</strong>.</p>
<p><img src="Images/symbolicPointGroups/image3.png" alt="" /></p>
<blockquote>
<p>Managing symbolic point groups</p>
</blockquote>
<h2 id="interaction-with-symbolic-point-groups"><a class="header" href="#interaction-with-symbolic-point-groups">Interaction with symbolic point groups</a></h2>
<p>Symbolic point grouping is commonly used in combination with buffer lanes. There are several ways of interaction with symbolic point groups:</p>
<ul>
<li>
<p>Production to a symbolic point group is signaled with <strong>TransferRequest</strong> message (ID 21) in MES interface.</p>
<p>The message has two optional fields <strong>PickupIDType</strong> and <strong>TargetIDType</strong> (supported in Navithor version 2.1.0.0 and later) which define whether the order is given to a single symbolic point or to a group of symbolic points.</p>
<p>If transfer request is given for a group of symbolic points, Navithor checks the status of all symbolic points in this group and chooses one of them that is available as the order end location. Navithor can still later change the final end location within this group, if the statuses change.</p>
</li>
<li>
<p>MES can change the resources at symbolic point group or set the symbolic points in a group disabled/enabled with <strong>SetSymbolicPointGroupStatus</strong> message (ID 34).</p>
</li>
<li>
<p>Navithor reports a group status to MES with <strong>SymbolicPointGroupStatus</strong> message (ID 324).</p>
</li>
<li>
<p>MES can request a setup of symbolic point group with <strong>GetSymbolicPointGroupSetup</strong> message (ID 47). And Navithor responds with <strong>SymbolicPointGroupSetup</strong> message (ID 332) in this case.</p>
</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="resource-handling"><a class="header" href="#resource-handling">Resource handling</a></h1>
<p>This document contains information on resource handling in fleet control.</p>
<p>Updated 16.06.2021</p>
<h2 id="version-history-20"><a class="header" href="#version-history-20">Version History</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Version</th><th>Date</th><th>Author</th><th>Change</th></tr></thead><tbody>
<tr><td>1.0</td><td>31.01.2020</td><td>Tommi Kärki</td><td>Document created</td></tr>
<tr><td>1.1</td><td>11.06.2021</td><td>Aleksi Ålander</td><td>Added short description for quantity</td></tr>
<tr><td>1.2</td><td>16.06.2021</td><td>Elena Sgonova</td><td>Changed images sizes. Fixed image path</td></tr>
</tbody></table>
</div>
<hr />
<h2 id="introduction-12"><a class="header" href="#introduction-12">Introduction</a></h2>
<h2 id="glossary-1"><a class="header" href="#glossary-1">Glossary</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Term</th><th>Explanation</th></tr></thead><tbody>
<tr><td>ResourceContainer</td><td>Abstraction for Container to store resource objects inside. Each symbolic point and AGV has one.</td></tr>
<tr><td>ResourceContainerType</td><td>Type of resource container. Currently <strong>MultiResourceContainer</strong> (allow multiple resource objects), <strong>SingleResourceContainer</strong> (allow single resource object), and <strong>BufferResourceContainer</strong> (see Using buffer lanes documentation) are implemented.</td></tr>
<tr><td>Resource object</td><td>Abstraction to represent a single resource object. This can be for example pallet, apple crate or anything that can be transferred.</td></tr>
<tr><td>Resource slot</td><td>Each resource object takes a single slot inside ResourceContainer.</td></tr>
<tr><td>Resource quantity</td><td>Internal quantity for resource object. If all resources in the stack are identical, quantity bigger than 1 can be used instead of generating multiple unique resources.</td></tr>
<tr><td>Load capacity</td><td>How many resources of given Type are allowed at once onboard AGV or Symbolic Point</td></tr>
<tr><td>TakeMode</td><td>Configuration from which slot of Resource Container do we take resource object from. ie. Top/Bottom</td></tr>
<tr><td>AddMode</td><td>Configuration for which slot in Resource Container we add resource object to. ie. Top/Bottom</td></tr>
</tbody></table>
</div>
<h2 id="configuring-container"><a class="header" href="#configuring-container">Configuring container</a></h2>
<p>Container has a wide support for different configurations and picking a correct configuration is important. Correct configuration depends on usage scenario, below is an outline of difference scenarios.</p>
<h3 id="configuring-container-as-stack"><a class="header" href="#configuring-container-as-stack">Configuring Container as Stack</a></h3>
<p>Stack type container can be used, when resources are stacked on top of each other. The stack can be, for example, empty marked space on the floor or somewhere else that follows First In - Last Out principle.</p>
<p><img src="./Images/ResourceHandling/pallets_empty.png" alt="" /></p>
<blockquote>
<p>Empty location where pallets can be stacked</p>
</blockquote>
<p><img src="./Images/ResourceHandling/pallets_filled.png" alt="" /></p>
<blockquote>
<p>Pallets stacked at location</p>
</blockquote>
<p>Configuration:</p>
<ul>
<li>ContainerType: MultiResourceContainer</li>
<li>StackMode: Always</li>
<li>Slots: Number of resource objects which can be stacked.</li>
<li>AddMode: Top</li>
<li>TakeMode: Top</li>
</ul>
<p>or</p>
<ul>
<li>AddMode: Bottom</li>
<li>TakeMode: Bottom</li>
</ul>
<h3 id="configuring-container-as-queue"><a class="header" href="#configuring-container-as-queue">Configuring Container as Queue</a></h3>
<p>The queue type container should be used when resources are moved in the container like they would be in queue.</p>
<p><img src="./Images/ResourceHandling/config_queue.png" alt="" /></p>
<p>Configuration:</p>
<ul>
<li>ContainerType: MultiResourceContainer</li>
<li>StackMode: Always</li>
<li>Slots: Depending how long queue will be.</li>
<li>AddMode: Top</li>
<li>TakeMode: Bottom</li>
</ul>
<p>or</p>
<ul>
<li>AddMode: Bottom</li>
<li>TakeMode: Top</li>
</ul>
<h3 id="configuring-container-as-single-only-single-resource-object-on-container"><a class="header" href="#configuring-container-as-single-only-single-resource-object-on-container">Configuring container as Single (only single resource object on container)</a></h3>
<p>Single container can be used when no multiple resources can be fit in the same container.</p>
<p>Configuration #1:</p>
<ul>
<li>ContainerType: SingleResourceContainer</li>
<li>StackMode: Always or Never</li>
<li>Slots: Ignored for SingleResourceContainer</li>
<li>AddMode: Top or Bottom</li>
<li>TakeMode: Top or Bottom</li>
</ul>
<p>Configuration #2 (recommended):</p>
<ul>
<li>ContainerType: MultiResourceContainer</li>
<li>StackMode: Never</li>
<li>Slots: 1</li>
<li>AddMode: Top or Bottom</li>
<li>TakeMode: Top or bottom</li>
</ul>
<h3 id="configuring-container-as-takefromany"><a class="header" href="#configuring-container-as-takefromany">Configuring container as TakeFromAny</a></h3>
<p>This container type can be used when all different resource types have their own slot.</p>
<p><strong>Note</strong>: This container type is not supported by AGV's.</p>
<p><img src="./Images/ResourceHandling/config_takeFromAny.png" alt="" /></p>
<p>Configuration:</p>
<ul>
<li>ContainerType: MultiResourceContainer</li>
<li>StackMode: Always</li>
<li>Slots: Depends on how many resource types allowed</li>
<li>AddMode: Top or bottom</li>
<li>TakeMode: FromAny</li>
</ul>
<h3 id="configuring-container-as-combinesametype"><a class="header" href="#configuring-container-as-combinesametype">Configuring Container as CombineSameType</a></h3>
<p>Combines same resource types in the same slot.</p>
<p><strong>Note:</strong> This container type is not recommended.</p>
<p>Configuration:</p>
<ul>
<li>ContainerType: MultiResourceContainer</li>
<li>StackMode: CombineSameType</li>
<li>Slots: Depends on how many resource types allowed</li>
<li>AddMode: Top or bottom</li>
<li>TakeMode: FromAny or Top or Bottom</li>
</ul>
<h3 id="configuring-container-with-internal-quantity"><a class="header" href="#configuring-container-with-internal-quantity">Configuring container with internal quantity</a></h3>
<p>Container with internal quantity can be used, when resource object is actually container for something else, and container should not track objects inside container. For example crates containing other items.</p>
<p><strong>Note</strong>: this configuration disabled individual tracking of items inside container and assumes container is built-in to AGV. This can cause multiple resource objects to be generated when splitting.</p>
<p>Internal quantities are supported in all configurations. Quantity is specified when communicating via MES interface or manually from Navithor Client.</p>
<p>When using internal quantity it's important to configure Load Capacity for Machine type(s) and Symbolic Points.</p>
<h2 id="resource-objects-vs-internal-quantity"><a class="header" href="#resource-objects-vs-internal-quantity">Resource objects VS internal quantity</a></h2>
<p>Main difference comes from tracking. Navithor will keep track of each resource object closely while internal quantity will generate new resource objects complicating tracking.</p>
<h2 id="additional-features"><a class="header" href="#additional-features">Additional features</a></h2>
<h3 id="permanent-resources"><a class="header" href="#permanent-resources">Permanent resources</a></h3>
<blockquote>
<p>Parameter: <code>ResourceManager_PermanentResources</code></p>
</blockquote>
<blockquote>
<p>Related parameters:</p>
<ul>
<li><code>ResourceManager_PermanentResourceAlarmValidityTime</code></li>
</ul>
</blockquote>
<p>This feature makes all resource objects permanent and undeleteable. This only makes sense we are transferring same physical object between locations.</p>
<h3 id="lingering-resources"><a class="header" href="#lingering-resources">Lingering resources</a></h3>
<blockquote>
<p>Parameter: <code>ResourceManager_ResourceLingeringTime</code></p>
</blockquote>
<p>This feature makes resources linger at location for a certain period of time after deletion. Main use of this when location has sensors that detect when resource is lifted up and send signal &quot;no resource at location&quot; to Navithor before AGV Loading is actually completed. This prevents situation where AGV reports loading is completed but Location is emptied during loading. If parameter is enabled the AGV will load Resource object that used to be there.</p>
<h3 id="overriding-duplicate-resources-when-unloading"><a class="header" href="#overriding-duplicate-resources-when-unloading">Overriding duplicate resources when unloading</a></h3>
<blockquote>
<p>Parameter: <code>MachineUnloadCompletionOverridesIdenticalAtTarget</code></p>
</blockquote>
<p>This feature will override resource object at target when unload is completed if resource object at target is of same type. Purpose of this parameter is similar to Lingering resources, Navithor receives a signal that resources are at location before unload is completed.</p>
<h3 id="stack-unload--load"><a class="header" href="#stack-unload--load">Stack unload / load</a></h3>
<blockquote>
<p>Parameter: <code>ResourceManager_OverrideUnloadResourceAlwaysMovesEntireStack</code></p>
</blockquote>
<blockquote>
<p>Parameter: <code>ResourceManager_OverrideLoadResourceAlwaysMovesEntireStack</code></p>
</blockquote>
<p>This feature overrides default loading / unloading behaviour to always load / unload all resource objects instead of single object.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="hold-release-reasoning-and-production-order-lists"><a class="header" href="#hold-release-reasoning-and-production-order-lists">Hold-Release reasoning and production order lists</a></h1>
<p>This document contains an overview of hold release reasoning and production order lists.</p>
<p>Updated 18.01.2022</p>
<h2 id="version-history-21"><a class="header" href="#version-history-21">Version History</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Version</th><th>Date</th><th>Author</th><th>Change</th></tr></thead><tbody>
<tr><td>1.0</td><td>16.10.2020</td><td>Antti Parkkonen</td><td>Document created</td></tr>
<tr><td>1.1</td><td>18.02.2021</td><td>Simon Clement</td><td>Document reviewed and updated reflecting Navithor version 2.21.0.0. Added part related to resource based hold-release logic and linking of production order lists.</td></tr>
<tr><td>1.2</td><td>12.03.2021</td><td>Simon Clement</td><td>Add note about not being able to edit and delete templates with activated lists</td></tr>
<tr><td>1.3</td><td>12.10.2021</td><td>Benard Gathimba</td><td>Minor document changes for clarification</td></tr>
<tr><td>1.4</td><td>18.01.2022</td><td>Tero Laakso-Pitkäkoski</td><td>Add clarifications to Production Order List modes 12 and 14</td></tr>
</tbody></table>
</div>
<hr />
<h2 id="hold-release-reasoning-1"><a class="header" href="#hold-release-reasoning-1">Hold release reasoning</a></h2>
<h3 id="overview"><a class="header" href="#overview">Overview</a></h3>
<p>In 'Hold release reasoning' production, the symbolic points are defined as hold-locations with rules of where it is allowed to go from the location. The figure below shows the hold-rules in Navithor Tools.</p>
<p><img src="./Images/media/image14.png" alt="" /></p>
<p>Defining hold-rules in Navithor Tools. Tick 'Enable hold state at symbolic point'-check box to set the symbolic point as a Hold-location. At least 'Default destination' must be defined for a Hold-location and other selections are optional.</p>
<p>From the above picture, we can see that symbolic point (429) has two Hold-Release destinations, (130) and (158). By default, the AGV will drive to (130) when released from Hold at this location. But if (130) is unavailable for any reason, the AGV will be ordered to drive to (158) instead.</p>
<p><img src="./Images/media/agvcandrivethroughstop.png" alt="" /></p>
<p>By default, AGV's are allowed to drive through all locations to reach their target without going to HOLD-state unless driving past a StopAndHold location. In the figure above, the AGV would be allowed to drive through (5) to reach its destination (1). Defining (5) as StopAndHold instead of Hold location would force the AGV to stop and transition to HOLD-state when driving through. It is also possible to add a penalty for driving through Hold-Locations.</p>
<p>The AGV will then remain in HOLD-state until the state is released from specific inputs. Inputs can be:</p>
<div class="table-wrapper"><table><thead><tr><th>Input source</th><th>Description</th></tr></thead><tbody>
<tr><td>Button</td><td>Press on AGV - UI onboard shows possible destinations from current location (maximum of 4 defined destinations) or physical buttons (e.g. 'Next', 'Alternative1', 'Alternative2', 'Alternative3'). Since Navithor version 1.6.2.0 it is possible to release HOLD-state to any of the symbolic points in the production area. i.e. destinations are not limited to 4.</td></tr>
<tr><td>Timer</td><td>If timer is enabled AGV can release HOLD-state by itself. Timer triggers the default destination.</td></tr>
<tr><td>MES</td><td>External release (e.g. panel at work station near symbolic point).</td></tr>
<tr><td>Navithor Client</td><td>User can send hold release commands from the Symbolic Point Status-form when an AGV executes hold-task at the symbolic point (Client v. 1.5.1.0 onwards).</td></tr>
</tbody></table>
</div>
<p><img src="./Images/media/HoldNoAGVAtSymbol.png" alt="" /></p>
<p>Hold Symbolic Point with no AGV at the location. Symbolic Point (9) is configured as the default destination. The default destination is highlighted (when hovering over the Symbolic Point, optional setting on Client).</p>
<p><img src="./Images/media/HoldAGVAtSymbol.png" alt="" /></p>
<p>Hold Symbolic Point with AGV at the location. Symbolic Point(8) is configured as the default destination. Symbolic Point (7) is configured as the first alternative destination.</p>
<p>When the AGV is commanded to drive to any Symbolic Point with Hold enabled, it will go to HOLD-state. In the above picture(s) SteerDrive1 is waiting for ReleaseHold signal from any source. After receiving a signal, the AGV will drive to the next target:</p>
<div class="table-wrapper"><table><thead><tr><th>Signal</th><th>Target</th><th>Symbolic Point</th></tr></thead><tbody>
<tr><td>Release</td><td>Default</td><td>(8)</td></tr>
<tr><td>Release with timer</td><td>Default</td><td>(8)</td></tr>
<tr><td>Release Alt1</td><td>Alt1</td><td>(7)</td></tr>
<tr><td>Release Custom</td><td>Custom</td><td>Given with signal</td></tr>
</tbody></table>
</div>
<p>Hold release production also supports loading and unloading. This can be enabled by setting the parameter <strong>ProductionManager_PerformLoadOrUnloadAtSymPointWhenArrivingWithOrderRule</strong> to <em>True</em> (this is also the default value). This requires Symbolic Points to be of Load or Unload type instead of Stop type. With these settings, when AGV arrives at Symbolic Point, it will perform a Load or Unload task before going into HOLD-state.</p>
<div class="table-wrapper"><table><thead><tr><th>Symbolic Point type</th><th>Result</th></tr></thead><tbody>
<tr><td>Stop</td><td>Stop does not support Load/Unload. AGV will go to HOLD-state without loading or unloading</td></tr>
<tr><td>Load</td><td>AGV will perform Load-task and transition to HOLD-state after finishing.</td></tr>
<tr><td>Unload</td><td>AGV will perform Unload-task and transition to HOLD-state after finishing.</td></tr>
<tr><td>LoadUnload</td><td>AGV will perform the correct operation based on the resource onboard info. Always Unload-task if AGV has resources and Load-task if AGV is empty</td></tr>
</tbody></table>
</div>
<p>Running production by Hold release reasoning makes it possible to have a fully operable production system without the need for external signals (i.e. PLC). Hold release reasoning is good for production environments where AGVs run production in loop(s) with predetermined locations to stop at.</p>
<h3 id="resource-related-checks-after-releasing-hold-state"><a class="header" href="#resource-related-checks-after-releasing-hold-state">Resource-related checks after releasing HOLD-state</a></h3>
<p>The parameter <strong>MissionManager_HoldReleaseRules</strong> can be used to make resource-related checks after HOLD-state has been released.
Multiple values can be enabled and they will have the following effects:</p>
<div class="table-wrapper"><table><thead><tr><th>Parameter flag</th><th>Result when AGV is released from HOLD</th></tr></thead><tbody>
<tr><td>UnhandledOrderRequired</td><td>If there is an unhandled order at the location, the AGV will deliver that resource to the hold release target. Otherwise the AGV will leave empty.</td></tr>
<tr><td>ResumeHoldIfNoPickupReq</td><td>The AGV will resume hold in case there is no valid unhandled order and <strong>UnhandledOrderRequired</strong>  is true.</td></tr>
<tr><td>UnloadingToPickupLocAllowed</td><td>AGV is allowed to unload a resource to the location where the resource was picked up from. This can be necessary in case the AGV picks up a resource, drives a loop and comes back to the pickup location with the resource.</td></tr>
</tbody></table>
</div>
<p>Note that the parameter <strong>MissionManager_CheckResourceTranferAfterHoldRelease</strong> needs to be true for <strong>UnhandledOrderRequired</strong> and <strong>ResumeHoldIfNoPickupReq</strong> to take effect.</p>
<h3 id="custom-hold-release-target-1"><a class="header" href="#custom-hold-release-target-1">Custom hold release target</a></h3>
<p>An AGV can be released from HOLD-state to any symbolic point in the production area. When released the default and possible alternative destinations of the current symbolic point are ignored. Releasing to a custom destination is supported in MES-interface and in Navitrol's AGV
supervisor interface.</p>
<h3 id="charging-requests-from-hold-rules-1"><a class="header" href="#charging-requests-from-hold-rules-1">Charging requests from Hold-rules</a></h3>
<p>In some production systems, AGVs should only be sent to a charger after the AGV completes a specific part of the production. Navithor can be set to generate charging requests based on hold rules only by setting the parameter <strong>MissionManager_GenerateChargingRequestsFromHoldRulesOnly_Rule</strong> to true.
With this enabled a symbolic point with a charging location as an alternative destination can be set to trigger charging requests if charging is needed.</p>
<p>When an AGV is released from a symbolic point to the default destination, and the symbolic point also has a charging location as an alternative destination, Navithor will act as follows:</p>
<ul>
<li>If charging is needed, Navithor generates a charging request for the AGV and sends it to a free charger near the actual alternative target of the symbolic point.</li>
<li>A production order is also generated to the default destination of the  symbolic point so that the actual release target stays in memory</li>
<li>If the system parameter <strong>MissionManager_PassProductionOrderToAnotherMachineWhenGoingToCharge_Rule</strong> is set to <em>True</em> the order is generated for another AGV that is charging and does not have any orders to perform. If no valid AGV is found the order is generated for the AGV itself.</li>
<li>The generated production order is then executed when the AGV in the charger (production order passed to another) or the AGV going to the charger is charged.</li>
</ul>
<h3 id="mes-messages-related-to-the-hold-release-reasoning"><a class="header" href="#mes-messages-related-to-the-hold-release-reasoning">MES messages related to the hold release reasoning</a></h3>
<p>See more detailed explanations from the document  Communication specification between Navithor and MES.</p>
<h4 id="releasehold-id--18"><a class="header" href="#releasehold-id--18">ReleaseHold (ID = 18)</a></h4>
<p>Sending this message will trigger Navithor to release a machine in the Symbolic Point from HOLD-state and generate a production order for the machine to the specified target location.</p>
<h4 id="releaseholdtocustomtarget-id--29"><a class="header" href="#releaseholdtocustomtarget-id--29">ReleaseHoldToCustomTarget (ID = 29)</a></h4>
<p>Sending this message will trigger Navithor to release a machine in the Symbolic Point from HOLD-state and generate a production order for the machine to a custom target location, which is given in the message.</p>
<hr />
<h2 id="production-order-lists-1"><a class="header" href="#production-order-lists-1">Production order lists</a></h2>
<p>In some production systems, the AGVs need to drive different production loops and stop at symbolic points along the route. The symbolic points may be shared among different routes, but the following destination from a symbolic point depends on the route given to the AGV. In this case it is not possible to use fixed hold destinations. Triggering custom hold release targets can be automated with Production Order Lists.</p>
<p>The different driving routes can be generated into production order list templates saved in the database. One list contains a set of symbolic points that must be reached in the correct order. A template can be activated either from the MES-interface, Navitrol or from Navithor Client. The activated list is then assigned to an AGV waiting for production at a waiting location. A production order to the first location in the production order list is generated, and the AGV will be ordered to drive there. When arriving at the first target location, the AGV may perform loading/unloading operations if configured to do so and then the AGV is ordered to HOLD-state. When released to default destination, the destination is picked from the production order list.</p>
<h3 id="configuring-the-production-area"><a class="header" href="#configuring-the-production-area">Configuring the production area</a></h3>
<p>The following configurations to the production area are required when using production order lists:</p>
<ul>
<li>
<p>Waiting locations should not be defined as Hold-locations -- Production order lists are only assigned to AGVs that do not have anything to do</p>
</li>
<li>
<p>Activate production order list-production by setting system parameter <strong>ProductionManager_POL_LIST_RULE_MODE</strong> to:</p>
<ul>
<li>
<p>1 = Activated lists are assigned to machines at any waiting location</p>
<ul>
<li>
<p>All locations in the production order list must be HOLD-locations except the last location.</p>
</li>
<li>
<p>The last location does not need to be a HOLD-location. Thus the last location can be e.g:</p>
<ul>
<li>A waiting location where it can wait for the next activation of any production order list.</li>
<li>A stopping location without hold-definitions – Navithor will then try to send the vehicle to one of the defined waiting location.</li>
</ul>
</li>
<li>
<p>Navithor assigns an activated list to a machine that is waiting for orders in a waiting location.</p>
</li>
</ul>
</li>
<li>
<p>12 = The activated list is assigned to a machine that is waiting at the first destination of the activated list</p>
<ul>
<li>
<p>The first destination in the production order list must be a waiting location (not a hold location).</p>
</li>
<li>
<p>The last destination in the production order list must also be a waiting location (Normally the first and last destinations are the same).</p>
</li>
<li>
<p>All other locations in the production order list must be HOLD-locations.</p>
</li>
<li>
<p>Navithor assigns the activated list to a machine that is at the first destination of the production order list.</p>
</li>
<li>
<p>The vehicle with the assigned list must be carrying a resource before starting the list execution.</p>
</li>
<li>
<p>The vehicle executing the list will reserve the location as long as it executes the list. If the list does not end up in different waiting location then the vehicle will return to the same waiting location after completing the list.</p>
</li>
<li>
<p>If an AGV finds itself slipped past the next target in its production order list, it will mark the location as reached and continue on to the next location in the list.</p>
</li>
</ul>
</li>
<li>
<p>14 = Same effects as <strong>ProductionManager_POL_LIST_RULE_MODE</strong> 12 with a few exceptions</p>
<ul>
<li>
<p>The AGV will not mark a location as reached if it has slipped past it. It will instead drive to the same location again.</p>
</li>
<li>
<p>The vehicle is not required to carry a resource to start the list execution.</p>
</li>
</ul>
</li>
<li>
<p>0 = Production order list-production is disabled. Hold-release reasoning is activated.</p>
</li>
</ul>
</li>
</ul>
<p><strong>When production order list-production is active hold-release reasoning-production is disabled thus using default or an alternative destination is not possible.</strong></p>
<h3 id="creating-and-managing-production-order-lists"><a class="header" href="#creating-and-managing-production-order-lists">Creating and managing Production Order Lists</a></h3>
<p><img src="./Images/ProductionOrderLists/CreatingAndManagingPOLs.png" alt="" /></p>
<p>New templates can be created in Navithor Client. Open the Production Order List view by selecting main menu item 'Views-&gt;Production Order List View'. This will open the view shown in the figure above.</p>
<p>A new template can then be created by clicking the 'Add new template'-button. A new control is added to the list of all templates[1]. Enter a describing name and either generate or set a valid id for the new template. A valid ID is a numeric id that is currently not in use. The production locations can be either selected from the drop down list or by clicking symbolic points in the Client’s main map view. When pressing the 'Save'-button the entered information for the template is sent to Navithor Server and it will create a new template for the production area and synchronize the information back to the Client(s). </p>
<p>Existing templates can be edited by pressing the 'Edit'-button or removed by pressing the 'Delete'-button. Activating a list can be done by pressing the 'Activate'-button [2]. To get the three buttons visible click the name and id box of the template [3]. A template cannot be edited or deleted if there are active production order lists based on that template.</p>
<p>Activated templates are listed in two groups: </p>
<ul>
<li>
<p>Active, not assigned [4] - This shows the production order lists that have been activated but has not yet been assigned for any vehicle. These lists are in priority order for assigning. Clicking the name panel for a not assigned list will reveal buttons for changing the priority (moving the control in the queue). </p>
</li>
<li>
<p>Active and assigned - This shows the lists that are being executed by vehicles. The current target for the vehicle is highlighted with a bright green box [5]. When an active list is cancelled or finished the control will change to disabled state. It will disappear from the view after 20 seconds [6].</p>
</li>
</ul>
<h3 id="production-order-lists-in-the-file-system"><a class="header" href="#production-order-lists-in-the-file-system">Production Order Lists in the file system</a></h3>
<p>Navithor creates reports from completed and cancelled production order lists. The main directory of Navithor Server contains a subfolder named ‘Picklists’. Under this folder the following four directories are found:</p>
<ul>
<li>templates
<ul>
<li>Whenever templates are edited, created or deleted a new template file is created to this folder</li>
<li>One file contains all templates that are in the system while the file was written</li>
</ul>
</li>
<li>reports
<ul>
<li>Contains text-files for each completed or cancelled production order list</li>
</ul>
</li>
<li>active
<ul>
<li>Contains text-files for currently active production order lists</li>
</ul>
</li>
<li>input
<ul>
<li>Navithor reads this folder periodically</li>
<li>Template-files (text-files found in the templates folder) can be dropped to this folder. Navithor will read the templates in and either update existing ones or create new ones if the same id was not found</li>
<li>The name of the file dropped to this folder must start with “Template” or “picklist”</li>
<li>A template will not be updated immediately If it has active production order lists when a file is added to the folder. It will first be updated when all activated lists related to the template have finished execution. The file will get the prefix &quot;PENDING_&quot; to show that it will be processed later</li>
</ul>
</li>
</ul>
<h3 id="linking-production-order-lists"><a class="header" href="#linking-production-order-lists">Linking Production Order Lists</a></h3>
<p>It is possible to link multiple Production Order Lists together such that the completion of one list activates one or more other lists.</p>
<p>This feature is enabled by adding a folder in Navithor Server's main folder called 'Overrides' and add a text file 'POLLinks.txt' there.
In that file you create links between Production Order Lists by adding a line for each Production Order List that you want to link.</p>
<p>Example:</p>
<pre><code>1:2,3,4
2:3
</code></pre>
<p>If the 'POLLinks.txt' looks like the above example it will have the following effects:</p>
<ul>
<li>Whenever a Production Order List with template id 1 is completed, templates 2,3 and 4 are activated</li>
<li>Whenever a Production Order List with template id 2 gets completed, template 3 is activated</li>
</ul>
<p>The POLLinks.txt file is read by Navithor once every minute. When the config file has been read a file 'POLLinks_Active.txt' is automatically created in the 'Overrides'-folder. 
From here you can see which Production Order List links currently are active.</p>
<p>Note: With linking there is no way to assign a linked Production Order List to a specific AGV. The assigned AGV depends on the POL rule mode, how templates have been configured, and where waiting AGVs are located.</p>
<h3 id="mes-messages-related-to-production-order-lists"><a class="header" href="#mes-messages-related-to-production-order-lists">MES Messages related to production order lists</a></h3>
<p>See more detailed explanations from the document  Communication specification between Navithor and MES.</p>
<h4 id="requestproductionorderlisttemplates-id--23"><a class="header" href="#requestproductionorderlisttemplates-id--23">RequestProductionOrderListTemplates (ID = 23)</a></h4>
<p>MES can request current templates of production order lists with this message. Navithor replies with ProductionOrderListTemplateResult message.</p>
<p>Templates can be created/edited and deleted from Navithor Client. Templates are saved in Navithor database.</p>
<h4 id="activateproductionorderlist-id--22"><a class="header" href="#activateproductionorderlist-id--22">ActivateProductionOrderList (ID = 22)</a></h4>
<p>MES can activate a production order list by sending this message.</p>
<h4 id="cancelactiveproductionorderlist-id--28"><a class="header" href="#cancelactiveproductionorderlist-id--28">CancelActiveProductionOrderList (ID = 28)</a></h4>
<p>Sending this message will command Navithor cancel specified active production order list(s).</p>
<h4 id="productionorderlistactivatedresult-id--315"><a class="header" href="#productionorderlistactivatedresult-id--315">ProductionOrderListActivatedResult (ID = 315)</a></h4>
<p>Navithor replies to message ActivateProductionOrderList with this message.</p>
<h4 id="productionorderlistcompleted-id--316"><a class="header" href="#productionorderlistcompleted-id--316">ProductionOrderListCompleted (ID = 316)</a></h4>
<p>Navithor replies to message ActivateProductionOrderList with this message.</p>
<h4 id="activeproductionorderliststatus-id--317"><a class="header" href="#activeproductionorderliststatus-id--317">ActiveProductionOrderListStatus (ID = 317)</a></h4>
<p>This message is sent when changes in statuses are reported or periodically if no changes detected.</p>
<h4 id="productionorderlisttemplateresult-id--318"><a class="header" href="#productionorderlisttemplateresult-id--318">ProductionOrderListTemplateResult (ID = 318)</a></h4>
<p>This message is as a reply to RequestProductionOrderListTemplates.</p>
<h2 id="practical-examples"><a class="header" href="#practical-examples">Practical examples</a></h2>
<h3 id="hold-release"><a class="header" href="#hold-release">Hold release</a></h3>
<p>The most basic use case for hold release reasoning is a simple linear process where an AGV is loaded at the start of the process and then driven through various stopping points where workers or robots work on the loaded piece on top of the AGV. Finally, the AGV unloads the processed load at the end of the process. In the physical world, this process could be, for example, used to provide a more flexible alternative for a conveyor system.  Below is a simple example of such a scenario. The picture is taken from Navithor Tools.</p>
<p><img src="./Images/holdRelease/hold-release-simple-prod-area.png" alt="" /></p>
<p>In Navithor Tools, an area like this is configured so that all of the symbolic points are set up with hold enabled. For each symbolic point, the following stop is set as the default hold release destination. In the picture above the process starts at the wait load symbolic point, from which the AGVs are released to the load station. The load station is a load symbolic point which is required to make Navithor command load for the AGV as the AGV arrives at the symbolic point. After executing the load, the AGV goes into hold state. Release from the hold state will cause the AGV to drive to the first station. In the stations 1 to 4, the AGV stops, goes to hold state and waits until it is released before advancing in the process. All the stations are normal stop symbolic points, meaning that Navithor does not automatically perform any actions to the AGVs as they arrive. Finally, after the AGV has been released from Station 4, the AGV drives to the drop off station that's an unload symbolic point. Here Navithor commands the AGV to unload the load to this symbolic point.</p>
<p>The actual realisation of the described system on the shop floor could be as simple as a button to release the AGV on each station. After finishing work on the product, the worker would hit the button and release the AGV to the next location. Each press on the button would send a release hold MES message to Navithor with the specific station's ID and default target location as the data. If the stations were robot cells, robots or a middleware could be programmed to send the release hold message after the robot finishes its process.</p>
<p>To further automate the system, the load station, unload station, and the wait station could have timers for releasing the AGV. This timer could release the AGV from the load and unload stations immediately after finishing the task. The wait station could have a timer to release the AGVs in a suitable rhythm for the process.</p>
<p>The basic logic introduced above can be expanded further to move AGVs in the same manner in more complex scenarios as well. Using different release options, it's possible to release the AGVs to multiple different processes. An example of a more complex use case for hold release reasoning is shown in the picture below. In this case, also charging, maintenance area, and three different assembly lines are in the same area.</p>
<p><img src="./Images/holdRelease/hold-release-more-prod-area.png" alt="" /></p>
<h3 id="production-order-lists-2"><a class="header" href="#production-order-lists-2">Production order lists</a></h3>
<p>The above examples could also be run as production order lists. These two options overlap in the sense that almost all hold release cases thinkable could also be defined as production order lists. This stems from the fact that a production order list is a configurable override for hold release logic.</p>
<p>As described earlier in this document, a common use case for the production order lists is when AGVs drive multiple different fixed routes but start from common waiting locations. For example, in the area below, the AGVs have three different loading / unloading areas and a final unload area.</p>
<p><img src="./Images/holdRelease/pol-example.png" alt="" /></p>
<p>Depending on which product is worked on, the AGVs get production order lists to execute. An example of such a list could be that the AGV should drive to Station1A to pick up a load. From there the AGV would need to drive to Drop location and leave the load there, continue to Pick location and wait there until the load dropped off has gone through a manufacturing process. After this, the AGV picks up the load again and drives the load to Station1B for finishing. Unloading the load to Station1B finishes the production order list, and the AGV drives back to the waiting location to wait for further production order lists to be activated.</p>
<p>In each step of the process described above the AGV goes to hold state after performing the drive and the action defined by the symbolic point. The AGV always continues to the next location defined by the production order list after a release hold signal has been received. The release hold signal is used just as with the hold release logic, but the destination is always taken from the production order list and not from the logic defined in Tools.</p>
<p>The advantages of the production order lists over basic hold release are configurability without reuploading the area from Navithor Tools and better status messages. MES Clients can monitor the MES messages shown above to follow each production order list's status or cancel a production order list at any given moment.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="transfer-requests-2"><a class="header" href="#transfer-requests-2">Transfer requests</a></h1>
<p>This document contains an overview of using transfer requsts to move items on the shop floor</p>
<p>Updated 02.12.2020</p>
<h2 id="version-history-22"><a class="header" href="#version-history-22">Version History</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Version</th><th>Date</th><th>Author</th><th>Change</th></tr></thead><tbody>
<tr><td>1.0</td><td>16.10.2020</td><td>Antti Parkkonen</td><td>Document created</td></tr>
<tr><td>1.1</td><td>02.12.2020</td><td>Tommi Karki</td><td>Clarified how to set ProductionManager_CALCULATE_UNHANDLED_ORDERS_PRIORITIES_MODE</td></tr>
</tbody></table>
</div>
<hr />
<h2 id="transfer-requests-3"><a class="header" href="#transfer-requests-3">Transfer requests</a></h2>
<h3 id="overview-1"><a class="header" href="#overview-1">Overview</a></h3>
<p>Simply put transfer requests tell Navithor to move an item of certain type from a specific load symbolic point or group of load symbolic points to an unload symbolic point or group of unload symbolic points. The limitations to how items can be moved around on the shop floor are configured in Navithor Tools using allowed destinations, allowed resource types and routing. By default all locations are available destinations from all symbolic points and all resource types are allowed on all symbolic points. Transfer requests that conflict against the configuration or routing are accepted in Navithor, but they'll never get executed.</p>
<p>In Navithor Client the transfer requests are shown in the production orders view. When an AGV is assigned for the transfer request a production order is generated and shown in the production orders view.</p>
<p><img src="./Images/transferRequests/poView.png" alt="Production order view" /></p>
<p>Deleting a production order linked to a transfer request does not delete the transfer request. Instead the transfer request will generate another production order based on the current situation. However, deleting the transfer request deletes all production orders linked to the specific transfer request.</p>
<p>Charging checks for the AGVs are activated whenever the AGVs do not have any production orders. When an AGVV's battery level drops low enough (defined by a parameter), the AGV will be driven to a charger that is free. In case that no charging locations are available the AGV will continue executing production orders until a charger is free or until it the battery level drops to an alarm limit. After this the AGV will just wait for a charger to be freed. There are also rules that can force a certain percentage of the fleet to be always charging to avoid situations where too many AGVs would suddenly need charging simultaneously. Navithor prioritises charging AGVs with lowest battery levels first.</p>
<h3 id="tuning-an-area-for-transfer-requests"><a class="header" href="#tuning-an-area-for-transfer-requests">Tuning an area for transfer requests</a></h3>
<p>There are multiple ways to control how Navithor executes transfer requests and how Navithor reacts in different cases. The most common parameter changes are related to when an AGV is allowed to start execute a transfer request and how does the AGV react if it has already picked up an item but the transfer request is cancelled. In large environments it might also be required to limit how Navithor can select AGVs in different waiting locations to execute transfer requests. The most common parameters to tune and their descriptions are listed below.</p>
<h4 id="symbolicpoint_waitinglocation_link_targets_mode"><a class="header" href="#symbolicpoint_waitinglocation_link_targets_mode">SymbolicPoint_WAITINGLOCATION_LINK_TARGETS_MODE</a></h4>
<p>Has two different modes 0 and 1. Mode 1 is the default value and it  is recommended.</p>
<p>Mode 0 means that waiting locations are only linked to load and unload locations that are reacheble without driving through other waiting locations.</p>
<p>Mode 1 links all waiting locations to all load and unload locations that are connected in the route network.</p>
<h4 id="productionmanager_maxdisttovalidlocations"><a class="header" href="#productionmanager_maxdisttovalidlocations">ProductionManager_MaxDistToValidLocations</a></h4>
<p>Defines how far away Navithor can send an AGV from its current position to wait for production. This parameter affects only WaitLoad locations. </p>
<p>Default value is -1, which means that there is no limit. The distance is calculated along the route in meters.</p>
<h4 id="missionmanager_changewaittriggerrules"><a class="header" href="#missionmanager_changewaittriggerrules">MissionManager_ChangeWaitTriggerRules</a></h4>
<p>Modes that define if an AGV should change waiting location on some condition. Multiple conditions can be set on simultaneously</p>
<p>Default value is None. </p>
<h4 id="missionmanager_waitinglocationselectrule"><a class="header" href="#missionmanager_waitinglocationselectrule">MissionManager_WaitingLocationSelectRule</a></h4>
<p>Defines how Navithor decides to which waiting location an AGV drives to wait for production. Only one mode is on at a time.</p>
<p>Default value is FastestDriveTime. This means that Navithor selects the closest available waiting location for each AGV.</p>
<p>Other modes are:</p>
<p>CurrentAvailableFreeSlots, where Navithor selects the waiting locations based on available free slots. When this mode is on Navithor will try to balance the AGVs in the waiting locations where AGVs can form a queue. If all queues are equally long Navithor will choose the closest queue for the AGV.</p>
<p>LinkedLocationPriority, Navithor selects the AGV's next waiting location based on location priority.. Priorized waiting locations can be useful in small production areas. The mode is not suitable for large areas where driving distances are very long because Navithor does not consider driving times at all when this mode is on.</p>
<h4 id="productionmanager_calculate_unhandled_orders_priorities_mode"><a class="header" href="#productionmanager_calculate_unhandled_orders_priorities_mode">ProductionManager_CALCULATE_UNHANDLED_ORDERS_PRIORITIES_MODE</a></h4>
<p>Default is 1, (PriorityForFastestAGV). This parameter is configured as binary bitmask where each bit enables a feature. Add the numbers together to enable different options for unhandled order assign calculation.</p>
<ul>
<li>None = 0</li>
<li>PriorityForFastestAGV = 1</li>
<li>PriorizeLocsWithAvailableUnloads = 2</li>
<li>PriorizeLocsWithDiffAllowedUnloads = 4</li>
<li>ApplyHandlingToTransferRequests = 8</li>
<li>UnhandledOrdersActiveOnlyWithTransferReq = 16</li>
<li>IgnoreTargetLocationAvailability = 32</li>
<li>DisableOrderGenerationForResOnboard = 64</li>
<li>TargetLocationAvailabilityRequiredForTReqs = 128</li>
</ul>
<p>For example when:</p>
<ul>
<li>Fastest AGV should be prioritized</li>
<li>and no production order should be generated when AGV has a resource on board without order</li>
</ul>
<p>Then the parameter has to be set to value: 65 (64 + 1) which in binary would be: 0100 0001</p>
<h4 id="productionmanager_allownadditionalordersfromsameloadinglocation"><a class="header" href="#productionmanager_allownadditionalordersfromsameloadinglocation">ProductionManager_AllowNAdditionalOrdersFromSameLoadingLocation</a></h4>
<p>Default  is -1 --&gt; rule not in use</p>
<p>Additional number of orders that are allowed from same loading location, if wait locations are already reserved. If set to 1, allows one extra order when there is already a pickup order to take out the existing resource. (at the moment only viable options are -1, or 1).</p>
<h4 id="productionmanager_transferrequestpriorityrule"><a class="header" href="#productionmanager_transferrequestpriorityrule">ProductionManager_TransferRequestPriorityRule</a></h4>
<p>Default is UseTransferRequestPriority</p>
<p>Determines what priorities to use for transfer requests. Effects only when ProductionManager_UnhandledOrderSortingRule has been set to UseTimeAndExternalPriorities.</p>
<p>Options:</p>
<ul>
<li>UseTransferRequestPriority  (given in TransferRequest message)</li>
<li>UsePickupLocationPriority  (location given in message, priority defined in LocationPriorities.txt)</li>
<li>UseTargetLocationPriority  (location given in message , priority defined in LocationPriorities.txt)</li>
<li>UseMaximumOfPickupOrTarget</li>
<li>UseMaximumOfPickupOrTargetOrMessage</li>
</ul>
<h4 id="productionmanager_pickupreserverulemode"><a class="header" href="#productionmanager_pickupreserverulemode">ProductionManager_PickupReserveRuleMode</a></h4>
<p>Rule that defines if a TransferRequest can reserve a pickup location without a resource:</p>
<ul>
<li>ResourceRequired: A resource at location is required</li>
<li>AlwaysAllowed: Reserving a location is always allowed</li>
<li>OneLocation: Reserving a location is allowed if there is only one possibility.</li>
</ul>
<p>With transfer requests AGVs can start to locations in advance, before the resource is there. This might be more efficient than waiting that the resource will be there, if future can be estimated properly.</p>
<h4 id="productionmanager_allowunloadlocationassingtoreservedloadunloadloc_rule"><a class="header" href="#productionmanager_allowunloadlocationassingtoreservedloadunloadloc_rule">ProductionManager_AllowUnloadLocationAssingToReservedLoadUnloadLoc_Rule</a></h4>
<p>Default is true.</p>
<p>If true, it is allowed to assign unload location as a target location to a production order even if the unload location is already full of resources.</p>
<p>If the unload locations will be cleared quickly then this can be set to true, otherwise false is recommended.</p>
<h4 id="productionmanager_allowunloadlocationassigntoreservedlocwithactivepickuporder_rule"><a class="header" href="#productionmanager_allowunloadlocationassigntoreservedlocwithactivepickuporder_rule">ProductionManager_AllowUnloadLocationAssignToReservedLocWithActivePickupOrder_Rule</a></h4>
<p>Default is true.</p>
<p>If set to true, assigning unload location is allowed, if there is an active order for another AGV to pick up the resource from this location.</p>
<h4 id="productionmanager_transferrequestpickupavailabilityrules"><a class="header" href="#productionmanager_transferrequestpickupavailabilityrules">ProductionManager_TransferRequestPickUpAvailabilityRules</a></h4>
<p>Navithor decides if a pickup location can be reserved for a transfer request based on the flags set on this parameter.
This parameter is used for checking the pickup location status.
See ProductionManager_TransferRequestTargetAvailabilityRules for rules based on target location status.</p>
<p>FullMachineBlocks - machine with a resource at location blocks selection
OutOfProdMachineBlocks - machine not in production at location blocks selection
FSTOPMachineBlocks - Machine in FSTOP state at location blocks selection.</p>
<h4 id="productionmanager_transferrequesttargetavailabilityrules"><a class="header" href="#productionmanager_transferrequesttargetavailabilityrules">ProductionManager_TransferRequestTargetAvailabilityRules</a></h4>
<p>Navithor decides if a pickup location can be reserved for a transfer request based on the flags set on this parameter.
This parameter is used for checking the target location status.
See ProductionManager_TransferRequestPickUpAvailabilityRules for rules based on pickup location status.</p>
<p>There must be at least one valid target in order to select a pickup location.</p>
<p>ResourceBlocks - Resource at target location blocks selection
MachineBlocks - Machine at target location blocks selection
ActiveOrderBlocks - Any active order to target blocks selection
AllowIfWaitAvailable - Blocked location is allowed if there is a wait location available
AllowIfOrderToPickup - Blocked location allowed if another order is going to pick up.</p>
<h3 id="mes-messages-related-to-transfer-requests"><a class="header" href="#mes-messages-related-to-transfer-requests">MES messages related to transfer requests</a></h3>
<p>See more detailed explanations from the document  Communication specification between Navithor and MES.</p>
<h4 id="set-status-at-symbolic-point-id--20"><a class="header" href="#set-status-at-symbolic-point-id--20">Set status at symbolic point (ID = 20)</a></h4>
<p>Sending this message will either enable or disable and set resource status to the Symbolic Point. Navithor will not order drives to disabled Symbolic Points. <strong>AffixNumber</strong> was added in Navithor 1.9.26.0, the old message format without the field is still supported. <strong>AffixNumber</strong> is set to 0 if it is not included in the message. <strong>RequestPickup</strong> field is supported since Navithor version 1.9.60.0 and above.</p>
<h4 id="set-resources-to-symbolic-point-id--32"><a class="header" href="#set-resources-to-symbolic-point-id--32">Set resources to symbolic point (ID = 32)</a></h4>
<p>Sets resources to location. If same data is being sent the resources at location will not change. If order of <em>MESResourceAtLocation</em> is changed or if any of data is different from what Navithor thinks then the resources will be regenerated.</p>
<h4 id="transfer-request-id--21"><a class="header" href="#transfer-request-id--21">Transfer request (ID = 21)</a></h4>
<p>Sending this message will result Navithor to create a production source to the pickup Symbolic Point. Navithor will assign machines that can carry the item type to the target Symbolic Point to fulfil the transfer request. Used together with <em>SetStatusAtSymbolicPoint</em> message. Start production from a symbolic with this message and inform the actual resource to be available at the location with message <em>SetStatusAtSymbolicPoint</em>. Fields <strong>Priority</strong> and <strong>RequestID</strong> are supported since Navithor version 1.9.62.X. MES interface updated to version 1.7. Older versions support only shorter form of
the message. Version 2.4 supports both. Fields <strong>PickupIDType</strong> and <strong>TargetIDType</strong> are supported since Navithor Version 2.1.X.X.</p>
<h4 id="transfer-request-status-id--323"><a class="header" href="#transfer-request-status-id--323">Transfer request status (ID = 323)</a></h4>
<p>If <em>TransferRequest</em> message was sent with a <strong>RequestID</strong>, Navithor sends this message with the same <strong>RequstID</strong> when the status of <em>TransferRequest</em> changes. The message is sent first time, when production order is created and linked to the transfer request. This message is supported in Navithor version 2.0.2.X -&gt; MES interface updated to version 2.4.</p>
<hr />
<h2 id="practical-examples-1"><a class="header" href="#practical-examples-1">Practical examples</a></h2>
<p>In practice transfer request can be used in a large number of different transfering cases where items are transported between different locations. In the simplest case a production area has only wait load locations and load and unload locations and AGVs transfer items from load locations to the unload locations. In order to address a bit more of the capabilities, the following example is slightly more complex.</p>
<p><img src="./Images/transferRequests/ExampleArea.png" alt="Example area" /></p>
<p>In demonstration unload locations 41, 42 and 43 are in a group called Conveyor (id 3), load/unload locations 21 and 22 are in a group called CellB (2) and load/unload stations 1, 2, 3 and 4 are in a group called Source (1). In addition to these locations there are multiple waiting locations in the area, and the allowed destinations for all the locations are configured carefully to allow creating feed buffers and faster emptying for the Cells. This area set up might not be practical in many situations but it is suitable for demonstrating the effects of some of the parameters above and how Navithor handles transfer requests.</p>
<h3 id="case-1-transfer-requests-in-groups-and-the-effect-of-pickupreserverulemode"><a class="header" href="#case-1-transfer-requests-in-groups-and-the-effect-of-pickupreserverulemode">Case 1 Transfer requests in groups and the effect of PickupReserveRuleMode</a></h3>
<p>Below is an example of how a transfer request from a group to another group looks like. In the case below the there are no boxes available in any of the source stations and ProductionManager_PickupReserveRuleMode is set to value resource required. In this situation Navithor will not assign the transfer request to any AGV even though there are two AGVs right next to the sources waiting for production. After adding a box to any of the possible pickup locations Navithor assigns an AGV for the transfer request.</p>
<p><img src="./Images/transferRequests/reserveRuleModeResourceRequired.png" alt="Pickup reserve rule" /></p>
<p><img src="./Images/transferRequests/reserveRuleModeResourceRequired2.png" alt="Pickup reserve rule" /></p>
<p>When ProductionManager_PickupReserveRuleMode is set to value always allowed the transfer request will reserve one free pickup location even if there is no resource present. Then Navithor will assign an AGV for the transfer request and send the AGV to the reserved location to wait for a resource.</p>
<p><img src="./Images/transferRequests/reserveRuleModeAlwaysAllowed.png" alt="Pickup reserve rule" /></p>
<p>Having the pickup reserve rule mode in value one location would work the same way as having the value resource required in the above example as there are multiple possible pickup locations for the transfer request.</p>
<h3 id="case-2-all-targets-taken"><a class="header" href="#case-2-all-targets-taken">Case 2 All targets taken</a></h3>
<p>In case all of the target locations are taken Navithor will look for a wait unload location that is linked to the target locations and drive the AGV to wait there for any of the target locations to be freed. You can see in the picture below how the Wait unload location is placed close to the unload locations and the only allowed destinations of the wait unload location are CellB 1 and CellB 2.</p>
<p><img src="./Images/transferRequests/WaitUnloadWhenTargetsNotAvailable.png" alt="Pickup reserve rule" /></p>
<p>In the picture above Navithor shows the target location as CellB 1 (21) but as the transfer request was given with the whole group CellB as the target the AGV can also take the resource to CellB 2 (22) if it is freed first.</p>
<p><img src="./Images/transferRequests/WaitUnloadWhenTargetBecomesAvailable.png" alt="Pickup reserve rule" /></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="using-warehouse-racking-feature"><a class="header" href="#using-warehouse-racking-feature">Using warehouse racking feature</a></h1>
<p>This document contains information on the warehouse racking feature.</p>
<p>Updated 09.09.2021</p>
<h2 id="version-history-23"><a class="header" href="#version-history-23">Version History</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Version</th><th>Date</th><th>Author</th><th>Change</th></tr></thead><tbody>
<tr><td>1.0</td><td>11.02.2020</td><td>Antti Parkkonen</td><td>1st Version of the document</td></tr>
<tr><td>1.1</td><td>03.04.2020</td><td>Evgenii Kuzminskii</td><td>Added specification for GetRackSetup, RackSetupReply and RackSetup messages</td></tr>
<tr><td>1.2</td><td>09.04.2020</td><td>Evgenii Kuzminskii</td><td>Added specification for RequestPickUp and RequestPickUpResult messages</td></tr>
<tr><td>1.3</td><td>21.04.2020</td><td>Evgenii Kuzminskii</td><td>Added Parameters section and description for ResourceManager_RemoveResourcesOnUnloading parameter</td></tr>
<tr><td>1.4</td><td>28.04.2020</td><td>Evgenii Kuzminskii</td><td>Added description for ProductionManager_ResourceMismatchRules parameter</td></tr>
<tr><td>1.5</td><td>29.04.2020</td><td>Evgenii Kuzminskii</td><td>Added DriveMachineToRack message<br>Updated RackTransferRequest message name<br>Updated maximum length of SetRackStatus message and its fields</td></tr>
<tr><td>1.6</td><td>29.04.2020</td><td>Evgenii Kuzminskii</td><td>Changed title page and updated DriveMachineToRack message</td></tr>
<tr><td>1.7</td><td>03.06.2020</td><td>Evgenii Kuzminskii</td><td>Updated Machine_DriveAwayFromRackDistance parameter description</td></tr>
<tr><td>1.8</td><td>13.07.2020</td><td>Evgenii Kuzminskii</td><td>Added driving away from rack info and screenshots to a separate section</td></tr>
<tr><td>1.9</td><td>23.09.2020</td><td>Evgenii Kuzminskii</td><td>Added ProductionManager_AllowMultipleOrdersFromDifferentRackShelves and ProductionManager_AllowMultipleOrdersFromLoadLocFlags parameters' descriptions</td></tr>
<tr><td>1.10</td><td>14.01.2021</td><td>Evgenii Kuzminskii</td><td>Added description and limitations for LoadAboardStatusChange message handling</td></tr>
<tr><td>1.11</td><td>28.04.2021</td><td>Evgenii Kuzminskii</td><td>Updated description for Item type ID field of ShelfStatus struct for SetRackStatus message, removed dependency on ProductionManager_PickupReserveRuleMode parameter</td></tr>
<tr><td>1.12</td><td>11.06.2021</td><td>Aleksi Ålander</td><td>Renamed title</td></tr>
<tr><td>1.13</td><td>03.08.2021</td><td>Evgenii Kuzminskii</td><td>Updated name and description for Machine_DriveAwayFromTargetDistance parameter (previous Machine_DriveAwayFromRackDistance)</td></tr>
<tr><td>1.14</td><td>09.09.2021</td><td>Evgenii Kuzminskii</td><td>Added MissionManager_DriveAwayRules parameter</td></tr>
</tbody></table>
</div>
<hr />
<h2 id="introduction-13"><a class="header" href="#introduction-13">Introduction</a></h2>
<p>Warehouse racking feature introduces large inventory and warehouse support in Navitec software products.</p>
<p>Navithor gets information of the racks and shelves from the map created in Navithor tools. Navithor keeps track of the units moved and gives orders to Navitrol for moving the units from one rack to another.</p>
<p>For more information of creating the map of the warehouse, please read the Navithor Tools warehouse racking document.</p>
<h2 id="requirements-1"><a class="header" href="#requirements-1">Requirements</a></h2>
<ul>
<li>Usual Navithor requirements</li>
<li>Correctly configured production area.</li>
<li>Navitrol with license for using warehouse racks.</li>
<li>MES Interface</li>
</ul>
<h2 id="racking-in-practice"><a class="header" href="#racking-in-practice">Racking in practice</a></h2>
<h3 id="functionality"><a class="header" href="#functionality">Functionality</a></h3>
<p>Move orders are given to Navithor via the MES interface. Moves from racks to another use the same logic as Transfer requests but the transfer requests are given with a different message than normal transfer requests as some of the information in the existing message is not valid for racks and the requests from and to racks also need information on the pickup and target heights.</p>
<p>The MES messages are defined at the end of this document.</p>
<p>Current limitations:</p>
<ul>
<li>Scheduling in a rack system is not optimized so the correct functionality is more probable with only single AGV systems.</li>
</ul>
<h4 id="handling-agv-load-status-changes-not-initiated-by-navithor"><a class="header" href="#handling-agv-load-status-changes-not-initiated-by-navithor">Handling AGV load status changes not initiated by Navithor</a></h4>
<p>Navitrol (version 6.30.0.0 onwards) can send LoadAboardStatusChange message (ID = 124) after loading/unloading was done manually. Navithor has several limitations related to the message handling:</p>
<ul>
<li>Requests for additional info from an operator are not currently supported.</li>
<li>Handling of lingering resources is not currently supported.</li>
<li>The only supported load statuses are 1 (Empty) and 4 (Full).</li>
<li>Only valid shelf IDs are currently supported and must be specified for both racks (existing shelf ID &gt; 0) and not specified for regular symbolic points (shelf ID = -1). If no valid loading/unloading location is found when specified then nothing will be done.</li>
</ul>
<p>In a case where an operator loads the AGV using a joystick or manually places something on top of the AGV and the AGV can detect this load, Navitrol informs Navithor that the load status has changed. The same applies in the case where the AGV is unloaded or the item taken away from the AGV. Navithor then handles the load status change with the following logic:</p>
<ul>
<li>
<p>On loading:</p>
<ul>
<li>If a loading resource is found and there is no resource aboard then the loading resource will be placed aboard.</li>
<li>If a loading resource is found but there is already a resource aboard then the resource aboard will be replaced with the loading resource.</li>
<li>If no loading resource is found or a loading location is not specified and there is no resource aboard then a default resource will be loaded.</li>
<li>If no loading resource is found or a loading location is not specified but there is already a resource aboard then nothing will be done.</li>
</ul>
</li>
<li>
<p>On unloading:</p>
<ul>
<li>If there is a resource aboard and no resource at an unloading location then the resource aboard will be moved to the unloading location.</li>
<li>If there is a resource aboard and there is a resource at an unloading location then the resource at the unloading location will be replaced with the resource unloaded from aboard.</li>
<li>If there is a resource aboard and an unloading location is not specified then the resource aboard will be removed.</li>
<li>If there is no resource aboard then nothing will be done.</li>
</ul>
</li>
</ul>
<h3 id="visualization"><a class="header" href="#visualization">Visualization</a></h3>
<p>Rack status will change the symbolic point’s color. Full racks will be marked black, partially taken racks are blue and empty racks are cyan like normal symbolic points.</p>
<p><img src="./Images/racking/rackStatusesOnMap.png" alt="image-20200406152557004" /></p>
<p>Hovering mouse on a rack will show on white which shelves are available.</p>
<p><img src="./Images/racking/rackHover.png" alt="image-20200406152656884" /></p>
<p>Clicking a rack will open the symbolic point status as with normal symbolic points. However, rack status shows also controls for each shelf in the rack.</p>
<p><img src="./Images/racking/rackStatusFrom.png" alt="image-20200406152725043" /></p>
<p>When giving a go to order for an AGV in Navithor Client, the user needs to also select the shelf after selecting the symbolic point. The shelf is selected by clicking the desired shelf with the mouse. Current selection is shown with green background. When selecting the shelf, clicking on the map and not on a shelf will revert back to symbolic point / route selection mode and right clicking will cancel the go to selection all together.</p>
<p><img src="./Images/racking/goToRack.png" alt="image-20200406152748190" /></p>
<p>If Target shelf and Pickup shelf columns are selected as shown columns in the production orders view, the transfer requests and production orders to racks will show the pickup and target shelves in the production order view.</p>
<p><img src="./Images/racking/rackOrders.png" alt="image-20200406152810089" /></p>
<h3 id="driving-away-from-rack"><a class="header" href="#driving-away-from-rack">Driving away from rack</a></h3>
<p>In general driving away from rack requires <code>MissionManager_DriveAwayRules</code> parameter to have either <code>DriveAwayFromTargetOnMachineRequest</code> or <code>DriveAwayFromRackIfTooClose</code> options enabled depending on the desired behavior.
The following example requires only <code>DriveAwayFromRackIfTooClose</code> option to be enabled.</p>
<p>The easiest way to demonstrate the case of driving away from a rack is a transfer request from a rack shelf to a different shelf on the same rack. It is represented step-by-step on the screenshots below:</p>
<ol>
<li>
<p>Transfer request is assigned to machine, drive to the target rack with height 1.
<img src="./Images/racking/drive_away_from_rack/1_drive_to_rack.png" alt="" /></p>
</li>
<li>
<p>Start loading the resource from the rack shelf at height 1.
<img src="./Images/racking/drive_away_from_rack/2_start_loading.png" alt="" /></p>
</li>
<li>
<p>The resource is loaded.
<img src="./Images/racking/drive_away_from_rack/3_loaded.png" alt="" /></p>
</li>
<li>
<p>Drive away from the rack to safely change the actuator position to height 2.
<img src="./Images/racking/drive_away_from_rack/4_drive_away.png" alt="" /></p>
</li>
<li>
<p>Drive back to the rack with height 2.
<img src="./Images/racking/drive_away_from_rack/5_drive_back.png" alt="" /></p>
</li>
<li>
<p>Start unloading the resource to the shelf at height 2.
<img src="./Images/racking/drive_away_from_rack/6_start_unloading.png" alt="" /></p>
</li>
<li>
<p>The resource is unloaded, transfer request is completed successfully.
<img src="./Images/racking/drive_away_from_rack/7_unloaded.png" alt="" /></p>
</li>
</ol>
<p>Navithor may drive an AGV away from rack automatically in the following cases:</p>
<ul>
<li>AGV executes a production order from rack A height 1 to the same rack A height 2. In this case Navithor first drives the AGV to the target rack with height 1 for loading, then drives away from the rack to safely change actuator position and finally drives back to the rack with height 2 for unloading.</li>
<li>AGV starts a drive order related to a production order closer than Machine_DriveAwayFromTargetDistance meters from the target rack with actuator position different from the target height. In this case Navithor drives the AGV away from the rack to safely change actuator position and then back to the rack.</li>
<li>Navitrol rejects a drive order to rack with the rejection reason value set to 10 (REJ_CLOSE_TO_RACK). If the drive was related to a production order then Navithor drives the AGV away from the target rack and then back in to resolve this. If the drive order is a GOTO drive then it will be aborted and Navithor Client will show a message to drive the AGV away from rack first.</li>
</ul>
<h2 id="mes-interface-messages"><a class="header" href="#mes-interface-messages">MES Interface messages</a></h2>
<p>See more detailed explanations from the document  Communication specification between Navithor
and MES.</p>
<h3 id="racktransferrequest-id--39"><a class="header" href="#racktransferrequest-id--39">RackTransferRequest (ID = 39)</a></h3>
<p>Sending this message will result Navithor to create a production source to the pick-up Symbolic Point. Navithor will assign machines that can carry the item type to the target Symbolic Point to fulfil the transfer request.</p>
<h3 id="setrackstatus-id--40"><a class="header" href="#setrackstatus-id--40">SetRackStatus (ID = 40)</a></h3>
<p>Equivalent to SetStatusAtSymbolicPoint for a warehouse rack.</p>
<h3 id="getracksetup-id--43"><a class="header" href="#getracksetup-id--43">GetRackSetup (ID = 43)</a></h3>
<p>Sending this message will result Navithor to send back RackSetupReply message. In addition, if MachineTypeId is positive, then for each rack with defined MachineTypeId RackSetup message will be sent back. If MachineTypeId is not positive, then for each rack and for each MachineTypeId defined on that rack RackSetup message will be sent back.</p>
<h3 id="racksetupreply-id--330"><a class="header" href="#racksetupreply-id--330">RackSetupReply (ID = 330)</a></h3>
<p>This message will be sent by Navithor back to the same MES client as a reply to its GetRackSetup message.</p>
<h3 id="racksetup-id--331"><a class="header" href="#racksetup-id--331">RackSetup (ID = 331)</a></h3>
<p>This message will be sent by Navithor back to the same MES client as an additional part of the reply to its GetRackSetup message.</p>
<h3 id="requestpickup-id--25"><a class="header" href="#requestpickup-id--25">RequestPickUp (ID = 25)</a></h3>
<p>Sending this message will result Navithor to create an unhandled pickup order and/or send back RequestPickUpResult message. If symbolic point is a rack, then ShelfId field must be set to a positive value of valid shelf ID on the rack. If symbolic point is not a rack, then ShelfId field must be skipped or set to zero or any negative value.</p>
<h3 id="requestpickupresult-id--320"><a class="header" href="#requestpickupresult-id--320">RequestPickUpResult (ID = 320)</a></h3>
<p>This message will be sent by Navithor to MES clients as a reply to RequestPickUp message.</p>
<h3 id="drivemachinetorack-id--44"><a class="header" href="#drivemachinetorack-id--44">DriveMachineToRack (ID = 44)</a></h3>
<p>Sending this message will result Navithor to create a production order for the machine if MachineId is greater than 0. Negative MachineId values are not supported.</p>
<h2 id="parameters-1"><a class="header" href="#parameters-1">Parameters</a></h2>
<h3 id="resourcemanager_removeresourcesonunloading"><a class="header" href="#resourcemanager_removeresourcesonunloading">ResourceManager_RemoveResourcesOnUnloading</a></h3>
<p>If this parameter is set to true, the resources will be removed on unloading at a target location. This parameter can be used in cases when there is no need for Navithor to track the resources on locations. The resource is shown on pickup location until it is waiting for pickup and on an AGV until it is delivered to its target location. After that it will be marked as deleted and will not appear in any resource container.</p>
<h3 id="productionmanager_resourcemismatchrules"><a class="header" href="#productionmanager_resourcemismatchrules">ProductionManager_ResourceMismatchRules</a></h3>
<p>This parameter defines rules which are applied when resource mismatch is detected on machine. If ProductionManager_DisableResourceMismatch parameter is set to true it turns the check for resource mismatch off, so these rules are ignored. If ProductionManager_AlwaysCheckResourceMismatch parameter is set to false the check is done only for driving tasks. It has the following flags:</p>
<ul>
<li>None: none of the following rules are applied. This option becomes active when no other option is set to checked. This is default value.</li>
<li>MoveResourceIfLoadDetected: if machine detects a load but Navithor has no resource on the machine, it will move the resource from the closest symbolic point and, if the symbolic point is a rack, from the shelf closest to machine's actuator position to the machine. If moving is not possible Navithor will create a new default resource on the machine.</li>
<li>MoveResourceIfNoLoadDetected: if machine detects no load but Navithor has a resource on the machine, it will move the resource from the machine to the closest symbolic point and, if the symbolic point is a rack, to the shelf closest to machine's actuator position. If moving is not possible Navithor will remove the resource from the machine.</li>
</ul>
<h3 id="machine_driveawayfromtargetdistance"><a class="header" href="#machine_driveawayfromtargetdistance">Machine_DriveAwayFromTargetDistance</a></h3>
<p>Determines how far away from a target location the AGV needs to drive in order to safely actuate. This parameter is used for example when an AGV needs to move a pallet from one level in a rack to another level in the same rack. The AGV drives the distance set to this parameter away from the rack between the loading and unloading.</p>
<p>This parameter is also used to define the distance machine drives away from target before trying to drive there again, in case machine has rejected the route to the target.</p>
<p>The value must be less than maximum drive order distance parameter value and not too close to it in order to drive to a target location normally, else the AGV may stop at the specified distance before the target location.</p>
<p>If drive task scheduling mode parameter has flag bits 5 or 6 set to 1 and there is a NoStop symbolic point on a drive route closer than this parameter value from the target location then the AGV may get stuck on the NoStop symbolic point.</p>
<h3 id="productionmanager_allowmultipleordersfromdifferentrackshelves"><a class="header" href="#productionmanager_allowmultipleordersfromdifferentrackshelves">ProductionManager_AllowMultipleOrdersFromDifferentRackShelves</a></h3>
<p>If True then multiple AGVs can start orders from the same rack but different shelves. Else only one AGV can start an order from the same rack.</p>
<p>This parameter is not taken into account if <code>ProductionManager_AllowMultipleOrdersFromLoadLocFlags</code> parameter has Rack flag enabled.
Setting this parameter to True may cause more deadlocks. For example, several AGVs going to the same dead-end rack at the same time will likely end up with a deadlock.</p>
<h3 id="productionmanager_allowmultipleordersfromloadlocflags"><a class="header" href="#productionmanager_allowmultipleordersfromloadlocflags">ProductionManager_AllowMultipleOrdersFromLoadLocFlags</a></h3>
<p>If true a new unhandled order can be assigned to an agv when there is already another agv executing an order from the same pickup location. This parameter should be true only if there are multiple unloading possibilities or if unloading is done to a conveyor.</p>
<h3 id="missionmanager_driveawayrules"><a class="header" href="#missionmanager_driveawayrules">MissionManager_DriveAwayRules</a></h3>
<p>The rules which define the options for drive-away feature.</p>
<ul>
<li>Disabled: Navithor never drives machines away from target.</li>
<li>DriveAwayFromTargetOnMachineRequest: If machine rejects drive order with a certain error code (12) Navithor drives the machine away from the current target using <code>Machine_DriveAwayFromTargetDistance</code> value and then back to the target.</li>
<li>DriveAwayFromRackIfTooClose: If machine rejects drive order with a certain error code (10) or production order to a different Rack shelf starts closer than <code>Machine_DriveAwayFromTargetDistance</code> from the target Rack Navithor drives the machine away from the Rack using <code>Machine_DriveAwayFromTargetDistance</code> value and then back to the Rack.</li>
<li>DriveOutOfBufferLane: If machine is inside a Buffer lane and starts a new drive order to the same Buffer Navithor will first drive the machine out of the Buffer lane and then back into it.</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="using-buffer-lanes"><a class="header" href="#using-buffer-lanes">Using Buffer Lanes</a></h1>
<p>This document contains information on buffer lanes in Navithor.</p>
<p>Updated 03.02.2022</p>
<h2 id="version-history-24"><a class="header" href="#version-history-24">Version History</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Version</th><th>Date</th><th>Author</th><th>Change</th></tr></thead><tbody>
<tr><td>1.0</td><td>23.05.2019</td><td>Samuli Vaara</td><td>First version</td></tr>
<tr><td>1.1</td><td>28.05.2019</td><td>Aleksi Ålander</td><td>Added Navitrol chapter</td></tr>
<tr><td>1.2</td><td>02.12.2020</td><td>Toni Liski</td><td>Updated document after adding a new BufferResourceContainer</td></tr>
<tr><td>1.3</td><td>10.03.2021</td><td>Toni Liski</td><td>Added three new parameters</td></tr>
<tr><td>1.4</td><td>28.04.2021</td><td>Toni Liski</td><td>Added description for Maximum resource capacity</td></tr>
<tr><td>1.5</td><td>11.06.2021</td><td>Aleksi Ålander</td><td>Renamed title</td></tr>
<tr><td>1.6</td><td>23.07.2021</td><td>Evgenii Kuzminskii</td><td>Updated &quot;Buffer Lanes in production&quot; chapter and added sub-chapter with examples how to run the production and related MES messages</td></tr>
<tr><td>1.7</td><td>03.02.2022</td><td>Toni Liski</td><td>Add Block Stacking chapter</td></tr>
</tbody></table>
</div>
<hr />
<h2 id="introduction-14"><a class="header" href="#introduction-14">Introduction</a></h2>
<p>Buffer lanes were created to allow different type of loading or
unloading to a symbolic point to be done when we have a buffer area
defined. Within the buffer area unloading or loading is done when the
AGV detects the first pallet/obstacle, so it does not need to go all the
way to the symbolic point.</p>
<h2 id="creating-buffer-lanes"><a class="header" href="#creating-buffer-lanes">Creating Buffer Lanes</a></h2>
<p>Creating a buffer lane for a Load or Unload point is done by setting a
buffer distance and enabling the buffer. This can only be done for
symbolic points with the type Load or Unload. The size of the lane is
visualized in magenta. The UI is displayed in figure 1.</p>
<p>As a limitation buffer lane cannot currently span across multiple links.
Additionally, the load or unload point must only have a single link
connected thus it needs to be at the end of a link.</p>
<p><img src="Images/bufferLanes/image3.png" alt="" /></p>
<blockquote>
<p>Creating buffer lanes</p>
</blockquote>
<p>In addition to buffer length (<em>buffer distance</em>), the number of resources allowed into buffer can be configured. Dialog opens when pressing Edit button in <em>Edit Allowed Resources</em> section (See Navithor Tools documentation for further details).</p>
<p>Number of allowed resources can be determined separately for each resource type, and in the bottom the calculated <em>Maximum resource capacity</em> is shown. This capacity specifies the maximum amount of resources in total allowed in buffer. Maximum resource capacity is automatically set as highest amount of any resource type allowed.</p>
<p>In the following example, if considered only resource types Box and Carbody, the following combinations in one buffer are possible:</p>
<ul>
<li>3 boxes, 1 carbody</li>
<li>2 boxes, 2 carbody</li>
<li>less than 3 boxes and less than 2 carbodies</li>
</ul>
<p><img src="Images/bufferLanes/image5.png" alt="" /></p>
<blockquote>
<p>Configuring allowed amount of resources</p>
</blockquote>
<h2 id="buffer-lanes-in-production"><a class="header" href="#buffer-lanes-in-production">Buffer Lanes in Production</a></h2>
<p>Using buffer lanes in production requires that Symbolic Point is configured as buffer, and distance (buffer size) is defined. Optionally, the following Parameters can be used (recommended values in brackets):</p>
<ul>
<li>
<p><strong>ProductionManager_UnloadLocationAssingRule</strong> (buffer_balance)</p>
<p>Option <strong>buffer_balance</strong> prioritizes unload point with most space is left in the buffer. Navithor updates the  space left in buffer always when a resource is unloaded to a buffer type unload point. If the point is set empty, the space left in buffer is also reset.</p>
</li>
<li>
<p><strong>SymbolicPoint_BUFFER_FULL_DISTANCE_REMAINING</strong> (minimum resource size along buffer lane)</p>
<p>The parameter specifies when we consider the buffer to be full. The buffer is considered full when Navithor believes that the space left in buffer is lower than this value. Disabled if the value is zero.</p>
</li>
<li>
<p><strong>SymbolicPoint_BUFFER_EMPTY_DISTANCE_REMAINING</strong> (0)</p>
<p>The parameter sets buffer empty, if loading machine is located closer to buffer symbolic point than specified distance. Disabled if value is zero.</p>
</li>
<li>
<p><strong>ResourceManager_BufferUnloadPositionMode</strong> (MachinePosition)</p>
<p>The parameter specifies how resource position is determined in unload buffer. <strong>MachinePosition</strong> means that resource is placed on the position where the machine is located while unloading. <strong>Calculated</strong> means that position is calculated based on the number of resources in the buffer and given margin parameter.</p>
</li>
<li>
<p><strong>ResourceManager_BufferResourceMargin</strong> (0.1)</p>
<p>The parameter specifies the distance in meters between resources in the buffer. Distance is used to calculate buffer fillgrade and resource positions in a load buffer, and in an unload buffer, if mode is <strong>Calculated</strong> (see previous parameter).</p>
</li>
<li>
<p><strong>SymbolicPoint_ResourceBufferAllowedResourcesRule</strong> (AnyResource)</p>
<p>The parameter defines rules to allow different resources combined in the same buffer. Resources in one buffer can be limited by resource type, external resource identifier (See <em>TransferRequestWithResourceIdentifier (ID = 54)</em> in MES documentation), or by their combination.</p>
</li>
<li>
<p><strong>MissionManager_AbortDriveToLoadIfNoResourceAtLocation</strong> (true)</p>
<p>Machine reports that buffer is empty, if it gets pickup order from the buffer and scanner cannot find any object within the buffer lane. If buffer is reported empty, it will be marked empty also in Fleet Control, and all the resources will be removed. If this parameter is set true, machine automatically aborts the current drive order to buffer because no resources are left in the pickup location.</p>
</li>
<li>
<p><strong>MissionManager_DeleteOrderTriggerRules</strong> (BufferReportedEmpty)</p>
<p>This parameter determines if the current pickup order and related unhandled order are removed automatically when the machine reports that the pickup buffer is empty.</p>
</li>
</ul>
<h3 id="examples-of-mes-messages-affecting-buffer-lanes-in-production"><a class="header" href="#examples-of-mes-messages-affecting-buffer-lanes-in-production">Examples of MES Messages Affecting Buffer Lanes in Production</a></h3>
<p>Production can be run with <strong>TransferRequest</strong> MES message (ID = 21), for instance. Pickup and target points can be either defined as single buffer lanes or as a group of buffer lanes. If either of them is a group Navithor Fleet Control will select a valid location from all the options.</p>
<p>The following MES messages can also be used to affect the production (the specifications can be found from &quot;Communication specification between Navithor and MES&quot; document):</p>
<ul>
<li><strong>SetSymbolicPointAvailability</strong> (ID = 31) to temporarily disable/enable a single buffer lane;</li>
<li><strong>SetBufferLaneStatus</strong> (ID = 50) to set buffer lanes empty/full (no knowledge about each resource required);</li>
<li><strong>SetResourcesAtLocation</strong> (ID = 32) to add resources to a single buffer lane;</li>
<li><strong>SetSymbolicPointGroupStatus</strong> (ID = 34) to fill group of buffer lanes with multiple resources (or remove them);</li>
<li><strong>RequestSPResourceStatus</strong> (ID = 55) to request status of resources on the buffer lanes.</li>
</ul>
<p>Status of the buffer lane group is sent by Navithor to MES in <strong>SymbolicPointGroupStatus</strong> message (ID = 324). Status of a single buffer lane is sent by Navithor to MES in <strong>SymbolicPointResourceStatus</strong> message (ID = 345).</p>
<h2 id="buffer-lanes-in-navithor-client"><a class="header" href="#buffer-lanes-in-navithor-client">Buffer Lanes in Navithor Client</a></h2>
<p>Buffers have all the same options as other symbolic points, but only resources are visualized differently and Navithor is internally keeping track of free space in the buffer. Each resource in the buffer is visualized at the location where it has been unloaded. The resource which has been unloaded first will be closest to the symbolic point and the resource unloaded last will be furthest away from the symbolic point.</p>
<p>If a resource has to be removed manually from the buffer, the selected resource is highlighted with a green frame.</p>
<p><img src="Images/bufferLanes/image4.png" alt="" /></p>
<blockquote>
<p>Buffer lane with resources. Selected resource is highlighted with a green color.</p>
</blockquote>
<h2 id="block-stacking"><a class="header" href="#block-stacking">Block stacking</a></h2>
<p>Block stacking is an extended feature of the normal resource buffer lane, where resources can be stacked on top of other resources, according to the specified rules. For automatic stacking in buffer without possibility for external control, see Navitrol <em>Block Stacking Instructions</em> documentation.</p>
<p><img src="Images/bufferLanes/image6.png" alt="" /></p>
<blockquote>
<p>Visualization of buffer lane with resources stacked in Navithor Client.</p>
</blockquote>
<p>Block stacking functionality is based on RackTransferRequest (ID = 39) message over the MES interface (see MES interface documentation for more details). Block stacking can be activated by setting <strong>BlockStacking</strong> (1 &lt;&lt; 2) flag for <em>ExtraInformation</em> field, and by defining the optional packet <em>BlockStacking</em>.</p>
<h3 id="simple-use-case"><a class="header" href="#simple-use-case">Simple use case</a></h3>
<p>Idea is that each transfer request specifies the transfer of one resource from pickup location to a target block stacking buffer. In the simplest case FleetControl will give machine a hint of possible drop location in buffer, and estimated height of the actuator for unload operation (actuator height) to speed up the process of looking for free slot, but the machine itself takes care of the rest. In this case the only limiting factor for stacking the resource on top of the previous one is the physical lifting height of the actuator.</p>
<p>Example of <em>RackTransferRequest</em> message with <strong>BlockStacking</strong> data packet:</p>
<div class="table-wrapper"><table><thead><tr><th>Field</th><th>Value</th><th>Comment</th></tr></thead><tbody>
<tr><td>Flags</td><td>3</td><td>Stacking allowed (on top and below)</td></tr>
<tr><td>MaximumStackingHeight</td><td>0</td><td>Maximum height is not limited, instead maximum actuator height can be used.</td></tr>
<tr><td>ResourceHeight</td><td>0</td><td>Height of the resource, if known. Can be used to speed up the unload process.</td></tr>
<tr><td>ResourcesInStack</td><td>0</td><td>Maximum number of resources in stack is not defined.</td></tr>
</tbody></table>
</div>
<h3 id="maximum-stack-height"><a class="header" href="#maximum-stack-height">Maximum stack height</a></h3>
<p>There are two ways to limit the allowed stacking height in the block stacking buffer. They can also be combined.</p>
<p>First is <em>MaximumStackingHeight</em> field in <strong>BlockStacking</strong> packet, which defines maximum possible height where actuator can be lifted. Note that this value cannot be higher where machine actually can reach (maximum physical height). If the given value is lower, it is used instead of maximum physical actuating height.</p>
<p>Following configuration will allow stacking of two resources with height of 600mm on top of each other.</p>
<div class="table-wrapper"><table><thead><tr><th>Field</th><th>Value</th><th>Comment</th></tr></thead><tbody>
<tr><td>Flags</td><td>3</td><td>Stacking allowed (on top and below)</td></tr>
<tr><td>MaximumStackingHeight</td><td>1000</td><td>Millimeters.</td></tr>
<tr><td>ResourceHeight</td><td>600</td><td>Millimeters.</td></tr>
<tr><td>ResourcesInStack</td><td>0</td><td>Maximum number of resources in stack is not defined.</td></tr>
</tbody></table>
</div>
<p>Another way is to limit maximum amount of resources on top of each other. Note, that this limitation is done on FleetControl side, so the buffer resource book keeping must then match to the real buffer situation in order this to work reliable.</p>
<p>Following configuration will allow stacking three resources on top of each other, even if maximum stacking height would allow more.</p>
<div class="table-wrapper"><table><thead><tr><th>Field</th><th>Value</th><th>Comment</th></tr></thead><tbody>
<tr><td>Flags</td><td>3</td><td>Stacking allowed (on top and below)</td></tr>
<tr><td>MaximumStackingHeight</td><td>1000</td><td>Millimeters.</td></tr>
<tr><td>ResourceHeight</td><td>200</td><td>Millimeters.</td></tr>
<tr><td>ResourcesInStack</td><td>3</td><td>Three resources allowed in stack.</td></tr>
</tbody></table>
</div>
<p>If resource height is not known, only maximum number of resources in stack can be used instead:</p>
<div class="table-wrapper"><table><thead><tr><th>Field</th><th>Value</th><th>Comment</th></tr></thead><tbody>
<tr><td>Flags</td><td>3</td><td>Stacking allowed (on top and below)</td></tr>
<tr><td>MaximumStackingHeight</td><td>0</td><td>Not defined.</td></tr>
<tr><td>ResourceHeight</td><td>0</td><td>Not known.</td></tr>
<tr><td>ResourcesInStack</td><td>3</td><td>Three resources allowed in stack.</td></tr>
</tbody></table>
</div>
<h3 id="stacking-flags"><a class="header" href="#stacking-flags">Stacking flags</a></h3>
<p>It is possible to allow resource to be stacked on top of another resources, but prevent other resource from being stacked on this resource. This handling relies on FleetControl book keeping in buffers, and is not checked among the real situation in the buffer when pickup or dropdown operations are performed.</p>
<ol>
<li>Normal pallet with rigid products, can be stacked normally
<ul>
<li>Flags: 3</li>
</ul>
</li>
<li>&quot;Open top&quot; box, can be stacked on top of other
<ul>
<li>Flags: 1</li>
</ul>
</li>
<li>High pallet, cannot be stacked on another pallet, but something low can be but on top
<ul>
<li>Flags: 2</li>
</ul>
</li>
<li>Unstable pallet, cannot be used for stacking at all
<ul>
<li>Flags: 0</li>
</ul>
</li>
</ol>
<p><strong>Note!</strong> If <em>BlockStacking</em> packet is not specified in Transfer Request, transported resource will have stacking flags 3 (stacking under and on top allowed). If such resource is transferred to resource buffer, it can be always used for stacking on, if next resource allows stacking.</p>
<h3 id="navithor-client-1"><a class="header" href="#navithor-client-1">Navithor Client</a></h3>
<p>Resources can be stacked also in Navithor Client. While modifying the resources on the buffer symbolic point, there is option to stack the newly created resource on previous resource in the buffer. No stacking rules are used when creating resources manually in the buffer lane.</p>
<p><img src="Images/bufferLanes/image7.png" alt="" /></p>
<blockquote>
<p>Creating a stacked resource in Navithor Client.</p>
</blockquote>
<h2 id="navitrol-1"><a class="header" href="#navitrol-1">Navitrol</a></h2>
<p>Using buffer buffer lanes requires support from Navitrol. Currently it is implemented in Navitrol version 6.21.40. See updated specifications in corresponding Navitrol documentation.</p>
<p>Parameters that have to be changed:</p>
<p><strong>I,target_detection_type_selection,</strong> <strong>3</strong> # Enables ref docking
or pallet detection, 0 = disabled, 1 = refl docking, 2 = pallet
detection, 3 = pallet detection ver 2 (allows buffer detection)</p>
<p><strong>I,target_detection_scan_selection, 3</strong> # Defines which scanners
are used for target detection: 1 = rear scanner only, 2 = front scanner
only, 3 = both scanners (supported only in refl docking and pallet
detection ver 2)</p>
<p>Pallet model should be set into the parameters with array index of 0.
Important parameters for buffers are:</p>
<p><strong>I,pallet_model_enabled[0], 1</strong> # 1 = pallet model enabled</p>
<p><strong>F,pallet_model_width_y[0], 0.80</strong> # Used for determining width
of the buffer to check if it is free or not</p>
<p>Parameters that can be added to params.txt to change how close to the
object the AGV stops in the buffer zone and how early it starts
checking, if the buffer is free or not:</p>
<p><strong>F,buffer_stop_dist_from_object_when_unloading, -2.0</strong> #
Stopping distance (m) from the closest object, when unloading in a
buffer. Calculated from navigation point to the first scanner
measurements seen on the buffer zone.</p>
<p><strong>F,buffer_check_start_dist_offset_m, 2.0</strong> # The minimum distance
from navigation point to the buffer zone, when the AGV starts checking
if the buffer is free or not</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="managing-battery-levels"><a class="header" href="#managing-battery-levels">Managing Battery Levels</a></h1>
<p>This document describes how to use the charging manager and opportunity charging.</p>
<p>Updated 13.12.2022</p>
<h2 id="version-history-25"><a class="header" href="#version-history-25">Version History</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Version</th><th>Date</th><th>Author</th><th>Change</th></tr></thead><tbody>
<tr><td>1.0</td><td>18.11.2021</td><td>Simon Clement</td><td>Document created</td></tr>
<tr><td>1.1</td><td>27.01.2022</td><td>Simon Clement</td><td>Add warning related to defining a minimum amount of charging AGVs</td></tr>
<tr><td>1.2</td><td>25.02.2022</td><td>Simon Clement</td><td>Update document to describe functionality of 2.50 release</td></tr>
<tr><td>1.3</td><td>08.12.2022</td><td>Simon Clement</td><td>Update document to include information about AlternativeChargingRuleZone</td></tr>
<tr><td>1.4</td><td>13.12.2022</td><td>Aleksi Ålander</td><td>Add new option of DriveAwayFromChargerIfChargingFails into parameters section</td></tr>
</tbody></table>
</div>
<hr />
<h2 id="charging-manager"><a class="header" href="#charging-manager">Charging manager</a></h2>
<p>Navithor's charging manager is used to intelligently control when AGVs are sent to charging locations based on a number of simple rules.
Enabling battery charging management in Navithor will generate charging requests for AGVs when charging is needed.
A charging request will result in a drive task to a free charging location (a symbolic point of type <em>Charge</em>).
If no location is available, the AGV will continue working until a free charging location is available unless the battery level goes below the ALERT trigger (see <em>AGV battery levels</em>).</p>
<h3 id="enabling-charging-management"><a class="header" href="#enabling-charging-management">Enabling charging management</a></h3>
<p>Charging management is enabled by setting the parameter <strong>ProductionManager_ControlBatteryCharging</strong> to <strong>true</strong>.</p>
<p>For AGVs with a battery monitoring system, the following machine type parameters should be enabled:</p>
<ul>
<li><strong>BATTERY_ENABLED</strong> = 1</li>
<li><strong>BATT_CHARGING_STATE_KNOWN</strong> = 1</li>
</ul>
<h4 id="controlling-assignment-of-unhandled-orders-while-charging"><a class="header" href="#controlling-assignment-of-unhandled-orders-while-charging">Controlling assignment of unhandled orders while charging</a></h4>
<p>By default, machines can be assigned unhandled orders while charging if the charging request allows it. 
This can be disabled by including the flag value <strong>PreventWhileAtCharge</strong> in the parameter <strong>MissionManager_OrderAssignmentRules</strong>. 
No unhandled orders will then be assigned to charging machines.</p>
<blockquote>
<p>Note that Navithor versions before 2.23 instead were relying on the flag value <strong>fromWaitToUnhandled</strong> to be included in the parameter <strong>Task_Extension_enable_mode</strong> before unhandled orders would be assigned to charging machines.</p>
</blockquote>
<h4 id="update-battery-levels-from-operation-times"><a class="header" href="#update-battery-levels-from-operation-times">Update battery levels from operation times</a></h4>
<p>If no battery monitoring system exists or AGVs are needed to have a specified operate-charge-operate-cycle, the parameter <strong>ProductionManager_UpdateBattTimesFromOpeTimes</strong> should be set to <strong>true</strong>.
When enabled, the battery level shown in the Client and monitored by the charging manager is the minimum of these two values: calculated battery level from operation times and battery level information from AGV.</p>
<p>The battery levels of each AGV will then be calculated based on the operation times and required charging times that have been defined in the machine type parameter file.
The relevant machine type parameters are the following:</p>
<ul>
<li><strong>BATT_CHARGE_TIME_MINUTES</strong></li>
<li><strong>BATT_OPERATION_MAX_TIME_MINUTES</strong></li>
<li><strong>BATT_OPERATION_NORM_TIME_MINUTES</strong></li>
</ul>
<p>These parameters create a value (0-100% ) that increases when AGV is charging and decreases when AGV is not charging.
Note that only the greater number of <strong>BATT_OPERATION_MAX_TIME_MINUTES</strong> and <strong>BATT_OPERATION_NORM_TIME_MINUTES</strong> is used when calculating the battery level.
The battery decrease rate when an AGV is moving is calculated from the system parameter <strong>Machine_BATTERY_STATUS_DROP_GAIN_AUTO</strong>.
It is calculated as <strong>Machine_BATTERY_STATUS_DROP_GAIN_AUTO</strong> * <strong>x</strong>, where <strong>x</strong> is the amount of time the AGV has been moving.</p>
<h3 id="charging-requests"><a class="header" href="#charging-requests">Charging requests</a></h3>
<p>There are multiple types of charging requests in the system:</p>
<ul>
<li><strong>Rules request</strong>: Navithor has generated the request automatically based on charging management rules.
A machine that is charging due to a rules request will never leave the charger until its battery level has reached HIGH (See <em>AGV battery levels</em>).</li>
<li><strong>Idle request</strong>: Navithor has generated the request automatically when there is no production available, and <strong>ProductionManager_DriveToChargeIfNoProduction</strong> is set to TRUE in system parameters.
A machine that is charging due to an idle request will leave a charger to do production as long as its battery level is above LOW (See <em>AGV battery levels</em>).
In the machine task log, an Idle request is described as &quot;Rules - no production&quot;.</li>
<li><strong>Machine request</strong>: The request has been triggered from an AGV (e.g., a button on board).</li>
<li><strong>External request</strong>: An external source (e.g., MES or PLC connected to Server) triggered the request.
Navithor cannot cancel this type of request.
This means the AGV will drive and stay at a charging location as long as the external source keeps the request active.
The MES message used to start and stop charging is ChargingCommand (ID = 9). See documentation related to communication between Navithor and MES for instructions on how to use this message.</li>
<li><strong>Client operator request</strong>: Navithor Client user has pressed the 'Request Charging' button in the Battery monitor-view.</li>
</ul>
<p>When the battery level of an AGV has reached HIGH, it may stop charging if there is production available and the charging request is not <strong>External request</strong>.</p>
<p>Production available means:</p>
<ul>
<li>There are production orders for the AGV or</li>
<li>There are unhandled orders available and the AGV is priority to one of them or</li>
<li>There are unhandled production order lists available or</li>
<li>The charging location is also a HOLD-location</li>
</ul>
<p>Note that an AGV never will drive to charge if it is carrying a resource. No matter the type of charging request.
It will first execute the charging request after the resource has been unloaded.</p>
<h3 id="agv-battery-levels"><a class="header" href="#agv-battery-levels">AGV battery levels</a></h3>
<p>The charging manager operates with four battery levels to trigger charging behavior:</p>
<ul>
<li>ALERT</li>
<li>LOW</li>
<li>HIGH</li>
<li>FULL</li>
</ul>
<p>The image below shows an overview of the battery levels and the general charging behavior of AGVs.
Each level is described in detail in the following sections.</p>
<p><img src="./Images/ChargingManagement/BatteryLevelsOverview.png" alt="" />
<em>Note: The colors used are only for illustrative purposes. The actual colors used in the clients varies between client.</em></p>
<h4 id="alert-trigger"><a class="header" href="#alert-trigger">ALERT trigger</a></h4>
<ul>
<li><strong>Parameter:</strong> ProductionManager_BattAlertLevel</li>
<li><strong>Default Value:</strong> 15 %</li>
<li>Should be set to a level that ensures the AGV always has enough time to get into the charger in time before running out of battery.</li>
</ul>
<h5 id="behavior-in-production"><a class="header" href="#behavior-in-production">Behavior in production</a></h5>
<p>When the battery level goes below ALERT, a rules charging request is generated for the AGV, and no unhandled orders can be assigned to it.
If the AGV is executing an order, it will finish the order and drive to a charging location.
If there are no free charging locations, an alarm is raised.</p>
<h5 id="behavior-in-charge"><a class="header" href="#behavior-in-charge">Behavior in charge</a></h5>
<p>The AGV will never leave the charger until the battery level reaches the HIGH limit.
Any manual orders given to the AGV will be executed when the HIGH battery level has been reached.</p>
<h4 id="low-trigger"><a class="header" href="#low-trigger">LOW trigger</a></h4>
<ul>
<li><strong>Parameter:</strong> ProductionManager_BattLowLevel</li>
<li><strong>Default Value:</strong> 30 %</li>
<li>Should be set to the minimum charge that is optimal for battery life.</li>
</ul>
<h5 id="behavior-in-production-1"><a class="header" href="#behavior-in-production-1">Behavior in production</a></h5>
<p>When the battery level goes below LOW, a rules charging request is generated for the AGV, and it no longer accepts unhandled orders.
If the AGV is executing an order when the battery level goes below LOW, it will finish the order and drive to a charging location.
If there are no free charging locations, the AGV will continue running production. No alarm is raised in this case.</p>
<h5 id="behavior-in-charge-1"><a class="header" href="#behavior-in-charge-1">Behavior in charge</a></h5>
<p>The AGV will never leave the charger until the battery level reaches the HIGH limit.
Any manual orders given to the AGV will be executed when the HIGH battery level has been reached.
The AGV will not leave to execute production orders until the battery level reaches the HIGH level.</p>
<h4 id="high-trigger"><a class="header" href="#high-trigger">HIGH trigger</a></h4>
<ul>
<li><strong>Parameter:</strong> ProductionManager_BattHighLevel</li>
<li><strong>Default Value:</strong> 45 %</li>
<li>Should be set depending on the availability of the charging stations and general process flow.</li>
</ul>
<h5 id="behavior-in-production-2"><a class="header" href="#behavior-in-production-2">Behavior in production</a></h5>
<p>As long as the battery level is at or above the HIGH limit, the AGV will continue production and never charge.</p>
<p>If the battery level goes below HIGH and no production orders exist, the default behavior is that the AGV will drive to a waiting position.
This can be changed by setting the parameter  <strong>ProductionManager_DriveToChargeIfNoProduction</strong> to true.
When <strong>ProductionManager_DriveToChargeIfNoProduction</strong> is true, an AGV with battery level below HIGH will drive to charge with an idle request if it isn't the priority for an unhandled order.
If it becomes priority for new unhandled orders or is given a production order it will leave to execute the order right away.</p>
<p>AGVs might also drive to charge if the charging manager has been configured to keep a certain number of AGVs in charge.
See <em>Keeping a certain number of AGVs in charge</em> for details.</p>
<h5 id="behavior-in-charge-2"><a class="header" href="#behavior-in-charge-2">Behavior in charge</a></h5>
<p>The behavior of a charging AGV with battery level below HIGH depends on the charge request.
If the AGV was sent to charge with a <strong>rules request</strong>, it will not leave to execute any orders until the battery level reaches HIGH.
If the AGV was sent to charge with an <strong>idle request</strong>, it will leave to execute orders if it is the priority to any.</p>
<p>When the battery level reaches the HIGH limit, the AGV will begin executing production orders if there are any.
Otherwise, it will stay in the charger and continue charging unless another AGV needs the charger.
If another AGV needs the charger, the AGV in the charger will leave the charger to make room for the other AGV under the following conditions:</p>
<ol>
<li>There is a free waiting location where the AGV can drive to.</li>
<li>The charging location is not a combined wait and charge location.</li>
<li>There are no other free charging locations.</li>
<li>The incoming AGV has a battery level below the ALERT limit.</li>
</ol>
<p>An AGV will never leave the charger automatically if the charging request is an <strong>external request</strong>.</p>
<h4 id="full-trigger"><a class="header" href="#full-trigger">FULL trigger</a></h4>
<ul>
<li><strong>Parameter:</strong> ProductionManager_BattFullLevel</li>
<li><strong>Default Value:</strong> 98 %</li>
<li>Should be set to the maximum charge that is optimal for battery life.</li>
</ul>
<h5 id="behavior-in-production-3"><a class="header" href="#behavior-in-production-3">Behavior in production</a></h5>
<p>As long as the battery level is above the FULL limit, the AGV will continue production and never go to charge.</p>
<h5 id="behavior-in-charge-3"><a class="header" href="#behavior-in-charge-3">Behavior in charge</a></h5>
<p>By default, an AGV with battery level at or above the FULL limit will behave the same way as an AGV with battery level at or above the HIGH limit.
This means that the charging request for the AGV continues to be active even after the battery reaches the FULL limit.
If the AGV must stop charging when the FULL level is reached, it can be achieved in two ways:</p>
<ol>
<li>Set the parameter <strong>ProductionManager_BehaviorOnFullCharge</strong> to <strong>StopCharging</strong></li>
<li>Set the priority of the charging location to at least HIGH (5) priority.</li>
</ol>
<p>In both cases, the AGV will stop charging when the FULL level is reached.
If a waiting location is available, the AGV will drive there.
Otherwise, the AGV will continue to occupy the charging location but will not be charging.
If the charging location is a combined wait and charge location, the AGV will always stay at the location when charging is finished.</p>
<blockquote>
<p><strong>WARNING</strong></p>
<p>Do not use high priority chargers or set <strong>ProductionManager_BehaviorOnFullCharge</strong> to <strong>StopCharging</strong> if either <strong>ProductionManager_KeepMachinesInChargeCount</strong> or <strong>ProductionManager_ForEveryMachineInProductionCount</strong> have values greater than zero.
It is not supported, and will lead to unwanted behavior.</p>
</blockquote>
<h3 id="keeping-a-certain-number-of-agvs-in-charge"><a class="header" href="#keeping-a-certain-number-of-agvs-in-charge">Keeping a certain number of AGVs in charge</a></h3>
<p>To help keep the production execution steady, it is possible to ensure that a part of the fleet is always in charge.
By doing this, there will always be a charged machine ready to take over production from a machine that needs charging.</p>
<p>Two parameters are used to control how many machines should be kept in charge:</p>
<ul>
<li><strong>ProductionManager_KeepMachinesInChargeCount</strong></li>
<li><strong>ProductionManager_ForEveryMachineInProductionCount</strong></li>
</ul>
<p><strong>ProductionManager_KeepMachinesInChargeCount</strong> defines a constant number of machines to keep in charge.
The charging manager will keep as many machines in charge as defined by this parameter.
If this parameter has been set to, e.g., 2, then at least 2 machines are always kept in charge.</p>
<p><strong>ProductionManager_ForEveryMachineInProductionCount</strong> defines a relative number of machines to keep in charge.
The number of machines to keep in charge will scale together with the size of the active fleet.
The value given to the parameter defines how many non-charging machines there should be per machine sent to charge.
If fewer machines are in production than the parameter's value, then no machines will be kept in charge.</p>
<p>If both <strong>ProductionManager_KeepMachinesInChargeCount</strong> and <strong>ProductionManager_ForEveryMachineInProductionCount</strong> have values greater than zero,
the charging manager will keep the maximum amount of machines in charge based on the two values.
There will always be at least one machine not in charge, regardless of fleet size and the parameter values.</p>
<p>The rules related to keeping a certain number of AGVs in charge do not supersede the general charging rules.
This means that even if there already are enough machines in charge, a machine that needs charging will still go to charge.
If any of the current machines in charge has a battery level above HIGH, it will leave to begin executing production.</p>
<blockquote>
<p><strong>WARNING</strong></p>
<p>Do not use high priority chargers or set <strong>ProductionManager_BehaviorOnFullCharge</strong> to <strong>StopCharging</strong> if either <strong>ProductionManager_KeepMachinesInChargeCount</strong> or <strong>ProductionManager_ForEveryMachineInProductionCount</strong> have values greater than zero.
It is not supported, and will lead to unwanted behavior.</p>
</blockquote>
<p>The following table gives examples of how many machines will be kept in charge at different fleet sizes and parameter values.</p>
<div class="table-wrapper"><table><thead><tr><th><strong>ProductionManager _KeepMachinesInChargeCount</strong></th><th><strong>ProductionManager _ForEveryMachineInProductionCount</strong></th><th>Fleet Size</th><th>AGVs in charge</th></tr></thead><tbody>
<tr><td>2</td><td>0</td><td>5</td><td>2</td></tr>
<tr><td>2</td><td>0</td><td>2</td><td>1</td></tr>
<tr><td>2</td><td>0</td><td>1</td><td>0</td></tr>
<tr><td>0</td><td>2</td><td>9</td><td>3</td></tr>
<tr><td>0</td><td>2</td><td>8</td><td>2</td></tr>
<tr><td>0</td><td>2</td><td>6</td><td>2</td></tr>
<tr><td>0</td><td>2</td><td>3</td><td>1</td></tr>
<tr><td>0</td><td>2</td><td>2</td><td>0</td></tr>
<tr><td>3</td><td>2</td><td>8</td><td>3</td></tr>
<tr><td>3</td><td>2</td><td>3</td><td>2</td></tr>
</tbody></table>
</div>
<h3 id="choosing-a-charge-location"><a class="header" href="#choosing-a-charge-location">Choosing a charge location</a></h3>
<p>By default, machines in need of charge will prioritize driving to the nearest free charging location.
This behavior can be changed by the parameter <strong>ProductionManager_ChargeLocationPriorityRule</strong>, which can have the following values:</p>
<ul>
<li><strong>only_shortest_distance</strong> (default) - Prioritize free charging locations based on the distance from the machine.</li>
<li><strong>highest_priority</strong> - Prioritize charging locations based on their location priority.</li>
<li><strong>lowest_id</strong> - Prioritize charging locations based on their location id.</li>
<li><strong>exclusive_charge_locations</strong> - Prioritize charging locations that only are charging locations and nothing else.</li>
</ul>
<p>If multiple free charging locations are equally good, the machine will choose between those based on the distance and drive to the nearest location.</p>
<p>If all chargers are occupied or unavailable when an AGV needs to be charged, an error is raised for charging location not being available (<strong>ChargeLocationNotAvailable</strong>-error). The charging location is tried to be freed for TrafficController_ABORT_WAIT_TIME_SECONDS time by checking if any other AGV can be released from charger and driven away. If a charging location cannot be freed during this time, then AGV will be routed to a valid waiting symbolic point.</p>
<h3 id="charging-with-hold-release"><a class="header" href="#charging-with-hold-release">Charging with Hold-Release</a></h3>
<p>An AGV in need of charging released from a HOLD-location will only go to charge if at least one of the release locations is a charging location.
If there are charging locations among the possible release destinations, the AGV will ignore the given release destination and instead drive to charge.</p>
<p>The AGV will charge until its battery level reaches the HIGH limit.
The AGV will then drive to the original release destination from the HOLD-location.</p>
<p>If the charging location is also a HOLD-location, the parameter <strong>ProductionManager_DeleteProdOrdersWhenGoingToCharge_Rule</strong> should be set to <strong>true</strong>.
Otherwise the machine will drive to the location it was released to from the initial hold location and not to the release location of the charger.
See <strong>Deleting production orders when going to charge</strong> for details.</p>
<p>The parameter <strong>MissionManager_GenerateChargingRequestsFromHoldRulesOnly_Rule</strong> should be enabled when using hold-release production to control when AGVs can drive to charge.
Enabling that parameter will have the following consequences:</p>
<ol>
<li>Charging requests are only generated by Navithor when an AGV is released from a HOLD-location with at least one charging location as a possible release target. Charging requests will not be generated under any other circumstances.</li>
<li>When charged, the AGV will continue production based on the hold release reason at the previous symbolic point.</li>
</ol>
<p>If another machine should take over for the machine being sent to charging, the parameter <strong>MissionManager_PassProductionOrderToAnotherMachineWhenGoingToCharge_Rule</strong> can be enabled.
When this is enabled, any production order given to the AGV going to charge is transferred to another charging AGV with a higher battery level.
That AGV will then begin executing the order when its battery level has reached the HIGH limit.
The parameter <strong>MissionManager_PassProductionOrderToAnotherMachineWhenGoingToCharge_Rule</strong> is only taken into account in hold-release production.</p>
<p>If chargers are hold locations you should enable the parameter for deleting orders when going to charge.
Otherwise the machine will drive to the location it was released to from the initial hold location and not to the release location of the charger.</p>
<h4 id="choosing-a-charge-location-after-hold-release"><a class="header" href="#choosing-a-charge-location-after-hold-release">Choosing a charge location after HOLD release</a></h4>
<p>When deciding which charge location to drive to, the charge locations specified as alternative release locations will be prioritized.
If all those charging locations are occupied, the AGV will be sent to any other charging location within a distance specified by the parameter <strong>ProductionManager_ALLOW_CHARGING_LOCATION_AUTOSELECT_RADIUS_BOUND</strong>.
Valid charging locations are any free charging locations that fulfills the following requirements:</p>
<ul>
<li>The charging location is within a radius of <strong>ProductionManager_ALLOW_CHARGING_LOCATION_AUTOSELECT_RADIUS_BOUND</strong> meters from any of the alternative charge release locations ignoring the route network.</li>
<li>The driving distance between the charging location and any of the alternative charge release locations must be at most <strong>ProductionManager_ALLOW_CHARGING_LOCATION_AUTOSELECT_RADIUS_BOUND</strong> * 3 meters.</li>
</ul>
<p>In the figure below, the charging locations (6) and (7) are specified as alternative release destinations from a HOLD location.
In this example <strong>ProductionManager_ALLOW_CHARGING_LOCATION_AUTOSELECT_RADIUS_BOUND</strong> is 10.
If both (6) and (7) are occupied, the AGV is allowed to drive to (8) since it is both within a radius of 10 m from (7) and the total driving distance is less than 30 meters.
The AGV is not allowed to drive to (21) even though it is within a radius of 10 meters from (7). The driving distance is much more than 30 meters.</p>
<p><img src="./Images/ChargingManagement/AllowedHoldChargingDestinations.png" alt="Allowed charging destinations from HOLD location" /></p>
<h3 id="controlling-charge-time"><a class="header" href="#controlling-charge-time">Controlling charge time</a></h3>
<p>To ensure that AGVs are not charging for too short a time, the charging manager will not stop charging a machine unless it has been charging for a certain minimum amount of time.
The absolute minimum charge time is defined by the parameter <strong>BATT_CHARGE_MIN_TIME_MINUTES</strong> in the machine type parameter file.
If it is necessary to keep machines charging for longer than this, then the charging manager parameter <strong>ProductionManager_KeepMachinesInChargeMinTime</strong> should be modified.
The minimum charging time will always be the maximum time of <strong>BATT_CHARGE_MIN_TIME_MINUTES</strong> and <strong>ProductionManager_KeepMachinesInChargeMinTime</strong>.</p>
<h3 id="deleting-production-orders-when-going-to-charge"><a class="header" href="#deleting-production-orders-when-going-to-charge">Deleting production orders when going to charge</a></h3>
<p>If an AGV has a production order when it starts charging, it will keep that order and begin executing it when the battery level has reached the HIGH limit by default.
That behavior can be changed by enabling the parameter  <strong>ProductionManager_DeleteProdOrdersWhenGoingToCharge_Rule</strong>.
When enabled, any production order given to the AGV is deleted automatically when the AGV starts charging.</p>
<p>This should be enabled when production is 'resource at location' triggered and waiting locations are defined in the area.
By enabling this, other AGVs in the system can handle the order left undone by the AGV in the charging station.</p>
<h3 id="controlling-where-charging-requests-are-generated-from"><a class="header" href="#controlling-where-charging-requests-are-generated-from">Controlling where charging requests are generated from</a></h3>
<p>By default, a charging request can be generated for an AGV, when it is standing still at a waiting location, and when it is driving somewhere.</p>
<p>To avoid charging requests being sent while the AGV is driving, the flag <strong>AllowChargeRequestOnlyFromWait</strong> can be enabled in the parameter <strong>ProductionManager_BatteryManagementRules</strong>.
When this flag is enabled, charging requests can only be generated for machines currently at waiting locations.</p>
<h3 id="aborting-charging-manually"><a class="header" href="#aborting-charging-manually">Aborting charging manually</a></h3>
<p>Charging can be aborted from Navithor Client or Web Client by pressing Abort-button. Automatic charging requests generated by the system will be disabled for 30 seconds after charging request have been removed. This is to give time for manual operations to move AGV out of charger if needed. Unless nothing is done during the 30 seconds and AGV is at the charging station, then charging may restart - depending on AGVs battery level and parameters.</p>
<h3 id="swapping-wait-and-charge-locations"><a class="header" href="#swapping-wait-and-charge-locations">Swapping wait and charge locations</a></h3>
<p>Two machines can't swap locations if one is charging and another is waiting.
This means that if there are no free waiting locations and a machine at a waiting location requires charging,
it will not be able to go to charge since any fully charged machine in a charging location will not be able to leave.</p>
<p>The opposite behavior can be forced by enabling the flag <strong>AllowOnlySwappingOfLocation</strong> in the parameter <strong>ProductionManager_BatteryManagementRules</strong>.
When this flag is enabled, a machine at a dedicated charging location is only allowed to leave the charging location if it can swap locations with a machine at a waiting location currently in need of charging.
This does mean that the charging machine will not leave the charger if there are no other AGVs it can swap position with even if there is production to execute.</p>
<h3 id="only-allow-charging-requests-when-battery-level-is-below-alert"><a class="header" href="#only-allow-charging-requests-when-battery-level-is-below-alert">Only allow charging requests when battery level is below ALERT</a></h3>
<p>By defining an Alternative Charging Rules Zone in Navithor Tools, it is possible to create areas where a machine will only receive a charging request if the battery level goes below ALERT.
See documentation about feature zones in the Navithor Tools manual for details on how to create the zone. </p>
<h3 id="all-charging-management-parameters"><a class="header" href="#all-charging-management-parameters">All charging management parameters</a></h3>
<p>This section contains all parameters in the Client that influence how the charging manager works.
Refer to the mentioned sections for a detailed description of how the related functionality works and can be configured.</p>
<ul>
<li><strong>ChargingManager_CHARGING_ERROR_WAIT_TIME_MINUTES</strong> - A charging error is triggered if charging does not start within this time after the AGV has arrived at a charger.</li>
<li><strong>MissionManager_DriveAwayRules</strong> option <strong>DriveAwayFromChargerIfChargingFails</strong> - If AGV is requested to charge, but it fails to start charging within the time limit defined by the parameter mentioned above, it can be driven away from the charger and then back to the same charge, if this rule is enabled.</li>
<li><strong>ProductionManager_ControlBatteryCharging</strong> - Enables the charging management. See <em>Enabling charging management</em>.</li>
<li><strong>MissionManager_PassProductionOrderToAnotherMachineWhenGoingToCharge_Rule</strong> - In hold-release production this will enable transferring production orders to other charging machines. See <em>Charging with Hold-Release</em>.</li>
<li><strong>ProductionManager_BattFullLevel</strong>, <strong>ProductionManager_BattHighLevel</strong>, <strong>ProductionManager_BattLowLevel</strong>, <strong>ProductionManager_BattAlertLevel</strong> - Defines the battery level limits used by the charging manager. See <em>AGV battery levels</em>.</li>
<li><strong>ProductionManager_KeepMachinesInChargeCount</strong>, <strong>ProductionManager_ForEveryMachineInProductionCount</strong> - Controls the minimum amount of AGVs in charge at all times. See <em>Keeping a certain number of AGVs in charge</em>.</li>
<li><strong>ProductionManager_KeepMachinesInChargeMinTime</strong> - The minimum time to keep an AGV in charge. See <em>Controlling charge time</em>.</li>
<li><strong>ProductionManager_DriveToChargeIfNoProduction</strong> - When enabled, AGVs will drive to charge if there is no production and the battery level is below the HIGH limit. See <em>AGV battery levels - HIGH trigger</em>.</li>
<li><strong>ProductionManager_ChargeAsWait</strong> - When enabled, AGVs can use charging locations as if they were wait locations.</li>
<li><strong>ProductionManager_DeleteProdOrdersWhenGoingToCharge_Rule</strong> - Enabling this will delete the production order of an AGV when it arrives at a charger. See <em>Deleting production orders when going to charge</em>.</li>
<li><strong>ProductionManager_UpdateBattTimesFromOpeTimes</strong> - When this is enabled, the operation times of AGVs are used to update battery levels. See <em>Enabling charging management</em>.</li>
<li><strong>MissionManager_GenerateChargingRequestsFromHoldRulesOnly_Rule</strong> - When this is enabled, charging requests are only generated from HOLD-locations. See <em>Charging with Hold-Release</em>.</li>
<li><strong>ProductionManager_ChargeLocationPriorityRule</strong> - Changes how charging locations are chosen for AGVs. See <em>Choosing a charge location</em>.</li>
<li><strong>ProductionManager_BehaviorOnFullCharge</strong> - Changes how an AGV reacts when the battery has been fully charged. See <em>AGV battery levels - FULL trigger</em>.</li>
<li><strong>Machine_BATTERY_STATUS_DROP_GAIN_AUTO</strong> - Controls how much battery level is decreased when an AGV moves, and operation times are used to control battery level. See <em>Base battery level on operation times</em>.</li>
<li><strong>MissionManager_OrderAssignmentRules</strong> - Controls when unhandled orders are assigned to an AGV. See <em>Controlling assignment of unhandled orders while charging</em>.</li>
<li><strong>ProductionManager_AllowChargeAbortInFSTOP_Rule</strong> - When true, an AGV can stop charging and be assigned unhandled orders if it has battery level above HIGH. 
If false, it will never be assigned unhandled orders as long as it is in FSTOP.</li>
<li><strong>ProductionManager_BatteryManagementRules</strong> - Different rules controlling how charging is managed. See <em>Swapping wait and charge locations</em> and <em>Swapping wait and charge locations</em>.</li>
<li><strong>ProductionManager_ALLOW_CHARGING_LOCATION_AUTOSELECT_RADIUS_BOUND</strong> - Controls the area from which charging locations can be chosen when an AGV is released from HOLD and needs charging. See <strong>Choosing a charge location after HOLD release</strong>.</li>
</ul>
<h2 id="opportunity-charging"><a class="header" href="#opportunity-charging">Opportunity Charging</a></h2>
<p>Opportunity charging feature has been introduced in Navithor version 2.10.0.0. Opportunity charging is standalone feature separate from charging manager. It is only effective when AGV is at Symbolic Point that is set as charging location and machine type parameter <strong>BATTERY_ENABLED</strong> is set to 1. Opportunity charging has following parameters to control:</p>
<p><strong>ProductionManager_OpportunityChargingMode</strong> – mode-parameter to enable opportunity charging. This is independent from parameter ProductionManager_ControlBatteryCharging. Opportunity charging can be enabled even if normal charging manager is disabled. The parameter is a set of rules to configure the charging:</p>
<ul>
<li>Disabled</li>
<li>Enabled</li>
<li>ForceUntilHighBattLevel
<ul>
<li>Uses parameter <strong>ProductionManager_BattFullLevel</strong> to define when opportunity charging is forced</li>
</ul>
</li>
<li>ForceUntilFullBattLevel
<ul>
<li>Uses parameter <strong>ProductionManager_BattHighLevel</strong> to define when opportunity charging is forced</li>
</ul>
</li>
<li>ForceMinChargingTime
<ul>
<li>Uses parameter <strong>ProductionManager_KeepMachinesInChargeMinTime</strong> to define when opportunity charging is forced</li>
</ul>
</li>
<li>ForceUntilMaxOpportunityChargeTime
<ul>
<li>Uses parameter <strong>ProductionManager_OpportunityCharging_MaxChargeTime</strong> to define time that opportunity charging is forced and then after this time forcing is disabled. Checking this rule will ignore other rules meaning that this rule should be used only if a specific time at charger needs to be spent.</li>
</ul>
</li>
</ul>
<p>When opportunity charging is forced then AGV is not allowed to move. Opportunity charging itself is not a task like charge_battery or drive so the AGV is trying to get new tasks while charging. WaitForProduction-task is returned in those cases when AGV should continue its production order execution with a drive task but the opportunity charging is still forced. Forcing will be stopped if AGV moves or Navitrol State is not valid for charging:</p>
<p><strong>ProductionManager_OpportunityCharging_AllowedMachineStates</strong> – This defines allowed Navitrol States when opportunity charging is allowed. A flag parameter with currently following possibilities:</p>
<ul>
<li>None,</li>
<li>STBY,</li>
<li>FSTOP,</li>
<li>ACTUATOR_CONTROL,</li>
<li>HOLD,</li>
<li>PAUSE,</li>
<li>MANUAL.</li>
</ul>
<p>If AGV is at charger and the opportunity charging has been started but the charging is not forced or forcing time has ended then the charging process will stop when:</p>
<ul>
<li>Battery level has reached value defined by parameter <strong>ProductionManager_OpportunityCharging_StopCharginLevel</strong></li>
<li>AGV moves</li>
</ul>
<p><strong>ProductionManager_OpportunityCharging_StopCharginLevel</strong> – Battery level when opportunity charging is set complete and charging command as 0 is sent to Navitrol.</p>
<p><strong>ProductionManager_OpportunityCharging_MaxChargeTime</strong> – Used to force opportunity charging for a specific amount of time. Used if <strong>ProductionManager_OpportunityChargingMode</strong> has ForceUntilMaxOpportunityChargeTime-rule checked.</p>
<p><strong>ProductionManager_OpportunityCharging_StartDelay</strong> – Time delay from the moment when charging could be started to the time when charging command with value as 2 (enable charging) is sent to Navitrol and OpportunityChargingState of AGV in Navithor changes to ChargingActive. If any of the forcing rules are enabled then AGV will spend the specified time in the charger before it can execute possible pending orders.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="using-one-machine-zones"><a class="header" href="#using-one-machine-zones">Using One Machine Zones</a></h1>
<p>This document contains information on &quot;One Machine Zones&quot;.</p>
<p>Updated 25.09.2018</p>
<h2 id="version-history-26"><a class="header" href="#version-history-26">Version History</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Version</th><th>Date</th><th>Author</th><th>Change</th></tr></thead><tbody>
<tr><td>1.0</td><td>25.09.2018</td><td>Joni Sundholm</td><td>First version</td></tr>
<tr><td>1.4</td><td>11.06.2021</td><td>Aleksi Ålander</td><td>Renamed title</td></tr>
</tbody></table>
</div>
<hr />
<h2 id="introduction-15"><a class="header" href="#introduction-15">Introduction</a></h2>
<p>One Machine Zone-feature was created to address the need of marking
specific traffic areas as exclusive. As production area may have very
complex route network and all traffic management related parameters
cannot create a setup that would be universally optimal then One Machine
Zones are a good tool to make local traffic management work as intended.</p>
<p>This feature has been taken into use in production areas where all
safety distance related parameters have been set near zero due to need
of driving agvs very near each other. As these safety related parameters
are universal for the area this then may cause traffic issues in other
locations when Navithor drives the agvs too close to each other. Using
One Machine Zones is specific locations it is then possible to prevent
agvs entering areas that needs to be reserved for other agv as long as
it operates within that area.</p>
<h2 id="creating-one-machine-zones"><a class="header" href="#creating-one-machine-zones">Creating One Machine Zones</a></h2>
<p>Navithor Tools has Zone Tool for creating different types of production
zones. One of possible zones is One Machine Zone. User can specify a
name and edit the generated ID. After uploading the production area to
Navithor this One Machine Zone is operable.</p>
<p><img src="Images/oneMachineZones/image3.png" alt="" /></p>
<blockquote>
<p>Creating One Machine Zone</p>
</blockquote>
<h2 id="one-machine-zones-in-production"><a class="header" href="#one-machine-zones-in-production">One Machine Zones in Production</a></h2>
<p>Navithor Server checks the occupancy of each One Machine Zone based on
few criteria:</p>
<ul>
<li>
<p>AGV's navigation point is within the bounds of the area</p>
</li>
<li>
<p>AGV's given drive path contains segment points that are within the
bounds of the area</p>
</li>
</ul>
<p>As the navigation point and the given path are the only occupancy check
items AGV's frame bounds are ignored. This makes it easier to define the
bounds for the one machine zones.</p>
<p>Once AGV has been set to occupy a One Machine Zone no other AGV can
enter the zone. System parameter
<strong>TrafficController_ONE_MACHINE_ZONE_WAIT_DIST</strong> defines how far
from the edge of the zone a stopping point is assigned. The parameter
distance is in metres and it is from AGV's navigation point to the edge
of the One Machine Zone.</p>
<p>An AGV that is within a One Machine Zone will always have right to use
the traffic areas within the zone. Also scheduler handles the One
Machine Zones in a way that AGV within a zone has always higher priority
over another AGV entering the area.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="distance-control-zones"><a class="header" href="#distance-control-zones">Distance Control Zones</a></h1>
<p>This document contains information on Navithor distances control zones.</p>
<p>Updated 25.09.2018</p>
<h2 id="version-history-27"><a class="header" href="#version-history-27">Version History</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Version</th><th>Date</th><th>Author</th><th>Change</th></tr></thead><tbody>
<tr><td>1.0</td><td>25.09.2018</td><td>Joni Sundholm</td><td>First version. Reflecting Navithor version 1.9.52.0</td></tr>
<tr><td>1.1</td><td>11.06.2021</td><td>Aleksi Ålander</td><td>Renamed title</td></tr>
</tbody></table>
</div>
<hr />
<h2 id="introduction-16"><a class="header" href="#introduction-16">Introduction</a></h2>
<p>A distance control zone is a fleet control feature that enables AGVs to
drive through an lane with constant distances between AGVs. A polygon
defined in Navithor Tools marks the area that is controlled. When ever
an AGV is routed within this area it will be taken into distance
control.</p>
<p>Actions taken by Fleet Control when AGV enters zone:</p>
<ul>
<li>
<p>Drive-extension through the distance control zone is given (Safe
stop point -feature is disabled)</p>
</li>
<li>
<p>SetSpeed-order is given according to the speed rules of the zone and
possible need of slow down or speed up to gain correct distance to
AGV ahead</p>
</li>
<li>
<p>Optimal zone exit time is calculated. This information is used to
understand situations when AGV queue gets delayed and speeds may
then be increased to catch the delay</p>
</li>
</ul>
<p>Periodically actions taken by Fleet Control when AGV is within zone:</p>
<ul>
<li>
<p>Calculate distance to AGV ahead (if found)</p>
</li>
<li>
<p>SetSpeed-order is given based on need of changing speed, e.g:</p>
<ul>
<li>
<p>AGV ahead stops (=&gt; distance too low)</p>
</li>
<li>
<p>AGV ahead speeds up (=&gt; distance increasing)</p>
</li>
<li>
<p>AGV ahead diverts from lane (AGV ahead changes)</p>
</li>
<li>
<p>Merging of two lanes ahead</p>
</li>
<li>
<p>Speed offsets changed (Client user)</p>
</li>
<li>
<p>Distance offset changed (Client user)</p>
</li>
</ul>
</li>
<li>
<p>Calculate time to exit</p>
</li>
<li>
<p>Calculate need of merging two AGVs from different lanes into one</p>
</li>
</ul>
<h2 id="creating-distance-control-zones"><a class="header" href="#creating-distance-control-zones">Creating Distance Control Zones</a></h2>
<p>Navithor Tools has Zone Tool for creating different types of production
zones. One of possible zones is Distance Control Zone. User can specify
a name and edit the generated ID. Additionally distance control zone
needs reference distance and reference speed. Reference distance means
distance between navigation points of AGVs.</p>
<p><img src="Images/distanceControlZones/image3.png" alt="" /></p>
<blockquote>
<p>Navithor Tools - Feature Zone tool control and Distance
Control Zone</p>
</blockquote>
<p>The speed that is defined for the routes within the zone (Route
Properties tool control) defines the maximum speed. Thus the AGV may be
given a speed limit that is more than the reference speed defined for
the zone. This happens in cases when AGV needs to speed up in cases of
delay or too large distance to AGV ahead.</p>
<p>Complex route networks within a distance control zone will not work.
This feature is targeted for assembly line operation where AGVs follow
each other on same path but can exit the line at some points and also
there can be merging points where two routes join to common lane. All
routes within zone should be one-way-oriented.</p>
<h2 id="distance-control-zones-in-production"><a class="header" href="#distance-control-zones-in-production">Distance Control Zones in Production</a></h2>
<h3 id="setup"><a class="header" href="#setup">Setup</a></h3>
<p>Distance Control Zones are loaded into Server memory when read from
definition file. No system parameters are needed to be changed. For very
slow moving AGVs these parameters should be checked for validity:</p>
<p>Scheduler_MACHINE_MIN_SPEED -- should be lower than the reference
speed of distance control zone</p>
<p>TrafficController_NEAR_ZERO_SPEED_LIMIT -- should also be lower than
the reference speed</p>
<p>Distance control zone-parameters are stored in a separate xml-file found
in subfolder &quot;Parameters\DistanceControlParams.xml&quot; of Navithor Servers
main folder.</p>
<h3 id="operation"><a class="header" href="#operation">Operation</a></h3>
<p>Navithor will automatically add and remove AGVs to/from distance control
operation when AGVs cross the bounds of the distance control zone. All
AGVs entering the zone are given a drive order or -extension to the end
of the zone. Thus some of normal safety features of Navithor are not
used. Only SetSpeed-commands are given in order to keep the AGVs in
correct distance from each other.</p>
<p>Navithor Client will show a control panel for Distance Control Zone when
mouse is pressed within the zone polygon. Client user has possibility to
change speed offset and distance offset. Also some control gains can be
changed.</p>
<p><img src="Images/distanceControlZones/image4.png" alt="" /></p>
<blockquote>
<p>Distance Control Zone's control panel in Navithor Client</p>
</blockquote>
<div style="break-before: page; page-break-before: always;"></div><h1 id="fire-alarm-zones"><a class="header" href="#fire-alarm-zones">Fire Alarm Zones</a></h1>
<p>This document contains information on how to use the fire alarm zones.</p>
<p>Updated 28.06.2022</p>
<h2 id="version-history-28"><a class="header" href="#version-history-28">Version History</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Version</th><th>Date</th><th>Author</th><th>Change</th></tr></thead><tbody>
<tr><td>1.0</td><td>23.06.2020</td><td>Samuli Vaara</td><td>Initial documentation</td></tr>
<tr><td>1.1</td><td>04.12.2020</td><td>Samuli Vaara</td><td>Queues, priorities.</td></tr>
<tr><td>1.2</td><td>27.01.2021</td><td>Samuli Vaara</td><td>Formatting</td></tr>
<tr><td>1.3</td><td>11.06.2021</td><td>Aleksi Ålander</td><td>Renamed title</td></tr>
<tr><td>1.4</td><td>28.06.2022</td><td>Joni Sundholm</td><td>Corrections based on updated functionality in Navithor ver 2.51.</td></tr>
</tbody></table>
</div>
<hr />
<h2 id="quick-overview"><a class="header" href="#quick-overview">Quick Overview</a></h2>
<p>FireAlarmZone gives a way to define areas where AGVs will try to drive away from when a fire alarm is set active.
The AGVs within an activated fire alarm zone are taken out of production and will be driven to defined fire alarm exit locations.
It is also possible to define routes that can only be driven only when an alarm is active.
These routes are normally hidden, but they are visualized while the fire alarm is active.</p>
<p>Machines will not drive into an activated fire alarm zone unless there is a possible route to the AGVs target that is marked with route rule 'Fire alarm active'.
In that case the AGV can continue its production without being interrupted.
The routes that are only driveable while a firealarm is active and symbolic points connected to such routes are hidden in the client while there is no fire alarm set active.</p>
<p>This document gives a short explanation on how to use the FireAlarmZones.</p>
<h2 id="using-the-zones"><a class="header" href="#using-the-zones">Using the zones</a></h2>
<h3 id="tools-configuration"><a class="header" href="#tools-configuration">Tools Configuration</a></h3>
<p><img src="./Images/FireAlarmZones/ZoneExample.png" alt="" /></p>
<blockquote>
<p>Figure 1: Example of defining a zone with fire alarm ID 10</p>
</blockquote>
<p><img src="./Images/FireAlarmZones/RuleExample.png" alt="" /></p>
<blockquote>
<p>Figure 2: Example of defining a fire alarm only rule for a route using fire alarm ID 10</p>
</blockquote>
<p>Defining the fire alarm zones and rules for routes is done in Navithor Tools. This is done the same way as any other zone or route. Only difference being that you can define a firealarm specific id for the rule and for the area. This is shown in figure 1 and 2.</p>
<p>You can also provide a priority for zones, they will be explained in their own section in this document.</p>
<img src="./Images/FireAlarmZones/FireAlarmZone.png" style="zoom:80%;" />
<blockquote>
<p>Figure 3: Yellow FireAlarmZone and routes with fire alarm only rule are highlighted in red.</p>
</blockquote>
<p>You are able to define zones with different firealarm IDs, you are also able to create multiple zones linked to the same ID.</p>
<p>There are 2 route rules available to restrict the driving with fire alarm zones:</p>
<ul>
<li><strong>Fire alarm active</strong> rule: Driving through the segments having this rule is allowed ONLY when the fire alarm zone specified in 'Fire Alarm Settings' ID-field the segments is activated (see Figure 2). This rule can be used to define special paths and locations that are only available during fire alarm to drive the AGVs to safe locations during the fire alarm is active. The rule can also be used to allow a certain route though fire alarm zone that AGVs can drive freely during fire alarm. AGVs can also enter active fire alarm zone if their path goes though the zone using route that has this rule enabled though the fire alarm zone.</li>
<li><strong>Fire alarm inactive</strong> rule: Driving the route is allowed only when the specified fire alarm zone is not active. This rule can be used for example in cases when a route can be used in normal production, but during fire alarm, the route should not be used. The route is not required to be within any fire alarm zone.</li>
</ul>
<p>The intended use case for the feature is that AGVs can drive away from a main road to make room for emergency vehicles and such. The AGVs will simply select the closest free symbolic point outside the zone that is defined as an allowed fire escape location from the activated zone. Each AGV inside active fire alarm zone will be driven to an exit location with high priority. Example shown in figure 3. There should be multiple exits with symbolic points at the ends, especially if it is expected that there are multiple AGVs inside a fire alarm zone.</p>
<h3 id="server-configuration-allowed-locations-and-queues"><a class="header" href="#server-configuration-allowed-locations-and-queues">Server configuration, allowed locations and queues</a></h3>
<p>Configuring fire alarm exit locations is currently done in a text file within the Overrides-folder in the servers directory. Upon booting up the server FireAlarmConfiguration.txt is generated there, unless it already exists. In the default file, all symbolic points are allowed for all fire alarms. Default configuration is valid in case all production locations near the fire alarm zones are valid to be occupied. In case there are such physical obstacles or if the symbolic points should only be accessed when targeted, then a custom fire alarm configuration should be made to the FireAlarmConfiguration.txt-file.</p>
<p>In this file you are able to define which symbolic points are allowed location for an alarm, and is it a queue type symbolic point by setting the machinecount higher than 1.</p>
<p>When setting a symbolic point as a queue type, it <strong>must</strong> be on a one way street so that AGV can keep moving after the firealarm is deactivated.</p>
<p>The format in the file is <strong>SymbolicPoint ID ; Alarm ID 1 , ... , Alarm ID X; MachineCount</strong></p>
<p>Examples:</p>
<p>5;1,2,3;2 (Symbolic point 5 can queue 2 AGVs for alarms 1,2,3)
3 (Symbolic point 3 is an exit location available for all alarms and a single machine)</p>
<h2 id="activationdeactivation-of-firealarms"><a class="header" href="#activationdeactivation-of-firealarms">Activation/Deactivation of Firealarms</a></h2>
<h3 id="usage-through-mes-interface"><a class="header" href="#usage-through-mes-interface">Usage through MES Interface</a></h3>
<p>Toggling the firealarms is done via the MES Interface using message  <strong>FireAlarmSignal</strong> (ID = 36), the message contains ID of the fire alarm and status of the fire alarm. Navithor reports the status of zones with active fire alarms with MES Interface message <strong>ActiveFireAlarmStatus</strong> (ID=326) which contains the ID of the fire alarm along with how many machines are still within the bounds of the area. The status is sent periodically and the interval can be set using <strong>TrafficController_FireAlarmStatusUpdateIntervalMs</strong>. These are defined in the MES Messages section.</p>
<h3 id="usage-in-client"><a class="header" href="#usage-in-client">Usage in Client.</a></h3>
<p><img src="./Images/FireAlarmZones/ProductionView.png" alt="" /></p>
<blockquote>
<p>Figure 4: Activating all alarms from production view.</p>
</blockquote>
<p>Fire alarms can be set active on the client as well. You can set all Alarms active from the main production view in the lower right corner. It will ask for confirmation after pressing the button in figure 4.</p>
<p><img src="./Images/FireAlarmZones/TabView.png" alt="" /></p>
<blockquote>
<p>Figure 5: TabView, clearing activating/deactivating single alarms.</p>
</blockquote>
<p>In the FireAlarm tab, you are able to both deactivate and activate alarms. When hovering over an alarm the respective zone will be highlighted. You are also able to clear all active alarms at once. All actions ask for a confirmation from the user.</p>
<h3 id="behavior"><a class="header" href="#behavior">Behavior</a></h3>
<p>Once a fire alarm is activated, all machines inside the zone will be taken out of production. They will select the closest allowed symbolic point, reserve it and drive to it. Any symbolic point is fine as long as it is outside of the zone and available. In case the drive gets aborted and machines stays in idle mode for some time, the machine will get routed again. The time the machine is allowed to stay in STBY mode inside is defined by <strong>TrafficController_FireAlarmMaxTimeInSTBY</strong>. By default this time is 5 seconds.</p>
<p>When the fire alarm is set back inactive by default the AGVs will not return to production. They can be set to return to production by setting <strong>TrafficController_ReturnToProductionAfterFireAlarm</strong> to true.</p>
<p><strong>Priorities</strong></p>
<p>When zones have a priority, the zone with the highest priority will be cleared first. Until that zone is cleared, machines in other zones will only wait.</p>
<h2 id="limitations"><a class="header" href="#limitations">Limitations</a></h2>
<p>Current implementation expects there to be enough routes and symbolic points available and space between machines. This can cause possible issues in certain areas with a <strong>large amount of machines in the zone</strong> and <strong>not enough exits</strong>, or badly planned fire alarm zone.  Symbolicpoints that the machine can drive through can also be bad near the Zone if multiple machines need to drive out as the first machine may block the second. This is why the allowed symbolic points to exit to must be set correctly.</p>
<p><img src="./Images/FireAlarmZones/FireAlarmZoneBad.png" alt="" /></p>
<blockquote>
<p>Figure 6: Symbolic points at the marked locations could cause problems for routing away from the zone in case there are more machines.</p>
</blockquote>
<p>Currently you are required to create multiple exit routes with symbolic points at the end, and it does not reliably handle multiple machines in a small area if there are not enough exits.</p>
<p>Example: In figure 6, if there were multiple machines within the zone and symbolic points in the marked areas. It would currently be possible for a machine to select that point and prevent the following machines to continue their escape from the area. Of course with four fire route exits there would have to be six to seven machines in that small area for this to happen.</p>
<h2 id="mes-messages"><a class="header" href="#mes-messages">MES Messages</a></h2>
<table>
  <tr>
    <td colspan="2"> <b>ID = 36</b> </td>
    <td colspan="4"> <b>FireAlarmSignal</b> </td>
  </tr>
  <tr>
    <td colspan="2"><b>Message Length</b></td>
    <td colspan="2">Min = 14</td>
    <td colspan="2">Max = 14</td>
  </tr>
  <tr>
    <td colspan="2"> <b>Description</b></td>
    <td colspan="4">
        This message can be used to activate fire alarm. AGVs inside the active fire alarm zone will drive away of the zone to the closest available symbolic point outside of the zone. During normal operation status is 1. When the fire alarm is active, Status 3 should be sent.
    </td>
  </tr>
  <tr>
    <td colspan="1"> <b>Field Name</b> </td>
    <td colspan="1"> <b>Type</b> </td>
    <td colspan="1"> <b>Length</b></td>
    <td colspan="3"> <b>Description</b></td>
  </tr>
  <tr>
    <!--Field-->
    <td colspan="1"> FireAlarmID </td>
    <!--Type-->
    <td colspan="1"> UInt32 </td>
    <!--Length-->
    <td colspan="1"> 4 </td>
    <!--Description-->
    <td colspan="3"> Id for the fire alarm zone </td>
  </tr>
  <tr>
    <!--Field-->
    <td colspan="1"> Status </td>
    <!--Type-->
    <td colspan="1"> Byte </td>
    <!--Length-->
    <td colspan="1"> 1 </td>
    <!--Description-->
          <td colspan="3"> 0 = none, <b>1 = inactive</b>, 2 = deactivating, <b>3 = fire alarm active</b> </td>
  </tr>
</table>
<table>
  <tr>
    <td colspan="2"> <b>ID = 326</b> </td>
    <td colspan="4"> <b>ActiveFireAlarmStatus</b> </td>
  </tr>
  <tr>
    <td colspan="2"><b>Message Length</b></td>
    <td colspan="2">Min = 15</td>
    <td colspan="2">Max = 15</td>
  </tr>
  <tr>
    <td colspan="2"> <b>Description</b></td>
    <td colspan="4">
        Status message containing information about an active firealarm. Sent periodically, interval defined by TrafficController_FireAlarmStatusUpdateIntervalMs
    </td>
  </tr>
  <tr>
    <td colspan="1"> <b>Field Name</b> </td>
    <td colspan="1"> <b>Type</b> </td>
    <td colspan="1"> <b>Length</b></td>
    <td colspan="3"> <b>Description</b></td>
  </tr>
  <tr>
    <!--Field-->
    <td colspan="1"> FireAlarmID </td>
    <!--Type-->
    <td colspan="1"> UInt32 </td>
    <!--Length-->
    <td colspan="1"> 4 </td>
    <!--Description-->
    <td colspan="3"> Id of the active fire alarm </td>
  </tr>
      <tr>
    <!--Field-->
    <td colspan="1"> MachineCount </td>
    <!--Type-->
    <td colspan="1"> UInt16 </td>
    <!--Length-->
    <td colspan="1"> 2 </td>
    <!--Description-->
    <td colspan="3"> Number of machines that are still in the zones belonging to the alarm. </td>
  </tr>
</table>
<div style="break-before: page; page-break-before: always;"></div><h1 id="using-zone-status-request-message"><a class="header" href="#using-zone-status-request-message">Using zone status request message</a></h1>
<p>This document contains information on zone status messages.</p>
<p>Updated 25.02.2021</p>
<h2 id="version-history-29"><a class="header" href="#version-history-29">Version History</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Version</th><th>Date</th><th>Author</th><th>Change</th></tr></thead><tbody>
<tr><td>1.0</td><td>18.09.2020</td><td>Antti Parkkonen</td><td>1st Version of the document</td></tr>
<tr><td>1.1</td><td>25.02.2021</td><td>Toni Liski</td><td>Added description for parameter RoutePlanner_SEGMENT_DRIVE_BLOCKED_TIME_PENALTY_SECS</td></tr>
<tr><td>1.1</td><td>11.06.2021</td><td>Aleksi Ålander</td><td>Renamed title, minor formating corrections.</td></tr>
</tbody></table>
</div>
<hr />
<h2 id="requirements-2"><a class="header" href="#requirements-2">Requirements</a></h2>
<ul>
<li>Usual Navithor requirements</li>
<li>Correctly configured production area.</li>
<li>MES Interface</li>
</ul>
<h2 id="introduction-and-usage"><a class="header" href="#introduction-and-usage">Introduction and usage</a></h2>
<p>From Navithor version 2.20.0.0 it's possible to ask Navithor if there are AGVs inside any zone polygon or a specific zone polygon. Per request Navithor checks the position of each AGV and checks if the position is within the requested zone's boundaries.</p>
<p>Two example use cases for this feature are</p>
<ol>
<li>
<p>reporting zone occupancy to control traffic lights for human driven vehicles, and</p>
</li>
<li>
<p>in combination with forbidden zones feature zone status reporting can be used to coordinate AGV traffic in areas where multiple fleet control systems share space.</p>
</li>
</ol>
<p><strong>Case 1</strong></p>
<p>For this use case the only requirement is to draw any zone in Navithor Tools to the area where AGV traffic needs to be monitored. As this area is uploaded to Navithor an MES client can poll the occupancy status of the drawn zone from Navithor using the messages documented below.</p>
<p>When the zone status reply tells that the zone is empty (Zone occupancy field 0 in the message) the MES Client can show a green light for the human driven vehicles. However, when the zone occupancy field is 1 the MES Client should show red light for the human driven vehicles as there is at least one AGV close to the intersection.</p>
<p><strong>Case 2</strong> </p>
<p>If the zone status polling is used to coordinate one ore more AGV systems working on a shared area the zones used for this need to be set as <em>forbidden zones</em>. The picture below shows where to find forbidden zones.</p>
<p><img src="./Images/zoneStatus/ForbiddenZone.png" alt="ForbiddenZone" /></p>
<p>Forbidden zones can be set undriveable using a MES message. Thus when an AGV not controlled by Navithor enters a forbidden zone, MES client can forbid Navithor from driving AGVs into this area until it is free again. The same works vice versa. MES clients should be able to forbid other AGV systems from driving into the forbidden zone when Navithor reports that there are Navithor controlled AGVs inside the zone.</p>
<p><strong>Note!</strong> See the parameter in the next section.</p>
<h2 id="parameters-2"><a class="header" href="#parameters-2">Parameters</a></h2>
<p>By default forbidding the drive inside the zone will give a penalty for the route. In case there are other possible routes, they are preferred, but it does not totally forbid driving through the zone. </p>
<p>By setting following parameter to <strong>-1</strong> will disable the penalty and forbid the segments within the zone completely.</p>
<p>​	 <strong>RoutePlanner_SEGMENT_DRIVE_BLOCKED_TIME_PENALTY_SECS</strong></p>
<p>Please notice, however, that this will affect all segment blockings in the area. This means, that Navithor will never plan the routes through the section where there are segments forbidden by the Traffic Controller. Such case can be when there is a stationary waiting location close to main route, where machine is standing. In this case might be that part of the main route is blocked and no drive can be planned pass the waiting location.</p>
<h2 id="mes-interface-messages-1"><a class="header" href="#mes-interface-messages-1">MES Interface messages</a></h2>
<p>See more detailed explanations from the document  Communication specification between Navithor and MES.</p>
<h3 id="request-zone-status-id--51"><a class="header" href="#request-zone-status-id--51">Request zone status (ID = 51)</a></h3>
<p>Gets the status of all zones or the status of a specified zone.  Valid since Navithor 2.20.0.0 forward.</p>
<h3 id="zone-status-reply-id--333"><a class="header" href="#zone-status-reply-id--333">Zone status reply (ID = 333)</a></h3>
<p>Reply to the Request zone status message (ID 51). Valid from Navithor 2.20.0.0 forward.</p>
<h3 id="set-zone-forbidden-message-id--33"><a class="header" href="#set-zone-forbidden-message-id--33">Set zone forbidden message (ID = 33)</a></h3>
<p>This message can be used to forbid or allow AGV driving on specific route segments / areas. Multiple waypoints can be allowed or forbidden in a single message. Please see the required parameter in the Parameters Section. Valid since Navithor version 2.0.1.8 forwards.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="tag-statuses"><a class="header" href="#tag-statuses">Tag Statuses</a></h1>
<p>This document contains information on door status and their controlers.</p>
<p>Updated 14.06.2019</p>
<h2 id="version-history-30"><a class="header" href="#version-history-30">Version History</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Version</th><th>Date</th><th>Author</th><th>Description</th></tr></thead><tbody>
<tr><td>1.0</td><td>14.06.2019</td><td>Antti Parkkonen</td><td>First version</td></tr>
<tr><td>1.1</td><td>11.06.2021</td><td>Aleksi Ålander</td><td>Renamed title</td></tr>
</tbody></table>
</div>
<hr />
<h2 id="introduction-17"><a class="header" href="#introduction-17">Introduction</a></h2>
<p>Navithor has a possibility to request a controller to open / close doors
when an AGV is approaching. This feature can be also used in controlling
lights when an AGV enters an area where other stakeholders need to be
informed about the AGV.</p>
<p>The purpose of this document is to shed light on how Navithor requests
the door statuses and how the communication between the Navithor and the
controller needs to be handled.</p>
<h2 id="basic-functionality"><a class="header" href="#basic-functionality">Basic functionality</a></h2>
<p>Navithor uses the generic MES TCP interface to request and receive tag
statuses. Detailed protocol is defined in another document. From this
document message IDs 24 and 319 are the ones used in controlling tag
statuses.</p>
<p>As the doors or lights may be controlled by other systems as well,
Navithor will periodically request the statuses for each symbolic point
with a door tag. This is done to make sure that the status is correctly
displayed on the client. The periodic requests will require closed
status. By default, the request period is 2 seconds, but this time
period can be shortened or made longer by tuning MES interface
parameters. If the controller does not respond to the requests, the
symbolic points will be labeled as being offline in Navithor.</p>
<p>When an AGV approaches a symbolic point with a door tag, Navithor will
start requesting the door to be open. These requests will be more
frequent and they will start at a distance that is specified with
Navithor parameters and the route network parameters. Request interval
can be tuned with MES interface parameters. The default interval is 100
ms.</p>
<p><img src="Images/tagStatuses/image3.png" alt="" /></p>
<blockquote>
<p>AGV1 requests that the controller would open Door 5001.</p>
</blockquote>
<h2 id="communication-between-controller-and-navithor"><a class="header" href="#communication-between-controller-and-navithor">Communication between Controller and Navithor</a></h2>
<p>The communication between the controller and Navithor is always
initiated by Navithor requesting a specific status for a door. This
means that there are 4 possible use cases in the communication. All of
them are explained in detail in this chapter.</p>
<p>In each use case we use the same names as in the MES interface document.
1 means closed, 4 means open. TagID refers to the tag id that is
attached to the symbolic point, usually the same as the symbolic point
ID. In these examples the tag id is 1 just for the sake of this example.</p>
<p><strong>Use case 1:</strong> Navithor requests tag status closed when the door
already is closed. This use case is the most common one and is the basic
sequence for the periodic status messages.</p>
<p><img src="Images/tagStatuses/image4.png" alt="" /></p>
<p><strong>Use case 2:</strong> Navithor Server requests tag status open when actual
status is closed. This is the use case for when the AGV approaches a
door. The use case consists of two parts, A and B.</p>
<p>If there is a delay in setting the tag status from closed to open (for
example a big door opening slowly) the part A might be repeated multiple
times before reaching part B.</p>
<p>Then again if setting the tag status from closed to open is an almost
immediate operation, the sequence may include just the B part.</p>
<p><img src="Images/tagStatuses/image5.png" alt="" /></p>
<p><strong>Use case 3:</strong> Navithor Server requests tag status open when status
already is open. This use case is realized when the AGV is driving
through the door.</p>
<p><img src="Images/tagStatuses/image6.png" alt="" /></p>
<p><strong>Use case 4:</strong> Navithor Server requests tag status closed when status
is open. The use case happens when an AGV has already driven through the
door and the door does not need to be open anymore. This use case also
consists of two parts, A and B.</p>
<p>If closing the door is slow then the part A might be repeated multiple
times before continuing to part B, and if the operation is fast the
sequence may include only part B.</p>
<p><img src="Images/tagStatuses/image7.png" alt="" /></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="trafficlights"><a class="header" href="#trafficlights">Trafficlights</a></h1>
<p>This document contains information on how to use the trafficlights feature.</p>
<p>Updated 27.01.2021</p>
<h2 id="version-history-31"><a class="header" href="#version-history-31">Version History</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Version</th><th>Date</th><th>Author</th><th>Change</th></tr></thead><tbody>
<tr><td>1.0</td><td>27.01.2021</td><td>Samuli Vaara</td><td>Initial documentation</td></tr>
<tr><td>1.1</td><td>11.06.2021</td><td>Aleksi Ålander</td><td>Renamed title, minor formating corrections.</td></tr>
<tr><td>1.2</td><td>16.08.2022</td><td>Samuli Vaara</td><td>QueueCount and PassCount information added</td></tr>
</tbody></table>
</div>
<hr />
<h2 id="quick-overview-1"><a class="header" href="#quick-overview-1">Quick Overview</a></h2>
<p>Trafficlights provides a way to control traffic with external commands at intersections. Navithor will request a status for the trafficlight and provide information on how many AGVs are waiting to pass the trafficlight and also report a priority based on the the AGVs current task and state. The external system that controls has the authority over the control of the trafficlights, Navithor cannot control the state of the trafficlights on its own. There are three MES messages that are used by this feature. TrafficLightStatus, TrafficLightStatusRequest and MESMessageSubscription.</p>
<h2 id="adding-trafficlights"><a class="header" href="#adding-trafficlights">Adding trafficlights</a></h2>
<p><img src="./Images/Trafficlights/TrafficlightSymbol.png" alt="" /></p>
<blockquote>
<p>Trafficlight Symbolic Point</p>
</blockquote>
<p>Trafficlights are defined as symbolicpoints and they are added the same way as any other symbolicpoint. They must be placed on a route where only one lane is enabled as moving against the traffic light is not allowed.</p>
<p><img src="./Images/Trafficlights/TrafficlightDist.png" alt="" /></p>
<blockquote>
<p>Trafficlight Distance</p>
</blockquote>
<p>Only addition with trafficlight symbolic points is that you are able to define a distance. The distance represent a distance before the trafficlight where Navithor will send requests to subscribed MES clients that controls the trafficlights when it detects AGVs waiting to pass. More about the functionality in the Functionality section.</p>
<img src="./Images/Trafficlights/TrafficlightZone.png" style="zoom:80%;" />
<blockquote>
<p>Trafficlight Zone</p>
</blockquote>
<p>For trafficlights to properly work, you must also define a zone. The ID of the zone becomes the group ID for the traffic light. This zone should contain all trafficlights of an intersection along with the intersection area. After an AGV passes a trafficlight, Navithor will keep on requesting Green status for the trafficlight until the AGV leaves the zone.</p>
<h3 id="limitations-1"><a class="header" href="#limitations-1">Limitations</a></h3>
<p>There are currently two additional limitation for this feature.</p>
<div class="table-wrapper"><table><thead><tr><th>Image</th><th>Description</th></tr></thead><tbody>
<tr><td><img src="./Images/Trafficlights/NotAllowedOverlap.png" alt="" /></td><td>Single trafficlight must <strong>NOT</strong> be part of of multiple trafficlight zones.</td></tr>
<tr><td><img src="./Images/Trafficlights/NotAllowedQueue.png" alt="" /></td><td>Queues of trafficlights must <strong>NOT</strong> overlap.</td></tr>
</tbody></table>
</div>
<h2 id="functionality-1"><a class="header" href="#functionality-1">Functionality</a></h2>
<h3 id="changing-status-of-a-trafficlight"><a class="header" href="#changing-status-of-a-trafficlight">Changing status of a trafficlight</a></h3>
<p>AGVs are only allowed to pass through a trafficlight when the status is set green. This status is set by the MES message <strong>TrafficLightStatus</strong>. Navithor does not control the lights in any way. However, if the status message is not received within 20 seconds (default), the status of the light is considered None</p>
<h3 id="subscribing-to-traffic-lights"><a class="header" href="#subscribing-to-traffic-lights">Subscribing to traffic lights</a></h3>
<p>It is possible to subscribe to trafficlights with <strong>MESMessageSubscription</strong> message. Subscribing allows Navithor to send <strong>TrafficLightStatusRequest</strong> messages periodically to the subscribing client. You can define the interval in the subscription message with the fields <em>IntervalGreen</em> and <em>IntervalNone</em>. <em>IntervalGreen</em> is used when requested status is green, in all other cases <em>IntervalNone</em> is used. Setting <em>IntervalNone</em> also changes the status validity time (default 20 seconds) to 2 * <em>IntervaNone</em></p>
<h3 id="trafficlight-status-requests"><a class="header" href="#trafficlight-status-requests">Trafficlight status requests</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Information</th><th>Description</th></tr></thead><tbody>
<tr><td>ID</td><td>ID of the trafficlight.</td></tr>
<tr><td>Group</td><td>Group ID of the trafficlight.</td></tr>
<tr><td>RequestedStatus</td><td>Status navithor is requesting.</td></tr>
<tr><td>Priority</td><td>Highest priority of AGVs in queue to the trafficlight.</td></tr>
<tr><td>QueueCount</td><td>Amount of AGVs behind the trafficlight, waiting to pass.</td></tr>
<tr><td>PassCount</td><td>Amount of AGVs that have passed the trafficlight but are still inside the intersection area.</td></tr>
</tbody></table>
</div>
<p>The status requests provide information about how many AGVs are waiting behind the trafficlights, amount of AGVs that have passed but are still within the intersection area, highest Priority of the AGVs in queue, and what status is requested. Once an AGV enters the queuing area of a trafficlight, Navithor will request the status to be set green. It will continue to do so until there are no AGVs in the queue. After the status is set green, AGVs will move past the trafficlight. Navithor will keep on requesting status green until the AGV has moved out of the trafficlight area.</p>
<h2 id="modifying-trafficlight-icons"><a class="header" href="#modifying-trafficlight-icons">Modifying trafficlight icons</a></h2>
<p>If you wish to modify how the trafficlights look like, it can easily be done by replacing the trafficlight icons in the clients Icons folder. Same goes for other symbolic point icons.</p>
<div class="table-wrapper"><table><thead><tr><th>TrafficLightNone</th><th>TrafficlightGreen</th><th>TrafficLightYellow</th><th>TrafficLightRed</th></tr></thead><tbody>
<tr><td><img src="./Images/Trafficlights/TrafficLightNone.png" alt="" /></td><td><img src="./Images/Trafficlights/TrafficLightGreen.png" alt="" /></td><td><img src="./Images/Trafficlights/TrafficLightYellow.png" alt="" /></td><td><img src="./Images/Trafficlights/TrafficLightRed.png" alt="" /></td></tr>
</tbody></table>
</div>
<h2 id="mes-messages-1"><a class="header" href="#mes-messages-1">MES Messages</a></h2>
<p>See more detailed explanations from the document  Communication specification between Navithor and MES.</p>
<h3 id="trafficlightstatusrequest-id--346"><a class="header" href="#trafficlightstatusrequest-id--346">TrafficLightStatusRequest (ID = 346)</a></h3>
<p>Trafficlight status request sent to all subscribed MES clients. Informs AGV count, priority and the status requested.</p>
<h3 id="trafficlightstatus-id--347"><a class="header" href="#trafficlightstatus-id--347">TrafficLightStatus (ID = 347)</a></h3>
<p>This message is used to control the status of a trafficlight.</p>
<h3 id="mesmessagesubscription-id--348"><a class="header" href="#mesmessagesubscription-id--348">MESMessageSubscription (ID = 348)</a></h3>
<p>This message is used to subscribe to various messages.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="elevators"><a class="header" href="#elevators">Elevators</a></h1>
<p>This document introduces Elevators feature.</p>
<p>Updated 30.06.2021</p>
<h2 id="version-history-32"><a class="header" href="#version-history-32">Version History</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Version</th><th>Date</th><th>Author</th><th>Change</th></tr></thead><tbody>
<tr><td>1.0</td><td>30.06.2021</td><td>Toni Liski</td><td>Document created</td></tr>
<tr><td>1.1</td><td>06.10.2021</td><td>Aleksi Ålander</td><td>Added new parameters</td></tr>
</tbody></table>
</div>
<hr />
<h2 id="introduction-18"><a class="header" href="#introduction-18">Introduction</a></h2>
<p>Navithor Fleet Control supports currently simple implementation of multi-level environment. It means that in the same production area, there is possibility to define separate areas which are linked together with so called <em>LevelChange</em> points. These points can lead to several floors in the building (connected to several <em>LevelChange</em> points) and Fleet Control can plan the routes from the area to another using these links.</p>
<p><img src="./Images/elevators/example1.png" alt="" /></p>
<blockquote>
<p>Figure: Simple environment with two levels. Connection between levels is shown with a red arrow.</p>
</blockquote>
<h2 id="navithor-tools-1"><a class="header" href="#navithor-tools-1">Navithor Tools</a></h2>
<p>Activating the built-in elevator logic requires two steps to be done in Navithor Tools.</p>
<ul>
<li>All <em>LevelChange</em> points must have <strong>Level ID</strong> specified</li>
<li>All <em>LevelChange</em> points and <em>Doors</em> in the same Elevator must be grouped to same SymbolicPoint group</li>
</ul>
<h3 id="add-levelchange-points"><a class="header" href="#add-levelchange-points">Add LevelChange points</a></h3>
<p>Firstly, environment must be built normally. In the example Figure below, the Elevator is built so that route is cut inside the Elevator to prevent machines from using Elevator as a drive-through route. This means that route end-point must have <em>LevelChange</em> point which leads to another level (SymbolicPoint <em>1158</em> in this example), and route start-point must have <em>LevelChange</em> point which is the target point from another level (symbolic point <em>1157</em>).</p>
<p><img src="./Images/elevators/two_levelchange_points.png" alt="Two LevelChange points on the same floor." /></p>
<blockquote>
<p>Figure: Two LevelChange points defined for one floor to prevent driving through the Elevator.</p>
</blockquote>
<p>To create LevelChange point:</p>
<ul>
<li>Create normal SymbolicPoint on the route</li>
<li>Select any <em>Type</em>, for example, <strong>Stop</strong></li>
<li>Tick <em>LevelChange</em> from Symbolic Point Settings</li>
<li>Specify <em>Level ID</em> in the field shown in the picture.</li>
</ul>
<p><img src="./Images/elevators/setLevelId.png" alt="Set LevelId for LevelChange point in Tools." /></p>
<blockquote>
<p>Figure: Set Level ID for LevelChange point in Tools.</p>
</blockquote>
<p>To specify the target point where this LevelChange point leads, go to <strong>Edit Destinations and Resources</strong> section and select <strong>Allowed Destinations</strong> tab.</p>
<p><img src="./Images/elevators/allowedDestinations.png" alt="Set LevelId for LevelChange point in Tools." /></p>
<blockquote>
<p>Figure: Specify LevelChange point in Navithor Tools.</p>
</blockquote>
<p>From there you can add target level by clicking first <strong>Add Destination</strong>, select the target LevelChange symbolic point (ID 1258 in this example) and press <strong>Add Destination</strong> again to confirm the selection. If multiple floors can be accessed from this point, add all LevelChange points which should be connected.</p>
<p>If the link is only one-way, then this is all what is required. If routing back from another floor to this point should be possible, allow routing to opposite direction by adding this symbolic point to list of Allowed Destinations of opposite symbolic point (ID 1258 in this example).</p>
<h3 id="define-elevator-doors"><a class="header" href="#define-elevator-doors">Define Elevator Doors</a></h3>
<p>Elevator needs always a door on each floor to control the access to/from elevator. Door can be placed at the physical door location, and changing <em>Door Distance</em> parameters it is possible to make machine to stop at the intended distance in front of the elevator. If elevator is only one-sided, it is good practice to make machine to stop in front of the elevator so that outgoing machine can bypass the incoming machine.</p>
<p><img src="./Images/elevators/doors.png" alt="" /></p>
<blockquote>
<p>Figure: Define Door SymbolicPoints for Elevator.</p>
</blockquote>
<h3 id="define-symbolicpoint-groups"><a class="header" href="#define-symbolicpoint-groups">Define SymbolicPoint Groups</a></h3>
<p>For two floor environments it would be enough just to define LevelChange points, link them together and add doors. Doors could be controlled as a normal door and PLC will handle the elevator requests with sensors, for example. However, in order to enable <em>full elevator logic</em> (recommended), it is required to group all the symbolicpoints in single elevator together. There are two options:</p>
<ol>
<li>Only group LevelChange points and handle doors separately with TagStatus messages</li>
<li>Group Doors and LevelChange points in the same group, and everything will be controlled with ElevatorRequest/ElevatorStatus messages</li>
</ol>
<p>To create a symbolic point group, navigate to <em>Manage Symbolic Point Groups</em> in the left menu. Enter the <em>name</em> and <em>ID</em> for the Elevator, as shown in Figure, and press <strong>Create</strong>. Select the newly created Symbolic Point Group from the dropdown menu and click <strong>Add Point</strong>. Now click all the symbolicpoints in the map, which belong to the same elevator group. Symbolic point will get a bolded circle around it when it is grouped successfully. When all points have been added, press <strong>Add Point</strong> again to confirm the selection. Repeat this process for each elevator in the system.</p>
<p><img src="./Images/elevators/SymbolicPointGroup.png" alt="" /></p>
<blockquote>
<p>Figure: Add Elevator group.</p>
</blockquote>
<h2 id="elevators-in-navithor-fleet-control"><a class="header" href="#elevators-in-navithor-fleet-control">Elevators in Navithor Fleet Control</a></h2>
<p>Navithor creates Elevators automatically based on the given route network. If there exists any LevelChange point which belongs to SymbolicPoint Group, it is considered as Elevator. The Elevator container will join together all LevelChange points in the same group, and all Doors which belong to the group and are found close enough to the LevelChange points.</p>
<p>To enable Elevator control, MES client must subscribe the ElevatorRequest messages. According to the ElevatorStatus messages from MES client, the Elevator can be used for routing, and depending the current level and reservations, the Elevator will have different penalties.</p>
<h3 id="parameters-3"><a class="header" href="#parameters-3">Parameters</a></h3>
<p>Elevators can be adjusted with following Navithor parameters.</p>
<h4 id="missionmanager_elevatoraveragetimetomovefromfloortofloor"><a class="header" href="#missionmanager_elevatoraveragetimetomovefromfloortofloor">MissionManager_ElevatorAverageTimeToMoveFromFloorToFloor</a></h4>
<p>This parameter can be used to estimate time to reach target floor, if more detailed information from MES is not available.</p>
<h4 id="missionmanager_elevatorrequesttimebeforearrival"><a class="header" href="#missionmanager_elevatorrequesttimebeforearrival">MissionManager_ElevatorRequestTimeBeforeArrival</a></h4>
<p>This parameter can be used to define how much earlier the machine is estimated to arrive at the elevator it should request the elevator to that floor. Defined as a time instead of distance, so that different routes to different elevators would be considered.</p>
<h4 id="missionmanager_elevatorreservationtimeout"><a class="header" href="#missionmanager_elevatorreservationtimeout">MissionManager_ElevatorReservationTimeout</a></h4>
<p>This parameter can be used to define a period of time that machine should keep the same elevator reserved to itself, even if machine is in estop or error and the drive task is not progressing. After the timeout, the elevator reservation is released and the AGV will recalculate the whole route after it can progress the task again. If machine is disabled, the reservation is released immediately.</p>
<p>Situations where machine task is considered as interrupted:</p>
<ul>
<li>Machine is driving towards the elevator and speed is near zero</li>
<li>No LevelChange point is found on the route anymore</li>
<li>Machine has EStop or Error active</li>
<li>Machine state is not AUTO</li>
<li>Machine is no more in production</li>
</ul>
<h4 id="routeplanner_levelchangelocationprioritypenalty"><a class="header" href="#routeplanner_levelchangelocationprioritypenalty">RoutePlanner_LevelChangeLocationPriorityPenalty</a></h4>
<p>Additional routeplanning penalty based on the location priority set to the level change point. Applied when crossing through a level change point.</p>
<h4 id="routeplanner_levelchangedrivingthroughallowed"><a class="header" href="#routeplanner_levelchangedrivingthroughallowed">RoutePlanner_LevelChangeDrivingThroughAllowed</a></h4>
<p>This parameter defines if driving through the level change point without changing level is allowed or not. On default set to true, which means driving through level change points is allowed.</p>
<h4 id="missionmanager_elevatorreservationresetdistance"><a class="header" href="#missionmanager_elevatorreservationresetdistance">MissionManager_ElevatorReservationResetDistance</a></h4>
<p>This parameter defines the maximum distance in meters to the current elevator reservation to keep the reservation, in case machine is taken out of production. If machine is further away, discard the reservation without waiting for the timeout. On default parameter is set to 10 meters to avoid accidentally giving away a reservation of the elevator for machine that is already very close to the elevator. This could easily cause issues with traffic, in case the elevator would be then reserved by another machine.</p>
<h3 id="mes-interface"><a class="header" href="#mes-interface">MES Interface</a></h3>
<p>To control Elevators over the MES interface, at least the following messages must be implemented (see detailed specification in the <em>MES Interface documentation</em>).</p>
<ul>
<li><strong>MESMessageSubscription</strong></li>
<li><strong>ElevatorStatus</strong></li>
<li><strong>ElevatorRequest</strong></li>
</ul>
<p>Requests for each elevator must be subscribed by at least one Client (PLC). Subscription is done using <em>MESMessageSubscription</em> message for type <strong>ElevatorRequest</strong>. Once requests are subscribed, Navithor starts sending <em>ElevatorRequest</em> messages to request the <em>ElevatorStatus</em> message from the Client, or to control Elevator to given floor. Intervals for sending the requests can be specified in seconds, when making the subscription.</p>
<p>If there are no machines planned to use Elevator, the ElevatorRequest has a RequestType = 0 (Status request) specified. In this case Navithor is only requesting the ElevatorStatus message, containing in which floor Elevator currently is, the operational status etc.</p>
<p>If there is a machine planned to use the elevator, and machine is close enough to elevator (see parameter <strong>MissionManager_ElevatorRequestTimeBeforeArrival</strong>), the ElevatorRequest message has a RequestType = 1 (RequestToFloor). Then more data about machine and target floors are added in the ElevatorRequest message.</p>
<blockquote>
<p><strong>Note!</strong> Both RequestTypes should be always replied with ElevatorStatus message. No separate request is sent for status message, if machine is requesting the Elevator to specific floor.</p>
</blockquote>
<p>In addition to new messages, <em>AgvStatus</em> message has been updated to contain new fields <strong>NextLevelChangePoint</strong> and <strong>DistanceToNextLevelChange</strong>, which can be used to detect if machine is going through any Elevator. See <em>MES Interface specification</em> for more detailed information.</p>
<h3 id="elevator-request-logic-in-navithor"><a class="header" href="#elevator-request-logic-in-navithor">Elevator Request Logic in Navithor</a></h3>
<p>Once machine gets order assigned, next part is to plan route to from machine location to target location. Route planner algorithm tries to minimize the cost (penalty) of the route in order to select the best possible route. Elevator logic adds now possibility to specify penalties for elevators based on the LevelChange point location penalty, and in addition to penalties which are caused by the delay that Elevator actually needs to drive to correct floor first, in case it is on another floor. See more details in the Section <em>Penalty Calculation</em>.</p>
<p>Once the best route is found, machine starts driving towards the elevator. At  that moment Elevator logic is still requesting only Elevator status over the MES interface. When machine proceeds and reaches the point where the estimated travel time to elevator is less than the parameter <em>MissionManager_ElevatorRequestTimeBeforeArrival</em>, Elevator will send request over the MES to move Elevator to floor where machine is going to enter the Elevator from.</p>
<p>Once Elevator reaches the target floor, doors must be opened (controlled by PLC), and this Elevator and Door status information must be sent to Navithor over the ElevatorStatus message.</p>
<p>When the doors are open, machine can enter the Elevator. Machine drives into Elevator until it reaches the LevelChange symbolic point defined. When machine as at the symbolic point, Elevator logic will request Elevator to move the target floor, by sending the ElevatorRequest message and having there RequestToFloor level as a target floor level.</p>
<p>Once Elevator reaches the target floor, opens door and sends the status over ElevatorStatus message, machine can drive out and continue it's task.</p>
<p>Once Machine exits the doors, the machine reservation for the Elevator is automatically deleted and Elevator is considered free. No more RequestToFloor messages are sent, instead only Elevator status request.</p>
<h3 id="multiple-reservations"><a class="header" href="#multiple-reservations">Multiple Reservations</a></h3>
<p>It is possible to reserve elevator for multiple machines simultaneously. For each floor, <strong>two</strong> machines can plan the route through the elevator simultaneously. <u>First reservation is always the priority reservation</u>, but in case another machine has made a reservation for the Elevator to enter from another floor and following conditions are fulfilled, the priority reservation changes. In order to change the priority machine:</p>
<ol>
<li>Only machine which is closest to elevator can be changed to priority machine</li>
<li>If closest machine is arriving from the same floor as priority machine, priority machine cannot be changed</li>
<li>If closest machine is arriving from the same floor where elevator currently is, it is changed to priority machine</li>
<li>If closest machine is arriving from another floor where elevator currently is, but  the arrival time is later than parameter <strong>MissionManager_ElevatorAverageTimeToMoveFromFloorToFloor</strong> defines, closest machine can be changed to priority machine.</li>
</ol>
<h3 id="penalty-calculation"><a class="header" href="#penalty-calculation">Penalty Calculation</a></h3>
<p>There will be an additional penalty based on the existing elevator reservations and its current floor calculated with the following steps:</p>
<ol>
<li>
<p>Each existing reservation will add <strong>MissionManager_ElevatorAverageTimeToMoveFromFloorToFloor</strong> value as a penalty for using this elevator on the route. This means that even if the reservation starts from and targets the same floor (driving through the elevator) the penalty is added.</p>
</li>
<li>
<p>Each change of the elevator floor in between the existing reservations will add the same <strong>MissionManager_ElevatorAverageTimeToMoveFromFloorToFloor</strong> value as a penalty. For example, the previous reservation targets the first floor and the next reservation starts from the second floor. This step also takes into account the initial change of the elevator floor if its current floor differs from the floor where the first reservation starts from. However, no penalty is added if there is no change of the elevator floor in between the reservations and the elevator's initial state (the elevator stays at the same floor).</p>
</li>
<li>
<p>After all the reservations are taken into account the resulting elevator floor (the current floor in case there were no reservations) is checked against the floor of the source LevelChange location on the route. If they differ then the same <strong>MissionManager_ElevatorAverageTimeToMoveFromFloorToFloor</strong> value is added as a penalty. Else no penalty is added at this step.</p>
</li>
<li>
<p>At this point if the accumulated penalty is less than the estimated driving time for the machine to reach the elevator then the elevator call penalty is considered to be zero (the elevator must be already on the correct floor when the machine arrives). Otherwise, the elevator call penalty is the difference between the accumulated penalty and the estimated driving time (the machine will wait for the elevator).</p>
</li>
<li>
<p>Finally, <strong>MissionManager_ElevatorAverageTimeToMoveFromFloorToFloor</strong> value is added to the elevator call penalty and the result is considered as the actual penalty for using the elevator on the route. This means that even if the elevator is used for driving through it the penalty is added.</p>
</li>
</ol>
<p>Amount of additional penalty based on LevelChange location priority can be configured with parameter <strong>RoutePlanner_LevelChangeLocationPriorityPenalty</strong>.
If parameter value is zero, no additional location priority penalty is applied.</p>
<p>Additional penalty is calculated by the following formula:
<code>AdditionalPenalty = (Priority.HIGHEST - LevelChangeSymbolicPointLocationPriority) * RoutePlanner_LevelChangeLocationPriorityPenalty</code></p>
<h3 id="elevator-status-visualization-in-navithor-client"><a class="header" href="#elevator-status-visualization-in-navithor-client">Elevator Status Visualization in Navithor Client</a></h3>
<p>When the elevator group is defined, this elevator state is visualized in Client with an icon displaying current status, current level and name of the elevator. Elevator icon is displayed nearby one of LevelChange locations on the map, one for each elevator at each floor.</p>
<p>Displayed elevator states:</p>
<div class="table-wrapper"><table><thead><tr><th>State</th><th>Icon</th></tr></thead><tbody>
<tr><td>Not defined</td><td><img src="./Images/elevators/ElevatorState_Unknown.png" alt="" /></td></tr>
<tr><td>Init</td><td><img src="./Images/elevators/ElevatorState_Init.png" alt="" /></td></tr>
<tr><td>Automatic</td><td><img src="./Images/elevators/ElevatorState_Automatic.png" alt="" /></td></tr>
<tr><td>AutomaticMoving</td><td><img src="./Images/elevators/ElevatorState_AutomaticMoving.png" alt="" /></td></tr>
<tr><td>Manual</td><td><img src="./Images/elevators/ElevatorState_Manual.png" alt="" /></td></tr>
<tr><td>OutOfService</td><td><img src="./Images/elevators/ElevatorState_OutOfService.png" alt="" /></td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="production-break"><a class="header" href="#production-break">Production Break</a></h1>
<p>This document contains information on how to use the Production Break feature with Navithor Fleet Control.</p>
<p>Updated 09.12.2022</p>
<h2 id="version-history-33"><a class="header" href="#version-history-33">Version History</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Version</th><th>Date</th><th>Author</th><th>Change</th></tr></thead><tbody>
<tr><td>1.0</td><td>18.11.2022</td><td>Toni Liski</td><td>Document created.</td></tr>
<tr><td>1.1</td><td>09.12.2022</td><td>Simon Clement</td><td>Add warning about decision points in wait queues</td></tr>
</tbody></table>
</div>
<hr />
<h2 id="overview-2"><a class="header" href="#overview-2">Overview</a></h2>
<p>The Production Break feature enables a more sophisticated way to control the longer breaks in the production, for instance, when the production is paused for the weekend. Once the Production Break mode is activated, the Fleet Control drives machines automatically to predefined locations and puts them in a sleep to save the battery.</p>
<p>The Production Break considers active production, so the machines which are carrying the load are first dropping off the load, before driving to the break locations. Also machines are required to be charged up to the specified level before driving to the break locations.</p>
<h2 id="sleep-mode"><a class="header" href="#sleep-mode">Sleep mode</a></h2>
<p>The sleep mode is a special feature which any machine can support. Fleet Control will command machines to the sleep mode to save the battery during the production break, or sleep mode can be started manually from the Clients. The Sleep mode requires custom implementation on the supervisor interface (See Navitrol documentation for more details).</p>
<p>If the machine supports the sleep mode, the machine is commanded automatically to sleep once it reaches the production break location. When production break is over, machines are woken up automatically and they should continue the normal production. The production break logic does not require that machine supports sleep mode.</p>
<h2 id="navithor-tools-2"><a class="header" href="#navithor-tools-2">Navithor Tools</a></h2>
<h3 id="defining-the-production-break-locations"><a class="header" href="#defining-the-production-break-locations">Defining the Production break locations</a></h3>
<p>Enabling the production break feature requires that at least one symbolicpoint has a ProductionBreak type defined in Navithor Tools. Any pickup, dropoff, waitForPickup, or waitForDropoff location can be defined as a production break location. It means that when production break is activated, machines are allowed to use only those symbolicpoints for waiting.</p>
<p>It is also possible to define symbolicpoint only as ProductionBreak. Then this symbolicpoint is not allowed for the normal production, but only when the production break is activated.</p>
<p><img src="./Images/prodbreak/tools1.png" alt="Setting production break locations" /></p>
<blockquote>
<p>Figure 1: Each symbolicpoint where waiting is allowed during the production break should be marked with a ProductionBreak type in Navithor Tools.</p>
</blockquote>
<p>A typical use case would be to define a long wait queue on the one-way lane for production break purpose. This allows that all machines gather at the same, known places when break is activated, and are not scattered around the factory.</p>
<p><img src="./Images/prodbreak/tools2.png" alt="Production break queue" /></p>
<blockquote>
<p>Figure 2: One typical use case is to define production break location as a wait queue.</p>
</blockquote>
<blockquote>
<p>Note: Do not place decision points inside a wait queue. It is not supported and may lead to unwanted behavior.</p>
</blockquote>
<h3 id="limiting-locations-for-specific-machine-types"><a class="header" href="#limiting-locations-for-specific-machine-types">Limiting locations for specific machine types</a></h3>
<p>Each symbolicpoint (production break location) can be defined to allow only specific machine types to drive to the location. The allowed machine types can be selected in Navithor Tools by selecting symbolicpoint and selecting types from the button <em>Select Enabled MachineTypes</em>.</p>
<h3 id="backup-dropoff-locations"><a class="header" href="#backup-dropoff-locations">Backup dropoff locations</a></h3>
<p>When the production break is activated and a machine has a load aboard, there might be situations that there is a machine or a load blocking the target location, and the location will not be available until the production break is over again. For this kind of situations it is possible to define a backup dropoff location in Navithor Tools, which is allowed for certain type of the loads and certain type of the machines. The backup dropoff must be defined as PickupDropoff location, as both actions must be allowed on the location.</p>
<p>Defining the backup dropoff location is done from the <em>Destinations And Loads</em> menu, selecting <strong>Edit</strong> button under the <em>Load Types</em>. The opened dialog allows to specify certain load types for which the backup dropoff is allowed.</p>
<p><img src="./Images/prodbreak/tools3.png" alt="Backup dropoff" /></p>
<blockquote>
<p>Figure 3: Defining location as a backup dropoff location in Navithor Tools.</p>
</blockquote>
<h2 id="activating-production-break"><a class="header" href="#activating-production-break">Activating Production Break</a></h2>
<p>The production break mode can be activated either from Navithor Client or over the MES interface (see message <em>StartStopProductionBreak</em> (ID = 359) in the MES interface documentation). When starting or stopping the break from the Navithor Client, the user responsible must have the role <strong>&quot;Start or stop production break&quot;</strong> granted.</p>
<p>A button to start a production break can be found from the main menu, Machines -&gt; Start production break. Confirm with <strong>Yes</strong> button.</p>
<p><img src="./Images/prodbreak/client1.png" alt="Start production break" /></p>
<blockquote>
<p>Figure 4: Production break can be started from Navithor Client.</p>
</blockquote>
<p>Once production break is activated, the indicator <em>Production on break</em> can be seen on the bottom left corner of the map view.</p>
<p><img src="./Images/prodbreak/client2.png" alt="Production break active" /></p>
<blockquote>
<p>Figure 5: Production break status is visualized on a bottom left corner of the map.</p>
</blockquote>
<h2 id="charging-rules"><a class="header" href="#charging-rules">Charging rules</a></h2>
<p>There are currently two system parameters affecting the charging logic with production break:</p>
<p><strong>BatteryLevelToAllowDrivingToProductionBreakWithoutCharging</strong></p>
<ul>
<li>The minimum battery level an AGV needs to have in order to drive directly to production break location without charging. If battery level is below this minimum level, charging is required. After the AGV has started driving towards a production break location, charging request will not be generated even if the battery level goes below this limit.</li>
</ul>
<p><strong>BatteryLevelToReleaseAGVFromChargerToProductionBreak</strong></p>
<ul>
<li>The parameter to control what battery level an AGV needs to reach before it can be released from the charger to the production break location in case the production break is active.</li>
</ul>
<p>These parameters override the normal battery levels defined in system. Even if the battery level would be high enough to execute normal production, it might be useful to set parameter <em>BatteryLevelToAllowDrivingToProductionBreakWithoutCharging</em> higher to force machines to charge a bit before entering the production break. While production break is active and machine is already at the production break location, the charging is never allowed, even if the battery level drops under the specified limits.</p>
<p><strong>Note:</strong> During the production break, the rules defined for <em>AlternativeChargingRulesZone</em> are ignored.</p>
<h2 id="production-rules-when-activating-production-break"><a class="header" href="#production-rules-when-activating-production-break">Production rules when activating production break</a></h2>
<p>After production break mode is activated, the rules below are followed:</p>
<p><strong>Machine does not have a load aboard and is not currently picking up anything</strong></p>
<ul>
<li>Machine can drive directly to a production break location.</li>
</ul>
<p><strong>Machine hasn't picked the load yet</strong></p>
<ul>
<li>The production order is removed and machine drives to production break location. <em>Unhandled orders</em> (transfer requests and pickup requests) are still kept, so when production break is over, new production orders are generated based on those.</li>
</ul>
<p><strong>Machine has a load aboard</strong></p>
<ul>
<li>Machine drives to assigned dropoff location and completes the current order. After dropoff it can continue to a production break location.</li>
</ul>
<p><strong>Machine has load aboard, but target location is not available</strong></p>
<ul>
<li>Machine is allowed to use the backup dropoff location. See Section <em>Using backup dropoff locations</em>.</li>
</ul>
<p><strong>Machine is not in production</strong></p>
<ul>
<li>Automatic production break mode requires that machine is in production. Machines out of production stay where they are.</li>
</ul>
<p><strong>Machine is charging</strong></p>
<ul>
<li>Machine is released when battery level reaches the parameter <em>BatteryLevelToReleaseAGVFromChargerToProductionBreak</em>. See Section <em>Charging rules</em>.</li>
</ul>
<p>Generally: Once the production break is activated, the active production orders are executed and completed if the machine has already picked up the load. If the load linked to the production order has not been picked yet, the production order is removed and machine drives to production break location.</p>
<p><strong>Note:</strong> If production is executed only with <em>Production orders</em> (generated from over MES with <em>AddProductionOrder</em> message), they must be sent again once production break is over.</p>
<h2 id="using-backup-dropoff-locations"><a class="header" href="#using-backup-dropoff-locations">Using backup dropoff locations</a></h2>
<p>If a machine has a load aboard, but target location is occupied by a load or a machine, the machine is allowed to use the backup dropoff locations. The machine drives the load to the backup dropoff location, and after dropping it off, the machine continues to the nearest production break location. A new transfer request is automatically generated to transfer the load from the backup dropoff location to the original dropoff location. When the production break is over, closest machine drives back to the backup dropoff location, picks the load and continues to the original dropoff target with the load.</p>
<p><strong>Note:</strong> Machine cannot drive to production break location until it has dropped off the load. If all backup dropoff locations are reserved, the machine must wait.</p>
<h2 id="custom-rules-to-distribute-machines-after-the-break-is-over"><a class="header" href="#custom-rules-to-distribute-machines-after-the-break-is-over">Custom rules to distribute machines after the break is over</a></h2>
<p>Once the production break is over, machines are distributed around the production area by assigning the available production orders for them automatically or by choosing the closest waiting location. There is also a way to define more sophisticated logic to spread the machines around the area by specifying a production break release priority for the waiting locations.</p>
<p>The special priority is entered in the file <code>LocationPriorities.txt</code>, which can be found under <code>&lt;server root&gt;\Overrides\</code> folder. The format of the file is following:</p>
<p><code>&lt;symbolicPointId&gt;,&lt;locationPriority&gt;,&lt;productionBreakReleasePriority&gt;</code> </p>
<p>For example:</p>
<pre><code class="language-text"># File for specifying the priorities of locations.
# Format: SymbolicPointId,Priority,ProductionBreakReleasedPriority
# Example: 3,2,4
14,4,1
17,4,3
18,4,4
21,4,1
</code></pre>
<p>which defines a custom production break release priority <code>3</code> for the location <code>(17)</code> and a priority <code>4</code> for the location <code>(18)</code>.</p>
<p>After the production break is over, all the locations with <em>ProductionBreakReleasedPriority</em> higher than <code>1</code> are collected and location requests are generated for those locations. Machines will select the best location and fulfill the location requests one by one. The maximum amount of location requests that can be triggered is limited by amount of machines currently targeting the production break locations.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="virtual-dynamic-safety-bounds"><a class="header" href="#virtual-dynamic-safety-bounds">Virtual Dynamic Safety Bounds</a></h1>
<p>This document contains information on Virtual Dynamic Safety Bounds in Navithor.</p>
<p>Updated 08.12.2022</p>
<h2 id="version-history-34"><a class="header" href="#version-history-34">Version History</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Version</th><th>Date</th><th>Author</th><th>Change</th></tr></thead><tbody>
<tr><td>1.0</td><td>27.04.2020</td><td>Joni Sundholm</td><td>First version of document for Navithor version 2.18.0.0</td></tr>
<tr><td>1.1</td><td>04.12.2020</td><td>Joni Sundholm</td><td>Document updated. Reflecting Navithor version 2.19.0.0 and above. New mode 'DynamicBounds' available.</td></tr>
<tr><td>1.2</td><td>11.06.2021</td><td>Aleksi Ålander</td><td>Renamed title</td></tr>
<tr><td>1.3</td><td>08.12.2022</td><td>Evgenii Kuzminskii</td><td>Reflected the changes in 'DynamicBounds' mode</td></tr>
</tbody></table>
</div>
<hr />
<h2 id="description"><a class="header" href="#description">Description</a></h2>
<p>Navithor Fleet Control System controls AGVs in a safe way by not allocating routes for AGVs if the routes are crossing or overlapping in a way that only one AGV could run its route at a time. As a further safety feature Navithor calculates dynamic safety- and speed bounds online. These bounds are used to prevent collisions and also to limit speeds when two AGVs are moving very close to each other. The feature uses two separate bounds, Safety bounds and Speed bounds, to create a polygon around the AGV that should not collide with other AGV's polygon.</p>
<p>Traffic Controller performs cross-checks of safety bound violations during each process cycle (5Hz). Only AGV's that report their position near each other are cross checked. AGV's that are nearer each other than system parameter <strong>TrafficController_MAX_TRACKING_DIST_BOUND</strong> defines are checked. Making the parameter value as 0 will disable the feature.</p>
<p>This feature is available in Navithor Fleet Control System only and within Navithor Server. AGV (Navitrol) does not have the information of the virtual bounds and thus it cannot be used to check agains live laser data.</p>
<p>Parameter <strong>TrafficController_Safetybounds_calculation_mode</strong> defines the mode how Safety bounds are calculated. Currently there are 3 modes available:</p>
<div class="table-wrapper"><table><thead><tr><th>Mode</th><th>Description</th></tr></thead><tbody>
<tr><td>Default</td><td>Safety bounds and Speed bounds are calculated along driven route. Driving speed affects the size of the polygon towards the direction of route and direction of speed.</td></tr>
<tr><td>StaticBox</td><td>Safety bounds are static around the AGV. Moving AGV has same safety area as stopped one. StaticBox is not recommended unless instructed by Navitec.</td></tr>
<tr><td>DynamicBounds</td><td>Safety bounds and Speed bounds increase to the direction of movement. Driving speed affects the size of the polygon towards the direction of speed. Route information is used to forecast direction changes. This mode is recommended for omni-type AGVs.</td></tr>
</tbody></table>
</div>
<h2 id="visualization-1"><a class="header" href="#visualization-1">Visualization</a></h2>
<p>Safety - and Speed bounds are visualized in Navithor Client only. Parameter <strong>ServiceInterface_SendSafetyAreaBoundsToClient</strong> changes viualization on/off. By default visualization is off.
In case Navithor Clients are used in WIFI network with poor data transfer rates then this is one way to limit data from Navithor Server to Clients. This parameter affects only visualization so having it disabled does not affect the feature itself.</p>
<h2 id="safety-bounds"><a class="header" href="#safety-bounds">Safety Bounds</a></h2>
<p>Gray polygon around AGV defines safe bounds that should not be violated by another AGV's safety bounds. Violation of safety bounds between two AGVs causes abort-signal to be commanded to the AGV's involved. Violation check is done between safety bounds of two AGVs that are near each other. AGV's position confidence has affect on the size of the safety polygon. All parameters that affect the size are considered to be values when position confidence is 100%. When confidence goes down and the AGV is moving (in AUTO-state) the safety bounds will increase in size.</p>
<p><img src="./Images/DynamicSafetyBounds/Navithor_SafetyBounds.png" alt="Safety bounds" /></p>
<blockquote>
<p>Figure: Virtual Safety bounds of AGV</p>
</blockquote>
<p>Following parameters affect the size of the safety bounds:</p>
<div class="table-wrapper"><table><thead><tr><th>Parameter</th><th>Description</th></tr></thead><tbody>
<tr><td>Machine_SAFE_DIST_FRONT_REAR_STATIONARY_BOUND</td><td>Distance from AGV front or rear to the end of the safety polygon when AGV is stationary. 'DynamicBounds' mode uses separate machine type parameters for calculation of rear (OBS_SAFE_REAR) and front (OBS_SAFE_FRONT) safety bounds instead.</td></tr>
<tr><td>TrafficController_SAFE_SIDE_ADD_DIST_BOUND</td><td>Distance from AGV left and right sides to the edge of the safety polygon. 'DynamicBounds' mode uses machine type parameter for calculation of side (OBS_SAFE_SIDE) safety bounds instead.</td></tr>
<tr><td>TrafficController_SAFE_STOP_TIME_SECONDS</td><td>Time parameter that is used to calculate expanding safety distance to the direction of route and speed. Higher values mean longer safety bounds.</td></tr>
<tr><td>TrafficController_SPEED_WHEN_MAX_SAFETY_AREA_APPLIED</td><td>The abs speed that results the maximum safety distance to the direction of route and speed. The smaller the value the faster the bounds will grow when speed increases.</td></tr>
<tr><td>TrafficController_SAFE_DISTANCE_BOUND</td><td>Added to front and rear safety distance in StaticBox-mode.</td></tr>
</tbody></table>
</div>
<h2 id="speed-warning-bounds"><a class="header" href="#speed-warning-bounds">Speed Warning Bounds</a></h2>
<p>Green polygon around AGV defines virtual speed warning bounds. Speed warning zones are checked against safety bounds of another AGV within <strong>TrafficController_MAX_TRACKING_DIST_BOUND</strong> distance. Violation of speed bounds causes speed reductions in steps. First reduction is to 50% speed and second to 25% of max speed on current route. AGV is stopped if bound violations still occur. Speed warning bounds expand when speed increases if default calculation mode is used. Thus all violations that causes speed reductions also make bounds smaller thus further reductions may be avoided.</p>
<p>Speed Warning Zones can be utilized to slow down AGVs that are confronting each others on an aisle. Confrontation with high speed may cause dust issues to laser scanners and extra stops as a result. Using sideways expanding speed warning zones the AGVs are automatically slowed down on tight aisle. AGV moving slower has smaller Speed bounds to the sides and thus two AGVs can pass each other without need of stopping. Once the AGVs have passed each other the speeds are set to maximum again.</p>
<p><img src="./Images/DynamicSafetyBounds/Navithor_SpeedBounds_Violation.png" alt="Speed Warning bounds violated" /></p>
<blockquote>
<p>Figure: Speed Warning Bounds crossing - speeds will be reduced</p>
</blockquote>
<br/>
<p><img src="./Images/DynamicSafetyBounds/Navithor_SpeedBounds_NoViolation.png" alt="Speed Warning bounds not violated" /></p>
<blockquote>
<p>Figure: Speed Warning Bounds are not violating safety bounds - no action</p>
</blockquote>
<P style="page-break-before: always">
<p>Following additional parameters affect the size of the speed warning bounds:</p>
<div class="table-wrapper"><table><thead><tr><th>Parameter</th><th>Description</th></tr></thead><tbody>
<tr><td>Machine_SAFE_DIST_SIDE_BOUND</td><td>Distance from AGV left and right sides to the edge of the speed warning polygon. Only 'Default' mode uses this parameter.</td></tr>
<tr><td>TrafficController_SAFE_DIST_SIDE_SPEEDGAIN_METERS</td><td>Distance added based on AGVs speed. This value is added when AGVs speed is as high as TrafficController_SPEED_WHEN_MAX_SAFETY_AREA_APPLIED parameter defines.</td></tr>
<tr><td>TrafficController_SPEED_REDUCE_BOUND_SECONDS</td><td>Time parameter that is used to calculate safety distance from AGVs speed to get needed distance to the direction of route and speed. This parameter is used when AGV's speed has not been reduced. Higher parameter values yield bigger bounds towards the direction of route and speed.</td></tr>
<tr><td>TrafficController_SLOW_SPEED_BOUND_SECONDS</td><td>Time parameter as above but used when speed warning zones have been violated already.</td></tr>
</tbody></table>
</div>
<h2 id="agvs-with-bigger-resources-than-agv-frame"><a class="header" href="#agvs-with-bigger-resources-than-agv-frame">AGVs with bigger resources than AGV frame</a></h2>
<p>Navithor supports resources carried by AGVs that are bigger than AGV since version 2.18.0.0. The safety bounds calculation mode is recommended to be 'DynamicBounds' but 'Default'-mode has been updated in version 2.19.0.0 to handle bigger resources correctly thus it can be used also.</p>
<h2 id="additional-parameters"><a class="header" href="#additional-parameters">Additional Parameters</a></h2>
<p>Following parameters affect this feature also:</p>
<div class="table-wrapper"><table><thead><tr><th>Parameter</th><th>Description</th></tr></thead><tbody>
<tr><td>TrafficController_TURNING_SAFETY_GAIN</td><td>Additional side safety can be added automatically according to turning rate of AGV.</td></tr>
<tr><td>TrafficController_SAFETY_BOUND_POLY_P_GAIN1</td><td>Paramter to tune concave polygon calculation in case polygons are not calculated correctly. Default value should be valid for normal size AGVs. Tuning is only needed if the safety polygons are not covering the AGV in all situations. Parameter change take immediate effect thus valid value can be found with visual feedback.</td></tr>
<tr><td>TrafficController_SAFETY_BOUND_POLY_P_INTERVAL_GAIN2</td><td>Same use as above. Used to define maximum polygon edge lenght. Default value should be valid for normal size AGVs. Parameter change take immediate effect thus valid value can be found with visual feedback.</td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="wait-queue-locations"><a class="header" href="#wait-queue-locations">Wait Queue Locations</a></h1>
<p>This document describes how Wait Queue Locations are handled by Navithor Server and visualized in Navithor Client.</p>
<p>Updated 09.12.2022</p>
<h2 id="version-history-35"><a class="header" href="#version-history-35">Version History</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Version</th><th>Date</th><th>Author</th><th>Change</th></tr></thead><tbody>
<tr><td>1.0</td><td>27.01.2022</td><td>Elena Sgonova</td><td>Document created</td></tr>
<tr><td>1.1</td><td>09.12.2022</td><td>Simon Clement</td><td>Add warning about decision points in wait queues</td></tr>
</tbody></table>
</div>
<hr />
<h2 id="introduction-19"><a class="header" href="#introduction-19">Introduction</a></h2>
<p>Wait queue locations or slots are designed to allow multiple AGV form a queue before waiting location at specified positions.</p>
<p>Wait queue locations can be defined with Navithor Tools starting from <strong>version 4.08.00</strong>. For more details how to do it, refer to Navithor Tools <em>Wait Queue Locations</em> document. Navithor supports wait queue locations starting from <strong>version 2.50.0.0</strong>.</p>
<blockquote>
<p>Note: For environments without wait queue locations defined Navithor will try to generate slots itself. The amount of generated wait queue locations, however, depends on a segment length. If segment splitting was enabled for routes, no additional slots will be generated.</p>
</blockquote>
<blockquote>
<p>Note: Do not place decision points inside a wait queue. It is not supported and may lead to unwanted behavior.</p>
</blockquote>
<h2 id="stopping-at-wait-queue-locations"><a class="header" href="#stopping-at-wait-queue-locations">Stopping at wait queue locations</a></h2>
<p>When waiting location is assigned to a machine it initially targets the last slot. After arriving to the end of a waiting queue, machine’s drive task is extended to the next available slot. If there’s no slots available or slot is blocked by other AGV, machine will wait at its current slot until it will be able to continue drive.</p>
<p>Until AGV has reached slot 0 – it is always located at wait location symbolic point position – AGV’s active task is <strong>Drive</strong>. Only when it stops at waiting location position, the task will be updated to <strong>Wait for production</strong> and AGV will be able to take production orders.</p>
<h2 id="visualization-2"><a class="header" href="#visualization-2">Visualization</a></h2>
<p>Navithor Client can visualize wait queue locations when mouse hovers over a waiting location.</p>
<p><strong>Figure 1</strong> shows 8 waiting slots defined for Wait Station (200). Slots 0,1,2 and 8 are highlighted as reserved slots.</p>
<p><img src="./Images/WaitingSlots/Figure1.png" alt="" /></p>
<p><strong>Figure 2</strong> shows how waiting locations are defined for multiple machine types.</p>
<p><img src="./Images/WaitingSlots/Figure2.png" alt="" /></p>
<p>Navithor Client allows to edit waiting slots color in <strong>Configuration-&gt;Preferences-&gt;On hover-&gt;Wait queue locations</strong> color.</p>
<p>Reserved slots color corresponds to <strong>Destination end points to any color</strong> parameter value.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="coupled-drive"><a class="header" href="#coupled-drive">Coupled Drive</a></h1>
<p>This document contains information on how to use the Coupled Drive feature with Navithor Fleet Control.</p>
<p>Updated 31.01.2022</p>
<h2 id="version-history-36"><a class="header" href="#version-history-36">Version History</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Version</th><th>Date</th><th>Author</th><th>Change</th></tr></thead><tbody>
<tr><td>1.0</td><td>18.12.2020</td><td>Albert Georgs</td><td>Document created.</td></tr>
<tr><td>1.1</td><td>07.01.2021</td><td>Albert Georgs</td><td>Tools section updated.</td></tr>
<tr><td>1.2</td><td>05.02.2021</td><td>Aleksi Ålander</td><td>Document updated to reflect current fleet control.</td></tr>
<tr><td>1.3</td><td>14.05.2021</td><td>Aleksi Ålander</td><td>Small updates to document.</td></tr>
<tr><td>1.4</td><td>09.11.2021</td><td>Aleksi Ålander</td><td>Converted to markdown format and updated some images.</td></tr>
<tr><td>1.5</td><td>16.11.2021</td><td>Toni Liski</td><td>Update picture of manual coupling form and automatic recovery tool</td></tr>
<tr><td>1.6</td><td>31.01.2022</td><td>Aleksi Ålander</td><td>Updated document according to modified logic that does not require hold rule in coupling points.</td></tr>
</tbody></table>
</div>
<hr />
<h2 id="overview-3"><a class="header" href="#overview-3">Overview</a></h2>
<p>In Coupled Drive multiple AGVs are docked into a combined formation and controlled synchronously. The main purpose is to transport loads that are too large for a single AGV to carry. The synchronous driving is controlled by Navitrol and can be used as a stand-alone feature, but it is also possible to use Navithor Fleet Control to handle the production order logic for bigger fleets. The user always needs to define the routes for the AGVs to drive in Navithor Tools.</p>
<p>In Navithor Tools and Navithor Fleet Control, the coupled drive logic is based on having a separate coupled drive machine type. This allows handling the coupled (driven in coupled mode) and single (normal routes driven by single AGVs) routes differently, from allowed lane directions to calculating segment overlaps.</p>
<h2 id="definitions"><a class="header" href="#definitions">Definitions</a></h2>
<p><img src="./Images/CoupledDrive/CoupledDrive_Definitions.png" alt="Coupled drive definitions" /> </p>
<blockquote>
<p>Figure 1: Coupled drive definitions.</p>
</blockquote>
<p>The coupling point is referred to as <strong>SPconn</strong>. This is defined as the navigation point of the coupled machine type and is visualized as the red circle in the figure above. The single machine coupling points are referred to as <strong>SP</strong>. These are the stopping points of the single AGV used to form the coupling formation. The white arrow shows the formation heading of the coupled machine type, this corresponds to the positive default driving direction (positive X-axis when defining the machine type parameters).</p>
<h2 id="machine-type-parameters"><a class="header" href="#machine-type-parameters">Machine type parameters</a></h2>
<p>The positions of the symbolic points in relation to the SPconn are essential in order for the coupling logic to work, which is why the coupled machine type requires specifying these positions explicitly. This is done by adding the following elements to the <em>machine type parameter .xml file</em>.</p>
<pre><code class="language-xml">  &lt;CoupledDrive SingleMachineTypeID=&quot;10012&quot;&gt;
	&lt;SP Index=&quot;0&quot;&gt;
		&lt;OffsetX&gt;0&lt;/OffsetX&gt;
		&lt;OffsetY&gt;1.2&lt;/OffsetY&gt;
	&lt;/SP&gt;
	&lt;SP Index=&quot;1&quot;&gt;
		&lt;OffsetX&gt;0&lt;/OffsetX&gt;
		&lt;OffsetY&gt;-1.2&lt;/OffsetY&gt;
	&lt;/SP&gt;
	&lt;SP Index=&quot;2&quot;&gt;
		&lt;OffsetX&gt;0&lt;/OffsetX&gt;
		&lt;OffsetY&gt;-2.4&lt;/OffsetY&gt;
	&lt;/SP&gt;
  &lt;/CoupledDrive&gt;
</code></pre>
<blockquote>
<p>Figure 2: Coupled drive element specifying coupling point positions.</p>
</blockquote>
<p>The positive X-axis is the forward drive direction of the AGV. The large load carried whilst in coupled mode should also be specified in this coupled machine type parameter file. The machine type dimensions should also be edited to reflect the dimensions of the load that is to be carried.</p>
<p>The coupled drive machine type kinematic model needs to be defined as omni (=3).</p>
<pre><code class="language-xml">&lt;KINEMATIC_MODEL&gt;3&lt;/KINEMATIC_MODEL&gt;
</code></pre>
<blockquote>
<p>Figure 3: Machine type parameter file - kinematic model defined as omni.</p>
</blockquote>
<h3 id="singlemachinetypeid"><a class="header" href="#singlemachinetypeid">SingleMachineTypeID</a></h3>
<p>The coupled drive machine type needs to have a machine type ID corresponding to the single AGVs that are going to be used to dock into the coupled drive. This ID is defined as above for the whole section of the defined coupling points in the machine type parameter file. The routes drawn to the docking positions will only be enabled for this machine type and cannot be edited while having any other machine type selected. As the single machine type used for docking is defined as a separate machine type, it needs to have a unique <em>Machine type ID</em> and <em>Machine type name.</em> The single machine type also needs to be defined as omni.</p>
<h3 id="sp"><a class="header" href="#sp">SP</a></h3>
<p>The SP element defines the X and Y offsets of the single machine coupling points with respect to the SPconn. The <em><strong>Index</strong></em> attribute can be freely assigned by the user, this is then used to differentiate between the different Symbolic points in Navithor.</p>
<p>The offsets indirectly define the formation heading of the coupled machine type. It is recommended that the offsets are defined in such a way that when entering/leaving coupling points, no frame heading changes need to be done in Navithor Tools.</p>
<h3 id="resource-and-machine-dimensions"><a class="header" href="#resource-and-machine-dimensions">Resource and machine dimensions</a></h3>
<p>For each resource that has different dimensions, there has to be a separate coupled drive machine type parameter file included in the Navithor Tools project. For example, if the project has two different large resources with different dimensions, the project needs to have the single machine type parameter file and in addition two machine type parameter files for the two coupled drive formations like shown below in the figure.</p>
<p><img src="./Images/CoupledDrive/CoupledDrive_MachineTypes.png" alt="" /></p>
<blockquote>
<p>Figure 4: Navithor Tools project should have machine types for all different coupled drive formations.</p>
</blockquote>
<p>The coupled drive machine types should use the resource dimensions as the machine dimensions, so that the segment overlaps will be calculated correctly in the fleet control while moving the large resources. For a resource with dimensions of 8 meters long and 3 meters wide the machine dimensions could be set as shown in the figure below.</p>
<p><img src="./Images/CoupledDrive/CoupledDrive_Dimensions.png" alt="" /></p>
<blockquote>
<p>Figure 5: Coupled machine type visualized in Machine Tool.</p>
</blockquote>
<h2 id="drawing-coupled-routes"><a class="header" href="#drawing-coupled-routes">Drawing coupled routes</a></h2>
<p>When a coupled machine type has been added to a Navithor Tools project, coupled routes can be drawn. It is also recommended that the single machine type specified in the coupled machine type parameter file be added to the project before starting to work on the routes or environment.</p>
<p><em>Coupled routes</em> can be drawn by activating the coupled machine type. To create a <em>coupled docking point</em> (a location at which the single machine types are to enter/exit coupled mode, i.e. load/unload the large resource), press the <em><strong>C-key</strong></em> while editing routes. This will automatically calculate the position of the single machine types relative to the center point of the load based on the values specified in the machine type parameter file.</p>
<p><img src="./Images/CoupledDrive/CoupledDrive_DrawingRoutes.png" alt="Drawing coupled routes" /></p>
<blockquote>
<p>Figure 6: Coupled route drawing in Navithor Tools.</p>
</blockquote>
<p>The red arrow always shows the expected formation heading of the coupled route at the SPconns. Docking points should only be added at locations where the coupled drive starts/ends and coupled drive routes should <strong>always</strong> start and end in these points.</p>
<p><img src="./Images/CoupledDrive/CoupledDrive_CoupledRoute.png" alt="Coupled route" /></p>
<blockquote>
<p>Figure 7: Coupled drive route.</p>
</blockquote>
<p>The coupled drive routes and SPconn can only be edited when having the corresponding coupled drive machine type selected. These are disabled for all other machine types in the project. When rotating the SPconn, the single machine docking points are automatically rotated accordingly. These can not be moved independently, but are always moved by moving the SPconn.</p>
<p>SPconns can also be defined as pivot points to enable drawing routes in any direction, but in that case it is up to the user to make sure the frame headings are correct. It is recommended to avoid this as the position of the SPs can be changed depending on how the user wants to define the formation heading of the coupled machine type.</p>
<h2 id="drawing-single-routes"><a class="header" href="#drawing-single-routes">Drawing single routes</a></h2>
<p>Single routes are effectively normal routes for normal AGV with the exception that if connected to a coupled drive docking point, the connected route will be enabled only for the machine type specified in the corresponding coupled machine type parameter file. The same way as coupled routes cannot be edited with any other machine type than the corresponding coupled machine type, these routes can only be created/edited with the correct single machine type.</p>
<p><img src="./Images/CoupledDrive/CoupledDrive_DrawingSingleRoutes.png" alt="Drawing single routes" /></p>
<blockquote>
<p>Figure 8: Drawing single routes.</p>
</blockquote>
<p>Single routes can be drawn in any direction from the SP coupling location node. Since this is designed to be highly customizable, it is the responsibility of the user to make sure that the frame headings of the routes are correct.</p>
<h2 id="generating-environment"><a class="header" href="#generating-environment">Generating environment</a></h2>
<p>Since the coupled machine type isn’t an actual physical AGV type, it should have the same environment points as the single machine type. This is not required for navigation or positioning, that is still handled by the separately controlled single machine types in Navitrol, but rather to avoid changing the file handling since the coupled machine type is regarded a separate machine type in both Navithor Tools and Navithor.</p>
<p>When creating environment points for either the coupled machine type or the specified single machine type connected to the coupled type, environment points will be created for both machine types. The same applies for removing environment points, if removed from one machine type, the same points are removed from the connected coupled drive machine type too. This way we can make sure that the environment points are always identical between coupled machine types and connected single machine types and do not need to take this into consideration in the file upload phase.</p>
<h2 id="uploading-files"><a class="header" href="#uploading-files">Uploading files</a></h2>
<p>When uploading the route and environment files to Navithor or Navitrol, the coupled machine type files will be handled slightly differently than normal. The segment file for the coupled machine type will be named <em>segCD_.xml</em> differing from the normal <em>seg_.xml.</em> This is to enable changing the active segment file dynamically when entering/exiting coupled mode. The environment file is handled exactly the same way as for normal production areas.</p>
<p>When uploading to Navithor, Navithor will handle passing the files to Navitrol, but if uploading directly to a Navitrol client, both segment files (the <em>segCD_.xml</em> and <em>seg_.xml</em>) will both be uploaded to the same client.</p>
<h2 id="configuring-the-coupling-points-for-navithor-fleet-control"><a class="header" href="#configuring-the-coupling-points-for-navithor-fleet-control">Configuring the coupling points for Navithor Fleet Control</a></h2>
<p>If Coupled Drive is used as a stand-alone Navitrol feature, the rest of the chapters can be ignored.</p>
<p>Coupling points are the symbolic points that single machines are going to drive into to wait for the coupling command. Machines will wait at these points until all machines have arrived.
The coupling points can be defined either as Stop, WaitLoad or LoadUnload symbolic points depending on the needs of the production flow. If the same symbolic points are used also as load locations for single machines, they should be LoadUnload type. Otherwise either Stop or WaitLoad should work fine.</p>
<p>If the location is not WaitLoad, the automatically created production order to drive the AGV to the coupling point will stay active until the coupling has been done to ensure that the AGV will stay at the location until all AGVs have arrived.
If the location is defined as WaitLoad, the production order is completed as soon as the machine arrives at the location and AGV can also assign other valid unhandled orders, if it has to still wait for other AGVs to arrive in their coupling points. To make sure the AGV reserved for coupling do not drive away, it makes sense to define the coupling points either as Stop or LoadUnload symbolic points.</p>
<p>Starting from Navithor version 2.50.0.0, the coupling points do not need to be WaitLoad symbolic points or have anymore the Hold rule enabled. Earlier version of Navithor required one of these conditions to be applied for the automatic logic to work correctly for Coupled Drive.</p>
<h2 id="configuring-navithor-fleet-control"><a class="header" href="#configuring-navithor-fleet-control">Configuring Navithor Fleet Control</a></h2>
<p>The Coupled Drive feature is developed in a way, that it does not require special configuring in the Navithor Fleet Control. The important aspects of configuring the system are done in Navithor Tools and the synchronous driving is handled by Navitrol. Fleet Control is responsible for:</p>
<ol>
<li>Detecting a Transfer Request that includes a resource, that can be carried only in a Coupled Drive formation.</li>
<li>Assigning and driving the machines that will be in Couple Drive formation to the correct coupling points with Location Requests.</li>
<li>Driving the machines to coupling points is done with a production order that is generated by the Location Request. The production order has only the coupling point as a target location.</li>
<li>Waiting for all machines to arrive at coupling points before continuing with the coupling. The production order for each AGV stays active and in Executing state until the coupling has been successfully done.</li>
<li>Commanding the Leader and Followers to couple and wait for the respond.</li>
<li>Switching the Leader machine from single machine type into the coupled drive machine type.</li>
<li>Commanding the Leader to load the resource.</li>
<li>Driving the formation to the target location.</li>
<li>Commanding the Leader to unload the resource.</li>
<li>After unloading is complete, commanding the Leader and Followers to decouple.</li>
<li>Switching machines back into single machines and continuing production normally.</li>
</ol>
<p>It is enough to define the single machines in the Navithor Client Settings, even though the coupled drive machine types also exist in the system. Changing machine type into the coupled drive is done automatically by the system.</p>
<p><img src="./Images/CoupledDrive/CoupledDrive_MachinesDefined.png" alt="" /></p>
<blockquote>
<p>Figure 9: Only single machines need to be configured in Navithor Fleet Control.</p>
</blockquote>
<p>It is important to note though, that the active area files need to include the coupled machine type and the segment files linked to this coupled machine <em>SegCD_*</em>. When the files are uploaded with Navithor Tools and user decides to take the files into use, they are correctly activated. You can also check in Navithor Client which files are currently active.</p>
<p><img src="./Images/CoupledDrive/CoupledDrive_ActiveAreaFiles.png" alt="" /></p>
<blockquote>
<p>Figure 10: Active area files in a system with three different coupled drive machines.</p>
</blockquote>
<h2 id="coupled-drive-production"><a class="header" href="#coupled-drive-production">Coupled Drive Production</a></h2>
<p>Production should be triggered with the standard <strong>TransferRequest</strong> (ID = 21) message via MES Interface.</p>
<p>Running automatic production without Transfer Request is not supported. Triggering an unhandled order with request pick up alone is not enough.</p>
<p>To test the system, Transfer Request can be triggered manually through inventory form in Navithor Client or through Orders tab in Web Client. Check Navithor Client and Web Client documentation to read more about these options.</p>
<p>The pickup symbolic point should be in coupled drive production the LoadUnload symbolic point in the beginning of the coupled drive machine type routes and the target symbolic point should be the LoadUnload symbolic point in the end of the route network.</p>
<p><img src="./Images/CoupledDrive/CoupledDrive_ProductionLocations.png" alt="" /></p>
<blockquote>
<p>Figure 11: Simple example of pickup and target locations for coupled drive.</p>
</blockquote>
<p>In the figure above, the system would transfer a resource from symbolic point (9) to (31). In addition to the TransferRequest message, the resource should be set to the Pickup location via MES Interface either with <strong>SetStatusAtSymbolicPoint</strong> (ID = 20) or <strong>SetResourcesAtLocation</strong> (ID = 32) message, when it is available for transfer. For manual testing the resource can be set through the Navithor or Web Client.</p>
<p>When the resource is available at the pickup location and the Transfer Request has been given to the system, Navithor will assign machines for the coupled drive formation and drive the selected machines with drive orders to the pickup locations. If there are not enough machines available to fill all coupling points, the machines already available will be reserved and driven to the locations to wait for remaining coupling points to be filled. </p>
<p><img src="./Images/CoupledDrive/CoupledDrive_DrivingToCouplingPoints.png" alt="" /></p>
<blockquote>
<p>Figure 12: Fleet control is driving the machines to the coupling points.</p>
</blockquote>
<p>The production order to drive the AGV to the coupling point will stay active and in Executing state until the coupling has been completed to ensure the AGVs do not drive somewhere else and are instead reserved for the coupled drive.</p>
<p>After all machines have arrived at the coupling points, fleet control automatically selects the Leader and Followers for the formation and sends the machines command to couple. During this coupling task, the machine can be seen having a task called <em>coupling</em> and Fleet Control is updating the required area files for the Leader as shown in the figure below.</p>
<p><img src="./Images/CoupledDrive/CoupledDrive_CouplingTask.png" alt="" /></p>
<blockquote>
<p>Figure 13: Machine in coupling task.</p>
</blockquote>
<p>Similar <em>decoupling</em> task is active while the machine is decoupling after unloading the resource.</p>
<p>After coupling is ready, the Leader machine should be visualized with the coupled drive machine type with the large dimensions, that should match with the real resource dimensions as mentioned earlier. The visualization is shown in the figure below.</p>
<p><img src="./Images/CoupledDrive/CoupledDrive_AtCouplingPoints.png" alt="" /></p>
<blockquote>
<p>Figure 14: Coupled drive machine.</p>
</blockquote>
<p>The pallet is used here to visualize that machines have loaded the resource it is going to carry. The dimensions do not need to match with the real resource, as long as the machine dimensions are correctly set.</p>
<p>After this machine will drive the routes allowed for the coupled drive machine and complete the Transfer Request as it would be a normal machine. Navitrol takes care of the synchronous driving. At the target location machines will drop off the resource and decouple to single machines.</p>
<p><img src="./Images/CoupledDrive/CoupledDrive_Driving.png" alt="" /></p>
<blockquote>
<p>Figure 15: Coupled drive machine driving towards target.</p>
</blockquote>
<p><img src="./Images/CoupledDrive/CoupledDrive_DecoupledMachines.png" alt="" /></p>
<blockquote>
<p>Figure 16: After unloading the resource and decoupling, machines are free to continue production as single machines.</p>
</blockquote>
<h2 id="coupling-manually-in-navithor-client"><a class="header" href="#coupling-manually-in-navithor-client">Coupling manually in Navithor Client</a></h2>
<p>Coupling and decoupling can be done manually in Navithor Client from <em>Couple/Decouple machines</em> form. It can be opened under the top menu <em>Machines</em> -&gt; <em>Couple/Decouple machines</em>:</p>
<p><img src="./Images/CoupledDrive/CoupledDrive_ClientTopMenu.png" alt="" /></p>
<blockquote>
<p>Figure 17: Coupling/Decoupling machines form can be opened from top menu.</p>
</blockquote>
<p>The form displayed in the figure below should open up.</p>
<p><img src="./Images/CoupledDrive/CoupledDrive_ClientCouplingForm.png" alt="" /></p>
<blockquote>
<p>Figure 18: The form can be used to manually coupling and decoupling the machines.</p>
</blockquote>
<p>The form can be used to manually test coupling and decoupling of machines. If the machines used for the test have been driven to coupling symbolic points, it is enough to only fill out Machine ID fields for each machines and press button <em>Couple</em>. If the AGVs and the system have been just booted up, the machines need to be again driven to the symbolic points to make sure they are reporting at being at the symbolic point. Without the information Navithor cannot automatically detect the correct coupling positions from the symbolic points.</p>
<p>The positions of the machines and load dimensions can be also inserted manually in the form. In case the given positions and load dimensions do not match with the real positions of the AGVs, Navitrol will reject the coupling command.</p>
<p><strong>Note!</strong> In order to couple machines manually, so that they are not at the symbolicpoint, also <em>Coupled machine ID</em> must be defined.</p>
<p>Form has also button <em>Auto Recover</em> which can be used, for example if machines in formation have been rebooted. It will read the stored state from database and try to couple machines again. It has limitations, but it is recommended to try this button first in error situations, before decoupling and coupling machines manually.</p>
<p><strong>Note!</strong> For this functionality, each Machine ID must be filled accordingly to leader and follower machines.</p>
<h2 id="coupled-drive-feature-in-navitrol"><a class="header" href="#coupled-drive-feature-in-navitrol">Coupled Drive feature in Navitrol</a></h2>
<p>Navitrol Coupled Drive feature can be used either in combination with the Navithor Fleet Control or as a stand-alone system through Navitrol Supervisor interface.</p>
<p>Check Navitrol documentation for more information how to correctly configure the feature.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="stopping-point-offsets-for-symbolic-points"><a class="header" href="#stopping-point-offsets-for-symbolic-points">Stopping Point Offsets for Symbolic Points</a></h1>
<p>This document contains information on how to configure custom stopping point offsets for any symbolic point.</p>
<p>Updated 31.01.2023</p>
<h2 id="version-history-37"><a class="header" href="#version-history-37">Version History</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Version</th><th>Date</th><th>Author</th><th>Change</th></tr></thead><tbody>
<tr><td>1.0</td><td>31.01.2023</td><td>Joni Sundholm</td><td>First version. Feature supported in Navithor version 2.52.0.0 or higher.</td></tr>
</tbody></table>
</div>
<hr />
<h2 id="configuring-offsets"><a class="header" href="#configuring-offsets">Configuring Offsets</a></h2>
<p>Stopping point offset contains following configurations:</p>
<ul>
<li>Transversal offset - In meters, positive value means AGV will stop left side of the route it drives to the target. 0 means no offset. Left side is looked from the approaching direction towards the target position.</li>
<li>Longitudal offset - In meters, positive value means AGV will drive past the target position. 0 means no offset.</li>
<li>Heading offset - In degrees, positive value is counter clockwise from the vehicle's route heading. 0 means no offset.</li>
</ul>
<p>Two sources for offets can be used: MES interface contains SetDriveOffset (ID = 30) that can be signalled to change offsets dynamically during the production and Override-file StoppingPointOffsets.txt can be configured for more permanent offsets based on carried loads, barcodes on loads, location Ids or specific AGVs. Both configurations can be used at the same time, but MES interface signalled offset is always selected over other type of offsets, if a valid offset is available for the AGV's drive task.</p>
<p>Stoppint Point Offsets from MES interface are stored in memory only thus Server restart will clear the offsets. See <em>Communication specification between Navithor and MES</em>-document for more information about the message.</p>
<p>Override-file offsets are read into memory always when production area is loaded in or when reading of Override files is requested. No system parameters are needed for this feature, but there are Navitrol parameters that affect offset driving.</p>
<h3 id="stoppingpointoffsetstxt-file"><a class="header" href="#stoppingpointoffsetstxt-file">StoppingPointOffsets.txt-file</a></h3>
<p>This file is created to Server's Override-folder if it does not exist. The file is filled manually so that every non-empty line that does not start with '#' is tried to be parsed as a single stopping point offset-configuration. Single location can have multiple configurations. If multiple configurations are valid for AGV's target location, then the first valid configuration in the file is used. </p>
<h3 id="file-format"><a class="header" href="#file-format">File Format</a></h3>
<p>One configuration in the file has the following data. Separator between the data fields is colon ':'.</p>
<p><em>Symbolic Point ID:Barcode of the load or tool ID:Load Type ID:Apply Rule:Transversal offset:Longitudal offset:Heading offset:Machine IDs(optional)</em></p>
<p><strong>Symbolic Point ID</strong> defines the location where the offset should apply. Using value 0 results configuration to be valid for every symbolic point.</p>
<p>The next two following configurations are checked separately. If barcode is provided and a valid configuration is found, then load type is ignored. If no matching barcode is found from configurations, then load type is checked.</p>
<ul>
<li><strong>Barcode of the load or Tool ID</strong>: If offset should be used only when a specific barcode is linked to the drive. This means AGV is either carrying the load or tool with specific barcode, or the AGV would be driving to a location where it would be picking up a load with a specific barcode or tool id. If the barcode is provided for the offset configuration, then <strong>Load Type ID</strong> should be 0 unless configuration should be used when barcode OR load type matches.</li>
<li><strong>Load Type ID</strong>: If offset should be used only with specific load type, then this field should be filled with corresponding load type. The AGV is either going to pickup or carrying the load to the target. If the load type is not important, then this can be left as 0.</li>
</ul>
<p>Following configurations can be used to limit when offset is applied:</p>
<ul>
<li><strong>Apply Rule</strong>: Bit-masked rules to define when offset is allowed to be applied. Rules:
<ul>
<li>Bit 0: 1 - apply offset when AGV would be picking up a load at the location. E.g. use value 1 to enable this rule only</li>
<li>Bit 1: 1 - apply offset when AGV would be going to drop a load at the location. E.g. use value 2 to enable this rule only</li>
<li>Bit 2: 1 - apply rule when AGV would be just stopping at the target without any actuator action. E.g. use value 4 to enable this rule only, value 7 if all rules should be enabled.</li>
</ul>
</li>
<li><strong>Machine IDs</strong>: If provided, then offset is valid only for AGVs with ID found in the configuration. The Id's should be separated with comma ',' if multiple AGVs should use the offset configuration. </li>
</ul>
<h2 id="examples"><a class="header" href="#examples">Examples</a></h2>
<p>Following configuration is for symbolic point 1, when AGVs are picking up or dropping off load type 3. When applied, the AGV will stop 10 cm on the left side of the route, but will not overshoot or stop early, nor will it have any heading offset.
1::3:3:0.1:0:0</p>
<p>Following configuration is valid only for AGVs 1, 3 and 5 when they are targeting symbolic point 1 and would be picking up a load with barcode &quot;123-ABC-123&quot;. The three AGVs would stop 10 cm early. Other AGVs would not have any offset unless file would contain another valid offset configuration for the other AGVs.
1:123-ABC-123:0:1:0:-0.1:0:1,3,5</p>
<h2 id="navitrol-behaviour"><a class="header" href="#navitrol-behaviour">Navitrol behaviour</a></h2>
<p>Navitrol has two offset apply modes available, starting from version 6.44. Related Navitrol parameter is drive_offset_apply_mode and it has two supported modes: 0 (default) and 1.</p>
<p>The default mode 0 is available also in older versions of Navitrol. The behaviour is to flip transversal offset from side to another when speed of the route is negative. This behaviour is best suited to offsets that are permanent for the AGV. When AGV arrives to a station with an offset and leaves to the direction where it came from, then flipping the offset makes it possible for the AGV to keep the offset fixed without the AGV moving to the other side of the route, when leaving the station.</p>
<p>This also means that in case target position is reached by driving a reversing segment, then AGV will stop to the right side of the route when defined transversal offset is positive.</p>
<p>The optional mode 1 is more suitable for a symbolic point specific offset. This is available in Navitrol versions 6.44 and above. In this mode the transversal offset is not flipped, thus it doesn't matter if the route is being driven in reverse or forwards, as the positive transversal offset always results the AGV to stop on the left side of the route when looking at the target position from the approaching direction. When AGV leaves the station, the offset is removed and the AGV will return to the nominal route, unless another offset is already being applied.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="safe-stopping-point-calculation"><a class="header" href="#safe-stopping-point-calculation">Safe stopping point calculation</a></h1>
<p>This document contains information on safe stopping point calculation (TCStopPoint) in Navithor.</p>
<p>Updated 11.08.2021</p>
<h2 id="version-history-38"><a class="header" href="#version-history-38">Version History</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Version</th><th>Date</th><th>Author</th><th>Change</th></tr></thead><tbody>
<tr><td>1.0</td><td>29.03.2021</td><td>Toni Liski</td><td>First version</td></tr>
<tr><td>1.1</td><td>28.05.2021</td><td>Toni Liski</td><td>Updated parameters affecting Door stopping point</td></tr>
<tr><td>1.2</td><td>11.08.2021</td><td>Toni Liski</td><td>Corrected affecting parameters for HitToMachine type</td></tr>
</tbody></table>
</div>
<hr />
<h2 id="introduction-20"><a class="header" href="#introduction-20">Introduction</a></h2>
<p>While Scheduler is planning a route for the machine, it is releasing the route segment by segment. One segment might be sometimes very long, and it is necessary that safe machine position can be defined more precisely. For this purpose there exists implementation for calculating safe stopping point.</p>
<p>The safe stopping point is calculated based on complex logic of ruleset. All different objects on the route will affect it - OneMachineZones, doors, other machines, etc. After combining all the rules together, the function returns one single point, the point how far the machine is allowed to advance on the route.</p>
<h2 id="fleet-control-stopping-point-calculation"><a class="header" href="#fleet-control-stopping-point-calculation">Fleet control stopping point calculation</a></h2>
<p>When machine is driving on the field, it follows the route which has been pre-planned for it. Might be that driving must be sometimes interrupted by some external or internal trigger. External trigger can be, for example, a door tag or fire alarm. Internal trigger can be other machine crossing the route, or resource drops too close to path.</p>
<p>Fleet control handles these interjacent stops by looking for multiple different situations which might occur if machine continues driving its route. If Fleet control notices that machine cannot proceed after certain point, it marks this point on the route with a specific tag called stopping point. For each type of stop it is possible to define separate parameter which controls the distance (<em>wait distance</em>) how close to this point machine can drive. The point until machine can proceed, when <em>wait distance</em> parameter has already taken in the account, is called <em>safe stopping point</em>, or <em>TC stop point</em>. When machine reaches this point, is must stop and it cannot proceed until object has been removed or situation has been changed somehow.</p>
<p>In the following Figure the stopping point for &quot;AssemblyOmni 1&quot; in front of &quot;AssemblyOmni 2&quot; is visualized with an orange dot, and segments which are released for a machine to drive are shown with a green line. The machine can then proceed until the orange dot.</p>
<p><img src="Images/stoppingpointvisualization.png" alt="img" /></p>
<p>Figure: Visualization of stopping point in Navithor Client.</p>
<h2 id="stopping-point-types-and-parameters"><a class="header" href="#stopping-point-types-and-parameters">Stopping point types and parameters</a></h2>
<p>Fleet control supports multiple different types of stopping point. By default, if there are no obstacles in the route, machine can drive until stop point called <em>Target</em>. Another final stop point is <em>Rack</em>.</p>
<p>If route is very long, Fleet control does not release all the segments on the route, instead machine can be proceed until <em>MaxDist</em> stopping point. This point  will be moved always further away when machine drives.</p>
<p>Currently available stopping point types are described in the following table. Parameter for each stopping point defines the waiting distance in front of the obstacle, if not stated otherwise.</p>
<div class="table-wrapper"><table><thead><tr><th>Stopping point type</th><th>Description</th><th>Parameters</th></tr></thead><tbody>
<tr><td>Target</td><td>Stopping point set at target point of the drive task</td><td><code>TrafficController_TARGET_NEAR_DIST_BOUND</code> defines how close to target point machine has to be so that it is considered to be at the target</td></tr>
<tr><td>MaxDist</td><td>Stopping point set at maximum allowed drive distance</td><td><code>TrafficController_MAX_DRIVE_ORDER_DIST</code> defines the distance in meters how far away the route is checked and how many segments can be released for machine</td></tr>
<tr><td>HitToResource</td><td>Machine will hit the resource on the route</td><td><code>Resource_ResBlocksPathMaxCheckDist</code> defines the distance how far away from the route resources are checked if they conflict the machine drive path</td></tr>
<tr><td>HitToMachine</td><td>Machine will hit to another machine on the route</td><td>Parameters affecting:<br />- <code>TrafficController_SAFE_SIDE_DIST_BOUND</code><br />- <code>TrafficController_SAFE_DISTANCE_BOUND</code><br />- <em>MachineLimitsPolygon</em> parameters<br /><br />Waiting distance at: <code>TrafficController_MIN_SAFE_DIST_FROM_MACH_END</code>. If another machine is executing the obstacle avoidance, then additional distance of 2 meters is added.</td></tr>
<tr><td>Distance Control</td><td>DistanceControl Zone is active, and machine is following another machine</td><td><code>TrafficController_SAFE_DISTANCE_BOUND</code>, <em>DistanceControlParams.xml</em> -&gt; <code>TC_StartStopPDist</code></td></tr>
<tr><td>OneMachine Zone</td><td>Machine cannot enter oneMachineZone and will stop before</td><td>Wait distance in front of OMZ: <code>TrafficController_ONE_MACH_ZONE_WAIT_DIST</code></td></tr>
<tr><td>Door</td><td>Door is closed and machine will stop in front of it</td><td>Wait distance is configured in tools, and distance how far the door opening can be requested is defined by parameter <code>TrafficController_REQUEST_TAG_STATUS_DISTANCE</code></td></tr>
<tr><td>Firearea</td><td>If fire alarm is active, zone will be kept empty and machine will stop in front of the zone</td><td>Waiting distance is fixed to be 2 meters. (<code>_wait_dist_fire_alarm_zone</code>)</td></tr>
<tr><td>TrafficLight</td><td>TrafficLight is red and does not allow machine to drive in to TrafficLightZone</td><td>To stop machine just before last TrafficLight segment point, stopping point will be set at distance of <code>SegmentHandler_POINT_NEAR_POINT_BOUND</code> before the TrafficLight.</td></tr>
<tr><td>Rack</td><td>Target point is a rack. Stopping point will not be set closer to rack than driveAwayDistance allows</td><td>Parameter <code>Machine_DriveAwayFromTargetDistance</code> defines that how close to rack the stopping point can be set</td></tr>
<tr><td>Waypoint Reservation</td><td>Waypoint is reserved, set stopping  point in front of the waypoint</td><td>Wait distance for waypoint reservation is configured with a parameter <code>Scheduler_WAIT_DIST_FROM_WP_END_DEFAULT_BOUND</code></td></tr>
<tr><td>Overlapping Reservation</td><td>Segment has overlapping reservation, stop before</td><td></td></tr>
<tr><td>Machine Position</td><td>Machine cannot proceed, set  stopping point at machine current position</td><td></td></tr>
</tbody></table>
</div>
<h3 id="add-safety-distance-parameter"><a class="header" href="#add-safety-distance-parameter">Add Safety Distance parameter</a></h3>
<p>In addition, there exists a parameter  <code>TrafficController_TC_SAFE_STOP_ADD_SAFETY_DIST_M</code> which can be used to add extra safety marginal for each interjacent stopping point type. For specific stopping point types, like <strong>Door</strong>, <strong>Rack</strong>, <strong>MachinePosition</strong>, <strong>Target</strong>, <strong>TrafficLight</strong>, and <strong>MaxDist</strong>, this parameter does not affect. </p>
<p>Parameter can be also negative, when it reduces the wait distance, which is defined by other parameters. For example, machine stops before oneMachineZone (OMZ) and wait distance distance  <code>TrafficController_ONE_MACH_ZONE_WAIT_DIST</code> is specified to 3 meters, and <code>TrafficController_TC_SAFE_STOP_ADD_SAFETY_DIST_M</code> is set to 1 meter, then wait distance in front of the OMZ is 2 meters.</p>
<h3 id="waypoint-end"><a class="header" href="#waypoint-end">Waypoint end</a></h3>
<p><code>Scheduler_WAIT_DIST_FROM_WP_END_DEFAULT_BOUND</code> defines the distance how close to the end of the waypoint the stopping point can be set. If any interjacent stopping point type is expected to be set closer to waypoint end, stopping point will be moved closer so that specified distance is reached.</p>
<h3 id="forbidden-distance-parameter"><a class="header" href="#forbidden-distance-parameter">Forbidden distance parameter</a></h3>
<p>Safe stopping point calculation supports the forbidden area in front of the target point. It can be controlled with a parameter <code>TrafficController_TC_SAFE_STOP_FORBIDDEN_DIST_FROM_TARGET_M</code>, meaning that when this parameter is set over zero, safe stopping point will never be set closer to target than this specified distance. For <strong>Rack</strong> type of symbolic point, separate parameter <code>Machine_DriveAwayFromTargetDistance</code> should be used instead for the similar functionality.</p>
<h3 id="one-machine-zones-1"><a class="header" href="#one-machine-zones-1">One machine zones</a></h3>
<p>One machine zones (OMZ), as name describes, are zones where only one machine is allowed to drive simultaneously. TCStopPoint functionality is taking care that machines do not drive inside the zone unintentionally. If machine is allowed to enter the zone, no stopping point is set before the zone. If zone is already occupied or reserved, stopping point type <em>OneMachineZone</em> will be set to the point where machine can proceed. Waiting distance is controlled by parameter <code>TrafficController_ONE_MACH_ZONE_WAIT_DIST</code>.</p>
<p>Multiple OneMachineZones can be also combined together. Below are some examples how several zones work together.</p>
<h4 id="overlapping-zones"><a class="header" href="#overlapping-zones">Overlapping zones</a></h4>
<p>If two zones are overlapping and machine should stop inside the OMZ, the stopping point is moved earlier so that it is not inside the zone anymore.</p>
<p><img src="Images/overlappingZones.jpg" alt="img" /></p>
<p>Figure: Two zones overlapping.</p>
<h4 id="consecutive-zones"><a class="header" href="#consecutive-zones">Consecutive zones</a></h4>
<p>If two zones are defined consecutive, but are not overlapping each other, stop point must be set inside the first zone, at the waiting distance from the second zone.</p>
<p><img src="Images/consecutiveZones.jpg" alt="img" /></p>
<p>Figure: Consecutive zones.</p>
<h4 id="onemachinezone-and-door-after"><a class="header" href="#onemachinezone-and-door-after">OneMachineZone and Door after</a></h4>
<p>If there is a door after the OneMachineZone, stopping inside the zone is allowed.</p>
<p><img src="Images/OmzAndDoorAfter.jpg" alt="img" /></p>
<p>Figure: OMZ with Door tag after.</p>
<h4 id="onemachinezone-and-door-inside"><a class="header" href="#onemachinezone-and-door-inside">OneMachineZone and Door inside</a></h4>
<p>If door is defined inside the one machine zone, and stopping point for door will be outside of the zone, stopping point for OMZ is used instead.</p>
<p><img src="Images/OmzAndDoorInside.jpg" alt="img" /></p>
<p>Figure: OMZ With Door inside the zone.</p>
<h2 id="navithorlogtxt"><a class="header" href="#navithorlogtxt">NavithorLog.txt</a></h2>
<p>Example of the log print in NavithorLog.txt when machine has stopped and cannot proceed. Log print shows that TCStopPoint functionality has calculated stopping point for OneMachineZone at distance of 10 cm, when target for drive is located in 8 meters. Machine cannot proceed because it is not allowed to enter in the oneMachineZone. All calculated stopping points and corresponding segment points are listed here, and algorithm selects first stopping point with closest distance from the machine.</p>
<pre><code>TrafficController: TryGetTCSTopPoint AGV1 ---     Distance Type                 StopPoint           
TrafficController: TryGetTCSTopPoint AGV1 * 1.       0.01m OneMachineZone       SP(Seg1599_i6_Bw{ -474.32 518.28 })     
TrafficController: TryGetTCSTopPoint AGV1   2.       8.38m Target               SP(Seg4667_i4_Bw{ -468.00 515.44 })     
TrafficController: TryGetTCSTopPoint AGV1 ---&gt; Stop point set: SP(Seg1599_i6_Bw{ -474.32 518.28 }).
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="statistics-2"><a class="header" href="#statistics-2">Statistics</a></h1>
<p>This document contains information about statistics handling in Navithor</p>
<p>Updated 04.02.2022</p>
<h2 id="version-history-39"><a class="header" href="#version-history-39">Version History</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Version</th><th>Date</th><th>Author</th><th>Change</th></tr></thead><tbody>
<tr><td>1.0</td><td>04.05.2020</td><td>Tommi Kärki</td><td>Initial corrected version</td></tr>
<tr><td>1.1</td><td>11.06.2021</td><td>Aleksi Ålander</td><td>Renamed title</td></tr>
<tr><td>1.2</td><td>04.02.2022</td><td>Tero Laakso-Pitkäkoski</td><td>Navithor Server.exe configuration moved to ServerSettings.json</td></tr>
</tbody></table>
</div>
<hr />
<h2 id="introduction-21"><a class="header" href="#introduction-21">Introduction</a></h2>
<p>There are 2 types of statistics generated by Navithor.</p>
<p>First type is old generation of statistics which can be found inside <em>ProductionData</em> directory. These statistics are always generated in a verbose format. These can be turned on or off by changing parameter <em>StatisticsEnabled</em> inside <em>ConfigFiles/ServerSettings.json</em>. Older statistics will continue to be generated but nothing new will be added.</p>
<p>Second type of statistics is configured differently and supports multiple output formats. It's possible to output statistics to:</p>
<ul>
<li>Dedicated statistics database</li>
<li>Verbose format</li>
<li>CSV format</li>
</ul>
<p>Server restart is required after changing configuration to enable or disable statistics generation for both type 1 and type 2.</p>
<h2 id="configuration-2"><a class="header" href="#configuration-2">Configuration</a></h2>
<p>Statistics will be enabled when either:</p>
<ul>
<li>Logging to database is enabled by parameter <strong>Statistics_UseStatisticsDatabase</strong> or</li>
<li>Logging to text files is enabled by parameter <strong>Statistics_UseFleetControlStatisticsTextLogger</strong> and at least one format is specified by <strong>Statistics_TextLoggerFormat</strong>.</li>
</ul>
<p><img src="Images/statistics/statistics_relevant_parameters.png" alt="" /></p>
<blockquote>
<p>Figure: Statistics parameters</p>
</blockquote>
<h3 id="statistics-database"><a class="header" href="#statistics-database">Statistics database</a></h3>
<p>If logging statistics to database is enabled then a separate Statistics database is required. By default, enabling statistics logging to database will generate a new database called <em>NTDB_Statistics</em> automatically after the server has been restarted. For manual configuration see * SQL Server and Database installation guide* - document for further instructions. Currently there is a technical limitation that the statistics database has to be on same SQL Server instance as main database.</p>
<p>Statistics view in the Web client will only appear when Statistics database is enabled. </p>
<h3 id="text-format"><a class="header" href="#text-format">Text format</a></h3>
<p>Text format statistics can be enabled by changing <code>Statistics_UseFleetControlStatisticsTextLogger </code> to <strong>true</strong> and enabling one or more output formats on <code>Statistics_TextLoggerFormat</code>. Text format statistics can be found inside <em>Logs\Production</em> directory.</p>
<ul>
<li>Text logs will be generated to Logs/Production directory</li>
<li>Each type of statistics data has it's own file</li>
<li>Each output format of statistics data is saved to it's own file</li>
<li>Once log file reaches maximum size it will be moved to Old directory</li>
<li>There will be a directory for each day inside Old directory</li>
<li>Files moved to Old directory will be prefixed with &quot;yyyy_MM_dd_&quot;</li>
</ul>
<p>Example of files/directories inside directory:</p>
<pre><code>MachineVisitedStatisticsEntry.csv
MachineVisitedStatisticsEntry.log
Old/
ProductionAreaData.txt
ProductionAreaData.xml
ProductionOrderDetailsStatisticsEntry.csv
ProductionOrderStatisticsEntry.csv
ProductionOrderStatisticsEntry.log
TriggeredEntityAlarmStatisticsEntry.csv
TriggeredEntityAlarmStatisticsEntry.log
TriggeredSystemAlarmStatisticsEntry.csv
TriggeredSystemAlarmStatisticsEntry.log
</code></pre>
<h2 id="considerations-with-statistics-database"><a class="header" href="#considerations-with-statistics-database">Considerations with Statistics database</a></h2>
<p>Logging statistics to database will cause increased usage of SQL Server instance. In extreme cases this might slow down access to production database which in turn will slow down the entire Navithor system. Please ensure that the computer hosting the SQL Server instance is powerful enough.</p>
<h2 id="considerations-with-text-log-statistics"><a class="header" href="#considerations-with-text-log-statistics">Considerations with Text log statistics</a></h2>
<p>This will cause more IO to be done on storage device and will require more storage space to be available for Navithor Server. Amount of extra storage space required depends on multiple factors: Amount of AGV's and production speed being biggest.</p>
<h2 id="example-verbose-logs"><a class="header" href="#example-verbose-logs">Example verbose logs:</a></h2>
<p>MachineVisitedStatisticsEntry.log</p>
<pre><code>Machine: Fork_AGV 2 At: (154) Arrive: 12.3.2020 16.54.33 Exited: 12.3.2020 16.54.49
Machine: AGV1 At: (152) Arrive: 12.3.2020 16.54.33 Exited: 12.3.2020 16.54.56
Machine: Fork_AGV 2 At: (151) Arrive: 12.3.2020 16.55.26 Exited: 12.3.2020 16.55.26
Machine: AGV1 At: (153) Arrive: 12.3.2020 16.55.31 Exited: 12.3.2020 16.55.31
Machine: Fork_AGV 2 At: (154) Arrive: 12.3.2020 16.55.56 Exited: 12.3.2020 16.55.56
Machine: AGV1 At: (152) Arrive: 12.3.2020 16.56.02 Exited: 12.3.2020 16.56.03
Machine: Fork_AGV 2 At: (151) Arrive: 12.3.2020 16.56.29 Exited: 12.3.2020 16.56.29
Machine: AGV1 At: (153) Arrive: 12.3.2020 16.56.38 Exited: 12.3.2020 16.56.38
Machine: Fork_AGV 2 At: (154) Arrive: 12.3.2020 16.57.04 Exited: 12.3.2020 16.57.04
Machine: AGV1 At: (152) Arrive: 12.3.2020 16.57.12 Exited: 12.3.2020 16.57.12
Machine: Fork_AGV 2 At: (151) Arrive: 12.3.2020 16.58.03 Exited: 12.3.2020 16.58.03
Machine: AGV1 At: (153) Arrive: 12.3.2020 16.58.11 Exited: 12.3.2020 16.58.11
Machine: AGV1 At: (152) Arrive: 12.3.2020 16.58.46 Exited: 12.3.2020 16.58.46
Machine: Fork_AGV 2 At: (154) Arrive: 12.3.2020 16.58.59 Exited: 12.3.2020 16.58.59

</code></pre>
<p>ProductionOrderStatisticsEntry.log</p>
<pre><code>ProductionOrderId: 52; Name: PM_Gen_(151)_To_(154); AGVName: Fork_AGV 2; PickupLocationName: (151); DestinationName: (154); Created: 12.3.2020 16.57.35; Completed: 12.3.2020 16.59.12; ResourceDesc: Pallet;
Details:
   OrderId: 52; Occured: 12.3.2020 16.57.35; EventType: DescriptionChanged; Description: Order status changed from new_order to loaded
   OrderId: 52; Occured: 12.3.2020 16.57.35; EventType: DescriptionChanged; Description: Status set to waiting.
   OrderId: 52; Occured: 12.3.2020 16.57.36; EventType: DescriptionChanged; Description: Machine is not loaded or fully loaded. Driving to pick up location: (151)
   OrderId: 52; Occured: 12.3.2020 16.57.36; EventType: DescriptionChanged; Description: DriveTask to loadpoint ((151)) created.
   OrderId: 52; Occured: 12.3.2020 16.58.03; EventType: DescriptionChanged; Description: Machine is at pick up location: (151)
   OrderId: 52; Occured: 12.3.2020 16.58.03; EventType: ArrivedAtSymbolicPoint; Description: SymbolicPoint: (151)
   OrderId: 52; Occured: 12.3.2020 16.58.03; EventType: DescriptionChanged; Description: LoadTask created.
   OrderId: 52; Occured: 12.3.2020 16.58.06; EventType: DescriptionChanged; Description: Resources loaded.
   OrderId: 52; Occured: 12.3.2020 16.58.06; EventType: DescriptionChanged; Description: Resource loaded. Resource target: (154)
   OrderId: 52; Occured: 12.3.2020 16.58.06; EventType: DescriptionChanged; Description: DriveTask to target ((154)) created.
   OrderId: 52; Occured: 12.3.2020 16.58.59; EventType: DescriptionChanged; Description: Drive finished.
   OrderId: 52; Occured: 12.3.2020 16.58.59; EventType: ArrivedAtSymbolicPoint; Description: SymbolicPoint: (154)
   OrderId: 52; Occured: 12.3.2020 16.58.59; EventType: DescriptionChanged; Description: UnloadingTask created.
   OrderId: 52; Occured: 12.3.2020 16.59.02; EventType: DescriptionChanged; Description: Resources delivered.
   OrderId: 52; Occured: 12.3.2020 16.59.02; EventType: DescriptionChanged; Description: Resource unloaded.
   OrderId: 52; Occured: 12.3.2020 16.59.02; EventType: DescriptionChanged; Description: Unload success. Order completed.
   OrderId: 52; Occured: 12.3.2020 16.59.12; EventType: OrderCompleted; Description: Order completed
</code></pre>
<p>ResourceTracking</p>
<pre><code>ResourceId: 43 Type: Pallet (1) From: Void [None] -&gt; To: (151) [SymbolicPoint] TransferredAt: 12.3.2020 16.54.43. Resource was at location for: 00:00:00
ResourceId: 44 Type: Car frame (10) From: Void [None] -&gt; To: (153) [SymbolicPoint] TransferredAt: 12.3.2020 16.54.50. Resource was at location for: 00:00:00
ResourceId: 43 Type: Pallet (1) From: (151) [SymbolicPoint] -&gt; To: Fork_AGV 2 [Machine] TransferredAt: 12.3.2020 16.55.29. Resource was at location for: 00:00:45.4490000
ResourceId: 44 Type: Car frame (10) From: (153) [SymbolicPoint] -&gt; To: AGV1 [Machine] TransferredAt: 12.3.2020 16.55.34. Resource was at location for: 00:00:43.6980000
ResourceId: 45 Type: Pallet (1) From: Void [None] -&gt; To: (151) [SymbolicPoint] TransferredAt: 12.3.2020 16.55.46. Resource was at location for: 00:00:00
ResourceId: 46 Type: Car frame (10) From: Void [None] -&gt; To: (153) [SymbolicPoint] TransferredAt: 12.3.2020 16.55.51. Resource was at location for: 00:00:00
ResourceId: 43 Type: Pallet (1) From: Fork_AGV 2 [Machine] -&gt; To: (154) [SymbolicPoint] TransferredAt: 12.3.2020 16.55.58. Resource was at location for: 00:00:29.5980000
ResourceId: 43 Type: Pallet (1) From: (154) [SymbolicPoint] -&gt; To: Void [None] TransferredAt: 12.3.2020 16.56.01. Resource was at location for: 00:00:02.8410000
ResourceId: 44 Type: Car frame (10) From: AGV1 [Machine] -&gt; To: (152) [SymbolicPoint] TransferredAt: 12.3.2020 16.56.05. Resource was at location for: 00:00:31.1490000
ResourceId: 44 Type: Car frame (10) From: (152) [SymbolicPoint] -&gt; To: Void [None] TransferredAt: 12.3.2020 16.56.08. Resource was at location for: 00:00:03.2450000
</code></pre>
<p>EntityAlarm</p>
<pre><code>AlarmTriggered: 9/22/2020 11:20:24 AM; AGVName: ExampleMachine 41; AGVId: 41; Identifier: StartingSegNotFound; IntegerID: 100004; Source: AGV; Location: (-393.85, 369.47); NearSymbolicPoint: (9185); AlarmActiveTime: 00:00:02.0625124
AlarmTriggered: 9/22/2020 11:57:28 AM; AGVName: ExampleMachine 42; AGVId: 42; Identifier: StartingSegNotFound; IntegerID: 100004; Source: AGV; Location: (-441.67, 364.12); NearSymbolicPoint: ; AlarmActiveTime: 00:00:02.0781337
AlarmTriggered: 9/22/2020 11:59:16 AM; AGVName: ExampleMachine 32; AGVId: 32; Identifier: StartingSegNotFound; IntegerID: 100004; Source: AGV; Location: (-455.87, 493.30); NearSymbolicPoint: (9200); AlarmActiveTime: 00:00:02.1094174
AlarmTriggered: 9/22/2020 12:00:57 PM; AGVName: ExampleMachine 42; AGVId: 42; Identifier: StartingSegNotFound; IntegerID: 100004; Source: AGV; Location: (-441.67, 364.12); NearSymbolicPoint: ; AlarmActiveTime: 00:00:02.0624103
AlarmTriggered: 9/22/2020 12:01:29 PM; AGVName: ExampleMachine 5; AGVId: 5; Identifier: StartingSegNotFound; IntegerID: 100004; Source: AGV; Location: (-444.17, 491.19); NearSymbolicPoint: (9016); AlarmActiveTime: 00:00:02.0626197
AlarmTriggered: 9/22/2020 12:26:18 PM; AGVName: ExampleMachine 29; AGVId: 29; Identifier: StartingSegNotFound; IntegerID: 100004; Source: AGV; Location: (-472.20, 514.07); NearSymbolicPoint: (7604); AlarmActiveTime: 00:00:02.0625449
AlarmTriggered: 9/22/2020 12:41:15 PM; AGVName: ExampleMachine 31; AGVId: 31; Identifier: StartingSegNotFound; IntegerID: 100004; Source: AGV; Location: (-439.67, 478.93); NearSymbolicPoint: ; AlarmActiveTime: 00:00:02.0625236
AlarmTriggered: 9/22/2020 1:44:06 PM; AGVName: ExampleMachine 11; AGVId: 11; Identifier: StartingSegNotFound; IntegerID: 100004; Source: AGV; Location: (-514.73, 518.28); NearSymbolicPoint: ; AlarmActiveTime: 00:00:02.0625405
AlarmTriggered: 9/22/2020 1:45:31 PM; AGVName: ExampleMachine 36; AGVId: 36; Identifier: StartingSegNotFound; IntegerID: 100004; Source: AGV; Location: (-444.75, 381.39); NearSymbolicPoint: (9221); AlarmActiveTime: 00:00:02.0938864
AlarmTriggered: 9/22/2020 2:09:40 PM; AGVName: ExampleMachine 26; AGVId: 26; Identifier: StartingSegNotFound; IntegerID: 100004; Source: AGV; Location: (-477.60, 515.44); NearSymbolicPoint: (9241); AlarmActiveTime: 00:00:02.0625147
AlarmTriggered: 9/22/2020 3:39:32 PM; AGVName: ExampleMachine 18; AGVId: 18; Identifier: StartingSegNotFound; IntegerID: 100004; Source: AGV; Location: (-390.00, 373.05); NearSymbolicPoint: ; AlarmActiveTime: 00:00:02.6406674
AlarmTriggered: 9/22/2020 4:14:13 PM; AGVName: ExampleMachine 9; AGVId: 9; Identifier: StartingSegNotFound; IntegerID: 100004; Source: AGV; Location: (-468.02, 514.70); NearSymbolicPoint: (9143); AlarmActiveTime: 00:00:02.0625359
AlarmTriggered: 9/22/2020 5:08:01 PM; AGVName: ExampleMachine 36; AGVId: 36; Identifier: StartingSegNotFound; IntegerID: 100004; Source: AGV; Location: (-444.75, 381.39); NearSymbolicPoint: (9221); AlarmActiveTime: 00:00:02.0625393
AlarmTriggered: 9/22/2020 5:18:28 PM; AGVName: ExampleMachine 7; AGVId: 7; Identifier: StartingSegNotFound; IntegerID: 100004; Source: AGV; Location: (-535.10, 512.47); NearSymbolicPoint: (45); AlarmActiveTime: 00:00:02.0936569
AlarmTriggered: 9/22/2020 5:54:38 PM; AGVName: ExampleMachine 43; AGVId: 43; Identifier: StartingSegNotFound; IntegerID: 100004; Source: AGV; Location: (-477.51, 493.30); NearSymbolicPoint: (9212); AlarmActiveTime: 00:00:02.0638699
AlarmTriggered: 9/22/2020 6:07:44 PM; AGVName: ExampleMachine 38; AGVId: 38; Identifier: StartingSegNotFound; IntegerID: 100004; Source: AGV; Location: (-435.12, 350.13); NearSymbolicPoint: (9219); AlarmActiveTime: 00:00:02.0625430
AlarmTriggered: 9/22/2020 6:30:32 PM; AGVName: ExampleMachine 48; AGVId: 48; Identifier: StartingSegNotFound; IntegerID: 100004; Source: AGV; Location: (-441.67, 356.66); NearSymbolicPoint: ; AlarmActiveTime: 00:00:02.0781397
AlarmTriggered: 9/22/2020 7:02:48 PM; AGVName: ExampleMachine 23; AGVId: 23; Identifier: StartingSegNotFound; IntegerID: 100004; Source: AGV; Location: (-522.74, 518.28); NearSymbolicPoint: ; AlarmActiveTime: 00:00:02.5780439
AlarmTriggered: 9/22/2020 7:28:15 PM; AGVName: ExampleMachine 38; AGVId: 38; Identifier: StartingSegNotFound; IntegerID: 100004; Source: AGV; Location: (-435.12, 350.13); NearSymbolicPoint: (9219); AlarmActiveTime: 00:00:02.0625415
AlarmTriggered: 9/22/2020 9:23:13 PM; AGVName: ExampleMachine 13; AGVId: 13; Identifier: StartingSegNotFound; IntegerID: 100004; Source: AGV; Location: (-483.70, 518.28); NearSymbolicPoint: (9233); AlarmActiveTime: 00:00:02.0625340
AlarmTriggered: 9/22/2020 10:24:14 PM; AGVName: ExampleMachine 10; AGVId: 10; Identifier: StartingSegNotFound; IntegerID: 100004; Source: AGV; Location: (-510.82, 518.28); NearSymbolicPoint: ; AlarmActiveTime: 00:00:02.0937715
AlarmTriggered: 9/22/2020 11:43:51 PM; AGVName: ExampleMachine 6; AGVId: 6; Identifier: StartingSegNotFound; IntegerID: 100004; Source: AGV; Location: (-392.68, 357.65); NearSymbolicPoint: (9183); AlarmActiveTime: 00:00:02.0624929
AlarmTriggered: 9/22/2020 11:51:33 PM; AGVName: ExampleMachine 6; AGVId: 6; Identifier: StartingSegNotFound; IntegerID: 100004; Source: AGV; Location: (-392.68, 357.65); NearSymbolicPoint: (9183); AlarmActiveTime: 00:00:02.5781599
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="machine-interfaces"><a class="header" href="#machine-interfaces">Machine interfaces</a></h1>
<p>This document introduces available machine communication interfaces.</p>
<p>Updated 08.03.2022</p>
<h2 id="version-history-40"><a class="header" href="#version-history-40">Version History</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Version</th><th>Date</th><th>Author</th><th>Change</th></tr></thead><tbody>
<tr><td>1.0</td><td>08.03.2022</td><td>Toni Liski</td><td>Document created</td></tr>
</tbody></table>
</div>
<hr />
<h2 id="introduction-22"><a class="header" href="#introduction-22">Introduction</a></h2>
<p>Navithor Fleet Control currently supports two different implementations of communication between Navithor Fleet Control and machines. Each implementation is called a channel. The default channel is the traditional Navitrol interface, which has been implemented specifically between Navithor Fleet Control and Navitrol controlled machine. From Fleet Control point of view this channel is called <code>Navitrol</code>.</p>
<p>Another channel aimed for more generic use is the <code>VDA5050</code> channel. VDA 5050 is a standardized interface for AGV communication. The VDA 5050 standard is the result of a collaboration between the <em>German Association of the Automotive Industry (VDA)</em> and the <em>VDMA Materials handling and Intralogistics Association</em>. This document assumes that the reader has a basic understanding of the VDA5050 standard, topic structure and available actions.</p>
<h2 id="navitrol-communication-channel"><a class="header" href="#navitrol-communication-channel">Navitrol Communication Channel</a></h2>
<p>Setting up the Navitrol channel requires that the correct <em>Channel</em> type has been selected in the machine settings. See more details for making initial configuration for the system from the document * System Overview and user instructions for Client UI*.</p>
<p><img src="./Images/comms/machine_settings_navitrol.png" alt="Setting up Navitrol channel in machine settings." /></p>
<blockquote>
<p>Figure: Setting up a Navitrol channel in machine settings.</p>
</blockquote>
<p>The Navitrol channel requires that the machine <strong>Id</strong> matches the MachineId set in the Navitrol parameters. Also IP address and port must match with machine IP and port configured in Navitrol. Other configuration for the Navitrol channel is not needed.</p>
<h2 id="vda5050-communication-channel"><a class="header" href="#vda5050-communication-channel">VDA5050 Communication Channel</a></h2>
<p>The VDA5050 communication is based on the MQTT protocol. In the MQTT protocol, all the participating clients will connect to a server, called Broker. This Broker is now implemented as part of the Navithor Server and can be enabled in the configuration file. More details of enabling it in the section <em>VDA configuration file</em>.</p>
<p>Using the VDA channel requires that all the machines have access to the port configured, and that Broker is able to listen to the specified port.</p>
<p><strong>Note:</strong> The currently implemented version of the VDA5050 specification is the version 1.1, even when standard refers to version as &quot;v2&quot; in the topic structure.</p>
<h3 id="setting-up-the-vda-channel"><a class="header" href="#setting-up-the-vda-channel">Setting up the VDA channel</a></h3>
<p>Setting up the VDA5050 channel requires that the correct channel is selected for each machine in machine settings.</p>
<p><img src="./Images/comms/machine_settings_vda.png" alt="Setting up VDA channel in machine settings." /></p>
<blockquote>
<p>Figure: Setting up a VDA channel in machine settings.</p>
</blockquote>
<p>Machine Id and name must be unique for each machine, but the Id does not need to match with any machine identifier, as it can be overwritten (see next section). Machine IP address or port are not used with VDA communication, as the machine is responsible for connecting to Broker.</p>
<p><strong>Note:</strong> When using Navitrol over the VDA channel, Fleet Control can automatically share the map to the machine. This requires that the machine IP is specified here.</p>
<h3 id="vda-configuration-file"><a class="header" href="#vda-configuration-file">VDA configuration file</a></h3>
<p>After launching Navithor Server for the first time, the file <em>vda.json</em> is generated in the <em>ConfigFiles</em> folder. By default the file contains a ServerSettings section and example machine configuration.</p>
<pre><code class="language-json">  &quot;ServerSettings&quot;: {
    &quot;EnableMQTTBroker&quot;: true,
    &quot;Port&quot;: 1883,
    &quot;Base&quot;: &quot;uagv&quot;,
    &quot;Version&quot;: &quot;v2&quot;,
    &quot;Username&quot;: &quot;vda&quot;,
    &quot;Password&quot;: &quot;a4a03419f3b617917f9f677236501874&quot;,
    &quot;UseTLS&quot;: true,
    &quot;CertificateCommonName&quot;: &quot;MCSSystem&quot;
  },
</code></pre>
<blockquote>
<p>Figure: Enable MQTT Broker by enabling the corresponding parameter.</p>
</blockquote>
<p>To enable MQTT Broker inside Navithor Server, set parameter <em>EnableMQTTBroker</em> to <strong>true</strong>. You can also specify the port the Broker listens on and the base structure for the MQTT topic by changing <em>Base</em> or <em>Version</em> parameters.</p>
<p>See authentication and encryption related parameters in the Section MQTT Authentication and Encryption.</p>
<p><strong>Note!</strong> Changing the ServerSettings section requires that Navithor Server is restarted.</p>
<h4 id="available-machine-parameters"><a class="header" href="#available-machine-parameters">Available machine parameters</a></h4>
<p>Each machine operating over the VDA channel needs some machine specific configurations in the <em>vda.json</em> file.</p>
<pre><code class="language-json">{
	&quot;MachineId&quot;: 1,
	&quot;SerialNumber&quot;: &quot;spot-BD-10040004&quot;,
	&quot;FileUploadMethod&quot;: &quot;None&quot;,
	&quot;OrderType&quot;: &quot;FreeNavigation&quot;,
	&quot;SupportedActions&quot;: [
		&quot;initPosition&quot;,
		&quot;cancelOrder&quot;
	],
	&quot;CoordinateTransformation&quot;: {
		&quot;DeltaX&quot;: -1.5244,
		&quot;DeltaY&quot;: -1.83047,
		&quot;DeltaH&quot;: 0.06469245
	}
},
</code></pre>
<blockquote>
<p>Figure: Available VDA related machine parameters.</p>
</blockquote>
<p>The configuration entry in <em>vda.json</em> file is mapped to the actual machine handled by Navitrol by the machine <em>Id</em>, so it must match with the Id defined in the machine settings.</p>
<p><em>SerialNumber</em> is the string representation of the serial number, which machine reports in each message posted to MQTT Broker, as well as in each topic. SerialNumber configured in <em>vda.json</em> must be the same which machine is using and it must be machine specific. If SerialNumber is not specified, MachineId is used as SerialNumber instead.</p>
<p><em>FileUploadMethod</em> is currently not supported. See <em>Custom actions</em> Section for details to automatically share maps with Navitrol controlled machine.</p>
<p><em>OrderType</em> specifies the type of the order which the machine is expecting. Currently two different types are supported:</p>
<ul>
<li>FreeNavigation: Fleet Control creates only two nodes in the drive order: start node and target node.</li>
<li>SegmentsAsEdges: Navitrol original order type containing multiple segments as edges.</li>
</ul>
<p><em>SupportedActions</em> collection should contain all the actions the machine supports.</p>
<p><em>CoordinateTransformation</em> allows to specify difference in machine coordinate system in relation to global coordinate system used by Fleet Control.</p>
<p>To apply changes in the <em>Machines</em> section from the configuration file, use <em>Reload overrides</em> feature of Navithor Server or Client. The file is also reloaded when Navithor Server is restarted.</p>
<h3 id="mqtt-authentication-and-encrypting"><a class="header" href="#mqtt-authentication-and-encrypting">MQTT Authentication and encrypting</a></h3>
<p>To require authentication when establishing connection to MQTT Broker, specify <em>Username</em> and <em>Password</em> fields in ServerSettings. <em>Password</em> must be MD5 hash of the password string, for example <strong>a4a03419f3b617917f9f677236501874</strong>. Username and Password parameters can be left empty if no authentication is required.</p>
<p><strong>Note!</strong> FleetSimulator does not require authentication.</p>
<p>To enable encrypted communication, set parameter <em>UseTLS</em> to True. By default the Broker will search the valid certificate from the Local Machine certificate store which is matching to a common name CN=<strong>MCSServer</strong>. CommonName can be configured in ServerSettings with a parameter <em>CertificateCommonName</em>. Setting up certificates in more details is described in ** Setting up Web server to enable Web client** document.</p>
<p>OpenSSL software can be used to create self-signed certificate for testing purposes:</p>
<pre><code class="language-cmd">openssl req -x509 -newkey rsa:4096 -keyout key.pem -out cert.pem -days 365
openssl pkcs12 -export -out certificate.pfx -inkey key.pem -in cert.pem
</code></pre>
<h3 id="vda-actions"><a class="header" href="#vda-actions">VDA Actions</a></h3>
<p>Status of implemented actions and their relation to existing features:</p>
<div class="table-wrapper"><table><thead><tr><th>Action</th><th>Description</th></tr></thead><tbody>
<tr><td>initPosition</td><td>Initializes machine position. MapId is currently <em>AreaName</em> used by Navithor.</td></tr>
<tr><td>cancelOrder</td><td>Cancels current machine order. Called <em>abort</em> functionality in Navithor Fleet Control.</td></tr>
<tr><td>startPause</td><td>Stops machine. Currently bind to existing <em>FSTOP</em> feature.</td></tr>
<tr><td>stopPause</td><td>Continues machine. Currently bind to existing <em>Release FSTOP</em> feature.</td></tr>
<tr><td>startCharging</td><td>Starts charging.</td></tr>
<tr><td>stopCharging</td><td>Stops charging.</td></tr>
<tr><td>stateRequest</td><td>Request sending state message.</td></tr>
<tr><td>logReport</td><td>Request machine to take log dump. Currently bind to existing Navithor LogSave functionality.</td></tr>
<tr><td>pick</td><td>Pickup resource. Currently bind to existing <em>Load</em> functionality.</td></tr>
<tr><td>drop</td><td>Drop off resource. Currently bind to existing <em>Unload</em> functionality.</td></tr>
<tr><td>detectObject</td><td>Not implemented.</td></tr>
<tr><td>finePositioning</td><td>Not implemented.</td></tr>
<tr><td>waitForTrigger</td><td>Waits until machine is triggered. Currently bind to existing <em>HOLD</em> feature.</td></tr>
</tbody></table>
</div>
<h3 id="custom-actions"><a class="header" href="#custom-actions">Custom actions</a></h3>
<p>Custom actions can be developed for special needs. Currently a few custom actions are already implemented:</p>
<div class="table-wrapper"><table><thead><tr><th>Custom action</th><th>Description</th></tr></thead><tbody>
<tr><td>getFileVersions</td><td>Reports the current route file versions as part of the &quot;resultDescription&quot; of the Finished response. Used with Navitrol.</td></tr>
<tr><td>reloadAreaFiles</td><td>Signals machine to reload the area files. Used with Navitrol.</td></tr>
</tbody></table>
</div>
<h3 id="simulation-with-fleet-simulator"><a class="header" href="#simulation-with-fleet-simulator">Simulation with Fleet Simulator</a></h3>
<p>Navithor Fleet Simulator can be used to simulate the VDA interface. To enable MQTT connection, go to Settings tab and change the parameter <em>UseMQTTCommunication</em> to <strong>True</strong>. FleetSim must be restarted after the parameter has been changed.</p>
<p><img src="./Images/comms/fleetsim_enable_mqtt.png" alt="Enabling MQTT connection in Fleet Simulator." /></p>
<blockquote>
<p>Figure: Enabling MQTT connection in Fleet Simulator.</p>
</blockquote>
<p>After FleetSimulator has been restarted, press <em>Start</em> button to connect MQTT Broker.</p>
<p>s<strong>Note:</strong> Broker must be running at the same machine where FleetSimulator is used.</p>
<h2 id="logging"><a class="header" href="#logging">Logging</a></h2>
<p>By default all the data transferred through the machine interface is logged to separate file per machine. Files can be found in</p>
<pre><code>&lt;serverPath&gt;/Logs/MachineInterface/
</code></pre>
<p>Log file name is constructed based on the used interface, so that Navitrol channel communication channel creates log file <code>Navitrol_X.log</code> and VDA communication channel creates a log file <code>Vda_X.log</code>, where <code>X</code> is the configured machine ID.</p>
<p>Configuration for logger is stored in <code>&lt;serverPath&gt;/ConfigFiles/ServerSettings.json</code> in the section <code>MachineLogging</code>.</p>
<pre><code class="language-json">  &quot;MachineLogging&quot;: {
    &quot;LogFileSize&quot;: 10,
    &quot;LogFilesPerMachine&quot;: 2,
    &quot;LogToSeparateFiles&quot;: true,
    &quot;EnableMachineInterfaceLogging&quot;: true
  }
</code></pre>
<p>The description of each parameter can be found from the table below.</p>
<div class="table-wrapper"><table><thead><tr><th>Parameter</th><th>Description</th></tr></thead><tbody>
<tr><td>LogFileSize</td><td>Maximum size of the created log file in megabytes before rolling. 10 megabytes by default.</td></tr>
<tr><td>LogFilesPerMachine</td><td>Number of log files stored per machine. Only latest two are stored in Log Archive.</td></tr>
<tr><td>LogToSeparateFiles</td><td>Indicates whether machine interface data should be written to separate files, or if all should be combined into single file.</td></tr>
<tr><td>EnableMachineInterfaceLogging</td><td>Indicates whether detailed machine interface data should be written at all. Message subjects are written in normal <code>NavithorLog.txt</code> file apart from this parameter.</td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="communication-specification-between-navithor-and-mes"><a class="header" href="#communication-specification-between-navithor-and-mes">Communication specification between Navithor and MES</a></h1>
<p>This document describes the interface between the Navithor Server and MES.</p>
<p>Version 2.78</p>
<p>Updated 03.02.2023</p>
<h2 id="version-history-41"><a class="header" href="#version-history-41">Version history</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Document Version</th><th>Date</th><th>Author</th><th>Description</th></tr></thead><tbody>
<tr><td>1.0</td><td>02.05.2016</td><td>Jouni Sievilä</td><td>First version</td></tr>
<tr><td>1.1</td><td>26.10.2016</td><td>Joni Sundholm</td><td>Added description texts to all messages</td></tr>
<tr><td>1.2</td><td>21.02.2017</td><td>Joni Sundholm</td><td>Added battery- and loadstatus-fields to AGVStatus-message and updated ProductionStatus-message. Added messages for handling of ProductionOrderLists. Navithor ver. 1.7 required for support</td></tr>
<tr><td>1.3</td><td>06.03.2017</td><td>Joni Sundholm</td><td>AsssingnedToMachine-field type changed from int16 to int32. DestinationIDs-field in message ID = 318 changed from int16 to uint16</td></tr>
<tr><td>1.4</td><td>11.05.2017</td><td>Joni Sundholm</td><td>Added messages TagStatus and TagStatusRequest</td></tr>
<tr><td>1.5</td><td>15.05.2017</td><td>Ville Rahikka</td><td>Major update to the chapter structure. Added RequestPickUp and RequestPickUpResult. Added ErrorIDs chapter</td></tr>
<tr><td>1.51</td><td>19.06.2017</td><td>Ville Rahikka</td><td>Minor spelling error</td></tr>
<tr><td>1.6</td><td>26.06.2017</td><td>Aleksi Ålander</td><td>Correction to SetStatusAtSymbolicPoint message</td></tr>
<tr><td>1.7</td><td>27.11.2017</td><td>Aleksi Ålander</td><td>Added messages 8.1.24 ClearProductionOrders and 8.1.25 ClearTransferRequests</td></tr>
<tr><td>1.71</td><td>08.12.2017</td><td>Aleksi Ålander</td><td>Corrected in 8.2.17. order status interrupted to be 4 and completed 5</td></tr>
<tr><td>1.72</td><td>16.01.2018</td><td>Tommi Kärki</td><td>Added data field AffixNumber to SetStatusAtSymbolicPoint</td></tr>
<tr><td>1.73</td><td>06.02.2018</td><td>Aleksi Ålander</td><td>Small fixes and notes to OutputAll and other Output messages</td></tr>
<tr><td>1.80</td><td>07.02.2018</td><td>Aleksi Ålander</td><td>Added TagType field to message 8.1.22. TagStatus</td></tr>
<tr><td>1.81</td><td>08.02.2018</td><td>Aleksi Ålander</td><td>Fixed the TagStatus format</td></tr>
<tr><td>1.9</td><td>28.02.2018</td><td>Aleksi Ålander</td><td>Corrected messages PickupReady, PickupAborted, EmptyReady, EmptyAborted</td></tr>
<tr><td>1.91</td><td>21.03.2018</td><td>Aleksi Ålander</td><td>Added 'cancelled' status to ProductionStatus message</td></tr>
<tr><td>2.0</td><td>21.08.2018</td><td>Joni Sundholm</td><td>DriveReady-messages (ID = 302) level-field is int32, not uint32 as previously in this document. Reflecting MES interface version 1.5 in Navithor Server</td></tr>
<tr><td>2.1</td><td>26.09.2018</td><td>Joni Sundholm</td><td>InitialSetup-messages (ID = 102) maximum data length is now 65535 bytes instead of 10000<p></p>Added message CancelActiveProductionOrderList (ID = 28). Supported by Navithor version 1.9.55.0 or later</td></tr>
<tr><td>2.2</td><td>09.11.2018</td><td>Aleksi Ålander</td><td>Added messages ResourceStatus (ID = 321), ReleaseHoldToCustomLoc (ID = 29) and SetDriveOffset (ID = 30). Messages supported by Navithor version 1.9.59.0 or later</td></tr>
<tr><td>2.3</td><td>18.02.2019</td><td>Joni Sundholm</td><td>Added messages RequestResourceStatusAtLocation (ID = 322) and AckRejRequest (ID = 201)<p></p>Messages supported by Navithor version 1.9.59.0 or later</td></tr>
<tr><td>2.4</td><td>15.03.2019</td><td>Aleksi Ålander</td><td>New message TransferRequestStatus (ID = 323). Added new optional fields to TransferRequest (ID = 21)<p></p>Added exectionStatus to ProductionStatus (ID = 313)<p></p>Document version number matches from now on with MES interface version</td></tr>
<tr><td>2.5</td><td>09.04.2019</td><td>Joni Sundholm</td><td>Added RequestPickup-field to SetStatusAtSymbolicPoint-message. Supported in Navithor version 1.9.62.0 or later</td></tr>
<tr><td>2.6</td><td>28.05.2019</td><td>Samuli Vaara</td><td>Added message SymbolicPointStatus (ID = 324) and SetSymbolicPointStatus (ID = 34). Modified TransferRequest (ID = 21) to allow requesting groups</td></tr>
<tr><td>2.7</td><td>31.07.2019</td><td>Aleksi Ålander</td><td>Added chapter 8.4. Heartbeat with description about the optional heartbeat and added messages 8.4.1 Heartbeat (ID = 203) and 8.4.2 HeartbeatResponse (ID = 204)</td></tr>
<tr><td>2.8</td><td>03.10.2019</td><td>Aleksi Älander</td><td>Added message FireAlarmSignbal (ID = 36)</td></tr>
<tr><td>2.9</td><td>17.10.2019</td><td>Björn Eike Sopha</td><td>Editing ResponseId description of TransferRequest (ID = 21)</td></tr>
<tr><td>2.10</td><td>29.10.2019</td><td>Samuli Vaara</td><td>Added Active FireAlarmStatus (ID = 326), fixed some typos and heading numbering</td></tr>
<tr><td>2.11</td><td>13.12.2019</td><td>Samuli Vaara</td><td>Added ClearTransfRequestWithTransferID</td></tr>
<tr><td>2.12</td><td>19.12.2019</td><td>Tommi Kärki</td><td>A lot of corrections to message lengths in document. String max lengths specified. Array max length specified</td></tr>
<tr><td>2.13</td><td>23.01.2020</td><td>Aleksi Ålander</td><td>Fixed OutputAll, OutputFloat and OutputDigital messages to Navithor version 2.13.0.0 to work correctly</td></tr>
<tr><td>2.14</td><td>23.03.2020</td><td>Evgenii Kuzminskii</td><td>Modified Version history table layout. Corrected number for 8.2.30<p></p>Added DriveMachineToSymbolicPointWithStops (ID = 38), EstimateDriveToStartSymbolicPoint (ID = 41), StoppedAtStopPoint message (ID 328), EstimationOfDriveToStartSymbolicPoint (ID = 329)</td></tr>
<tr><td>2.15</td><td>28.04.2020</td><td>Evgenii Kuzminskii</td><td>Updated RequestPickUp (ID = 25)<p></p>Added RackTransferRequest (ID = 39), SetRackStatus (ID = 40), GetRackSetup (ID = 43), DriveMachineToRack (ID = 44)<p></p>Updated RequestPickUpResult (ID = 320)<p></p>Added RackSetupReply (ID = 330), RackSetup (ID = 331)</td></tr>
<tr><td>2.16</td><td>29.04.2020</td><td>Tommi Kärki</td><td>Added missing SetResourcesAtMachine (ID = 42)</td></tr>
<tr><td>2.17</td><td>29.04.2020</td><td>Evgenii Kuzminskii</td><td>Updated SetResourcesAtMachine (ID = 42) and fixed numbering</td></tr>
<tr><td>2.18</td><td>29.04.2020</td><td>Evgenii Kuzminskii</td><td>Updated DriveMachineToRack (ID = 44)</td></tr>
<tr><td>2.19</td><td>06.05.2020</td><td>Aleksi Ålander</td><td>Clarify description for SetResourcesAtMachine (ID = 42), corrected header numbering for messages 8.1.41 and 8.1.42, updated Table of contents</td></tr>
<tr><td>2.20</td><td>14.05.2020</td><td>Samuli Vaara</td><td>Added optional flags for AddProductionOrder (ID = 16)</td></tr>
<tr><td>2.21</td><td>15.05.2020</td><td>Evgenii Kuzminskii</td><td>Added LoadUnloadMachineRequest (ID = 46)</td></tr>
<tr><td>2.22</td><td>28.07.2020</td><td>Aleksi Ålander</td><td>Modified InitialSetup ResourceTypeData struct's resource type ID datatype from uint16 to int32. Note: Before Navithor version 2.20.0.0 these resource types were not sent with InitialSetup, even though they should have been. This was fixed to release 2.20.0.0</td></tr>
<tr><td>2.23</td><td>31.08.2020</td><td>Björn Eike Sopha</td><td>Removed optional field that was not implemented for SetSymbolicPointAvailability (ID = 31)</td></tr>
<tr><td>2.24</td><td>02.09.2020</td><td>Antti Parkkonen</td><td>Added RequestZoneStatus (ID = 51) and ZoneStatusReply (ID = 333) messages to this document</td></tr>
<tr><td>2.25</td><td>15.09.2020</td><td>Aleksi Ålander</td><td>Added new messages GetSymbolicPointGroupSetup (ID = 46), SaveLogs (ID = 48), AckAlarms (ID = 49), SetBufferLaneStatus (ID = 50) and SymbolicPointGroupSetup (ID = 332). Added also option to extend existing TransferReqeustStatus (ID = 323) to include more information. This is optional and can be enabled from Navithor Server parameters, on default old shorter form is used</td></tr>
<tr><td>2.26</td><td>31.08.2020</td><td>Björn Eike Sopha</td><td>Fixing message SetSymbolicPointAvailability (ID = 31)</td></tr>
<tr><td>2.27</td><td>24.09.2020</td><td>Toni Liski</td><td>Added a new message ProductionAreaChanged (ID = 334)</td></tr>
<tr><td>2.28</td><td>24.09.2020</td><td>Samuli Vaara</td><td>Added a new message MesBatteryTemperatureWarning (ID = 334). Corrected previous message in doc 334 -&gt; 335</td></tr>
<tr><td>2.29</td><td>01.10.2020</td><td>Tommi Kärki</td><td>Added new messages ID = 52 (GetProductionAreaInformation) and ID = 336-344 which are replies to ID = 52. Removed InitialSetup from Tips because it is optional</td></tr>
<tr><td>2.30</td><td>19.10.2020</td><td>Toni Liski</td><td>Add new messages SetResourceAtLocationWithExtendedInfo (ID = 53) and TransferRequestWithResourceIdentifier (ID = 54)</td></tr>
<tr><td>2.31</td><td>04.12.2020</td><td>Toni Liski</td><td>Add new messages RequestSPResourceStatus (ID = 55) and SymbolicPointResourceStatus (ID = 345)</td></tr>
<tr><td>2.32</td><td>10.12.2020</td><td>Evgenii Kuzminskii</td><td>Updated description for several fields of RackTransferRequest (ID = 39) message</td></tr>
<tr><td>2.33</td><td>17.11.2020</td><td>Tommi Kärki</td><td>Added optional field documentation for RackTransferRequest (ID = 39) message</td></tr>
<tr><td>2.34</td><td>15.01.2021</td><td>Tommi Kärki</td><td>Corrected TransferRequest wrongly mentioning AckOrRejRequest being sent as reply. It is actually AckOrRej. Changed RackTransferRequest TransferId to be uint32 instead of int32 to match TransferRequestStatus RequestId</td></tr>
<tr><td>2.35</td><td>29.01.2021</td><td>Evgenii Kuzminskii</td><td>Fixed document style after conversion from DOCX to MD. Merged documents for incoming and outgoing messages into this document with multiple minor fixes. Updated type of ProductionOrderID field in StoppedAtStopPoint message (ID = 328)</td></tr>
<tr><td>2.36</td><td>17.02.2021</td><td>Evgenii Kuzminskii</td><td>Added chapter with MES message example, updated CurrentStatus field description in ProductionOrderData struct of ProductionStatus message (ID = 313)</td></tr>
<tr><td>2.37</td><td>25.02.2021</td><td>Aleksi Ålander</td><td>Added option to send DistanceToTarget in AGVStatus message, if parameter MES_StatusMessageProtocolVersion is at least 3.</td></tr>
<tr><td>2.38</td><td>15.03.2021</td><td>Aleksi Ålander</td><td>Added option to send CurrentDriveThroughPoint in AGVStatus message, if parameter MES_StatusMessageProtocolVersion is at least 4.</td></tr>
<tr><td>2.39</td><td>12.04.2021</td><td>Tero Laakso</td><td>Add new message ErrorsV2</td></tr>
<tr><td>2.40</td><td>19.04.2021</td><td>Evgenii Kuzminskii</td><td>Corrected ErrorLevel description in ErrorsV2 specification</td></tr>
<tr><td>2.41</td><td>28.04.2021</td><td>Evgenii Kuzminskii</td><td>Updated description for Item type ID field of ShelfStatus struct for SetRackStatus message</td></tr>
<tr><td>2.42</td><td>26.05.2021</td><td>Evgenii Kuzminskii</td><td>Renamed Group to ErrorType field of ErrorDataV2 struct in ErrorsV2 specification and updated description for it and for multiple fields in ErrorsV2Request specification</td></tr>
<tr><td>2.43</td><td>11.06.2021</td><td>Aleksi Ålander</td><td>Clarified that StrictUnloadLoc in TransferRequest is obsolete. Renamed title, minor corrections to formatting</td></tr>
<tr><td>2.44</td><td>16.06.2021</td><td>Elena Sgonova</td><td>Fixed typos in ErrorDataV2 fields names. Added EntityID field description</td></tr>
<tr><td>2.45</td><td>17.06.2021</td><td>Toni Liski</td><td>Add new messages ElevatorStatus (ID = 351) and ElevatorRequest (ID = 352)</td></tr>
<tr><td>2.46</td><td>18.06.2021</td><td>Toni Liski</td><td>Add new Subscription mode ElevatorRequest to MESMessageSubscription</td></tr>
<tr><td>2.47</td><td>30.06.2021</td><td>Aleksi Ålander</td><td>Added option to send CurrentDriveThroughPoint, NextLevelChangePointId and DistanceToNextLevelChange in AGVStatus message, if parameter MES_StatusMessageProtocolVersion is at least 5</td></tr>
<tr><td>2.48</td><td>02.07.2021</td><td>Evgenii Kuzminskii</td><td>Corrected header level and location of ErrorsV2 message (ID = 349) in the document</td></tr>
<tr><td>2.49</td><td>07.07.2021</td><td>Evgenii Kuzminskii</td><td>Changed value range for ElevatorStatus and DoorStatus fields in ElevatorStatus message (ID = 351)</td></tr>
<tr><td>2.50</td><td>03.08.2021</td><td>Aleksi Ålander</td><td>Changed RequestIdType in message 55 into RequestFlags and added new option of requesting ResourceCreationDate in SymbolicPointResourceStatus (ID = 345).</td></tr>
<tr><td>2.51</td><td>18.08.2021</td><td>Toni Liski</td><td>Corrected SPStatus values in message SymbolicPointResourceStatus (ID = 345).</td></tr>
<tr><td>2.52</td><td>06.09.2021</td><td>Tommi Kärki</td><td>Added new field to RackTransferRequest (ID = 39) message. Further clarified how message works.</td></tr>
<tr><td>2.53</td><td>29.09.2021</td><td>Benard Gathimba</td><td>Added DeleteProductionOrderWithId (ID = 353) message.</td></tr>
<tr><td>2.54</td><td>08.11.2021</td><td>Joni Sundholm</td><td>Clarified description for RequestResourceStatusAtLocation (ID = 322) message. Added more error- and reject-reasons to Error IDs-chapter</td></tr>
<tr><td>2.55</td><td>13.12.2021</td><td>Aleksi Ålander</td><td>Reverted change of message 345 minimum length done in protocol version 2.50.</td></tr>
<tr><td>2.56</td><td>15.12.2021</td><td>Aleksi Ålander</td><td>Added option to send LastSymbolPointDrivenOver in AGVStatus message, if parameter MES_StatusMessageProtocolVersion is at least 6.</td></tr>
<tr><td>2.57</td><td>02.02.2022</td><td>Toni Liski</td><td>Added new optional flags for RequestSPResourceStatus message to request all resources and resource slot and shelf indices.</td></tr>
<tr><td>2.58</td><td>01.03.2022</td><td>Elena Sgonova</td><td>Corrected mistakes found by a customer (ID = 348, ID = 320), fixed typos found all over the document.</td></tr>
<tr><td>2.59</td><td>03.03.2022</td><td>Samuli Vaara</td><td>Added SetSymbolicPointPriority (ID = 355)</td></tr>
<tr><td>2.60</td><td>10.03.2022</td><td>Samuli Vaara</td><td>Added RackId extenstion for pickup and target in RackTransferRequest (ID = 39)</td></tr>
<tr><td>2.61</td><td>06.04.2022</td><td>Aleksi Ålander</td><td>Added option to send RequestFlags in SymbolicPointResourceStatus (ID = 345) in case correct override file is found.</td></tr>
<tr><td>2.62</td><td>06.04.2022</td><td>Samuli Vaara</td><td>Added TransferRequestReply (ID = 356), reorganize a bit.</td></tr>
<tr><td>2.63</td><td>25.04.2022</td><td>Tommi Kärki</td><td>Added InitPositionToSymbolicPoint.</td></tr>
<tr><td>2.64</td><td>18.05.2022</td><td>Aleksi Ålander</td><td>AddProductionOrder (ID = 16) extended with option to include racks in the order and new flags for giving only pickup or dropoff order.</td></tr>
<tr><td>2.65</td><td>19.05.2022</td><td>Aleksi Ålander</td><td>Added messages ValidateLoad (ID = 357) and ValidateLoadReply (ID = 358). Added a new flag to AddProductionOrder for requiring load validation.</td></tr>
<tr><td>2.66</td><td>31.05.2022</td><td>Tero Laakso-Pitkäkoski</td><td>Added message StartStopProductionBreak (ID = 359) to activate and stop production break.</td></tr>
<tr><td>2.67</td><td>19.05.2022</td><td>Aleksi Ålander</td><td>Added RequestID to the TransferRequestReply (ID = 356) and modified order of optional RackData in AddProductionOrder (ID = 16) according to customer feedback.</td></tr>
<tr><td>2.68</td><td>30.06.2022</td><td>Tero Laakso-Pitkäkoski</td><td>Length of Status field in TrafficLightStatus fixed to match field type.</td></tr>
<tr><td>2.69</td><td>14.07.2022</td><td>Aleksi Ålander</td><td>Updated DriveMachineToSymbolicPoint behaviour in case of sending machine ID -1.</td></tr>
<tr><td>2.70</td><td>05.09.2022</td><td>Samuli Vaara</td><td>Added NearSymbolicPoint for AGV status, requires protocol version 7</td></tr>
<tr><td>2.71</td><td>15.09.2022</td><td>Toni Liski</td><td>Added a new message ReleaseStopAndHold (ID = 362).</td></tr>
<tr><td>2.72</td><td>28.09.2022</td><td>Toni Liski</td><td>Add MES Subscription for ProductionStatus (ID = 313) message.</td></tr>
<tr><td>2.73</td><td>28.09.2022</td><td>Toni Liski</td><td>Added a new message ReturnToRoute (ID = 361).</td></tr>
<tr><td>2.74</td><td>28.09.2022</td><td>Samuli Vaara</td><td>AGVStatus NearSymbolicPoint value when not found to -1, heading parameter was wrong in docs as well</td></tr>
<tr><td>2.75</td><td>28.09.2022</td><td>Toni Liski</td><td>DriveMachineToSymbolicPoint (ID = 19) extended to contain OrderFlags.</td></tr>
<tr><td>2.76</td><td>30.09.2022</td><td>Aleksi Ålander</td><td>ErrorsV2 (ID = 349) sends ID as uint32, if MES_StatusMessageProtocolVersion is set to at least 8.</td></tr>
<tr><td>2.77</td><td>30.11.2022</td><td>Toni Liski</td><td>Update maximum priority for certain production order and transfer request related messages.</td></tr>
<tr><td>2.78</td><td>03.02.2023</td><td>Simon Clement</td><td>Changed behavior of SymbolicPointResourceStatus (ID = 345) to return quantity of items in each resource when RequestSPResourceStatus (ID = 55) is sent with bit 3 enabled in RequestFlags.</td></tr>
</tbody></table>
</div>
<hr />
<h2 id="glossary-2"><a class="header" href="#glossary-2">Glossary</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Term</th><th>Description</th></tr></thead><tbody>
<tr><td>MES</td><td>Manufacturing execution system</td></tr>
<tr><td>Navithor</td><td>Navithor is fleet management software controlling a fleet of AGVs</td></tr>
</tbody></table>
</div>
<hr />
<h2 id="general"><a class="header" href="#general">General</a></h2>
<p>This document describes the interface between the Navithor Server and MES.</p>
<h2 id="communication-protocol"><a class="header" href="#communication-protocol">Communication protocol</a></h2>
<p>Communication between Navithor and MES client follows TCP/IP protocol where Navithor works as a TCP server.
Listening port for communication establishment is defined in parameters.
By default the listening port is 8015.</p>
<h2 id="endianness"><a class="header" href="#endianness">Endianness</a></h2>
<p>Little-endian format is used (LSB first). Navithor does not support big-endian currently.</p>
<hr />
<h2 id="mes-channel"><a class="header" href="#mes-channel">MES channel</a></h2>
<p>MES channel uses TCP protocol.
Navithor acts as a server, listens for connections and allows one or multiple PLCs to connect as a client.
Messages can be sent in both directions in an MES channel, e.g. for receiving commands from MES and reporting Navithor and AGV statuses back to MES.</p>
<h3 id="versioning-and-identification"><a class="header" href="#versioning-and-identification">Versioning and identification</a></h3>
<p>Communication protocol follows semantic versioning with a format XXX.YYY where XXX is major version and YYY is minor version.</p>
<p><em>Major number</em> is incremented whenever backwards compatibility of the specification is compromised and all SW through the system should be updated.
This kind of change in specification should be allowed only on very significant reasons.
Severity of changing major number naturally depends also on the number of different machines and applications in the system.
It is also possible to introduce new major number for special reasons even if the backwards compatibility has not been compromised.
For example if it is desirable to force all SW in the system to be updated for some reason.
As explained in the <em>&quot;Backward/forward compatibility&quot;</em> chapter, applications refuse to communicate with other parties if the major number of the communication specification does not match.
Any HMI application should give a clear error in such a case.</p>
<p><em>Minor number</em> is incremented whenever specification is extended or modified in backwards compatible manner but reflecting change in implementation.
These changes require software update to MES only if the new features of the specification need to be supported.
Whenever major number is increased, minor number is set to 0.</p>
<p>Every message includes identification information about its sender and receiver.
For instance, while sending a message each machine and HMI adds its identification number to a message header as a sender ID.
The same way an ID of machine or HMI the message is addressed to is included in the message header.
Therefore, the receiver can check who has sent the message using the sender ID and reject the message if its own ID does not match the receiver ID included in the message.</p>
<h3 id="backwardforward-compatibility"><a class="header" href="#backwardforward-compatibility">Backward/forward compatibility</a></h3>
<p>Rules:</p>
<ol>
<li>When a message is defined the same message id cannot be used for any other message.</li>
<li>The meaning of message bytes cannot be changed.</li>
<li>The length of message may vary:</li>
</ol>
<ul>
<li>Messages can be of any length;</li>
<li>Frame tells the length of message;</li>
<li>Received message can be longer than expected. In this case only the known bytes will be parsed.</li>
</ul>
<ol start="4">
<li>Messages can be extended as long as the meaning of the original bytes does not change.</li>
<li>Any number of new messages can be introduced.</li>
</ol>
<h2 id="sending-and-receiving-messages"><a class="header" href="#sending-and-receiving-messages">Sending and receiving messages</a></h2>
<p>Once connection between Navithor and MES has been successfully established Navithor will start sending following messages periodically:</p>
<ul>
<li><strong>AGVStatus</strong> (ID = 310) - status information of the AGVs in the system;</li>
<li><strong>InputValues</strong> (ID = 312) - input data from the AGVs;</li>
<li><strong>ProductionStatus</strong> (ID = 313) - status of all production orders in system.</li>
</ul>
<h3 id="message-respond-requirements"><a class="header" href="#message-respond-requirements">Message respond requirements</a></h3>
<p>MES is not required to answer or acknowledge any way to messages received from Navithor.</p>
<p>Navithor replies with <strong>AckOrReject</strong> message (ID = 200) to each successfully parsed message from MES and replies with corresponding reply-message when request is handled in Navithor.</p>
<h3 id="tips-for-client-software-mes"><a class="header" href="#tips-for-client-software-mes">Tips for client software (MES)</a></h3>
<ul>
<li>Send message <strong>VersionInfo</strong> (ID = 1) to verify that the communication matches with Navithor.</li>
<li>Send message <strong>SetTime</strong> (ID = 3) when needing to have the AGVs set time to MES time.</li>
</ul>
<hr />
<h2 id="message-structure"><a class="header" href="#message-structure">Message structure</a></h2>
<div class="table-wrapper"><table><thead><tr><th></th><th>Length(bytes)</th></tr></thead><tbody>
<tr><td>Frame</td><td>9</td></tr>
<tr><td>Message Data</td><td>0-65535</td></tr>
</tbody></table>
</div>
<h3 id="frame"><a class="header" href="#frame">Frame</a></h3>
<p>Every message has a frame that consists of following data.
Sender ID and Receiver ID are specified as follow:</p>
<p>Navithor: ID = 1000, MES clients: ID = 1001, 1002, ...
For example when sending a message from MES to Navithor Sender ID = 1001 and Receiver ID = 1000.</p>
<div class="table-wrapper"><table><thead><tr><th>Field</th><th>Type</th><th>Length (bytes)</th><th>Value</th><th>Description</th></tr></thead><tbody>
<tr><td>Id</td><td>uint16</td><td>2</td><td>0-65535</td><td>Message ID</td></tr>
<tr><td>Sender id</td><td>uint16</td><td>2</td><td>0-65535</td><td>Unique ID of the sender</td></tr>
<tr><td>Receiver id</td><td>uint16</td><td>2</td><td>0 Any, 1-65535 receiver id</td><td>Unique ID of the receiver</td></tr>
<tr><td>Message type</td><td>byte</td><td>1</td><td>1 reply needed, 2 reply not needed</td><td>Tells if the message needs to be replied</td></tr>
<tr><td>Data length</td><td>uint16</td><td>2</td><td>0-65535</td><td>Message data length in bytes (0 means that no other data than frame is sent)</td></tr>
</tbody></table>
</div>
<h3 id="message-data"><a class="header" href="#message-data">Message data</a></h3>
<p>Message data consists of bytes that are defined in Messages section of this document.</p>
<hr />
<h2 id="messages"><a class="header" href="#messages">Messages</a></h2>
<p>Following message-tables contains required information to build the message data.
&quot;Min Length&quot; and &quot;Max Length&quot; are byte counts containing bytes from message frame.
Thus, the minimum length is always at least 9 bytes for all messages.</p>
<h3 id="messages-from-mes-to-navithor"><a class="header" href="#messages-from-mes-to-navithor">Messages from MES to Navithor</a></h3>
<h4 id="getversion-id--1"><a class="header" href="#getversion-id--1">GetVersion (ID = 1)</a></h4>
<p>Gets the communication version from Navithor.</p>
<div class="table-wrapper"><table><thead><tr><th><strong>Frame Length</strong></th><th><strong>Data Length</strong></th><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>9</td><td>0</td><td>9</td><td>9</td></tr>
</tbody></table>
</div>
<h4 id="getinitialsetup-id--2"><a class="header" href="#getinitialsetup-id--2">GetInitialSetup (ID = 2)</a></h4>
<p>Should not be used in new installations. Recommended way to get production area information is with GetProductionAreaInformation (ID = 52) instead.</p>
<div class="table-wrapper"><table><thead><tr><th><strong>Frame Length</strong></th><th><strong>Data Length</strong></th><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>9</td><td>0</td><td>9</td><td>9</td></tr>
</tbody></table>
</div>
<h4 id="settime-id--3"><a class="header" href="#settime-id--3">SetTime (ID = 3)</a></h4>
<p>Sets the time on machine.</p>
<div class="table-wrapper"><table><thead><tr><th><strong>FieldName</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>Frame</td><td>header</td><td>9</td><td>Every message has a frame that consists of the same data</td></tr>
<tr><td>Year</td><td>uint16</td><td>2</td><td>0-65536</td></tr>
<tr><td>Month</td><td>byte</td><td>1</td><td>1-12</td></tr>
<tr><td>Day</td><td>byte</td><td>1</td><td>1-31</td></tr>
<tr><td>Hour</td><td>byte</td><td>1</td><td>0-23</td></tr>
<tr><td>Minute</td><td>byte</td><td>1</td><td>0-59</td></tr>
<tr><td>Second</td><td>byte</td><td>1</td><td>0-59</td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Frame Length</strong></th><th><strong>Data Length</strong></th><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>9</td><td>7</td><td>16</td><td>16</td></tr>
</tbody></table>
</div>
<h4 id="fstop-id--4"><a class="header" href="#fstop-id--4">FSTOP (ID = 4)</a></h4>
<p>Sending this message will stop a specific machine or all machines in the production system. This also takes the machine(s) out of production.</p>
<div class="table-wrapper"><table><thead><tr><th><strong>FieldName</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>Frame</td><td>header</td><td>9</td><td>Every message has a frame that consists of the same data</td></tr>
<tr><td>MachineID</td><td>int16</td><td>2</td><td>Machine ID, -1 for all machines</td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Frame Length</strong></th><th><strong>Data Length</strong></th><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>9</td><td>2</td><td>11</td><td>11</td></tr>
</tbody></table>
</div>
<h4 id="releasefstop-id--5"><a class="header" href="#releasefstop-id--5">ReleaseFSTOP (ID = 5)</a></h4>
<p>Sending this message will release the brakes and FSTOP-state of Navitrol. If automatic start production is enabled in Navithor machines are taken back into production automatically after a specified timeout (system parameter, default 30 seconds).</p>
<div class="table-wrapper"><table><thead><tr><th><strong>FieldName</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>Frame</td><td>header</td><td>9</td><td>Every message has a frame that consists of the same data</td></tr>
<tr><td>MachineID</td><td>int16</td><td>2</td><td>Machine ID, -1 for all machines</td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Frame Length</strong></th><th><strong>Data Length</strong></th><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>9</td><td>2</td><td>11</td><td>11</td></tr>
</tbody></table>
</div>
<h4 id="initializeposition-id--6"><a class="header" href="#initializeposition-id--6">InitializePosition (ID = 6)</a></h4>
<p>Sending this message will trigger position initialization for the requested machine. Valid position initialization locations are Symbolic Points that define at least posInitId1, see GetProductionAreaInformation (ID-52). To initialize position for any symbolic point see InitPositionToSymbolicPoint (ID = 59) instead.</p>
<div class="table-wrapper"><table><thead><tr><th><strong>FieldName</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>Frame</td><td>header</td><td>9</td><td>Every message has a frame that consists of the same data</td></tr>
<tr><td>MachineID</td><td>uint16</td><td>2</td><td></td></tr>
<tr><td>SymbolPointPosInitId</td><td>uint16</td><td>2</td><td>posInitId1 or posInitId2 of the correct Symbolic Point</td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Frame Length</strong></th><th><strong>Data Length</strong></th><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>9</td><td>4</td><td>13</td><td>13</td></tr>
</tbody></table>
</div>
<h4 id="chargingcommand-id--9"><a class="header" href="#chargingcommand-id--9">ChargingCommand (ID = 9)</a></h4>
<p>Sending this message will either trigger a charging request for a machine or release the charging request. Charging request from MES forces Navithor to find a valid charging location after the machine has executed its current production order. Charging request triggered by MES can only be released by MES (command = 0), i.e. machines will stay at charge as long as it has not been released by MES.</p>
<div class="table-wrapper"><table><thead><tr><th><strong>FieldName</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>Frame</td><td>header</td><td>9</td><td>Every message has a frame that consists of the same data</td></tr>
<tr><td>MachineID</td><td>uint16</td><td>2</td><td></td></tr>
<tr><td>command</td><td>uint16</td><td>2</td><td>0 no charge command, 1 charge command</td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Frame Length</strong></th><th><strong>Data Length</strong></th><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>9</td><td>4</td><td>13</td><td>13</td></tr>
</tbody></table>
</div>
<h4 id="outputall-id--10"><a class="header" href="#outputall-id--10">OutputAll (ID = 10)</a></h4>
<p>Sending this message will result Navithor to forward this data to the machine.</p>
<div class="table-wrapper"><table><thead><tr><th><strong>FieldName</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>Frame</td><td>header</td><td>9</td><td>Every message has a frame that consists of the same data</td></tr>
<tr><td>MachineId</td><td>uint16</td><td>2</td><td></td></tr>
<tr><td>DigitalOutputLength</td><td>uint16</td><td>2</td><td>Number of digital outputs, from 0 to max 32</td></tr>
<tr><td>DigitalOutputs</td><td>byte[]</td><td>0...32</td><td>If DigitalOutputLength == 0, skip this field</td></tr>
<tr><td>IntegerOutputLength</td><td>uint16</td><td>2</td><td>Number of integer outputs, from 0 to max 32</td></tr>
<tr><td>IntegerOutputs</td><td>int[]</td><td>0...128</td><td>If IntegerOutputLength == 0, skip this field</td></tr>
<tr><td>FloatOutputLength</td><td>uint16</td><td>2</td><td>Number of float outputs, from 0 to max 32</td></tr>
<tr><td>FloatOutPuts</td><td>float[]</td><td>0...128</td><td>If FloatOutputLength == 0, skip this field</td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Frame Length</strong></th><th><strong>Data Length</strong></th><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>9</td><td>8 + DigitalOutputLength + IntegerOutputLength * 4 + FloatOutputLength * 4</td><td>17</td><td>305</td></tr>
</tbody></table>
</div>
<h4 id="outputdigital-id--11"><a class="header" href="#outputdigital-id--11">OutputDigital (ID = 11)</a></h4>
<p>Sending this message will result Navithor to forward this data to the machine.</p>
<div class="table-wrapper"><table><thead><tr><th><strong>FieldName</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>Frame</td><td>header</td><td>9</td><td>Every message has a frame that consists of the same data</td></tr>
<tr><td>MachineID</td><td>uint16</td><td>2</td><td></td></tr>
<tr><td>DigitalOutNumber</td><td>uint16</td><td>2</td><td>Starting from index 0, maximum number 31</td></tr>
<tr><td>DigitalOutValue</td><td>byte</td><td>1</td><td></td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Frame Length</strong></th><th><strong>Data Length</strong></th><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>9</td><td>5</td><td>14</td><td>14</td></tr>
</tbody></table>
</div>
<h4 id="outputinteger-id--12"><a class="header" href="#outputinteger-id--12">OutputInteger (ID = 12)</a></h4>
<p>Sending this message will result Navithor to forward this data to the machine.</p>
<div class="table-wrapper"><table><thead><tr><th><strong>FieldName</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>Frame</td><td>header</td><td>9</td><td>Every message has a frame that consists of the same data</td></tr>
<tr><td>MachineID</td><td>uint16</td><td>2</td><td></td></tr>
<tr><td>IntegerOutNumber</td><td>uint16</td><td>2</td><td>Starting from index 0, maximum number 31</td></tr>
<tr><td>IntegerOut</td><td>int32</td><td>4</td><td></td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Frame Length</strong></th><th><strong>Data Length</strong></th><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>9</td><td>8</td><td>17</td><td>17</td></tr>
</tbody></table>
</div>
<h4 id="outputfloat-id--13"><a class="header" href="#outputfloat-id--13">OutPutFloat (ID = 13)</a></h4>
<p>Sending this message will result Navithor to forward this data to the machine.</p>
<div class="table-wrapper"><table><thead><tr><th><strong>FieldName</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>Frame</td><td>header</td><td>9</td><td>Every message has a frame that consists of the same data</td></tr>
<tr><td>MachineID</td><td>uint16</td><td>2</td><td></td></tr>
<tr><td>FloatOutNumber</td><td>uint16</td><td>2</td><td>Starting from index 0, maximum number 31</td></tr>
<tr><td>FloatOut</td><td>float</td><td>4</td><td></td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Frame Length</strong></th><th><strong>Data Length</strong></th><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>9</td><td>8</td><td>17</td><td>17</td></tr>
</tbody></table>
</div>
<h4 id="startstopproduction-id--14"><a class="header" href="#startstopproduction-id--14">StartStopProduction (ID = 14)</a></h4>
<p>Sending this message will command Navithor to start or stop production with the selected machine or the whole fleet.</p>
<div class="table-wrapper"><table><thead><tr><th><strong>FieldName</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>Frame</td><td>header</td><td>9</td><td>Every message has a frame that consists of the same data</td></tr>
<tr><td>MachineID</td><td>int16</td><td>2</td><td>Machine ID, -1 for all machines</td></tr>
<tr><td>Start</td><td>byte</td><td>1</td><td>1 = Start, 0 = Stop</td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Frame Length</strong></th><th><strong>Data Length</strong></th><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>9</td><td>3</td><td>12</td><td>12</td></tr>
</tbody></table>
</div>
<h4 id="enablemachine-id--15"><a class="header" href="#enablemachine-id--15">EnableMachine (ID = 15)</a></h4>
<p>Sending this message will enable or disable a selected machine or all machines in the system. Enable machine takes machine into use in Navithor. Disable machine removes the machine from Navithor. <strong>NOTE! Navithor releases the traffic zones that machine reserved when machine is disabled.</strong></p>
<div class="table-wrapper"><table><thead><tr><th><strong>FieldName</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>Frame</td><td>header</td><td>9</td><td>Every message has a frame that consists of the same data</td></tr>
<tr><td>MachineID</td><td>int16</td><td>2</td><td>Machine ID, -1 for all machines</td></tr>
<tr><td>Enable</td><td>byte</td><td>1</td><td>0 = Disable, 1 = Enable</td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Frame Length</strong></th><th><strong>Data Length</strong></th><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>9</td><td>3</td><td>12</td><td>12</td></tr>
</tbody></table>
</div>
<h4 id="addproductionorder-id--16"><a class="header" href="#addproductionorder-id--16">AddProductionOrder (ID = 16)</a></h4>
<p>Sending this message will trigger Navithor to generate a production order for a specific machine. By default the target can be changed if unavailable. Enable strict unload bit to disable this behaviour.</p>
<div class="table-wrapper"><table><thead><tr><th><strong>FieldName</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>Frame</td><td>header</td><td>9</td><td>Every message has a frame that consists of the same data</td></tr>
<tr><td>MachineID</td><td>int16</td><td>2</td><td>Machine ID</td></tr>
<tr><td>productionOrderID</td><td>uint32</td><td>4</td><td>OrderID, unique for each order</td></tr>
<tr><td>fromSymbolicPoint</td><td>uint16</td><td>2</td><td>Symbolic point ID where order starts</td></tr>
<tr><td>toSymbolicPoint</td><td>uint16</td><td>2</td><td>Symbolic point ID where order ends</td></tr>
<tr><td>ItemsToDeliver</td><td>uint16</td><td>2</td><td>Number Of Items to deliver</td></tr>
<tr><td>ItemType</td><td>uint16</td><td>2</td><td>Item ID</td></tr>
<tr><td>StartTimeLength</td><td>uint16</td><td>2</td><td>If 0 start time not defined</td></tr>
<tr><td>StartTime</td><td>string</td><td>0 or 19</td><td>&quot;yyyy.mm.dd.hh.mm.ss&quot;</td></tr>
<tr><td>Priority</td><td>uint16</td><td>2</td><td>1 to 32767, where 1 has the lowest priority</td></tr>
<tr><td>OrderFlags</td><td>uint32</td><td>4</td><td><strong>Optional field, added in MES version 2.20</strong> Bitmask to define behavior of the production order. Bits 1-6 affect resource handling with multi resource container. Check the table below for details.</td></tr>
<tr><td>RackData</td><td>struct</td><td>8...518</td><td><strong>Optional field, added in MES version 2.64.</strong> Specifies shelf and rack IDs for pickup and dropoff locations. Check table below for data structure.</td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Frame Length</strong></th><th><strong>Data Length</strong></th><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>9</td><td>18 + StartTimeLength + optional fields</td><td>27</td><td>568</td></tr>
</tbody></table>
</div>
<p><strong>OrderFlags bitmask</strong></p>
<div class="table-wrapper"><table><thead><tr><th><strong>OrderFlags bits</strong></th><th><strong>Bitmask</strong></th><th><strong>Numeric value</strong></th></tr></thead><tbody>
<tr><td>None</td><td>0</td><td>0</td></tr>
<tr><td>Pickup whole stack</td><td>1 &lt;&lt; 0</td><td>1</td></tr>
<tr><td>Dropoff whole stack</td><td>1 &lt;&lt; 1</td><td>2</td></tr>
<tr><td>Pickup load from bottom of the stack</td><td>1 &lt;&lt; 2</td><td>4</td></tr>
<tr><td>Pickup load from top of the stack</td><td>1 &lt;&lt; 3</td><td>8</td></tr>
<tr><td>Dropoff to bottom of the stack</td><td>1 &lt;&lt; 4</td><td>16</td></tr>
<tr><td>Dropoff to top of the stack</td><td>1 &lt;&lt; 5</td><td>32</td></tr>
<tr><td>Strict unload (Navithor will not change target)</td><td>1 &lt;&lt; 6</td><td>64</td></tr>
<tr><td>Remove load from the system after dropoff</td><td>1 &lt;&lt; 7</td><td>128</td></tr>
<tr><td>After completing PO, take machine out of production</td><td>1 &lt;&lt; 8</td><td>256</td></tr>
<tr><td>Ignore resources at pickup location</td><td>1 &lt;&lt; 9</td><td>512</td></tr>
<tr><td>Ignore resources at target location</td><td>1 &lt;&lt; 10</td><td>1024</td></tr>
<tr><td>Reserved for internal use</td><td>1 &lt;&lt; 11 to 15</td><td>Do not use</td></tr>
<tr><td>Only pickup order</td><td>1 &lt;&lt; 16</td><td>65536</td></tr>
<tr><td>Only dropoff order</td><td>1 &lt;&lt; 17</td><td>131072</td></tr>
<tr><td>Rack data included in the packet</td><td>1 &lt;&lt; 18</td><td>262144</td></tr>
<tr><td>Load needs to be validated before picking up</td><td>1 &lt;&lt; 19</td><td>524288</td></tr>
<tr><td>A new production order is needed to complete PO</td><td>1 &lt;&lt; 20</td><td>1048576</td></tr>
</tbody></table>
</div>
<p><strong>Optional data: Rack Data</strong></p>
<p>Specifies shelf and rack IDs for pickup and dropoff locations. If rack ID is given, it will override the symbolic point ID and specify desired side of the rack for side loaders.
For regular racks (not a sideloader) or non-rack locations, the PickupRackIdLength and DropoffRackIdLength should be given as 0.</p>
<div class="table-wrapper"><table><thead><tr><th><strong>FieldName</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>PickupShelfID</td><td>uint16</td><td>2</td><td>Shelf ID for the height where the load needs to be picked up from (0 for non-rack symbolic points)</td></tr>
<tr><td>PickupRackIdLength</td><td>uint16</td><td>2</td><td>Length of the rack identifier</td></tr>
<tr><td>PickupRackId</td><td>string</td><td>0...255</td><td>Rack identifier, max 255 chars.</td></tr>
<tr><td>DropoffShelfID</td><td>uint16</td><td>2</td><td>Shelf ID for the height where the load needs to be moved to (0 for non-rack symbolic points)</td></tr>
<tr><td>DropoffRackIdLength</td><td>uint16</td><td>2</td><td>Length of the rack identifier</td></tr>
<tr><td>DropoffRackId</td><td>string</td><td>0...255</td><td>Rack identifier, max 255 chars.</td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>8</td><td>518</td></tr>
</tbody></table>
</div>
<h4 id="enableproductionorder-id--17"><a class="header" href="#enableproductionorder-id--17">EnableProductionOrder (ID = 17)</a></h4>
<p>Sending this message will enable or disable a specific production order or all orders in the system.</p>
<div class="table-wrapper"><table><thead><tr><th><strong>FieldName</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>Frame</td><td>header</td><td>9</td><td>Every message has a frame that consists of the same data</td></tr>
<tr><td>productionOrderId</td><td>int32</td><td>4</td><td>Production order ID, -1 for all production orders</td></tr>
<tr><td>Enable</td><td>byte</td><td>1</td><td>0 = Disable, 1 = Enable</td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Frame Length</strong></th><th><strong>Data Length</strong></th><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>9</td><td>5</td><td>14</td><td>14</td></tr>
</tbody></table>
</div>
<h4 id="releasehold-id--18-1"><a class="header" href="#releasehold-id--18-1">ReleaseHold (ID = 18)</a></h4>
<p>Sending this message will trigger Navithor to release a machine in the Symbolic Point from HOLD-state and generate a production order for the machine to the specified target location.</p>
<p><strong>Note:</strong> HOLD feature is a separate feature from StopAndHold, so this message should not be mixed with <em>ReleaseStopAndHold (ID = 362)</em>.</p>
<div class="table-wrapper"><table><thead><tr><th><strong>FieldName</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>Frame</td><td>header</td><td>9</td><td>Every message has a frame that consists of the same data</td></tr>
<tr><td>SymbolicPointId</td><td>uint16</td><td>2</td><td>Symbolic point ID where hold is released</td></tr>
<tr><td>ReleaseTarget</td><td>byte</td><td>1</td><td>0 = default, 1 = first alternative, 2 = second alternative, 3 = third alternative. Note: This is index for predefined hold-Release targets. Use ReleaseHoldToCustomTarget (ID = 29) instead to release by SymbolicPoint ID</td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Frame Length</strong></th><th><strong>Data Length</strong></th><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>9</td><td>3</td><td>12</td><td>12</td></tr>
</tbody></table>
</div>
<h4 id="drivemachinetosymbolicpoint-id--19"><a class="header" href="#drivemachinetosymbolicpoint-id--19">DriveMachineToSymbolicPoint (ID = 19)</a></h4>
<p>Sending this message will result Navithor to either create a production order for the machine if MachineId is greater than 0.
Using MachineId less than zero results Navithor to create a drive request to the Symbolic Point. Navithor will then reason the best possible machine to execute the drive order.</p>
<p>If drive request is given to a location that has Hold-rule enabled, machine goes to hold after arriving at the location.
If location is a WaitLoad symbolic point, machine goes to <em>Wait for production</em> task and can continue with any valid order from there.
For other type of symbolic points the production order is completed, but the system does not guarantee that the AGV would stay at this location.
If there are no unhandeld orders available and there is a reachable wait location available, the AGV will start driving towards the wait location.</p>
<div class="table-wrapper"><table><thead><tr><th><strong>FieldName</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>Frame</td><td>header</td><td>9</td><td>Every message has a frame that consists of the same data</td></tr>
<tr><td>MachineId</td><td>int16</td><td>2</td><td>Machine ID, use &lt; 0 to allow Navithor to select the machine</td></tr>
<tr><td>productionOrderID</td><td>uint32</td><td>4</td><td>OrderID, unique for each order</td></tr>
<tr><td>toSymbolicPoint</td><td>uint16</td><td>2</td><td>Symbolic point ID where order ends</td></tr>
<tr><td>StartTimeLength</td><td>uint16</td><td>2</td><td>If 0 start time not defined</td></tr>
<tr><td>StartTime</td><td>string</td><td>0 or 19</td><td>&quot;yyyy.mm.dd.hh.mm.ss&quot;</td></tr>
<tr><td>Priority</td><td>uint16</td><td>2</td><td>1 to 32767, where 1 has the lowest priority</td></tr>
<tr><td>OrderFlags (optional)</td><td>uint32</td><td>4</td><td><strong>Optional field:</strong> OrderFlags to define specific options for generated production order. Can be left out from the message.<br /> - With <code>NewOrderRequiredToComplete (1 &lt;&lt; 20 = 1048576)</code> is required that a new production order is needed to complete DriveMachineToSymbolicPoint production order.</td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Frame Length</strong></th><th><strong>Data Length</strong></th><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>9</td><td>12 + StartTimeLength</td><td>21</td><td>44</td></tr>
</tbody></table>
</div>
<h4 id="setstatusatsymbolicpoint-id--20"><a class="header" href="#setstatusatsymbolicpoint-id--20">SetStatusAtSymbolicPoint (ID = 20)</a></h4>
<p>Sending this message will either enable or disable and set resource status to the Symbolic Point. Navithor will not order drives to disabled Symbolic Points.</p>
<p>AffixNumber was added in Navithor 1.9.26.0, the old message format without the field is still supported.</p>
<p><strong>AffixNumber is set to 0 if it is not included in the message. RequestPickup-field is supported in Navithor version 1.9.60.0 and above.</strong></p>
<div class="table-wrapper"><table><thead><tr><th><strong>FieldName</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>Frame</td><td>header</td><td>9</td><td>Every message has a frame that consists of the same data</td></tr>
<tr><td>SymbolicPoint</td><td>uint16</td><td>2</td><td>Symbolic point ID</td></tr>
<tr><td>NumberOfItems</td><td>uint16</td><td>2</td><td>Number of items of given type at the symbolic point location</td></tr>
<tr><td>ItemTypeId</td><td>uint16</td><td>2</td><td>0 if no resource at location, otherwise item type ID that will be set available at the location.<br/>ItemTypeID:s are defined in MachineTool</td></tr>
<tr><td>Enabled</td><td>byte</td><td>1</td><td>0 = Disabled, 1 = Enabled</td></tr>
<tr><td>AffixNumber</td><td>double</td><td>8</td><td><strong>Optional field, on default set to 0.</strong> Number used in additional resource info. Informational purpose only</td></tr>
<tr><td>RequestPickup</td><td>byte</td><td>1</td><td><strong>Optional field, on default set to 0.</strong> If value 1 a pickup request is automatically triggered for the resource that is set to be at the location. If Location is empty this field does not have affect</td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Frame Length</strong></th><th><strong>Data Length</strong></th><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>9</td><td>7 + optional fields length</td><td>16</td><td>25</td></tr>
</tbody></table>
</div>
<h4 id="transferrequest-id--21"><a class="header" href="#transferrequest-id--21">TransferRequest (ID = 21)</a></h4>
<p>Sending this message will result Navithor to create a production source to the pick-up Symbolic Point. Navithor will assign machines that can carry the item type to the target Symbolic Point to fulfil the transfer request.</p>
<p>Used together with SetStatusAtSymbolicPoint-message. Start production from a symbolic with this message and inform the actual resource to be available at the location with message SetStatusAtSymbolicPoint.</p>
<p><strong>Fields &quot;Priority&quot; and &quot;RequestID&quot; are supported in Navithor version 1.9.62.X -&gt; MES interface updated to version 1.7. Older versions support only shorter form of the message. Version 2.4 supports both.</strong></p>
<p><strong>Fields &quot;PickupIDType&quot; and &quot;TargetIDType&quot; are supported in Navithor Version 2.1.X.X. -&gt;</strong></p>
<div class="table-wrapper"><table><thead><tr><th><strong>FieldName</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>Frame</td><td>header</td><td>9</td><td>Every message has a frame that consists of the same data</td></tr>
<tr><td>PickupSymbolicPoint</td><td>uint16</td><td>2</td><td>Symbolic point ID</td></tr>
<tr><td>TargetSymbolicPoint</td><td>uint16</td><td>2</td><td>Symbolic point ID</td></tr>
<tr><td>ItemsToPickup</td><td>uint16</td><td>2</td><td>Number of items</td></tr>
<tr><td>ItemTypeId</td><td>uint16</td><td>2</td><td></td></tr>
<tr><td>StrictUnloadLoc</td><td>byte</td><td>1</td><td><strong>Optional field</strong> Obsolete field: If Transfer Request is given to a single symbolic point, unload location is never changed (strict unload location rule). If given to symbolic point group instead, unload location can be changed within this group.</td></tr>
<tr><td>Priority</td><td>byte</td><td>1</td><td><strong>Optional field</strong> 1 to 127, where 1 has the lowest priority. Value 0 means Navithor default priority</td></tr>
<tr><td>RequestID</td><td>uint32</td><td>4</td><td><strong>Optional field</strong> ID sent by the planner. TransferRequest is initially answered by AckOrReject (ID = 200) and later when production order is created for the TransferRequest, TransferRequestStatus message (ID = 323) is sent using this RequestID</td></tr>
<tr><td>PickupIDType</td><td>byte</td><td>1</td><td><strong>Optional field</strong> <p></p>0 = PickupSymbolicPoint-field points to symbolic point ID<br/>1 = PickupSymbolicPoint-field points to symbolic point group ID</td></tr>
<tr><td>TargetIDType</td><td>byte</td><td>1</td><td><strong>Optional field</strong> <p></p>0 = TargetSymbolicPoint-field points to symbolic point ID<br/>1 = TargetSymbolicPoint-field points to symbolic point group ID</td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Frame Length</strong></th><th><strong>Data Length</strong></th><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>9</td><td>8 + optional fields length</td><td>17</td><td>25</td></tr>
</tbody></table>
</div>
<h4 id="activateproductionorderlist-id--22-1"><a class="header" href="#activateproductionorderlist-id--22-1">ActivateProductionOrderList (ID = 22)</a></h4>
<p>MES can activate a production order list by sending this message.</p>
<div class="table-wrapper"><table><thead><tr><th><strong>FieldName</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>Frame</td><td>header</td><td>9</td><td>Every message has a frame that consists of the same data</td></tr>
<tr><td>POLId</td><td>uint32</td><td>4</td><td>ID of the Production Order List template that was activated</td></tr>
<tr><td>MachineID</td><td>int32</td><td>4</td><td>ID of the machine that is requested to execute this list. Less than 0 if any machine</td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Frame Length</strong></th><th><strong>Data Length</strong></th><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>9</td><td>8</td><td>17</td><td>17</td></tr>
</tbody></table>
</div>
<h4 id="requestproductionorderlisttemplates-id--23-1"><a class="header" href="#requestproductionorderlisttemplates-id--23-1">RequestProductionOrderListTemplates (ID = 23)</a></h4>
<p>MES can request current templates of production order lists with this message. Navithor replies with ProductionOrderListTemplateResult-message.</p>
<p>Templates can be created/edited and deleted from Navithor Client. Templates are saved in Navithor database.</p>
<div class="table-wrapper"><table><thead><tr><th><strong>Frame Length</strong></th><th><strong>Data Length</strong></th><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>9</td><td>0</td><td>9</td><td>9</td></tr>
</tbody></table>
</div>
<h4 id="tagstatus-id--24"><a class="header" href="#tagstatus-id--24">TagStatus (ID = 24)</a></h4>
<p>MES can set a status for defined tags. Following tag linking’s are supported by Navithor:</p>
<ul>
<li>Symbolic Point of type ’Door’</li>
</ul>
<div class="table-wrapper"><table><thead><tr><th><strong>FieldName</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>Frame</td><td>header</td><td>9</td><td>Every message has a frame that consists of the same data</td></tr>
<tr><td>TagID</td><td>uint32</td><td>4</td><td>Tag ID defined in Navithor Tools for Symbolic Point</td></tr>
<tr><td>TagStatus</td><td>int32</td><td>4</td><td>Status of the tag. Defined values:<p></p> 0 = OFFLINE<br/>1 = DOOR CLOSED<br/>2 = DOOR CLOSING<br/>3 = DOOR OPENING<br/>4 = DOOR OPEN</td></tr>
<tr><td>TagType</td><td>byte</td><td>1</td><td><strong>Optional field</strong>, Status type (introduced in version 1.80, defaults to 1, if not send in the message):<p></p> 0 = NO ACTION<br/>1 = DOOR STATUS</td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Frame Length</strong></th><th><strong>Data Length</strong></th><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>9</td><td>8 + optional fields length</td><td>17</td><td>18</td></tr>
</tbody></table>
</div>
<h4 id="requestpickup-id--25-1"><a class="header" href="#requestpickup-id--25-1">RequestPickUp (ID = 25)</a></h4>
<p>Sending this message will result Navithor to create an unhandled pickup order and/or send back RequestPickUpResult message.</p>
<p>If symbolic point is a rack, then ShelfId field must be set to a positive value of valid shelf ID on the rack. If symbolic point is not a rack, then ShelfId field must be skipped or set to zero or any negative value.</p>
<div class="table-wrapper"><table><thead><tr><th><strong>FieldName</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>Frame</td><td>header</td><td>9</td><td>Every message has a frame that consists of the same data</td></tr>
<tr><td>Symbolic Point ID</td><td>uint32</td><td>4</td><td>Symbolic Point ID defined in Navithor Tools for Symbolic Point</td></tr>
<tr><td>Shelf ID</td><td>int32</td><td>4</td><td><strong>Optional field</strong>, Shelf ID if symbolic point is a rack</td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Frame Length</strong></th><th><strong>Data Length</strong></th><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>9</td><td>4 + optional fields length</td><td>13</td><td>17</td></tr>
</tbody></table>
</div>
<h4 id="clearproductionorders-id--26"><a class="header" href="#clearproductionorders-id--26">ClearProductionOrders (ID = 26)</a></h4>
<p>Sending this message will command Navithor to clear production orders from the selected machine or the whole fleet.</p>
<div class="table-wrapper"><table><thead><tr><th><strong>FieldName</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>Frame</td><td>header</td><td>9</td><td>Every message has a frame that consists of the same data</td></tr>
<tr><td>MachineId</td><td>int16</td><td>2</td><td>Machine ID, -1 for all machines</td></tr>
<tr><td>ClearProduction</td><td>byte</td><td>1</td><td>1 = clear all production orders, 0 = no action</td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Frame Length</strong></th><th><strong>Data Length</strong></th><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>9</td><td>3</td><td>12</td><td>12</td></tr>
</tbody></table>
</div>
<h4 id="cleartransferrequests-id--27"><a class="header" href="#cleartransferrequests-id--27">ClearTransferRequests (ID = 27)</a></h4>
<p>Sending this message will command Navithor to clear all transfer requests from the given symbolic point or from all the symbolic points. Also sets the production status of the symbolic point to RequestForPickupRequired, so if there is a resource and it needs to be transported, either a new TransferRequest or RequestForPickup is needed.</p>
<div class="table-wrapper"><table><thead><tr><th><strong>FieldName</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>Frame</td><td>header</td><td>9</td><td>Every message has a frame that consists of the same data</td></tr>
<tr><td>Symbolic Point ID</td><td>int32</td><td>4</td><td>Symbolic point ID, -1 for all symbolic points</td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Frame Length</strong></th><th><strong>Data Length</strong></th><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>9</td><td>4</td><td>13</td><td>13</td></tr>
</tbody></table>
</div>
<h4 id="cancelactiveproductionorderlist-id--28-1"><a class="header" href="#cancelactiveproductionorderlist-id--28-1">CancelActiveProductionOrderList (ID = 28)</a></h4>
<p>Sending this message will command Navithor cancel specified active production order list(s).</p>
<div class="table-wrapper"><table><thead><tr><th><strong>FieldName</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>Frame</td><td>header</td><td>9</td><td>Every message has a frame that consists of the same data</td></tr>
<tr><td>Cancel Mode</td><td>byte</td><td>1</td><td>Affect how &quot;Target ID&quot;-field is handled:<p></p> 0 = Cancel active production order with given order ID (Target ID = Active Production Order ID)<br/>1 = Cancel active production order list of given AGV ID (Target ID = MachineID)<br/>2 = Cancel all active production order lists with given template ID<br/>(TargetID == Production Order Template ID)</td></tr>
<tr><td>AgvToFinal</td><td>byte</td><td>1</td><td>1 = if AGV was executing the cancelled production order list it will be rerouted to the final destination of the cancelled production order list.<br/>0 = Agv will not be rerouted anywhere – normal &quot;no production&quot; handling takes place</td></tr>
<tr><td>Target ID</td><td>uint32</td><td>4</td><td>ID of the active production order list, machine ID or production order list template. Usage defined in &quot;Cancel Mode&quot;</td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Frame Length</strong></th><th><strong>Data Length</strong></th><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>9</td><td>6</td><td>15</td><td>15</td></tr>
</tbody></table>
</div>
<h4 id="releaseholdtocustomtarget-id--29-1"><a class="header" href="#releaseholdtocustomtarget-id--29-1">ReleaseHoldToCustomTarget (ID = 29)</a></h4>
<p>Sending this message will trigger Navithor to release a machine in the Symbolic Point from HOLD-state and generate a production order for the machine to a custom target location, which is given in the message.</p>
<p><strong>Note:</strong> HOLD feature is a separate feature from StopAndHold, so this message should not be mixed with <em>ReleaseStopAndHold (ID = 362)</em>.</p>
<div class="table-wrapper"><table><thead><tr><th><strong>FieldName</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>Frame</td><td>header</td><td>9</td><td>Every message has a frame that consists of the same data</td></tr>
<tr><td>symbolicPointId</td><td>uint16</td><td>2</td><td>Symbolic point ID where hold is released</td></tr>
<tr><td>releaseTargetId</td><td>uint16</td><td>2</td><td>Target symbolic point ID for the next drive order</td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Frame Length</strong></th><th><strong>Data Length</strong></th><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>9</td><td>4</td><td>13</td><td>13</td></tr>
</tbody></table>
</div>
<h4 id="setdriveoffset-id--30"><a class="header" href="#setdriveoffset-id--30">SetDriveOffset (ID = 30)</a></h4>
<p>The offset information will be sent to Navitrol and the machine should drive the route with the given offset. The offset resets after reaching the given symbolic point, if the target is defined.</p>
<div class="table-wrapper"><table><thead><tr><th><strong>FieldName</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>Frame</td><td>header</td><td>9</td><td>Every message has a frame that consists of the same data</td></tr>
<tr><td>MachineId</td><td>int32</td><td>4</td><td>Machine ID, -1 for all machines</td></tr>
<tr><td>toSymbolicPoint</td><td>int32</td><td>4</td><td>Symbolic point ID where offset resets, -1 to disable automatic reset</td></tr>
<tr><td>Transversal offset</td><td>float</td><td>4</td><td>Positive value to the left of the route, 0 = no offset</td></tr>
<tr><td>Longitudinal offset</td><td>float</td><td>4</td><td>Positive value for driving past the end point. 0 = no offset</td></tr>
<tr><td>Heading offset</td><td>float</td><td>4</td><td>Positive value CCW from route vehicle heading in degrees. 0 = no offset</td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Frame Length</strong></th><th><strong>Data Length</strong></th><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>9</td><td>20</td><td>29</td><td>29</td></tr>
</tbody></table>
</div>
<h4 id="setsymbolicpointavailability-id--31"><a class="header" href="#setsymbolicpointavailability-id--31">SetSymbolicPointAvailability (ID = 31)</a></h4>
<p>Sets symbolic point to enabled or disabled state.</p>
<div class="table-wrapper"><table><thead><tr><th><strong>FieldName</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>Frame</td><td>header</td><td>9</td><td>Every message has a frame that consists of the same data</td></tr>
<tr><td>SymbolicPointId</td><td>uint16</td><td>2</td><td>ID of symbolic point</td></tr>
<tr><td>Enabled</td><td>byte</td><td>1</td><td>0 = Disabled<br/>1 = Enabled<br/>2 = No change, use last enabled status<br/>2-255 = Reserved</td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Frame Length</strong></th><th><strong>Data Length</strong></th><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>9</td><td>3</td><td>12</td><td>12</td></tr>
</tbody></table>
</div>
<h4 id="setresourcesatlocation-id--32"><a class="header" href="#setresourcesatlocation-id--32">SetResourcesAtLocation (ID = 32)</a></h4>
<p>Sets resources to location. If same data is being sent the resources at location will not change. If order of MESResourceAtLocation is changed or if any of data is different from what Navithor thinks then the resources will be regenerated.</p>
<div class="table-wrapper"><table><thead><tr><th><strong>FieldName</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>Frame</td><td>header</td><td>9</td><td>Every message has a frame that consists of the same data</td></tr>
<tr><td>SymbolicPointId</td><td>uint16</td><td>2</td><td>ID of symbolic point</td></tr>
<tr><td>ResourceAtLocationCount</td><td>uint16</td><td>2</td><td>Count of ResourceAtLocation structures in array (from 0 to 1000)</td></tr>
<tr><td>ResourcesAtLocation</td><td>ResourceAtLocation[]</td><td>ResourceAtLocationCount * ResourceAtLocation length</td><td>Array of ResourceAtLocation structures</td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Frame Length</strong></th><th><strong>Data Length</strong></th><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>9</td><td>4 + ResourceAtLocation length</td><td>13</td><td>8013</td></tr>
</tbody></table>
</div>
<p><strong>ResourceAtLocation</strong></p>
<p>ResourceAtLocation struct.</p>
<div class="table-wrapper"><table><thead><tr><th><strong>FieldName</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>ResourceTypeId</td><td>int32</td><td>4</td><td>ID of resource type</td></tr>
<tr><td>Quantity</td><td>int32</td><td>4</td><td>How many of given resource type are at location</td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>8</td><td>8</td></tr>
</tbody></table>
</div>
<h4 id="setareaforbidden-id--33"><a class="header" href="#setareaforbidden-id--33">SetAreaForbidden (ID = 33)</a></h4>
<p>This message can be used to forbid or allow AGV driving on specific route segments/areas. Multiple waypoints can be allowed or forbidden in a single message. Valid from Navithor version 2.0.1.8 forwards.</p>
<div class="table-wrapper"><table><thead><tr><th><strong>FieldName</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>Frame</td><td>header</td><td>9</td><td>Every message has a frame that consists of the same data</td></tr>
<tr><td>Forbidden area ID</td><td>uint16</td><td>2</td><td>ID for the forbidden area</td></tr>
<tr><td>IsAllowed</td><td>byte</td><td>1</td><td>1 = Driving is allowed, 0 = driving not allowed</td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Frame Length</strong></th><th><strong>Data Length</strong></th><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>9</td><td>3</td><td>12</td><td>12</td></tr>
</tbody></table>
</div>
<h4 id="setsymbolicpointgroupstatus-id--34"><a class="header" href="#setsymbolicpointgroupstatus-id--34">SetSymbolicPointGroupStatus (ID = 34)</a></h4>
<p>This message can be used to set resource related status for a SymbolicPointGroup.</p>
<div class="table-wrapper"><table><thead><tr><th><strong>FieldName</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>Frame</td><td>header</td><td>9</td><td>Every message has a frame that consists of the same data</td></tr>
<tr><td>GroupID</td><td>uint16</td><td>2</td><td>ID of the SymbolicPointGroup</td></tr>
<tr><td>GroupStatus</td><td>uint16</td><td>2</td><td>0 = disable all symbolic points in this group<br/> &gt; 0 = enable all symbolic points in this group</td></tr>
<tr><td>RequestedResourceType</td><td>uint16</td><td>2</td><td>0 = set all symbolic points in this group as empty<br/> &gt; 0 = set resource count for to all points in the group</td></tr>
<tr><td>ResourceCount</td><td>uint16</td><td>2</td><td>Number of resources for each point in this group. If value is higher than maximum amount of resources, then the maximum amount is applied</td></tr>
<tr><td>ResFillMode</td><td>uint16</td><td>2</td><td>Strategy for filling symbolic point groups:<p></p> 0 = Set &quot;ResourceCount&quot; of resources to ALL symbolic points. Max total amount in group: ResourceCount * SymPointGroupCount<br/> 1 = Set symbolic point resources in sorted order. Max total amount in group: ResourceCount</td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Frame Length</strong></th><th><strong>Data Length</strong></th><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>9</td><td>10</td><td>19</td><td>19</td></tr>
</tbody></table>
</div>
<h4 id="groupedtagstatus-id--35"><a class="header" href="#groupedtagstatus-id--35">GroupedTagStatus (ID = 35)</a></h4>
<p>MES can set statuses for an arbitrary number of tags in a single message.</p>
<ul>
<li>Symbolic Point of type ’Door’</li>
</ul>
<p>Available from Navithor server versions 2.1.2.0 onwards.</p>
<div class="table-wrapper"><table><thead><tr><th><strong>Field Name</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>Frame</td><td>header</td><td>9</td><td>Every message has a frame that consists of the same data</td></tr>
<tr><td>NumberOfTags</td><td>uint16</td><td>2</td><td>Number of tag datas to send (N). Max 100</td></tr>
<tr><td>TagDatas</td><td>TagData[]</td><td>4 * N</td><td>Tag ID defined in Navithor Tools for Symbolic Point</td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Frame Length</strong></th><th><strong>Data Length</strong></th><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>9</td><td>2 + TagDatas length</td><td>17</td><td>417</td></tr>
</tbody></table>
</div>
<p><strong>TagData</strong></p>
<p>Data structure for a single machine type.</p>
<div class="table-wrapper"><table><thead><tr><th><strong>Field Name</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>TagID</td><td>uint16</td><td>2</td><td>Tag ID defined in Navithor Tools for Symbolic Point</td></tr>
<tr><td>TagStatus</td><td>uint16</td><td>2</td><td>Status of the tag. Defined values:<p></p> 0 = OFFLINE<br/>1 = DOOR CLOSED<br/>2 = DOOR CLOSING<br/>3 = DOOR OPENING<br/>4 = DOOR OPEN</td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>4</td><td>4</td></tr>
</tbody></table>
</div>
<h4 id="firealarmsignal-id--36"><a class="header" href="#firealarmsignal-id--36">FireAlarmSignal (ID = 36)</a></h4>
<p>This message can be used to activate fire alarm. AGVs inside the active fire alarm zone will drive away of the zone to the closest available symbolic point outside of the zone. During normal operation status is 1. When the fire alarm is active, Status 3 should be sent.</p>
<div class="table-wrapper"><table><thead><tr><th><strong>FieldName</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>Frame</td><td>header</td><td>9</td><td>Every message has a frame that consists of the same data</td></tr>
<tr><td>FireAlarmId</td><td>uint32</td><td>4</td><td>ID for the fire alarm zone</td></tr>
<tr><td>Status</td><td>byte</td><td>1</td><td>0 = none, <strong>1 = inactive</strong>, 2 = deactivating, <strong>3 = fire alarm active</strong></td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Frame Length</strong></th><th><strong>Data Length</strong></th><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>9</td><td>5</td><td>14</td><td>14</td></tr>
</tbody></table>
</div>
<h4 id="cleartransferrequestwithtransferid-id--37"><a class="header" href="#cleartransferrequestwithtransferid-id--37">ClearTransferRequestWithTransferID (ID = 37)</a></h4>
<p>Sending this message will command Navithor to clear a Transfer request with specified TransferID if it exists. Sending -1 as TransferID will clear all transfer requests. This will also remove generated production order if resource has not been picked up. If the resource has been picked up then only the transfer request is removed while the production order remains active.</p>
<div class="table-wrapper"><table><thead><tr><th><strong>FieldName</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>Frame</td><td>header</td><td>9</td><td>Every message has a frame that consists of the same data</td></tr>
<tr><td>TransferID</td><td>int32</td><td>4</td><td>TransferID, -1 for all transfers</td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Frame Length</strong></th><th><strong>Data Length</strong></th><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>9</td><td>4</td><td>13</td><td>13</td></tr>
</tbody></table>
</div>
<h4 id="drivemachinetosymbolicpointwithstops-id--38"><a class="header" href="#drivemachinetosymbolicpointwithstops-id--38">DriveMachineToSymbolicPointWithStops (ID = 38)</a></h4>
<p>The MES can send this message to Navithor. Navithor will acknowledge with AckOrReject message.</p>
<p>Sending this message will result Navithor to create a production order for the machine if MachineId is greater than 0.</p>
<p>If MES generates the order with the IsMachineReserved flag set to 1 then the machine executes the order and stays in stop and hold mode until released.</p>
<p>On each stopping point machine goes to stop and hold mode until released.</p>
<div class="table-wrapper"><table><thead><tr><th><strong>FieldName</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>Frame</td><td>header</td><td>9</td><td>Every message has a frame that consists of the same data</td></tr>
<tr><td>ProductionOrderId</td><td>int32</td><td>4</td><td>Order ID, unique for each order</td></tr>
<tr><td>Priority</td><td>uint16</td><td>2</td><td>Order priority from 1 to 32767, where 1 is the lowest priority</td></tr>
<tr><td>MachineId</td><td>int32</td><td>4</td><td>Machine ID</td></tr>
<tr><td>StartSpId</td><td>uint16</td><td>2</td><td>Start symbolic point ID</td></tr>
<tr><td>EndSpId</td><td>uint16</td><td>2</td><td>End symbolic point ID</td></tr>
<tr><td>IsMachineReserved</td><td>uint16</td><td>2</td><td>Flag to tell if the machine is reserved until released:<p></p> 0 = machine is <strong>not</strong> reserved<br/>1 = machine is reserved</td></tr>
<tr><td>NumberOfStops</td><td>uint16</td><td>2</td><td>Number of stopping points, from 1 to 20.<br/>Each of the points has a distance to target, needs to be before the symbolic point</td></tr>
<tr><td>StoppingDistances</td><td>int32[]</td><td>NumberOfStops * 4</td><td>List of stopping points’ distances, in millimeters, in decreasing order, one or more (negative values are invalid for now). Minimum decrease is 5 mm</td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Frame Length</strong></th><th><strong>Data Length</strong></th><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>9</td><td>18 + StoppingDistances length</td><td>31</td><td>107</td></tr>
</tbody></table>
</div>
<h4 id="racktransferrequest-id--39-1"><a class="header" href="#racktransferrequest-id--39-1">RackTransferRequest (ID = 39)</a></h4>
<p>Sending this message will result Navithor to create a production source to the pick-up Symbolic Point. Navithor will assign machines that can carry the item type to the target Symbolic Point to fulfil the transfer request.</p>
<div class="table-wrapper"><table><thead><tr><th><strong>FieldName</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>Frame</td><td>header</td><td>9</td><td>Every message has a frame that consists of the same data</td></tr>
<tr><td>Pickup symbol ID</td><td>uint16</td><td>2</td><td>ID of the symbolic point where the load needs to be picked up from</td></tr>
<tr><td>Pickup shelf ID</td><td>uint16</td><td>2</td><td>Shelf ID for the height where the load needs to be picked up from (0 for non-rack symbolic points)</td></tr>
<tr><td>Target symbol ID</td><td>uint16</td><td>2</td><td>ID of the symbolic point where the load needs to be moved to</td></tr>
<tr><td>Target shelf ID</td><td>uint16</td><td>2</td><td>Shelf ID for the height where the load needs to be moved to (0 for non-rack symbolic points)</td></tr>
<tr><td>Item type ID</td><td>uint16</td><td>2</td><td>Type ID for the load</td></tr>
<tr><td>Priority</td><td>uint16</td><td>2</td><td>Priority for the transfer. The higher this number, the higher the priority. Lowest priority is 1, and 0 means to use default priority.</td></tr>
<tr><td>Ignore pickup status</td><td>uint16</td><td>2</td><td>0 = Transfer request is executed only when the pickup symbol actually has the load on the correct shelf<br/>1 = The load with the item type ID given in this message will be created on the pickup symbol on the pickup shelf when this message is received. If there already is an item on the shelf the type will be converted to the one given in this message</td></tr>
<tr><td>Ignore target status</td><td>uint16</td><td>2</td><td>0 = Transfer request will not be executed until the target location and shelf are available<br/>1 = Transfer request will be executed regardless of the target’s load status. If Navithor thinks there is something on the target shelf, the information will be overridden when the AGV unloads its load on the target</td></tr>
<tr><td>Extra information flags</td><td>uint16</td><td>2</td><td>Mandatory bitmask field that is used to determine which optional fields are included in this message. Sending 0 means no additional data is included. Values larger than 0 mean that optional data is being included and must be parsed.</td></tr>
<tr><td>Optional data</td><td>byte[]</td><td>0...N</td><td>Optional data to be included.</td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Frame Length</strong></th><th><strong>Data Length</strong></th><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>9</td><td>18 + OptionalDataLength</td><td>27</td><td>1465</td></tr>
</tbody></table>
</div>
<p><strong>ExtraInformation bitmask</strong></p>
<div class="table-wrapper"><table><thead><tr><th><strong>ExtraInformation bits</strong></th><th><strong>Bitmask</strong></th><th><strong>Numeric value</strong></th></tr></thead><tbody>
<tr><td>None</td><td>0</td><td>0</td></tr>
<tr><td>Barcode</td><td>1 &lt;&lt; 0</td><td>1</td></tr>
<tr><td>TransferId</td><td>1 &lt;&lt; 1</td><td>2</td></tr>
<tr><td>BlockStacking</td><td>1 &lt;&lt; 2</td><td>4</td></tr>
<tr><td>PickupRackId</td><td>1 &lt;&lt; 3</td><td>8</td></tr>
<tr><td>TargetRackId</td><td>1 &lt;&lt; 4</td><td>16</td></tr>
</tbody></table>
</div>
<p>Combining multiple bits is allowed. To include both Barcode and TransferId the ExtraInformation should be set to 3 (1 + 2). To include Barcode and BlockStacking but not TransferId the value should be set to 5 (1 + 4).</p>
<p>The order of optional data MUST match the order of bits listed above. For example if both TransferId and BlockStacking are included then the data for TransferId MUST be included first and the data for BlockStacking MUST be included second.</p>
<p><strong>Optional data: Barcode</strong></p>
<div class="table-wrapper"><table><thead><tr><th><strong>Field name</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>BarcodeLength</td><td>uint16</td><td>2</td><td>Length of the barcode identifier</td></tr>
<tr><td>Barcode</td><td>string</td><td>[0…N]</td><td>Barcode identifier</td></tr>
</tbody></table>
</div>
<p>RESERVED, NOT IMPLEMENTED!</p>
<p>Specifies barcode or other unique identifier for resource to be transferred. If this is not included then resource will not have associated string identifier.</p>
<p><strong>Optional data: TransferId</strong></p>
<div class="table-wrapper"><table><thead><tr><th><strong>Field name</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>TransferId</td><td>uint32</td><td>4</td><td>Numeric identifier for transfer request.</td></tr>
</tbody></table>
</div>
<p>Specifies identifier for TransferRequest that will be included as 'RequestId' in TransferRequestStatus (ID = 323). If ID is not included then it will be generated automatically.</p>
<p><strong>Optional data: BlockStacking</strong></p>
<p>Enables block stacking (stacking on the top of another resource) at the target buffer location. See separate buffer documentation for more details.</p>
<p>Only supported for buffer locations and will be ignored if target destination does not support stacking feature. If this packet is not included, then resources will not be stacked. Racks do not support stacking resources on top of each other, rather the resources will be placed in predefined shelves.</p>
<div class="table-wrapper"><table><thead><tr><th><strong>Field name</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>Flags</td><td>uint16</td><td>2</td><td>Flags indicating how resource can be stacked.<br />0 = No stacking allowed<br />1 &lt;&lt; 0 = Resource can be stacked on top of previous resource<br />1 &lt;&lt; 1 = Another resource can be stacked on the top of this resource</td></tr>
<tr><td>MaximumStackingHeight</td><td>uint16</td><td>2</td><td>Allowed stacking height in millimeters. How high AGV forks can be lifted to stack the resource on top of another. If 0, maximum reach of AGV actuator is used instead.</td></tr>
<tr><td>ResourceHeight</td><td>uint16</td><td>2</td><td>Height of the resource to be transferred (in millimeters). This data is stored to resource object, and is used to speed up the stacking/destacking process at the resource buffer. If height 0 is specified, resource height can be updated automatically by the system, if available during the resource transport process.</td></tr>
<tr><td>ResourcesInStack</td><td>uint16</td><td>2</td><td>Allowed number of resources in the stack. If 0, maximum number of resources in the stack is limited only by the height. This information is only used by Navithor together with estimation of the existing resources in the buffer. Navithor can prevent stacking of resources, even the situation in the real buffer would allow stacking.</td></tr>
</tbody></table>
</div>
<p>MaximumStackingHeight, ResourceHeight, and ResourcesInStack fields are also used to estimate if target resource buffer still has free space to hold a new resource.</p>
<p><strong>Optional data: PickupRackId</strong></p>
<div class="table-wrapper"><table><thead><tr><th><strong>Field name</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>RackIdLength</td><td>uint16</td><td>2</td><td>Length of the rack identifier</td></tr>
<tr><td>RackId</td><td>string</td><td>[0…N]</td><td>Rack identifier, max 255 chars.</td></tr>
</tbody></table>
</div>
<p>Specifies rackId, this will override the given pickup symbolic point id and specify desired side of the rack for side loaders.</p>
<p><strong>Optional data: TargetRackId</strong></p>
<div class="table-wrapper"><table><thead><tr><th><strong>Field name</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>RackIdLength</td><td>uint16</td><td>2</td><td>Length of the rack identifier</td></tr>
<tr><td>RackId</td><td>string</td><td>[0…N]</td><td>Rack identifier, max 255 chars.</td></tr>
</tbody></table>
</div>
<p>Specifies rackId, this will override the given target symbolic point id and specify desired side of the rack for side loaders.</p>
<h4 id="setrackstatus-id--40-1"><a class="header" href="#setrackstatus-id--40-1">SetRackStatus (ID = 40)</a></h4>
<p>Equivalent to SetStatusAtSymbolicPoint for a warehouse rack.</p>
<div class="table-wrapper"><table><thead><tr><th><strong>FieldName</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>Frame</td><td>header</td><td>9</td><td>Every message has a frame that consists of the same data</td></tr>
<tr><td>Symbol ID</td><td>int32</td><td>4</td><td>ID of the symbolic point where the status on shelves is set</td></tr>
<tr><td>NumOfShelves</td><td>uint16</td><td>2</td><td>Tells how many shelf statuses are set in this message (from 0 to 255)</td></tr>
<tr><td>Shelf Statuses</td><td>ShelfStatus[]</td><td>NumOfShelves * ShelfStatus length</td><td></td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Frame Length</strong></th><th><strong>Data Length</strong></th><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>9</td><td>6 + Shelf Statuses length</td><td>15</td><td>2055</td></tr>
</tbody></table>
</div>
<p><strong>ShelfStatus</strong></p>
<div class="table-wrapper"><table><thead><tr><th><strong>FieldName</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>Shelf ID</td><td>int32</td><td>4</td><td>ID of the shelf</td></tr>
<tr><td>Item type ID</td><td>int32</td><td>4</td><td>ID of the Item type (0 = remove resource)</td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>8</td><td>8</td></tr>
</tbody></table>
</div>
<h4 id="estimatedrivetostartsymbolicpoint-id--41"><a class="header" href="#estimatedrivetostartsymbolicpoint-id--41">EstimateDriveToStartSymbolicPoint (ID = 41)</a></h4>
<p>The MES can send this message to Navithor. If valid message sent, Navithor will reply to it with EstimationOfDriveToStartSymbolicPoint message. If message is invalid, Navithor will reply to it with AckOrReject message with reject reason.</p>
<p>In this message, both the StartSpId and EndSpId are needed because the drive direction needs to be determined by Navithor for the possible time and distance values to the StartSpId. This needs to be done while avoiding driving through the EndSpId.</p>
<p>Sending this message will result Navithor to reply with driving distances and times to the start symbolic point for each possible machine.</p>
<p>If end symbolic point ID is positive, it must be avoided when planning the route to maintain the correct direction.</p>
<div class="table-wrapper"><table><thead><tr><th><strong>FieldName</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>Frame</td><td>header</td><td>9</td><td>Every message has a frame that consists of the same data</td></tr>
<tr><td>StartSpId</td><td>uint16</td><td>2</td><td>Start symbolic point ID</td></tr>
<tr><td>EndSpId</td><td>int32</td><td>4</td><td>End symbolic point ID. If positive, the route must avoid the symbolic point</td></tr>
<tr><td>SortingField</td><td>byte</td><td>1</td><td>Field for sorting the results:<p></p> 0 = sort by machine ID<br/>1 = sort by driving distance<br/>2 = sort by driving time</td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Frame Length</strong></th><th><strong>Data Length</strong></th><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>9</td><td>7</td><td>16</td><td>16</td></tr>
</tbody></table>
</div>
<h4 id="setresourcesatmachine-id--42"><a class="header" href="#setresourcesatmachine-id--42">SetResourcesAtMachine (ID = 42)</a></h4>
<p>Sets resources at machine. If same data is being sent the resources at machine will not change. If order of ResourceAtMachine is changed or if any of data is different from what Navithor thinks then the resources will be regenerated.</p>
<p>When removing all resources from machine, send only MachineId and ResourceCount as 0 (header + 4 bytes of data), so that all resources will be cleared.</p>
<div class="table-wrapper"><table><thead><tr><th><strong>FieldName</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>Frame</td><td>header</td><td>9</td><td>Every message has a frame that consists of the same data</td></tr>
<tr><td>MachineId</td><td>uint16</td><td>2</td><td>ID of machine</td></tr>
<tr><td>ResourceCount</td><td>uint16</td><td>2</td><td>Number of elements in ResourceList. Minimum is 0, maximum is 1000</td></tr>
<tr><td>ResourceList</td><td>ResourceAtMachine[]</td><td>ResourceCount * ResourceAtMachine length</td><td>List of ResourceAtMachine structs</td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Frame Length</strong></th><th><strong>Data Length</strong></th><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>9</td><td>4 + ResourceAtMachineList length</td><td>13</td><td>8013</td></tr>
</tbody></table>
</div>
<p><strong>ResourceAtMachine</strong></p>
<p>Resource at machine.</p>
<div class="table-wrapper"><table><thead><tr><th><strong>FieldName</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>ResourceTypeId</td><td>int32</td><td>4</td><td>ID of resource type</td></tr>
<tr><td>Quantity</td><td>int32</td><td>4</td><td>How many of given resource type are at location</td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>8</td><td>8</td></tr>
</tbody></table>
</div>
<h4 id="getracksetup-id--43-1"><a class="header" href="#getracksetup-id--43-1">GetRackSetup (ID = 43)</a></h4>
<p>Sending this message will result Navithor to send back RackSetupReply message.</p>
<p>In addition, if MachineTypeId is positive, then for each rack with defined MachineTypeId RackSetup message will be sent back. If MachineTypeId is not positive, then for each rack and for each MachineTypeId defined on that rack RackSetup message will be sent back.</p>
<div class="table-wrapper"><table><thead><tr><th><strong>FieldName</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>Frame</td><td>header</td><td>9</td><td>Every message has a frame that consists of the same data</td></tr>
<tr><td>MachineTypeId</td><td>int32</td><td>4</td><td>ID of the machine type</td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Frame Length</strong></th><th><strong>Data Length</strong></th><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>9</td><td>4</td><td>13</td><td>13</td></tr>
</tbody></table>
</div>
<h4 id="drivemachinetorack-id--44-1"><a class="header" href="#drivemachinetorack-id--44-1">DriveMachineToRack (ID = 44)</a></h4>
<p>Sending this message will result Navithor to create a production order for the machine if MachineId is greater than 0. Negative MachineId values are not supported.</p>
<div class="table-wrapper"><table><thead><tr><th><strong>FieldName</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>Frame</td><td>header</td><td>9</td><td>Every message has a frame that consists of the same data</td></tr>
<tr><td>MachineID</td><td>int16</td><td>2</td><td>Machine ID. Negative values are not supported</td></tr>
<tr><td>ProductionOrderId</td><td>uint32</td><td>4</td><td>OrderID, unique for each order</td></tr>
<tr><td>ToSymbolicPointId</td><td>uint16</td><td>2</td><td>Rack symbolic point ID where order ends</td></tr>
<tr><td>StartTimeLength</td><td>uint16</td><td>2</td><td>If 0 start time not defined</td></tr>
<tr><td>StartTime</td><td>string</td><td>0 or 19</td><td>&quot;yyyy.mm.dd.hh.mm.ss&quot;</td></tr>
<tr><td>Priority</td><td>uint16</td><td>2</td><td>1 to 32767, where 1 has the lowest priority</td></tr>
<tr><td>ToShelfId</td><td>uint16</td><td>2</td><td>Rack shelf ID</td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Frame Length</strong></th><th><strong>Data Length</strong></th><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>9</td><td>14 + StartTimeLength</td><td>23</td><td>42</td></tr>
</tbody></table>
</div>
<h4 id="loadunloadmachinerequest-id--46"><a class="header" href="#loadunloadmachinerequest-id--46">LoadUnloadMachineRequest (ID = 46)</a></h4>
<p>Sending this message will result Navithor to load/unload machine.</p>
<div class="table-wrapper"><table><thead><tr><th><strong>FieldName</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>Frame</td><td>header</td><td>9</td><td>Every message has a frame that consists of the same data</td></tr>
<tr><td>MachineID</td><td>int32</td><td>4</td><td>Which machine should perform load/unload</td></tr>
<tr><td>ResourceTypeId</td><td>int32</td><td>4</td><td>Which resource type to load/unload if &gt; 0. Otherwise assume resource type from Container configuration</td></tr>
<tr><td>ResourceQuantity</td><td>int32</td><td>4</td><td>Quantity of resources to unload/load if &gt; 0. Otherwise max of given type</td></tr>
<tr><td>LoadType</td><td>int16</td><td>2</td><td>1 = Load, 2 = Unload. Sending anything else will result in rejected</td></tr>
<tr><td>LoadUnloadFlags</td><td>uint16</td><td>2</td><td>Special handling related to Load. 0 = no specials. Used for syncing resource state only. Bit flags:<p></p> 1 &lt;&lt; 0 = Reject message if AGV not on symbolic point.<br/>1 &lt;&lt; 1 = Changes behavior so that message is not rejected if symbolic point is missing specified resource<br/>1 &lt;&lt; 2 = Changes behavior so that resource will be always removed from system after unload<br/>1 &lt;&lt; 3 = Source should use LoadFromBottom configuration. Rejected if given resourceTypeId is not on bottom slot<br/>1 &lt;&lt; 4 = Source should use LoadFromTop configuration. Rejected if given resourceTypeId is not on top slot.<br/>1 &lt;&lt; 5 = Future SourceLoad option<br/>1 &lt;&lt; 6 = Future SourceLoad option<br/>1 &lt;&lt; 7 = RESERVE<br/>1 &lt;&lt; 8 = Target should be use UnloadToBottom configuration<br/>1 &lt;&lt; 9 = Target should use UnloadToTop configuration<br/>1 &lt;&lt; 10 = Future TargetUnload option<br/>1 &lt;&lt; 11 = Future TargetUnload option<br/>1 &lt;&lt; 12-15 = RESERVED</td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Frame Length</strong></th><th><strong>Data Length</strong></th><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>9</td><td>16</td><td>25</td><td>25</td></tr>
</tbody></table>
</div>
<p>Message will be rejected with AckOrReject message if:</p>
<ul>
<li>AGV with given MachineId was not found;</li>
<li>AGV is moving or in production or performing an order;</li>
<li>Specified ResourceTypeId is not valid;</li>
<li>LoadType was not correct;</li>
<li>Conflicting flags were being set for example both SourceLoadFromBottom and SourceLoadFromTop set;</li>
<li>Load was given with ResourceTypeId that is not found on symbolic point;</li>
<li>It is not possible to load/unload specified resource.</li>
</ul>
<p>Warning in Client will be given if:</p>
<ul>
<li>Load/unload was given when AGV was not on symbolic point;</li>
<li>Unload was given with ResourceTypeId that machine is not carrying.</li>
</ul>
<h4 id="getsymbolicpointgroupsetup-id--47"><a class="header" href="#getsymbolicpointgroupsetup-id--47">GetSymbolicPointGroupSetup (ID = 47)</a></h4>
<p>Gets the initial setup of symbolic point groups from Navithor.</p>
<div class="table-wrapper"><table><thead><tr><th><strong>Frame Length</strong></th><th><strong>Data Length</strong></th><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>9</td><td>0</td><td>9</td><td>9</td></tr>
</tbody></table>
</div>
<h4 id="savelogs-id--48"><a class="header" href="#savelogs-id--48">SaveLogs (ID = 48)</a></h4>
<p>Sending this message will trigger Navithor to save logs.</p>
<div class="table-wrapper"><table><thead><tr><th><strong>FieldName</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>Frame</td><td>header</td><td>9</td><td>Every message has a frame that consists of the same data</td></tr>
<tr><td>NumOfMachinesInvolved</td><td>uint16</td><td>2</td><td>Number of machines involved. Can be set to 0, if no logs from the machine are needed. Maximum value is 1000 (N)</td></tr>
<tr><td>MachineIDs</td><td>uint16[]</td><td>2 * N</td><td>Machine IDs as an array. Navithor sends a command to dump a Navitrol log and tries to download it to be included on the log package</td></tr>
<tr><td>DescStringLength</td><td>uint16</td><td>2</td><td>Length of the description. Can be set to 0, if no additional description is needed. Max 1000 chars</td></tr>
<tr><td>Description</td><td>string</td><td>0...1000</td><td>Custom description that is saved to the log package as explanation of the issue</td></tr>
<tr><td>IncidentTimeLength</td><td>uint16</td><td>2</td><td>If 0, incident time not defined. Current system time is used</td></tr>
<tr><td>IncidentTime</td><td>string</td><td>0 or 19</td><td>&quot;yyyy.mm.dd.hh.mm.ss&quot;</td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Frame Length</strong></th><th><strong>Data Length</strong></th><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>9</td><td>6 + MachineIDs length + DescStringLength + IncidentTimeLength</td><td>15</td><td>3034</td></tr>
</tbody></table>
</div>
<h4 id="ackalarms-id--49"><a class="header" href="#ackalarms-id--49">AckAlarms (ID = 49)</a></h4>
<p>Sending this message will acknowledge Navithor Alarms. Flag defines which alarms will be acknowledged.</p>
<div class="table-wrapper"><table><thead><tr><th><strong>FieldName</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>Frame</td><td>header</td><td>9</td><td>Every message has a frame that consists of the same data</td></tr>
<tr><td>AcknowledgeFlags</td><td>uint16</td><td>2</td><td>Bit 0: 1 = Reset all alarms<br/>Bit 1-15: reserved</td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Frame Length</strong></th><th><strong>Data Length</strong></th><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>9</td><td>2</td><td>11</td><td>11</td></tr>
</tbody></table>
</div>
<h4 id="setbufferlanestatus-id--50"><a class="header" href="#setbufferlanestatus-id--50">SetBufferLaneStatus (ID = 50)</a></h4>
<p>Sets symbolic point buffer lane status to full or to has space.</p>
<div class="table-wrapper"><table><thead><tr><th><strong>FieldName</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>Frame</td><td>header</td><td>9</td><td>Every message has a frame that consists of the same data</td></tr>
<tr><td>SymbolicPointId</td><td>uint16</td><td>2</td><td>ID of symbolic point</td></tr>
<tr><td>BufferLaneStatus</td><td>uint16</td><td>2</td><td>0 = No change<br/>1 = Buffer full<br/>2 = Buffer has space</td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Frame Length</strong></th><th><strong>Data Length</strong></th><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>9</td><td>4</td><td>13</td><td>13</td></tr>
</tbody></table>
</div>
<h4 id="requestzonestatus-id--51"><a class="header" href="#requestzonestatus-id--51">RequestZoneStatus (ID = 51)</a></h4>
<p>Gets the status of all zones or the status of a specified zone.</p>
<p>Valid from Navithor 2.20.0.0 forward.</p>
<div class="table-wrapper"><table><thead><tr><th><strong>FieldName</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>Frame</td><td>header</td><td>9</td><td>Every message has a frame that consists of the same data</td></tr>
<tr><td>Zone ID</td><td>uint32</td><td>4</td><td>The ID of the zone whose status needs to be received. ID = 0 for requesting all statuses</td></tr>
<tr><td>Requested information</td><td>uint16</td><td>2</td><td>Determines what information is requested from the Server as a bit field. <br/> Existing fields:<p></p>ZoneOccupancy status 1 &lt;&lt; 0<br/>AGVs inside zone (List of AGV ids) 1 &lt;&lt; 1</td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Frame Length</strong></th><th><strong>Data Length</strong></th><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>9</td><td>6</td><td>15</td><td>15</td></tr>
</tbody></table>
</div>
<h4 id="getproductionareainformation-id--52"><a class="header" href="#getproductionareainformation-id--52">GetProductionAreaInformation (ID = 52)</a></h4>
<p>Gets information about production area. Navithor will send a separate reply with requested information.</p>
<p>Valid from Navithor 2.21.0.0 forward.</p>
<div class="table-wrapper"><table><thead><tr><th><strong>FieldName</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>Frame</td><td>header</td><td>9</td><td>Every message has a frame that consists of the same data</td></tr>
<tr><td>InfoType</td><td>uint16</td><td>2</td><td>Type of information to request:<p></p> 1 = MachineTypeInformation (Reply ID = 336)<br/>2 = MachineInformation (Reply ID = 337)<br/>3 = SymbolicPointInformation (Reply ID = 338)<br/>4 = SymbolicPointHoldInformation (Reply ID = 339)<br/>5 = SymbolicPointSpatialInformation (Reply ID = 340)<br/>6 = ResourceTypeInformation (Reply ID = 341)<br/>7 = ResourceTypeOffsetInformation (Reply ID = 342)<br/>8 = MachineLoadCapacityInformation (Reply ID = 343)<br/>9 = SymbolicPointLoadCapacityInformation (Reply ID = 344)</td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Frame Length</strong></th><th><strong>Data Length</strong></th><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>9</td><td>2</td><td>11</td><td>11</td></tr>
</tbody></table>
</div>
<h4 id="setresourceatlocationwithextendedinfo-id--53"><a class="header" href="#setresourceatlocationwithextendedinfo-id--53">SetResourceAtLocationWithExtendedInfo (ID = 53)</a></h4>
<p>Sets a resource at a location with maximum of ten additional strings for extended information. Allows usage of transfer requests with a resource identifier which is not resource type ID (see message ID = 54).</p>
<p>ResContainerFlags can be used to determine behavior when same or different data is sent.</p>
<p>Supported from version 2.21.0.0.</p>
<div class="table-wrapper"><table><thead><tr><th><strong>FieldName</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>Frame</td><td>header</td><td>9</td><td>Every message has a frame that consists of the same data</td></tr>
<tr><td>SymbolicPointId</td><td>uint16</td><td>2</td><td>ID of symbolic point</td></tr>
<tr><td>ResourceTypeId</td><td>int32</td><td>4</td><td>ID of resource type</td></tr>
<tr><td>Quantity</td><td>int32</td><td>4</td><td>How many of given resource types are at location</td></tr>
<tr><td>ResContainerFlags</td><td>uint16</td><td>2</td><td>Flags to determine rules for resource container options. 0 to use global rules. Other flags currently not implemented</td></tr>
<tr><td>ResIdStringLength</td><td>uint16</td><td>2</td><td>Length of resource identifier</td></tr>
<tr><td>ResourceIdentifier</td><td>string</td><td>0...100</td><td>A string that can be used to identify the resource instead of using the resource type ID</td></tr>
<tr><td>ExtInfoCount</td><td>uint16</td><td>2</td><td>Number of strings for extended info (from 0 to 10). Additional info shown only in Client</td></tr>
<tr><td>MESExtendedResInfos</td><td>MESExtendedResInfo[]</td><td>ExtInfoCount * MESExtendedResInfo length</td><td>MESExtendedResInfo structure list</td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Frame Length</strong></th><th><strong>Data Length</strong></th><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>9</td><td>16 + ResIdStringLength +  MESExtendedResInfos length</td><td>25</td><td>1145</td></tr>
</tbody></table>
</div>
<p><strong>MESExtendedResInfo</strong></p>
<p>MESExtendedResInfo structure</p>
<div class="table-wrapper"><table><thead><tr><th><strong>FieldName</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>ResInfoStringLength</td><td>uint16</td><td>2</td><td>Length of resource info</td></tr>
<tr><td>ResInfo</td><td>string</td><td>0...100</td><td>Additional info as string</td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>2</td><td>102</td></tr>
</tbody></table>
</div>
<h4 id="transferrequestwithresourceidentifier-id--54"><a class="header" href="#transferrequestwithresourceidentifier-id--54">TransferRequestWithResourceIdentifier (ID = 54)</a></h4>
<p>Sending this message will result Navithor to create a production order from the pick-up Symbolic Point to the Target. Navithor will assign machines that can carry the item type to fulfil the transfer request.</p>
<p>This message supports creating a transfer request with some other resource identifier besides resource type ID. Should be used in combination with the SetResourceAtLocationWithExtendedInfo (ID = 53) message.</p>
<p>If both ItemTypeId and ResourceIdentifier are defined, the resource needs to fulfil both requirements for creating a valid order.</p>
<p>This message can be also used with only one of the ItemTypeId or ResourceIdentifier defined, or even that neither of them are defined.</p>
<p>Supported from version 2.21.0.0.</p>
<div class="table-wrapper"><table><thead><tr><th><strong>FieldName</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>Frame</td><td>header</td><td>9</td><td>Every message has a frame that consists of the same data</td></tr>
<tr><td>PickupSymbolicPoint</td><td>uint16</td><td>2</td><td>Symbolic point ID</td></tr>
<tr><td>TargetSymbolicPoint</td><td>uint16</td><td>2</td><td>Symbolic point ID</td></tr>
<tr><td>ItemsToPickup</td><td>uint16</td><td>2</td><td>Number of items</td></tr>
<tr><td>ItemTypeId</td><td>uint16</td><td>2</td><td>If 0, not defined, and only Resource Identifier used</td></tr>
<tr><td>Priority</td><td>uint16</td><td>2</td><td>1 to 32767, where 1 has the lowest priority. Value 0 means Navithor default priority</td></tr>
<tr><td>RequestID</td><td>uint32</td><td>4</td><td>ID sent by the planner. TransferRequest is initially answered by AckOrRejRequest (ID = 201) and later when production order is created for the TransferRequest, TransferRequestStatus message (ID = 323) is sent using this RequestID</td></tr>
<tr><td>PickupIDType</td><td>byte</td><td>1</td><td>0 = PickupSymbolicPoint-field points to symbolic point ID<br/>1 = PickupSymbolicPoint-field points to symbolic point group ID</td></tr>
<tr><td>TargetIDType</td><td>byte</td><td>1</td><td>0 = TargetSymbolicPoint-field points to symbolic point ID<br/>1 = TargetSymbolicPoint-field points to symbolic point group ID</td></tr>
<tr><td>ResIdStringLength</td><td>uint16</td><td>2</td><td>Length of the resource identifier. If 0, only resource type ID is used. Max length is 100</td></tr>
<tr><td>ResourceIdentifier</td><td>string</td><td>0...100</td><td>Resource identifier as string. This can be used instead of, or in combination with ItemTypeId</td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Frame Length</strong></th><th><strong>Data Length</strong></th><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>9</td><td>18 + ResIdStringLength</td><td>27</td><td>127</td></tr>
</tbody></table>
</div>
<h4 id="requestspresourcestatus-id--55"><a class="header" href="#requestspresourcestatus-id--55">RequestSPResourceStatus (ID = 55)</a></h4>
<p>Requests the status of all or a certain symbolic point. Answered with SymbolicPointResourceStatus (ID = 345).</p>
<p>Valid from Navithor 2.21.0.0.</p>
<div class="table-wrapper"><table><thead><tr><th><strong>FieldName</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>Frame</td><td>header</td><td>9</td><td>Every message has a frame that consists of the same data</td></tr>
<tr><td>Identifier</td><td>uint32</td><td>4</td><td>ID of a single symbolic point or a group. If 0, status of all symbolic points will be sent</td></tr>
<tr><td>RequestFlags</td><td>uint16</td><td>2</td><td>Flags:<br/>bit 0:<br/>0 = Identifier field points to a symbolic point ID<br/>1 = Identifier field points to a symbolic point group ID<br/><br/>bit 1:<br/>1 = Send creation date of last resource added to the symbolic point in addition to the default data<br/><br/>bit 2:<br/>1 = Send resource slot and shelf information.<br/><br/>bit 3:<br/>1 = Send information of all resources at specific symbolicpoint or in a group.</td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Frame Length</strong></th><th><strong>Data Length</strong></th><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>9</td><td>6</td><td>15</td><td>15</td></tr>
</tbody></table>
</div>
<h4 id="errorsv2request-id--56"><a class="header" href="#errorsv2request-id--56">ErrorsV2Request (ID = 56)</a></h4>
<p>Requests the status of errors in the system. Answered with ErrorsV2 (ID = 349).</p>
<p>Valid from Navithor 2.21.0.0.</p>
<div class="table-wrapper"><table><thead><tr><th><strong>FieldName</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>Frame</td><td>header</td><td>9</td><td>Every message has a frame that consists of the same data</td></tr>
<tr><td>ErrorType</td><td>byte</td><td>1</td><td>Apply exclusive filter by type of error:<p></p>0 = all errors<br/>1 = system errors<br/>2 = all entity errors<br/>3 = machine errors (belong to entity errors)<br/>4 = symbolic point errors (belong to entity errors)<br/>5 = waypoint errors (belong to entity errors)</td></tr>
<tr><td>ErrorLevel</td><td>byte</td><td>1</td><td>Apply filter by minimum level of error:<p></p>0 = all<br/>1 = warning<br/>2 = error<br/>3 = fatal error</td></tr>
<tr><td>EntityID</td><td>uint32</td><td>4</td><td>Request errors for specific EntityId (0 = all errors matching the other filters are sent). This filter does not affect on system errors</td></tr>
<tr><td>Options</td><td>uint32</td><td>4</td><td>Reserved for later use (0 = not defined)</td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Frame Length</strong></th><th><strong>Data Length</strong></th><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>9</td><td>10</td><td>19</td><td>19</td></tr>
</tbody></table>
</div>
<h4 id="reserved-id--57"><a class="header" href="#reserved-id--57">RESERVED (ID = 57)</a></h4>
<h4 id="reserved-id--58"><a class="header" href="#reserved-id--58">RESERVED (ID = 58)</a></h4>
<h4 id="initpositiontosymbolicpoint-id--59"><a class="header" href="#initpositiontosymbolicpoint-id--59">InitPositionToSymbolicPoint (ID = 59)</a></h4>
<p>Initializes AGV position to symbolic point with given heading in degrees. This works for any symbolic point unlike InitializePosition (ID = 6) which only works for symbolic points marked as position initialization locations.</p>
<div class="table-wrapper"><table><thead><tr><th><strong>FieldName</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>Frame</td><td>header</td><td>9</td><td>Every message has a frame that consists of the same data</td></tr>
<tr><td>SymbolicPointId</td><td>int32</td><td>4</td><td>Id of symbolic point. X,Y position of symbolic point will be used when initializing position.</td></tr>
<tr><td>MachineId</td><td>int32</td><td>4</td><td>Id of machine.</td></tr>
<tr><td>HeadingDegrees</td><td>float</td><td>4</td><td>Heading of AGV in degrees. In coordinate system 0 degrees is map west and 90 degrees is map south.</td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Frame Length</strong></th><th><strong>Data Length</strong></th><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>9</td><td>12</td><td>21</td><td>21</td></tr>
</tbody></table>
</div>
<h4 id="trafficlightstatus-id--347-1"><a class="header" href="#trafficlightstatus-id--347-1">TrafficLightStatus (ID = 347)</a></h4>
<p>Message is sent by MES to inform current status of a traffic light.</p>
<div class="table-wrapper"><table><thead><tr><th>Field Name</th><th>Type</th><th>Length</th><th>Description</th></tr></thead><tbody>
<tr><td>Frame</td><td>header</td><td>9</td><td>Every message has a frame that consists of the same data</td></tr>
<tr><td>TrafficLightID</td><td>uint32</td><td>4</td><td>ID of the traffic light</td></tr>
<tr><td>Status</td><td>uint16</td><td>2</td><td>ID of the group containing the trafficlight</td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th>Frame Length</th><th>Data Length</th><th>Min Length</th><th>Max Length</th></tr></thead><tbody>
<tr><td>9</td><td>6</td><td>15</td><td>15</td></tr>
</tbody></table>
</div>
<h4 id="mesmessagesubscription-id--348-1"><a class="header" href="#mesmessagesubscription-id--348-1">MESMessageSubscription (ID = 348)</a></h4>
<p>Message is sent by MES to subscribe to different messages.</p>
<div class="table-wrapper"><table><thead><tr><th>Field Name</th><th>Type</th><th>Length</th><th>Description</th></tr></thead><tbody>
<tr><td>Frame</td><td>header</td><td>9</td><td>Every message has a frame that consists of the same data</td></tr>
<tr><td>Subscriptions</td><td>Subscription[]</td><td>0...x</td><td>Multiple subscriptions in array</td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th>Frame Length</th><th>Data Length</th><th>Min Length</th><th>Max Length</th></tr></thead><tbody>
<tr><td>9</td><td>0...65526</td><td>9</td><td>65535</td></tr>
</tbody></table>
</div>
<p><strong>Subscription</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Field Name</th><th>Type</th><th>Length</th><th>Description</th></tr></thead><tbody>
<tr><td>SubscriptionType</td><td>uint16</td><td>2</td><td>Type of the subscription</td></tr>
<tr><td>SubscriptionData</td><td>Opaque</td><td>2..x</td><td>Contains data of different subscriptions, data depends on type chosen</td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>4</td><td>65526</td></tr>
</tbody></table>
</div>
<p><strong>Subscription Datas</strong></p>
<p>Different subscriptions listed.</p>
<p><strong>TrafficLight (Type = 1)</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Field Name</th><th>Type</th><th>Length</th><th>Description</th></tr></thead><tbody>
<tr><td>Subscribe</td><td>uint16</td><td>2</td><td>Unsubscribe when set 0, else subscribe</td></tr>
<tr><td>SubscriptionToGroup</td><td>uint16</td><td>2</td><td>Subscription to single trafficlight ID when set 0, else to group ID</td></tr>
<tr><td>ID</td><td>uint16</td><td>2</td><td>Group or trafficlight ID</td></tr>
<tr><td>IntervalGreen</td><td>uint16</td><td>2</td><td>Interval to send request while requested status is green.</td></tr>
<tr><td>IntervalNone</td><td>uint16</td><td>2</td><td>Interval to send request while not requesting a status</td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>10</td><td>10</td></tr>
</tbody></table>
</div>
<p><strong>ElevatorRequest (Type = 3)</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Field Name</th><th>Type</th><th>Length</th><th>Description</th></tr></thead><tbody>
<tr><td>Subscribe</td><td>uint16</td><td>2</td><td>0 = unsubscribe, 1 = subscribe requests</td></tr>
<tr><td>ElevatorId</td><td>uint16</td><td>2</td><td>Subscription to single ElevatorID, or all requests if set to 0</td></tr>
<tr><td>StatusRequestInterval</td><td>uint16</td><td>2</td><td>Interval in seconds how often ElevatorRequest should be sent to MES client when no machines are reserving the Elevator. Value 0 means at every cycle (1 second cycle).</td></tr>
<tr><td>RequestToFloorInterval</td><td>uint16</td><td>2</td><td>Interval in seconds how often ElevatorRequest with type RequestToFloor should be sent to MES client when machine has reservation for Elevator. Value 0 means at every cycle (1 second cycle).</td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>8</td><td>8</td></tr>
</tbody></table>
</div>
<p><strong>ProductionStatus (Type = 4)</strong></p>
<p>This subscription type can be used to request of sending ProductionStatus (ID = 313) message, and override default parameter <code>MES_ProductionStatusSendTimer</code>.</p>
<p>Parameters specified in this message are global, so if two clients subscribe the message, the later subscriber will define the parameters for sending the message.</p>
<p>If any client has subscribed the message, global interval parameter is overridden, and only subscribed client will receive the message. If all clients have unsubscribed the message, the interval defined in global parameter is used again.</p>
<div class="table-wrapper"><table><thead><tr><th>Field Name</th><th>Type</th><th>Length</th><th>Description</th></tr></thead><tbody>
<tr><td>Subscribe</td><td>uint16</td><td>2</td><td>Subscribe message when set to 1, unsubscribe when 0</td></tr>
<tr><td>SubscriptionType</td><td>uint16</td><td>2</td><td>Different subscription options:<br />1 = Sending of message is completely disabled.<br />2 = OnlyPeriodically - Message is sent by the given interval.<br />3 = OnlyWhenChanged - Message is only sent if there are changes in the content.<br />4 = WhenChangedOrPeriodically - Message is sent by the given interval or when there are changes in the content.</td></tr>
<tr><td>RequestInterval</td><td>uint16</td><td>2</td><td>Interval in milliseconds how often message is sent. The process cycle is 1000ms, so message can be sent every 1000ms or more seldom.</td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>6</td><td>6</td></tr>
</tbody></table>
</div>
<h4 id="elevatorstatus--id--351"><a class="header" href="#elevatorstatus--id--351">ElevatorStatus  (ID = 351)</a></h4>
<p>Message is sent by MES client to publish the status of the single elevator. This message is sent as reply to message <strong>ElevatorRequest</strong> (ID = 352).</p>
<p>If <em>ElevatorId</em> is not found, Navithor will reply with <strong>AckOrReject</strong> (ID = 200) message with reject reason <strong>SymbolicPointNotFound (4)</strong>. If floors defined in Navithor Tools are not matching with the data in the message, the reject reason will be <strong>BadInputData (1)</strong>.</p>
<div class="table-wrapper"><table><thead><tr><th>Field Name</th><th>Type</th><th>Length</th><th>Description</th></tr></thead><tbody>
<tr><td>Frame</td><td>header</td><td>9</td><td>Every message has a frame that consists of the same data</td></tr>
<tr><td>StatusType</td><td>uint16</td><td>2</td><td>Type of status message (default 0)</td></tr>
<tr><td>ElevatorId</td><td>uint16</td><td>2</td><td>ID of the elevator (symbolic point group ID)</td></tr>
<tr><td>ElevatorStatus</td><td>uint16</td><td>2</td><td>1 = automatic, 2 = automatic and moving, 3 = manual, 4 = out of service</td></tr>
<tr><td>CurrentLevel</td><td>uint16</td><td>2</td><td>Level where elevator is currently, or was previously if currently moving</td></tr>
<tr><td>DoorStatus</td><td>uint16</td><td>2</td><td>Door status at <strong>CurrentLevel</strong>: 1 = closed, 2 = open, 3 = broken and cannot be used (disabled)</td></tr>
<tr><td>TargetLevel</td><td>uint16</td><td>2</td><td>Level where elevator is currently going to. Must equal to <strong>CurrentLevel</strong>, if not moving or target is not known.</td></tr>
<tr><td>TargetReachTime</td><td>uint16</td><td>2</td><td>Estimation to reach target level in seconds, or 0 if not moving. 0 if no estimation available.</td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th>Frame Length</th><th>Data Length</th><th>Min Length</th><th>Max Length</th></tr></thead><tbody>
<tr><td>9</td><td>14</td><td>23</td><td>23</td></tr>
</tbody></table>
</div>
<h4 id="deleteproductionorderwithid-id--353"><a class="header" href="#deleteproductionorderwithid-id--353">DeleteProductionOrderWithId (ID = 353)</a></h4>
<p>Sending this message with a production order ID will delete the given production order.</p>
<div class="table-wrapper"><table><thead><tr><th><strong>FieldName</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>Frame</td><td>header</td><td>9</td><td>Every message has a frame that consists of the same data</td></tr>
<tr><td>ProductionOrderId</td><td>int32</td><td>4</td><td>Order ID, unique for each order</td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Frame Length</strong></th><th><strong>Data Length</strong></th><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>9</td><td>4</td><td>13</td><td>13</td></tr>
</tbody></table>
</div>
<h4 id="setsymbolicpointpriority-id--355"><a class="header" href="#setsymbolicpointpriority-id--355">SetSymbolicPointPriority (ID = 355)</a></h4>
<p>Sending this message will set the priority of the symbolic point.</p>
<div class="table-wrapper"><table><thead><tr><th><strong>FieldName</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>Frame</td><td>header</td><td>9</td><td>Every message has a frame that consists of the same data</td></tr>
<tr><td>SymbolicPointID</td><td>int32</td><td>4</td><td>ID of the symbolic point</td></tr>
<tr><td>Priority</td><td>int16</td><td>2</td><td>Desired priority between 1 and 8. Priority 1 is lowest.</td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Frame Length</strong></th><th><strong>Data Length</strong></th><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>9</td><td>6</td><td>15</td><td>15</td></tr>
</tbody></table>
</div>
<h4 id="validateloadreply-id--358"><a class="header" href="#validateloadreply-id--358">ValidateLoadReply (ID = 358)</a></h4>
<p>Message used to reply to message ValidateLoad (ID = 357).</p>
<div class="table-wrapper"><table><thead><tr><th><strong>Field Name</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>MessageContents</td><td>uint32</td><td>4</td><td>Bit flags of included message contents<br> 1 &lt;&lt; 0 = LoadValidationDataWithBarcode<br>1 &lt;&lt; 1 = ValidationResult<br>1 &lt;&lt; 2 = NewTransferTarget<br> Bits 4 to 32 reserved for later use.</td></tr>
</tbody></table>
</div>
<p><strong>LoadValidationDataWithBarcode</strong></p>
<p>Should be identical to the data sent in the ValidateLoad (ID = 357) request. Helps to determine which barcode is validated by the reply.</p>
<div class="table-wrapper"><table><thead><tr><th><strong>Field Name</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>ProductionOrderID</td><td>uint32</td><td>4</td><td>OrderID, unique for each order. 0 if no linked order.</td></tr>
<tr><td>RequestingAgvID</td><td>uint16</td><td>2</td><td>ID of the AGV requesting the validation of the load.</td></tr>
<tr><td>SymbolicPointID</td><td>uint16</td><td>2</td><td>Symbolic point ID of the location of the load.</td></tr>
<tr><td>LoadTypeID</td><td>int32</td><td>4</td><td>ID of the load type.</td></tr>
<tr><td>BarcodeStringLength</td><td>uint16</td><td>2</td><td>Barcode string length.</td></tr>
<tr><td>Barcode</td><td>string</td><td>0...255</td><td>Barcode of the load. If not available, nothing is sent. Minimum length is 0, maximum 255.</td></tr>
</tbody></table>
</div>
<p><strong>ValidationResult</strong></p>
<div class="table-wrapper"><table><thead><tr><th><strong>Field Name</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>Result</td><td>uint32</td><td>4</td><td>Result of the validation:<br> 0 = Success, continue with the pickup task.<br> 1 = Error: Invalid barcode.<br> 2 = Error: Invalid resource type.</td></tr>
</tbody></table>
</div>
<p><strong>NewTransferTarget</strong></p>
<p>Gives a new transfer target for the load that is being validated. Typically WMS decides the end target for each load. Production Order of the AGV is updated accordingly.
If not given, AGV either continues to the old target, if such was given, or completes the pickup order and waits for a new order.</p>
<div class="table-wrapper"><table><thead><tr><th><strong>Field Name</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>SymbolicPointId</td><td>uint16</td><td>2</td><td>ID of the symbolic point where the load needs to be transferred to (can be 0, if RackId is given instead)</td></tr>
<tr><td>ShelfId</td><td>uint16</td><td>2</td><td>Shelf ID for the height where the load needs to be transferred to (0 for non-rack symbolic points)</td></tr>
<tr><td>RackIdLength</td><td>uint16</td><td>2</td><td>Length of the rack identifier. 0 if no rack ID given.</td></tr>
<tr><td>RackId</td><td>string</td><td>0...255</td><td>Rack identifier, max 255 chars. Specifies rackId. If given, this will override the given symbolic point id and specifies desired side of the rack for side loaders.</td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Frame Length</strong></th><th><strong>Data Length</strong></th><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>9</td><td>4 + Packet Lengths</td><td>13</td><td>547</td></tr>
</tbody></table>
</div>
<h4 id="startstopproductionbreak-id--359"><a class="header" href="#startstopproductionbreak-id--359">StartStopProductionBreak (ID = 359)</a></h4>
<p>Message is used to control production break feature of the Fleet Control. Activation of production break will make stop normal production activity and make the machines to drive into locations configured as production break locations.</p>
<div class="table-wrapper"><table><thead><tr><th><strong>FieldName</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>Frame</td><td>header</td><td>9</td><td>Every message has a frame that consists of the same data</td></tr>
<tr><td>ProductionBreakMode</td><td>byte</td><td>1</td><td>0 = Normal mode, production break feature not active<br>1 = Production break active</td></tr>
<tr><td>ActivationReasonLength</td><td>uint16</td><td>2</td><td>Length of reason for activation, can be set to 0 when no reason specified</td></tr>
<tr><td>ActivationReason</td><td>string</td><td>0...200</td><td>Reason for break mode activation.</td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Frame Length</strong></th><th><strong>Data Length</strong></th><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>9</td><td>3</td><td>12</td><td>212</td></tr>
</tbody></table>
</div>
<h4 id="returntoroute-id--361"><a class="header" href="#returntoroute-id--361">ReturnToRoute (ID = 361)</a></h4>
<p>Message is used to request machine to return to the route, if it is nearby the route. Successful action requires that the machine is currently either in STBY or IDLE state.</p>
<div class="table-wrapper"><table><thead><tr><th><strong>FieldName</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>Frame</td><td>header</td><td>9</td><td>Every message has a frame that consists of the same data</td></tr>
<tr><td>MachineId</td><td>int32</td><td>4</td><td>Machine ID to request to return to the route.</td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Frame Length</strong></th><th><strong>Data Length</strong></th><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>9</td><td>4</td><td>13</td><td>13</td></tr>
</tbody></table>
</div>
<h4 id="releasestopandhold-id--362"><a class="header" href="#releasestopandhold-id--362">ReleaseStopAndHold (ID = 362)</a></h4>
<p>Message is used to release machine from StopAndHold symbolicpoint. This message can be used with either machine ID or symbolicpoint ID, both are not required.</p>
<p><strong>Note:</strong> StopAndHold feature is a separate feature from HOLD, so this message should not be mixed with <em>ReleaseHold (ID = 18)</em>.</p>
<div class="table-wrapper"><table><thead><tr><th><strong>FieldName</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>Frame</td><td>header</td><td>9</td><td>Every message has a frame that consists of the same data</td></tr>
<tr><td>MachineId</td><td>int32</td><td>4</td><td>Machine ID to release, or <code>0</code> if symbolicpointId is used.</td></tr>
<tr><td>SymbolicpointId</td><td>int32</td><td>4</td><td>The ID of the symbolicpoint where machine is at StopAndHold state, or <code>0</code> if machineId is used.</td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Frame Length</strong></th><th><strong>Data Length</strong></th><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>9</td><td>8</td><td>17</td><td>17</td></tr>
</tbody></table>
</div>
<h3 id="messages-from-navithor-to-mes"><a class="header" href="#messages-from-navithor-to-mes">Messages from Navithor to MES</a></h3>
<h4 id="versioninfo-id--101"><a class="header" href="#versioninfo-id--101">VersionInfo (ID = 101)</a></h4>
<p>Returns the version number of the communication protocol. Version of this document reflects the version of the communication protocol.</p>
<div class="table-wrapper"><table><thead><tr><th><strong>Field Name</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>Frame</td><td>header</td><td>9</td><td>Every message has a frame that consists of the same data</td></tr>
<tr><td>InterfaceVersionMajor</td><td>uint16</td><td>2</td><td>Major number of the protocol version. When major number is changed the earlier protocol versions will be incompatible</td></tr>
<tr><td>InterfaceVersionMinor</td><td>uint16</td><td>2</td><td>Minor number of the protocol version</td></tr>
<tr><td>String Length</td><td>uint16</td><td>2</td><td></td></tr>
<tr><td>software_version</td><td>string</td><td>0...100</td><td>Navithor software version (eg. &quot;2.3.10.0&quot;). Major.Minor.Branch.Revision</td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Frame Length</strong></th><th><strong>Data Length</strong></th><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>9</td><td>6...106</td><td>15</td><td>115</td></tr>
</tbody></table>
</div>
<h4 id="initialsetup-id--102"><a class="header" href="#initialsetup-id--102">InitialSetup (ID = 102)</a></h4>
<p>Navithor sends this message as reply to message GetInitialSetup (ID = 2). GetInitialSetup should not be used in new installations, use GetProductionAreaInformation (ID = 52) instead. If production area is large enough then InitialSetup message cannot contain all of the information and will be trimmed at end.</p>
<div class="table-wrapper"><table><thead><tr><th><strong>Field Name</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>Frame</td><td>header</td><td>9</td><td>Every message has a frame that consists of the same data</td></tr>
<tr><td>MachineTypesCount</td><td>uint16</td><td>2</td><td>Number of machine types in Navithor</td></tr>
<tr><td>MachineTypes</td><td>MachineTypeData[]</td><td>MachineTypesCount * MachineTypeData length</td><td>Machine Type data</td></tr>
<tr><td>MachinesCount</td><td>uint16</td><td>2</td><td>Number of machines in Navithor</td></tr>
<tr><td>Machines</td><td>MachineData[]</td><td>MachinesCount * MachineData length</td><td>Machine Data</td></tr>
<tr><td>SymbolicPointsCount</td><td>uint16</td><td>2</td><td>Number of symbolic points in Navithor</td></tr>
<tr><td>SymbolicPointData</td><td>SymbolicPointData[]</td><td>SymbolicPointsCount * SymbolicPointData length</td><td>Struct defined below for each symbolic point in production area</td></tr>
<tr><td>ResourceTypesCount</td><td>uint16</td><td>2</td><td>Number of resource types</td></tr>
<tr><td>ResourceTypes</td><td>ResourceTypeData[]</td><td>ResourceTypesCount * ResourceTypeData length</td><td>Resource Type Data</td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Frame Length</strong></th><th><strong>Data Length</strong></th><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>9</td><td>8 + structs</td><td>17</td><td>65535</td></tr>
</tbody></table>
</div>
<p><strong>Machine Type Data</strong></p>
<p>Data structure for a single machine type.</p>
<div class="table-wrapper"><table><thead><tr><th><strong>Field Name</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>NameStringLength</td><td>uint16</td><td>2</td><td>Max 100 characters</td></tr>
<tr><td>Name</td><td>string</td><td>0...100</td><td>Machine type name</td></tr>
<tr><td>Id</td><td>uint32</td><td>4</td><td>Machine type ID</td></tr>
<tr><td>CarryItemStringLength</td><td>uint16</td><td>2</td><td>Max 100 characters</td></tr>
<tr><td>CarryItemString</td><td>string</td><td>0...100</td><td>Name of default resource type for machine type</td></tr>
<tr><td>CarryItemId</td><td>uint32</td><td>4</td><td>ID of default resource type for machine type</td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>12</td><td>212</td></tr>
</tbody></table>
</div>
<p><strong>Machine Data</strong></p>
<p>Data structure for a single machine in the system.</p>
<div class="table-wrapper"><table><thead><tr><th><strong>Field Name</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>NameStringLength</td><td>uint16</td><td>2</td><td>Max 100 characters</td></tr>
<tr><td>Name</td><td>string</td><td>0...100</td><td>Machine name</td></tr>
<tr><td>Id</td><td>uint16</td><td>2</td><td>Machine ID</td></tr>
<tr><td>TypeId</td><td>uint32</td><td>4</td><td>Machine type ID</td></tr>
<tr><td>Enabled</td><td>byte</td><td>1</td><td>Machine enabled status</td></tr>
<tr><td>X</td><td>float</td><td>4</td><td>Machine x-coordinate</td></tr>
<tr><td>Y</td><td>float</td><td>4</td><td>Machine y-coordinate</td></tr>
<tr><td>H</td><td>float</td><td>4</td><td>Machine heading (radians)</td></tr>
<tr><td>PositionStatus</td><td>byte</td><td>1</td><td>0 if no position, 1 if position initialized</td></tr>
<tr><td>State</td><td>uint16</td><td>2</td><td>Machine state</td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>24</td><td>124</td></tr>
</tbody></table>
</div>
<p><strong>Symbolic Point Data</strong></p>
<p>Data structure for a single Symbolic Point in the system.</p>
<div class="table-wrapper"><table><thead><tr><th><strong>Field Name</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>Id</td><td>uint16</td><td>2</td><td>Symbolic Point ID</td></tr>
<tr><td>nameStringLength</td><td>uint16</td><td>2</td><td>Max 100 characters</td></tr>
<tr><td>Name</td><td>string</td><td>0...100</td><td>Symbolic point name</td></tr>
<tr><td>Enabled</td><td>byte</td><td>1</td><td>0 = Disabled, 1 = Enabled</td></tr>
<tr><td>numberOfMachineTypes</td><td>uint16</td><td>2</td><td>Machine types that can use symbolic point. Only first 20 will be sent</td></tr>
<tr><td>Machine Type IDs</td><td>uint32[]</td><td>numberOfMachineTypes * 4</td><td></td></tr>
<tr><td>x-coordinate</td><td>float</td><td>4</td><td></td></tr>
<tr><td>y-coordinate</td><td>float</td><td>4</td><td></td></tr>
<tr><td>posInitHeading1</td><td>float</td><td>4</td><td>In radians</td></tr>
<tr><td>posInitHeading2</td><td>float</td><td>4</td><td>In radians (opposite heading to posInitHeading1)</td></tr>
<tr><td>posInitId1</td><td>int32</td><td>4</td><td>-1 if not used</td></tr>
<tr><td>posInitId2</td><td>int32</td><td>4</td><td>-1 if not used</td></tr>
<tr><td>HoldPoint</td><td>byte</td><td>1</td><td>Hold point = 1</td></tr>
<tr><td>Default location</td><td>int32</td><td>4</td><td>Symbolic point ID for default location</td></tr>
<tr><td>Alternative 1 location</td><td>int32</td><td>4</td><td>Symbolic point ID for the first alternative location. -1 for not used</td></tr>
<tr><td>Alternative 2 location</td><td>int32</td><td>4</td><td>Symbolic point ID for the second alternative location. -1 for not used</td></tr>
<tr><td>Alternative 3 location</td><td>int32</td><td>4</td><td>Symbolic point ID for the third alternative location. -1 for not used</td></tr>
<tr><td>Timer</td><td>int32</td><td>4</td><td>Timer in seconds for releasing hold. -1 for not used</td></tr>
<tr><td>level</td><td>int32</td><td>4</td><td></td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>56</td><td>236</td></tr>
</tbody></table>
</div>
<p><strong>Resource Type Data</strong></p>
<p>Data structure for a single resource type definition in the system.</p>
<div class="table-wrapper"><table><thead><tr><th><strong>Field Name</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>ResourceTypeId</td><td>int32</td><td>4</td><td>ID of resource type</td></tr>
<tr><td>ResourceTypeNameStringLength</td><td>uint16</td><td>2</td><td>Max 100 characters</td></tr>
<tr><td>ResourceTypeName</td><td>string</td><td>0...100</td><td>Name of resource type</td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>6</td><td>106</td></tr>
</tbody></table>
</div>
<h4 id="timeset-id--103"><a class="header" href="#timeset-id--103">TimeSet (ID = 103)</a></h4>
<p>Time is set message.</p>
<div class="table-wrapper"><table><thead><tr><th><strong>Frame Length</strong></th><th><strong>Data Length</strong></th><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>9</td><td>0</td><td>9</td><td>9</td></tr>
</tbody></table>
</div>
<h4 id="fstopdone-id--104"><a class="header" href="#fstopdone-id--104">FSTOPDone (ID = 104)</a></h4>
<p>Machine(s) have stopped and are in FSTOP-state.</p>
<div class="table-wrapper"><table><thead><tr><th><strong>Field Name</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>Frame</td><td>header</td><td>9</td><td>Every message has a frame that consists of the same data</td></tr>
<tr><td>MachineId</td><td>int16</td><td>2</td><td>-1 for all</td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Frame Length</strong></th><th><strong>Data Length</strong></th><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>9</td><td>2</td><td>11</td><td>11</td></tr>
</tbody></table>
</div>
<h4 id="fstopreleased-id--105"><a class="header" href="#fstopreleased-id--105">FSTOPReleased (ID = 105)</a></h4>
<p>Machine(s) have returned to normal operation mode.</p>
<div class="table-wrapper"><table><thead><tr><th><strong>Field Name</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>Frame</td><td>header</td><td>9</td><td>Every message has a frame that consists of the same data</td></tr>
<tr><td>MachineId</td><td>int16</td><td>2</td><td>-1 for all</td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Frame Length</strong></th><th><strong>Data Length</strong></th><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>9</td><td>2</td><td>11</td><td>11</td></tr>
</tbody></table>
</div>
<h4 id="driveready-id--302"><a class="header" href="#driveready-id--302">DriveReady (ID = 302)</a></h4>
<p>Machine has stopped driving.</p>
<div class="table-wrapper"><table><thead><tr><th><strong>Field Name</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>Frame</td><td>header</td><td>9</td><td>Every message has a frame that consists of the same data</td></tr>
<tr><td>MachineID</td><td>uint16</td><td>2</td><td></td></tr>
<tr><td>X</td><td>double</td><td>8</td><td></td></tr>
<tr><td>Y</td><td>double</td><td>8</td><td></td></tr>
<tr><td>Heading</td><td>double</td><td>8</td><td></td></tr>
<tr><td>Level</td><td>int32</td><td>4</td><td></td></tr>
<tr><td>SymbolicPointId</td><td>uint16</td><td>2</td><td>If driving has finished at symbolic point SymbolicPointId &gt; 0</td></tr>
<tr><td>ProductionOrderID</td><td>uint32</td><td>4</td><td>ID of the production order, or 0 when drive task was not from production order</td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Frame Length</strong></th><th><strong>Data Length</strong></th><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>9</td><td>36</td><td>45</td><td>45</td></tr>
</tbody></table>
</div>
<h4 id="loadpickupstarted-id--303"><a class="header" href="#loadpickupstarted-id--303">LoadPickUpStarted (ID = 303)</a></h4>
<p>Machine has started loading task.</p>
<div class="table-wrapper"><table><thead><tr><th><strong>Field Name</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>Frame</td><td>header</td><td>9</td><td>Every message has a frame that consists of the same data</td></tr>
<tr><td>MachineID</td><td>uint16</td><td>2</td><td></td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Frame Length</strong></th><th><strong>Data Length</strong></th><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>9</td><td>2</td><td>11</td><td>11</td></tr>
</tbody></table>
</div>
<h4 id="loadpickupready-id--304"><a class="header" href="#loadpickupready-id--304">LoadPickupReady (ID = 304)</a></h4>
<p>Machine has completed loading task.</p>
<div class="table-wrapper"><table><thead><tr><th><strong>Field Name</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>Frame</td><td>header</td><td>9</td><td>Every message has a frame that consists of the same data</td></tr>
<tr><td>MachineID</td><td>uint16</td><td>2</td><td></td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Frame Length</strong></th><th><strong>Data Length</strong></th><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>9</td><td>2</td><td>11</td><td>11</td></tr>
</tbody></table>
</div>
<h4 id="loadpickupaborted-id--305"><a class="header" href="#loadpickupaborted-id--305">LoadPickupAborted (ID = 305)</a></h4>
<p>Machine has failed loading task.</p>
<div class="table-wrapper"><table><thead><tr><th><strong>Field Name</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>Frame</td><td>header</td><td>9</td><td>Every message has a frame that consists of the same data</td></tr>
<tr><td>MachineID</td><td>uint16</td><td>2</td><td></td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Frame Length</strong></th><th><strong>Data Length</strong></th><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>9</td><td>2</td><td>11</td><td>11</td></tr>
</tbody></table>
</div>
<h4 id="emptyloadstarted-id--306"><a class="header" href="#emptyloadstarted-id--306">EmptyLoadStarted (ID = 306)</a></h4>
<p>Machine has started unloading task.</p>
<div class="table-wrapper"><table><thead><tr><th><strong>Field Name</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>Frame</td><td>header</td><td>9</td><td>Every message has a frame that consists of the same data</td></tr>
<tr><td>MachineID</td><td>uint16</td><td>2</td><td></td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Frame Length</strong></th><th><strong>Data Length</strong></th><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>9</td><td>2</td><td>11</td><td>11</td></tr>
</tbody></table>
</div>
<h4 id="emptyloadready-id--307"><a class="header" href="#emptyloadready-id--307">EmptyLoadReady (ID = 307)</a></h4>
<p>Machine has completed unloading task.</p>
<div class="table-wrapper"><table><thead><tr><th><strong>Field Name</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>Frame</td><td>header</td><td>9</td><td>Every message has a frame that consists of the same data</td></tr>
<tr><td>MachineID</td><td>uint16</td><td>2</td><td></td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Frame Length</strong></th><th><strong>Data Length</strong></th><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>9</td><td>2</td><td>11</td><td>11</td></tr>
</tbody></table>
</div>
<h4 id="emptyloadaborted-id--308"><a class="header" href="#emptyloadaborted-id--308">EmptyLoadAborted (ID = 308)</a></h4>
<p>Machine has failed unloading task.</p>
<div class="table-wrapper"><table><thead><tr><th><strong>Field Name</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>Frame</td><td>header</td><td>9</td><td>Every message has a frame that consists of the same data</td></tr>
<tr><td>MachineID</td><td>uint16</td><td>2</td><td></td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Frame Length</strong></th><th><strong>Data Length</strong></th><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>9</td><td>2</td><td>11</td><td>11</td></tr>
</tbody></table>
</div>
<h4 id="errors-id--309"><a class="header" href="#errors-id--309">Errors (ID = 309)</a></h4>
<p>This message is sent periodically from Navithor to MES. Message contains current error status in the system.</p>
<div class="table-wrapper"><table><thead><tr><th><strong>Field Name</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>Frame</td><td>header</td><td>9</td><td>Every message has a frame that consists of the same data</td></tr>
<tr><td>NumberOfErrors</td><td>uint16</td><td>2</td><td>Max 1000 entries</td></tr>
<tr><td>ErrorDataList</td><td>ErrorData[]</td><td>NumberOfErrors * ErrorData length</td><td>ErrorData-struct below</td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Frame Length</strong></th><th><strong>Data Length</strong></th><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>9</td><td>2 + structs</td><td>11</td><td>65000</td></tr>
</tbody></table>
</div>
<p><strong>ErrorData</strong></p>
<p>Error Data struct.</p>
<div class="table-wrapper"><table><thead><tr><th><strong>Field Name</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>DescriptionStringLength</td><td>uint16</td><td>2</td><td>Length of the following Name-field. Limited by Server parameter: MES_MesMaxMsgInfoStringLen</td></tr>
<tr><td>Description</td><td>string</td><td>0...X</td><td>Error description with following format: ERROR_SOURCE.ENTITY.ERROR_TEXT<br/>Alarm source can be: &quot;FleetControl&quot;, &quot;NavigationSoftware&quot; or &quot;Supervisor&quot;<br/>Entity is either name of the AGV that the error is related to or &quot;SystemAlarm&quot;.</td></tr>
<tr><td>Id</td><td>uint16</td><td>2</td><td>Error ID</td></tr>
<tr><td>Value</td><td>uint16</td><td>2</td><td>Error level: 1 = warning, 2 = erropr, 3 = fatal error</td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>6</td><td>6 + MES_MesMaxMsgInfoStringLen</td></tr>
</tbody></table>
</div>
<h4 id="agvstatus-id--310"><a class="header" href="#agvstatus-id--310">AGVStatus (ID = 310)</a></h4>
<p>Periodic status message from a single machine in the system. Sending interval can be changed from Navithor Server parameters: <strong>Machine_STATUS_TO_MES_INTERVAL_ENABLED_MS</strong> and <strong>Machine_STATUS_TO_MES_INTERVAL_DISABLED_MS</strong>. Parameter <strong>MES_DisabledOutMessageGroups</strong> can be used to disable message completely.</p>
<div class="table-wrapper"><table><thead><tr><th><strong>Field Name</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>Frame</td><td>header</td><td>9</td><td>Every message has a frame that consists of the same data</td></tr>
<tr><td>MachineId</td><td>uint16</td><td>2</td><td>Machine ID</td></tr>
<tr><td>X</td><td>double</td><td>8</td><td>X-coordinate location of the machine</td></tr>
<tr><td>Y</td><td>double</td><td>8</td><td>Y-coordinate location of the machine</td></tr>
<tr><td>H</td><td>double</td><td>8</td><td>Machine heading</td></tr>
<tr><td>Level</td><td>int16</td><td>2</td><td>Current level of the machine</td></tr>
<tr><td>PositionConfidence</td><td>byte</td><td>1</td><td>Position confidence level of the machine (0-100)</td></tr>
<tr><td>SpeedNavigationPoint</td><td>double</td><td>8</td><td>Current speed of the machine</td></tr>
<tr><td>State</td><td>byte</td><td>1</td><td>Navitrol state (e.g. STBY = 2, AUTO = 3)</td></tr>
<tr><td>BatteryLevel</td><td>double</td><td>8</td><td>Current battery level of the machine (0-100)</td></tr>
<tr><td>AutoOrManual</td><td>byte</td><td>1</td><td>Control status (0=manual control active, 1 = automatic control active)</td></tr>
<tr><td>PositionInitialized</td><td>byte</td><td>1</td><td>1 = position is initialized, 0 = position is not initialized</td></tr>
<tr><td>LastSymbolPoint</td><td>int32</td><td>4</td><td>ID of the symbolic point where machine previously visited</td></tr>
<tr><td>MachineAtLastSymbolPoint</td><td>byte</td><td>1</td><td>1 = machine is at &quot;LastSymbolPoint&quot;-symbolic point, 0 = machine is not at the location</td></tr>
<tr><td>TargetSymbolPoint</td><td>int32</td><td>4</td><td>ID of the symbolic point that is the current target for the machine</td></tr>
<tr><td>MachineAtTarget</td><td>byte</td><td>1</td><td>1 = machine is at &quot;TargetSymbolPoint&quot;, 0 = machine is not at the location</td></tr>
<tr><td>Operational</td><td>byte</td><td>1</td><td>1 if no errors, 0 if errors are stopping AGV</td></tr>
<tr><td>InProduction</td><td>byte</td><td>1</td><td>1 if in production, 0 if not in production</td></tr>
<tr><td>LoadStatus</td><td>byte</td><td>1</td><td>0 = unknown, 1 = empty, 2 = empty started, 3 = pickup started, 4 = full</td></tr>
<tr><td>Battery voltage</td><td>double</td><td>8</td><td>Battery voltage reported by machine</td></tr>
<tr><td>ChargingStatus</td><td>byte</td><td>1</td><td>0 = not charging, 1 = charging requested, 2 = charging</td></tr>
<tr><td>DistanceToTarget</td><td>float</td><td>4</td><td>Distance in meters to machine's current end target. <strong>(Optional: enable by setting parameter MES_StatusMessageProtocolVersion &gt;= 3)</strong></td></tr>
<tr><td>CurrentDriveThroughPoint</td><td>int32</td><td>4</td><td>Current drive through point of the machine. If drive is cut to either level change, NoStop or traffic light, reports the symbolic point ID of that location. If no drive through point is set, reports -1. <strong>(Optional: enable by setting parameter MES_StatusMessageProtocolVersion &gt;= 4)</strong></td></tr>
<tr><td>NextLevelChangePointId</td><td>int32</td><td>4</td><td>Symbolic point ID of next level change point along the route. If no level change point along the route, -1 is sent. <strong>(Optional: enable by setting parameter MES_StatusMessageProtocolVersion &gt;= 5)</strong></td></tr>
<tr><td>DistanceToNextLevelChange</td><td>float</td><td>4</td><td>Distance to next level change point. If no level change point assigned, 0 is sent. <strong>(Optional: enable by setting parameter MES_StatusMessageProtocolVersion &gt;= 5)</strong></td></tr>
<tr><td>LastSymbolPointDrivenOver</td><td>int32</td><td>4</td><td>ID of the symbolic point that was last driven over, regardless if it was a target or not. <strong>(Optional: enable by setting parameter MES_StatusMessageProtocolVersion &gt;= 6)</strong></td></tr>
<tr><td>NearSymbolicPoint</td><td>int32</td><td>4</td><td>ID of the symbolic point that we are currently within TrafficController_Strict_Target_Near_Distance from. AGV must not be moving and heading difference between AGV and symbolic point must also be within TrafficController_MAX_HEADING_DIFF_RAD. Value -1 if not set. <strong>(Optional: enable by setting parameter MES_StatusMessageProtocolVersion &gt;= 7)</strong></td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Frame Length</strong></th><th><strong>Data Length</strong></th><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>9</td><td>70 [+ max 24]</td><td>79</td><td>103</td></tr>
</tbody></table>
</div>
<h4 id="chargingrequest-id--311"><a class="header" href="#chargingrequest-id--311">ChargingRequest (ID = 311)</a></h4>
<p>This message is sent when machine charging request status is changed (e.g. ChargeCommand-message (ID = 9) triggers this message with RequestType = 3).</p>
<div class="table-wrapper"><table><thead><tr><th><strong>Field Name</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>Frame</td><td>header</td><td>9</td><td>Every message has a frame that consists of the same data</td></tr>
<tr><td>MachineId</td><td>uint16</td><td>2</td><td>Machine ID</td></tr>
<tr><td>RequestType</td><td>uint16</td><td>2</td><td>Charging request type:<p></p>0 = no request active, 1 = rules request, 2 = Navithor Client operator request, 3 = MES or PLC request (force), 4 = machine request, 5 = idle rule request</td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Frame Length</strong></th><th><strong>Data Length</strong></th><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>9</td><td>4</td><td>13</td><td>13</td></tr>
</tbody></table>
</div>
<h4 id="inputvalues-id--312"><a class="header" href="#inputvalues-id--312">InputValues (ID = 312)</a></h4>
<p>Current input values sent by the machine.</p>
<div class="table-wrapper"><table><thead><tr><th><strong>Field Name</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>Frame</td><td>header</td><td>9</td><td>Every message has a frame that consists of the same data</td></tr>
<tr><td>MachineId</td><td>uint16</td><td>2</td><td></td></tr>
<tr><td>DigitalInputlength</td><td>uint16</td><td>2</td><td></td></tr>
<tr><td>DigitalInputs</td><td>byte[]</td><td>0...n</td><td></td></tr>
<tr><td>IntegerInputLength</td><td>uint16</td><td>2</td><td></td></tr>
<tr><td>IntegerInputs</td><td>int[]</td><td>0...n</td><td></td></tr>
<tr><td>FloatInputLength</td><td>uint16</td><td>2</td><td></td></tr>
<tr><td>FloatInputs</td><td>float[]</td><td>0...n</td><td></td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Frame Length</strong></th><th><strong>Data Length</strong></th><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>9</td><td>8 + Inputs</td><td>17</td><td>1000</td></tr>
</tbody></table>
</div>
<h4 id="productionstatus-id--313"><a class="header" href="#productionstatus-id--313">ProductionStatus (ID = 313)</a></h4>
<p>Periodic production status message sent by Navithor. Message is sent periodically defined by the interval parameter <code>MES_ProductionStatusSendTimer</code>.</p>
<p>Message can be also subscribed using <strong>MESMessageSubscription</strong> (ID = 348) message with subscription type 4 (ProductionStatus). This allows only specific clients to receive the message with specific interval, or when content of the message has changed.</p>
<div class="table-wrapper"><table><thead><tr><th><strong>Field Name</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>Frame</td><td>header</td><td>9</td><td>Every message has a frame that consists of the same data</td></tr>
<tr><td>numberOfProductionOrders</td><td>uint16</td><td>2</td><td>Number of ProductionOrderData-structures in this message. Max 200</td></tr>
<tr><td>ProductionOrderData</td><td>ProductionOrderData[]</td><td>numberOfProductionOrders * ProductionOrderData length</td><td>Production Order Data structure below</td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Frame Length</strong></th><th><strong>Data Length</strong></th><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>9</td><td>2 + structs</td><td>11</td><td>44411</td></tr>
</tbody></table>
</div>
<p><strong>Production Order Data</strong></p>
<p>Production order data struct containing information from a single production order.</p>
<div class="table-wrapper"><table><thead><tr><th><strong>Field Name</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>NameStringLength</td><td>uint16</td><td>2</td><td>Max 200 characters</td></tr>
<tr><td>Name</td><td>string</td><td>0...200</td><td>Production Order Name</td></tr>
<tr><td>Id</td><td>uint32</td><td>4</td><td>Production order ID</td></tr>
<tr><td>TargetSymbol</td><td>int32</td><td>4</td><td></td></tr>
<tr><td>AssignedToMachineId</td><td>uint16</td><td>2</td><td>0 if not assigned, machine ID if assigned machine</td></tr>
<tr><td>PickupSymbol</td><td>int32</td><td>4</td><td>-1 if no pickup symbol</td></tr>
<tr><td>ItemTypeToDeliver</td><td>int32</td><td>4</td><td>-1 if no items</td></tr>
<tr><td>CurrentStatus</td><td>byte</td><td>1</td><td>new_order = 0, loaded = 1, waiting = 2, executing = 3, interrupted = 4, completed = 5, cancelled = 6, paused = 7</td></tr>
<tr><td>ExecutionStatus</td><td>byte</td><td>1</td><td>none = 0, drive to load = 1, at load = 2, loading = 3, loaded = 4, driving to target = 5, at target = 6, unloading = 7, unloaded = 8, at hold = 9</td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>22</td><td>222</td></tr>
</tbody></table>
</div>
<h4 id="productionordercompleted-id--314"><a class="header" href="#productionordercompleted-id--314">ProductionOrderCompleted (ID = 314)</a></h4>
<p>This message is sent by Navithor when machine has completed a production order.</p>
<div class="table-wrapper"><table><thead><tr><th><strong>Field Name</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>Frame</td><td>header</td><td>9</td><td>Every message has a frame that consists of the same data</td></tr>
<tr><td>NameStringLength</td><td>uint16</td><td>2</td><td>Max 200 characters</td></tr>
<tr><td>Name</td><td>string</td><td>0...200</td><td>Production Order Name</td></tr>
<tr><td>ID</td><td>uint32</td><td>4</td><td>Unique ID of the production order</td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Frame Length</strong></th><th><strong>Data Length</strong></th><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>9</td><td>4 + Name length</td><td>15</td><td>215</td></tr>
</tbody></table>
</div>
<h4 id="productionorderlistactivatedresult-id--315-1"><a class="header" href="#productionorderlistactivatedresult-id--315-1">ProductionOrderListActivatedResult (ID = 315)</a></h4>
<p>Navithor replies to message ActivateProductionOrderList with this message.</p>
<div class="table-wrapper"><table><thead><tr><th><strong>Field Name</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>Frame</td><td>header</td><td>9</td><td>Every message has a frame that consists of the same data</td></tr>
<tr><td>POLId</td><td>uint32</td><td>4</td><td>ID of the Production Order List template that was activated</td></tr>
<tr><td>OrderID</td><td>uint32</td><td>4</td><td>ID of the created active POL -&gt; 0 if failed</td></tr>
<tr><td>MachineID</td><td>int32</td><td>4</td><td>ID of the machine that is requested to execute the order or less than zero when any machine was requested</td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Frame Length</strong></th><th><strong>Data Length</strong></th><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>9</td><td>12</td><td>21</td><td>21</td></tr>
</tbody></table>
</div>
<h4 id="productionorderlistcompleted-id--316-1"><a class="header" href="#productionorderlistcompleted-id--316-1">ProductionOrderListCompleted (ID = 316)</a></h4>
<p>Navithor replies to message ActivateProductionOrderList with this message.</p>
<div class="table-wrapper"><table><thead><tr><th><strong>Field Name</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>Frame</td><td>header</td><td>9</td><td>Every message has a frame that consists of the same data</td></tr>
<tr><td>OrderID</td><td>uint32</td><td>4</td><td>ID of the completed Production Order List</td></tr>
<tr><td>ExecutionTime</td><td>uint32</td><td>4</td><td>Seconds</td></tr>
<tr><td>TotalDist</td><td>double</td><td>8</td><td>Meters travelled during execution of this order</td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Frame Length</strong></th><th><strong>Data Length</strong></th><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>9</td><td>16</td><td>25</td><td>25</td></tr>
</tbody></table>
</div>
<h4 id="activeproductionorderliststatus-id--317-1"><a class="header" href="#activeproductionorderliststatus-id--317-1">ActiveProductionOrderListStatus (ID = 317)</a></h4>
<p>This message is sent when changes in statuses are reported or periodically if no changes detected.</p>
<div class="table-wrapper"><table><thead><tr><th><strong>Field Name</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>Frame</td><td>header</td><td>9</td><td>Every message has a frame that consists of the same data</td></tr>
<tr><td>NumberOfActiveLists</td><td>uint16</td><td>2</td><td>Number of currently active (waiting for assign, assigned to machine) ProductionOrderLists in Navithor. Max 1000</td></tr>
<tr><td>POLDataList</td><td>POLData[]</td><td>NumberOfActiveLists * POLData length</td><td>List of ProductionOrderList-data structures</td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Frame Length</strong></th><th><strong>Data Length</strong></th><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>9</td><td>2 + structs</td><td>11</td><td>49011</td></tr>
</tbody></table>
</div>
<p><strong>POLData</strong></p>
<p>Production Order List Data structure containing information of a single POL (active).</p>
<div class="table-wrapper"><table><thead><tr><th><strong>Field Name</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>NameStringLength</td><td>uint16</td><td>2</td><td>Max 30 characters</td></tr>
<tr><td>POLName</td><td>string</td><td>0...30</td><td>Production Order List Name (max length = 30 chars)</td></tr>
<tr><td>POLId</td><td>uint32</td><td>4</td><td>Production order List ID</td></tr>
<tr><td>OrderID</td><td>uint32</td><td>4</td><td>OrderID generated by Navithor when a template list was activated</td></tr>
<tr><td>AssignedToMachineId</td><td>int32</td><td>4</td><td>-1 if not assigned, machine ID if assigned machine</td></tr>
<tr><td>POLStatus</td><td>byte</td><td>1</td><td>0 = none, 1 = loaded (waiting), 2 = active, 3 = cancelled, 4 = completed</td></tr>
<tr><td>CurrentTargetIndex</td><td>int16</td><td>2</td><td>-1 if not started, 0-&gt; index of the Production Order List location that is the current target</td></tr>
<tr><td>NumberOfTargets</td><td>uint16</td><td>2</td><td>Total number of locations in the POL</td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>19</td><td>49</td></tr>
</tbody></table>
</div>
<h4 id="productionorderlisttemplateresult-id--318-1"><a class="header" href="#productionorderlisttemplateresult-id--318-1">ProductionOrderListTemplateResult (ID = 318)</a></h4>
<p>This message is as a reply to RequestProductionOrderListTemplates.</p>
<div class="table-wrapper"><table><thead><tr><th><strong>Field Name</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>Frame</td><td>header</td><td>9</td><td>Every message has a frame that consists of the same data</td></tr>
<tr><td>NumberOfTemplates</td><td>uint16</td><td>2</td><td>Number of templates loaded in Navithor. Max 100</td></tr>
<tr><td>POLTemplateData</td><td>POLTemplateData[]</td><td>NumberOfTemplates * POLTemplateData length</td><td>List of ProductionOrderList-template data structures</td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Frame Length</strong></th><th><strong>Data Length</strong></th><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>9</td><td>2 + structs</td><td>11</td><td>23811</td></tr>
</tbody></table>
</div>
<p><strong>POLTemplateData</strong></p>
<p>Production Order List Template Data structure containing information of a single POL Template.</p>
<div class="table-wrapper"><table><thead><tr><th><strong>Field Name</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>NameStringLength</td><td>uint16</td><td>2</td><td>Max 30 characters</td></tr>
<tr><td>POLName</td><td>string</td><td>0...30</td><td>Production Order List Name (max length = 30 chars)</td></tr>
<tr><td>POLId</td><td>uint32</td><td>4</td><td>Production order List ID</td></tr>
<tr><td>NumberOfDestinations</td><td>uint16</td><td>2</td><td>Number of destinations in execution order. Max 100</td></tr>
<tr><td>DestinationID</td><td>uint16[]</td><td>NumberOfDestinations * 2</td><td>SymbolicPointID of the destination</td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>8</td><td>238</td></tr>
</tbody></table>
</div>
<h4 id="tagstatusrequest-id--319"><a class="header" href="#tagstatusrequest-id--319">TagStatusRequest (ID = 319)</a></h4>
<p>Navithor can request a certain status for a tag that is attached to production area entity. Currently supported entities are:</p>
<ul>
<li>Symbolic Point of type 'Door'</li>
</ul>
<p>When controlled tags are defined for the production system Navithor sends this message with regular interval and when status change is required. MES should answer to this message with TagStatus (ID = 24).</p>
<div class="table-wrapper"><table><thead><tr><th><strong>Field Name</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>Frame</td><td>header</td><td>9</td><td>Every message has a frame that consists of the same data</td></tr>
<tr><td>TagID</td><td>uint32</td><td>4</td><td>Tag ID defined in Navithor Tools for Symbolic Point</td></tr>
<tr><td>RequiredStatus</td><td>int32</td><td>4</td><td>Required status for entity linked to the tag. Defined values:<p></p>0 = OFFLINE (not requested)<br/>1 = DOOR CLOSED (default request)<br/>2 = DOOR CLOSING (not requested)<br/>3 = DOOR OPENING (not requested)<br/>4 = DOOR OPEN (when machine needs pass-through)</td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Frame Length</strong></th><th><strong>Data Length</strong></th><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>9</td><td>8</td><td>17</td><td>17</td></tr>
</tbody></table>
</div>
<h4 id="requestpickupresult-id--320-1"><a class="header" href="#requestpickupresult-id--320-1">RequestPickUpResult (ID = 320)</a></h4>
<p>Navithor's answer to RequestPickUp message (ID = 25).</p>
<div class="table-wrapper"><table><thead><tr><th><strong>Field Name</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>Frame</td><td>header</td><td>9</td><td>Every message has a frame that consists of the same data</td></tr>
<tr><td>Symbolic Point ID</td><td>uint32</td><td>4</td><td>Symbolic point ID defined in Navithor Tools for Symbolic Point</td></tr>
<tr><td>Result</td><td>uint32</td><td>4</td><td>Result of RequestPickUp message handling. Possible results:<p></p>0 = no error<br/>1 = bad input data, invalid combination of Symbolic Point ID and Shelf ID<br/>2 = no resource at the specified location<br/>4 = symbolic point with specified ID was not found<br/>Error ID (See chapter 9.5 &quot;Error IDs&quot;)</td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Frame Length</strong></th><th><strong>Data Length</strong></th><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>9</td><td>8</td><td>17</td><td>17</td></tr>
</tbody></table>
</div>
<h4 id="mesresourcestatus-id--321"><a class="header" href="#mesresourcestatus-id--321">MESResourceStatus (ID = 321)</a></h4>
<p>Periodic resource status message sent by Navithor.</p>
<div class="table-wrapper"><table><thead><tr><th><strong>Field Name</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>Frame</td><td>header</td><td>9</td><td>Every message has a frame that consists of the same data</td></tr>
<tr><td>NumberOfResources</td><td>uint16</td><td>2</td><td>Number of ResourceData-structures in this message. Max 500</td></tr>
<tr><td>ResourceDataList</td><td>ResourceData[]</td><td>NumberOfResources * ResourceData length</td><td>ResourceData structure below</td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Frame Length</strong></th><th><strong>Data Length</strong></th><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>9</td><td>2 + structs</td><td>11</td><td>10011</td></tr>
</tbody></table>
</div>
<p><strong>ResourceData</strong></p>
<p>Resource data struct containing information from a single resource</p>
<div class="table-wrapper"><table><thead><tr><th><strong>Field Name</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>ResourceId</td><td>int32</td><td>4</td><td>Unique ID for the resource</td></tr>
<tr><td>ResourceTypeId</td><td>int32</td><td>4</td><td>Resource type ID</td></tr>
<tr><td>ResourceQuantity</td><td>uint16</td><td>2</td><td>Resource quantity</td></tr>
<tr><td>ResourceStatus</td><td>uint16</td><td>2</td><td>0 = not defined, 1 = at symbolic point, 2 = onboard of AGV</td></tr>
<tr><td>LocationID</td><td>int32</td><td>4</td><td>-1 if not defined, otherwise either SymbolicPointId or MachineId depending on the resource status given above</td></tr>
<tr><td>ProductionOrderId</td><td>int32</td><td>4</td><td>-1 if no production order linked to the resource</td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>20</td><td>20</td></tr>
</tbody></table>
</div>
<h4 id="requestresourcestatusatlocation-id--322"><a class="header" href="#requestresourcestatusatlocation-id--322">RequestResourceStatusAtLocation (ID = 322)</a></h4>
<p>Navithor sends this message to request a specific resource status to a location. The request can be:</p>
<ul>
<li>Navithor asks for a specific resource type to be added to a specific symbolic point
<ul>
<li>Use case: Transfer request is linked to a pickup location but there is no resource at the pickup location. The transfer request cannot proceed until the correct resource is added to the symbolic point</li>
</ul>
</li>
<li>Navithor requests that a resource must be removed from a specific symbolic point
<ul>
<li>Use case 1: unload location needs to be set empty so that next AGV arriving to the location can unload its resource</li>
<li>Use case 2: pickup location has wrong resource type compared to the resource type of transfer request</li>
</ul>
</li>
</ul>
<p>This message is not automatically sent by default. Enabling requires a mapping file configuration for Navithor to understand the correct MES client IDs that handles the request(s). Mapping file:</p>
<ul>
<li>File 'LocationMESRequestLinkings.txt' must be found in 'Overrides'-subfolder of Navithor Server's running folder</li>
<li>One configuration per line (Symbolic Point ID:MES ID). E.g:
<ul>
<li>1:1001
<ul>
<li>Symbolic Point 1 is monitored for required resource status and RequestResourceStatusAtLocation-message will be sent to MES Client that is identified as 1001</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>Parameters MES_ResRequestSendInterval and MES_ResRequestSendInterval_NoAck affect the periodic interval of sending this message. The request is also sent in case the data in the message gets changed.</p>
<p>MES should reply with message ID = 201 AckOrRejRequest. Acknowleding the request does not create any changes in the production. The requests can be fulfilled only by changing the resource status at needed symbolic point(s). This can be done with messages SetStatusAtSymbolicPoint (ID = 20), SetResourceAtLocationWithExtendedInfo (ID = 53) or SetResourcesAtLocation (ID = 32). Bada</p>
<p>MES Client can also reject the request with AckOrRejRequest. Rejecting a request will either cause the related transfer request to be postponed or cancelled. See section <em>Error IDs</em> for information about reason codes. Postponing means the transfer request will unlink from the symbolic point and become inactive for a specified time (parameter ProductionManager_TRANSFER_REQUEST_POSTPONE_TIME) until it can link to a symbolic point again.</p>
<p>This message is supported in Navithor version 1.9.59.X -&gt; MES interface updated to version 1.6.</p>
<div class="table-wrapper"><table><thead><tr><th><strong>Field Name</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>Frame</td><td>header</td><td>9</td><td>Every message has a frame that consists of the same data</td></tr>
<tr><td>RequestID</td><td>uint16</td><td>2</td><td>A running number to identify reply to this specific request</td></tr>
<tr><td>SymbolicPointID</td><td>uint16</td><td>2</td><td>ID of the symbolic point</td></tr>
<tr><td>CurrResTypeAtLoc</td><td>int32</td><td>4</td><td>Type ID of the resource currently at symbolic point. 0 if location is empty</td></tr>
<tr><td>CurrResCountAtLoc</td><td>uint16</td><td>2</td><td>Number of resources currently at the location. 0 if location is empty</td></tr>
<tr><td>CurrPickUpReqStatus</td><td>uint16</td><td>2</td><td>Current Pickup request-status:<p></p>0 = No request<br/>1 = Pickup request active<br/>2 = Pickup request active and AGV routed to location</td></tr>
<tr><td>RequestedResTypeID</td><td>int32</td><td>4</td><td>Type ID of the resource needed at the location</td></tr>
<tr><td>RequestedResCount</td><td>uint16</td><td>2</td><td>Number of resources requested to be at location</td></tr>
<tr><td>RequestReason</td><td>uint16</td><td>2</td><td>Navithor has reason for the request:<p></p>0 = Production Request. E.g. transfer request received but no resource at pickup location<br/>1 = AGV is currently picking up current resource<br/>2 = AGV is currently dropping a resource to this location<br/>100 = Error – wrong resource at symbolic point<br/>200 = Error – delivery of current resource is not possible<br/>300 = Error – AGV fails to load current resource at location<br/>301 = Error – AGV fails to unload resource to location</td></tr>
<tr><td>ReqResIdentifierLen</td><td>uint16</td><td>2</td><td>Length of following ReqResIdentifier-string field. Max len = 256 characters</td></tr>
<tr><td>ReqResIndentifier</td><td>string</td><td>0...255</td><td>Resource identifier number or code</td></tr>
<tr><td>RequestInfoStrLen</td><td>uint16</td><td>2</td><td>Length of following RequestInformation-string field. Max len = 256 characters</td></tr>
<tr><td>RequestInformation</td><td>string</td><td>0...255</td><td>Information from Navithor about the request</td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Frame Length</strong></th><th><strong>Data Length</strong></th><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>9</td><td>24 + ReqResIdentifierLen + RequestInfoStrLen</td><td>33</td><td>543</td></tr>
</tbody></table>
</div>
<h4 id="transferrequeststatus-id--323"><a class="header" href="#transferrequeststatus-id--323">TransferRequestStatus (ID = 323)</a></h4>
<p>If TransferRequest message was sent with a RequestID, Navithor sends this message with the same RequestID when the status of TransferRequest changes. The message is sent first time, when production order is created and linked to the transfer request.</p>
<p>This message is supported in Navithor version 2.0.2.X -&gt; MES interface updated to version 2.4.</p>
<div class="table-wrapper"><table><thead><tr><th><strong>Field Name</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>Frame</td><td>header</td><td>9</td><td>Every message has a frame that consists of the same data</td></tr>
<tr><td>RequestID</td><td>uint32</td><td>4</td><td>ID sent by the planner in TransferRequest message to identify reply to that specific request</td></tr>
<tr><td>ProductionOrderID</td><td>uint32</td><td>4</td><td>Production order ID linked to the transfer request</td></tr>
<tr><td>TransferStatus</td><td>uint16</td><td>2</td><td>None = 0, waiting pickup = 1, assigned to machine = 2, transporting = 3, unloaded = 4, cancelled = 6</td></tr>
<tr><td>MachineID</td><td>uint32</td><td>4</td><td>0 = not assigned to any machine, otherwise tells the machine ID</td></tr>
<tr><td>PickupLocationID</td><td>uint16</td><td>2</td><td>ID of the pickup location (symbolic point or group). <strong>(Optional: enable by setting parameter MES_StatusMessageProtocolVersion &gt;= 2)</strong></td></tr>
<tr><td>TargetLocationID</td><td>uint16</td><td>2</td><td>ID of the current target location (symbolic point or group). <strong>(Optional: enable by setting parameter MES_StatusMessageProtocolVersion &gt;= 2)</strong></td></tr>
<tr><td>PickupIDType</td><td>byte</td><td>1</td><td>0 = PickupLocationID-field points to symbolic point ID<br/>1 = PickupLocationID-field points to symbolic point group ID<br/><strong>(Optional: enable by setting parameter MES_StatusMessageProtocolVersion &gt;= 2)</strong></td></tr>
<tr><td>TargetIDType</td><td>byte</td><td>1</td><td>0 = TargetLocationID-field points to symbolic point ID<br/> 1 = TargetLocationID-field points to symbolic point group ID<br/><strong>(Optional: enable by setting parameter MES_StatusMessageProtocolVersion &gt;= 2)</strong></td></tr>
<tr><td>OrderedAmount</td><td>uint16</td><td>2</td><td>Total amount of resources to be delivered in the order. <strong>(Optional: enable by setting parameter MES_StatusMessageProtocolVersion &gt;= 2)</strong></td></tr>
<tr><td>AGVsTransporting</td><td>uint16</td><td>2</td><td>Total amount of AGVs currently transporting resources. <strong>(Optional: enable by setting parameter MES_StatusMessageProtocolVersion &gt;= 2)</strong></td></tr>
<tr><td>DeliveredCount</td><td>uint16</td><td>2</td><td>Amount of resources delivered so far. <strong>(Optional: enable by setting parameter MES_StatusMessageProtocolVersion &gt;= 2)</strong></td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Frame Length</strong></th><th><strong>Data Length</strong></th><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>9</td><td>14 [+ 12]</td><td>23</td><td>35</td></tr>
</tbody></table>
</div>
<h4 id="symbolicpointgroupstatus-id--324"><a class="header" href="#symbolicpointgroupstatus-id--324">SymbolicPointGroupStatus (ID = 324)</a></h4>
<p>This message can be used to set resource related status for a SymbolicPointGroup.</p>
<div class="table-wrapper"><table><thead><tr><th><strong>Field Name</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>Frame</td><td>header</td><td>9</td><td>Every message has a frame that consists of the same data</td></tr>
<tr><td>SympointGroupID</td><td>uint16</td><td>2</td><td>ID of the SymbolicPointGroup</td></tr>
<tr><td>NumberOfSyms</td><td>uint16</td><td>2</td><td>Number of enabled Symbolic Points in this group</td></tr>
<tr><td>NumberOfAvailableSyms</td><td>uint16</td><td>2</td><td>Number of Symbolic Points in this group that are available for resources</td></tr>
<tr><td>MaxResCount</td><td>uint16</td><td>2</td><td>Total number of resources possible for Symbolic Points in this group</td></tr>
<tr><td>CurrResCount</td><td>uint16</td><td>2</td><td>Current number of resources at Symbolic Points of this group</td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Frame Length</strong></th><th><strong>Data Length</strong></th><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>9</td><td>10</td><td>19</td><td>19</td></tr>
</tbody></table>
</div>
<h4 id="groupedtagstatusrequest-id--325"><a class="header" href="#groupedtagstatusrequest-id--325">GroupedTagStatusRequest (ID = 325)</a></h4>
<p>Navithor can request a certain status for a tag that is attached to production area entity. Currently supported entities are:</p>
<ul>
<li>Symbolic Point of type 'Door'</li>
</ul>
<p>When controlled tags are defined for the production system Navithor sends this message with regular interval and when status change is required. MES should answer to this message with TagStatus (ID = 24) or with GroupedTagStatus (ID = 35).</p>
<p>This message is only sent if MES_GroupTagStatusRequests parameter is set to true. Available from Navithor server versions 2.1.2.0 onwards.</p>
<div class="table-wrapper"><table><thead><tr><th><strong>Field Name</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>Number of tags</td><td>uint16</td><td>2</td><td>Number of tags in this request</td></tr>
<tr><td>Requests for tags</td><td>TagData[]</td><td>Number of tags * TagData length</td><td></td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Frame Length</strong></th><th><strong>Data Length</strong></th><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>9</td><td>2 + structs</td><td>11</td><td>4011</td></tr>
</tbody></table>
</div>
<p><strong>TagData</strong></p>
<p>Data structure for a single machine type.</p>
<div class="table-wrapper"><table><thead><tr><th><strong>Field Name</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>TagID</td><td>uint16</td><td>2</td><td>Tag ID defined in Navithor Tools for Symbolic Point</td></tr>
<tr><td>TagStatus</td><td>uint16</td><td>2</td><td>Status of the tag. Defined values:<p></p>0 = OFFLINE<br/>1 = DOOR CLOSED<br/>2 = DOOR CLOSING<br/>3 = DOOR OPENING<br/>4 = DOOR OPEN</td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>4</td><td>4</td></tr>
</tbody></table>
</div>
<h4 id="activefirealarmstatus-id--326"><a class="header" href="#activefirealarmstatus-id--326">ActiveFireAlarmStatus (ID = 326)</a></h4>
<p>Navithor sends this message periodically for each active fire alarm.</p>
<div class="table-wrapper"><table><thead><tr><th><strong>Field Name</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>Frame</td><td>header</td><td>9</td><td>Every message has a frame that consists of the same data</td></tr>
<tr><td>FireAlarmID</td><td>uint32</td><td>4</td><td>ID of the active fire alarm</td></tr>
<tr><td>MachineCount</td><td>uint16</td><td>2</td><td>Number of machines that are still in the zones belonging to the alarm</td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Frame Length</strong></th><th><strong>Data Length</strong></th><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>9</td><td>6</td><td>15</td><td>15</td></tr>
</tbody></table>
</div>
<h4 id="stoppedatstoppoint-id--328"><a class="header" href="#stoppedatstoppoint-id--328">StoppedAtStopPoint (ID = 328)</a></h4>
<p>Machine has stopped driving.</p>
<div class="table-wrapper"><table><thead><tr><th><strong>Field Name</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>Frame</td><td>header</td><td>9</td><td>Every message has a frame that consists of the same data</td></tr>
<tr><td>MachineID</td><td>uint16</td><td>2</td><td></td></tr>
<tr><td>StopPointIndex</td><td>int16</td><td>2</td><td>The index of the current point where AGV stopped. Might be used for sending notification when light curtain triggered with negative index</td></tr>
<tr><td>ProductionOrderID</td><td>int32</td><td>4</td><td>ID of the production order, or 0 when drive task was not from production order</td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Frame Length</strong></th><th><strong>Data Length</strong></th><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>9</td><td>8</td><td>17</td><td>17</td></tr>
</tbody></table>
</div>
<h4 id="estimationofdrivetostartsymbolicpoint-id--329"><a class="header" href="#estimationofdrivetostartsymbolicpoint-id--329">EstimationOfDriveToStartSymbolicPoint (ID = 329)</a></h4>
<p>Navithor will reply with this message to valid EstimateDriveToStartSymbolicPoint message.</p>
<p>Navithor replies with driving distances and times in the ascending order of the SortingField specified in EstimateDriveToStartSymbolicPoint. The distances and times are calculated to the start symbolic point for each possible machine.</p>
<p>Estimation of the driving distances and times are only possible for enabled machines in production. If some machine is not enabled, or is not in production, or is executing another order, it will not appear in the estimation results.</p>
<div class="table-wrapper"><table><thead><tr><th><strong>Field Name</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>Frame</td><td>header</td><td>9</td><td>Every message has a frame that consists of the same data</td></tr>
<tr><td>NumberOfMachines</td><td>uint16</td><td>2</td><td>Number of machines, from 0 to 200</td></tr>
<tr><td>MachineIds</td><td>uint16[]</td><td>NumberOfMachines * 2</td><td>Array of machine IDs</td></tr>
<tr><td>DrivingDistances</td><td>float[]</td><td>NumberOfMachines * 4</td><td>Estimated driving distances in meters</td></tr>
<tr><td>DrivingTimes</td><td>uint16[]</td><td>NumberOfMachines * 2</td><td>Estimated driving times in seconds</td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Frame Length</strong></th><th><strong>Data Length</strong></th><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>9</td><td>2 + NumberOfMachines * 8</td><td>11</td><td>1611</td></tr>
</tbody></table>
</div>
<h4 id="racksetupreply-id--330-1"><a class="header" href="#racksetupreply-id--330-1">RackSetupReply (ID = 330)</a></h4>
<p>This message will be sent by Navithor back to the same MES client as a reply to its GetRackSetup message.</p>
<div class="table-wrapper"><table><thead><tr><th><strong>Field Name</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>Frame</td><td>header</td><td>9</td><td>Every message has a frame that consists of the same data</td></tr>
<tr><td>NumberOfSps</td><td>int32</td><td>4</td><td>If GetRackSetup message had positive MachineTypeId, then this field contains the number of symbolic points which are racks with defined MachineTypeId. Else, this field contains the number of all symbolic points which are racks</td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Frame Length</strong></th><th><strong>Data Length</strong></th><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>9</td><td>4</td><td>13</td><td>13</td></tr>
</tbody></table>
</div>
<h4 id="racksetup-id--331-1"><a class="header" href="#racksetup-id--331-1">RackSetup (ID = 331)</a></h4>
<p>This message will be sent by Navithor back to the same MES client as an additional part of the reply to its GetRackSetup message.</p>
<div class="table-wrapper"><table><thead><tr><th><strong>Field Name</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>Frame</td><td>header</td><td>9</td><td>Every message has a frame that consists of the same data</td></tr>
<tr><td>SpId</td><td>int32</td><td>4</td><td>Symbolic point ID which is a rack with defined MachineTypeId</td></tr>
<tr><td>MachineTypeId</td><td>int32</td><td>4</td><td>Machine type ID</td></tr>
<tr><td>NumberOfShelves</td><td>uint16</td><td>2</td><td>Number of shelves in this rack (maximum is 100)</td></tr>
<tr><td>Shelves</td><td>&lt;int32, int32&gt;[]</td><td>0...800</td><td>Shelves passed as list of tuples containing &lt;Shelf ID, Actuator height (mm)&gt;. Number of the list elements is equal to NumberOfShelves</td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Frame Length</strong></th><th><strong>Data Length</strong></th><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>9</td><td>10 + length of shelves</td><td>19</td><td>819</td></tr>
</tbody></table>
</div>
<h4 id="symbolicpointgroupsetup-id--332"><a class="header" href="#symbolicpointgroupsetup-id--332">SymbolicPointGroupSetup (ID = 332)</a></h4>
<p>This message will be sent by Navithor back to the same MES client as an answer to the GetSymbolicPointGroupSetup message.</p>
<div class="table-wrapper"><table><thead><tr><th><strong>Field Name</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>Frame</td><td>header</td><td>9</td><td>Every message has a frame that consists of the same data</td></tr>
<tr><td>NumOfGroups</td><td>uint16</td><td>2</td><td>Number of symbolic point groups in the system</td></tr>
<tr><td>SymbolicPointGroups</td><td>SymbolicPointGroupData[]</td><td>NumOfGroups * SymbolicPointGroupData length</td><td>Array of SymbolicPointGroupData structs containing information about each group. Data defined below</td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Frame Length</strong></th><th><strong>Data Length</strong></th><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>9</td><td>2 + structs</td><td>11</td><td>6011</td></tr>
</tbody></table>
</div>
<p><strong>SymbolicPointGroupData</strong></p>
<p>Data structure for a single symbolic point group.</p>
<div class="table-wrapper"><table><thead><tr><th><strong>Field Name</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>Group ID</td><td>uint16</td><td>2</td><td>Symbolic point group ID</td></tr>
<tr><td>NameStringLength</td><td>uint16</td><td>2</td><td>Max 100 characters</td></tr>
<tr><td>Name</td><td>string</td><td>0...100</td><td>Name of the symbolic point group</td></tr>
<tr><td>NumberOfSPs</td><td>uint16</td><td>2</td><td>Number of Symbolic Points in this group (SPN)</td></tr>
<tr><td>SympointID</td><td>uint16[]</td><td>2 * SPN</td><td>Symbolic point IDs as array</td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>6</td><td>600</td></tr>
</tbody></table>
</div>
<h4 id="zonestatusreply-id--333"><a class="header" href="#zonestatusreply-id--333">ZoneStatusReply (ID = 333)</a></h4>
<p>Reply to the Request zone status message (ID = 51).</p>
<p>Valid from Navithor 2.20.0.0 forward.</p>
<div class="table-wrapper"><table><thead><tr><th><strong>Field Name</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>Frame</td><td>header</td><td>9</td><td>Every message has a frame that consists of the same data</td></tr>
<tr><td>Zone ID</td><td>uint32</td><td>4</td><td>The ID of the zone</td></tr>
<tr><td>Requested information</td><td>uint16</td><td>2</td><td>Flags that were set in the request so that the Client can read the message:<p></p>ZoneOccupancy status 1 &lt;&lt; 0<br/>AGVs inside zone (List of AGV ids) 1 &lt;&lt; 1</td></tr>
<tr><td>Zone occupancy status</td><td>uint16</td><td>2</td><td>1 if occupied and 0 if no AGVs inside the zone. <strong>(Optional: is only sent when Requested information flags have first bit set to 1 (1 &lt;&lt; 0))</strong></td></tr>
<tr><td>Number of AGVs inside zone</td><td>uint16</td><td>2</td><td>How many AGVs are inside the zone. Denoted as N <strong>(Optional: is only sent when Requested information flags have second bit set to 1 (1 &lt;&lt; 1))</strong></td></tr>
<tr><td>AGV IDs of the AGVs inside</td><td>uint32[]</td><td>N * 4</td><td>The IDs of the AGVs inside the zone. <strong>(Optional: is only sent when Requested information flags have second bit set to 1 (1 &lt;&lt; 1))</strong></td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Frame Length</strong></th><th><strong>Data Length</strong></th><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>9</td><td>6 [+ 2] [+ 2 + N * 4]</td><td>15</td><td>1617</td></tr>
</tbody></table>
</div>
<h4 id="mesbatterytemperaturewarning-id--334"><a class="header" href="#mesbatterytemperaturewarning-id--334">MesBatteryTemperatureWarning (ID = 334)</a></h4>
<p>This message is sent when machine battery reports too high temperature.</p>
<div class="table-wrapper"><table><thead><tr><th><strong>Field Name</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>MachineID</td><td>int32</td><td>4</td><td>MachineID</td></tr>
<tr><td>PositionX</td><td>float</td><td>4</td><td>Machine X position</td></tr>
<tr><td>PositionY</td><td>float</td><td>4</td><td>Machine Y position</td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Frame Length</strong></th><th><strong>Data Length</strong></th><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>9</td><td>12</td><td>21</td><td>21</td></tr>
</tbody></table>
</div>
<h4 id="productionareachanged-id--335"><a class="header" href="#productionareachanged-id--335">ProductionAreaChanged (ID = 335)</a></h4>
<p>Message will be sent by Navithor when production area has been changed or reloaded. Will be also sent at startup.</p>
<p>Available from Navithor server versions 2.21.0.0 onwards.</p>
<div class="table-wrapper"><table><thead><tr><th><strong>Field Name</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>Frame</td><td>header</td><td>9</td><td>Every message has a frame that consists of the same data</td></tr>
<tr><td>ProductionAreaID</td><td>uint16</td><td>2</td><td>The ID of the production area</td></tr>
<tr><td>ProductionAreaVersion</td><td>uint16</td><td>2</td><td>The version number of the production area</td></tr>
<tr><td>NameStringLength</td><td>uint16</td><td>2</td><td>Length of the Production Area Name. Max 128 characters</td></tr>
<tr><td>ProductionAreaName</td><td>string</td><td>0...128</td><td>Production Area Name. Max length = 128 characters</td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Frame Length</strong></th><th><strong>Data Length</strong></th><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>9</td><td>6 + ProductionAreaName length</td><td>15</td><td>143</td></tr>
</tbody></table>
</div>
<h4 id="machinetypeinformationreply-id--336"><a class="header" href="#machinetypeinformationreply-id--336">MachineTypeInformationReply (ID = 336)</a></h4>
<p>Message sent as reply to GetProductionAreaInformation (ID = 52). Contains information about currently active machine types.</p>
<p>Available from Navithor server versions 2.21.0.0 onwards.</p>
<div class="table-wrapper"><table><thead><tr><th><strong>Field Name</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>Frame</td><td>header</td><td>9</td><td>Every message has a frame that consists of the same data</td></tr>
<tr><td>NumberOfMachineTypes</td><td>uint16</td><td>2</td><td>How many MachineTypeInfo data structures are included</td></tr>
<tr><td>Information</td><td>MachineTypeInfo[]</td><td>NumberOfMachineTypes * MachineTypeInfo length</td><td>Machine type information</td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Frame Length</strong></th><th><strong>Data Length</strong></th><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>9</td><td>2 + structs</td><td>11</td><td>65535</td></tr>
</tbody></table>
</div>
<p><strong>MachineTypeInfo</strong></p>
<p>Machine type information.</p>
<div class="table-wrapper"><table><thead><tr><th><strong>Field Name</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>ID</td><td>int32</td><td>4</td><td>ID of machine type</td></tr>
<tr><td>NameStringLength</td><td>uint16</td><td>2</td><td>Length machine type name</td></tr>
<tr><td>Name</td><td>string</td><td>0...50</td><td>Name of machine type</td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>6</td><td>56</td></tr>
</tbody></table>
</div>
<h4 id="machineinformationreply-id--337"><a class="header" href="#machineinformationreply-id--337">MachineInformationReply (ID = 337)</a></h4>
<p>Message sent as reply to GetProductionAreaInformation (ID = 52). Contains information about currently active machines.</p>
<p>Available from Navithor server versions 2.21.0.0 onwards.</p>
<div class="table-wrapper"><table><thead><tr><th><strong>Field Name</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>Frame</td><td>header</td><td>9</td><td>Every message has a frame that consists of the same data</td></tr>
<tr><td>NumberOfMachineEntries</td><td>uint16</td><td>2</td><td>How many MESMachineInformation data structures are included</td></tr>
<tr><td>Information</td><td>MESMachineInformation[]</td><td>NumberOfMachineEntries * MESMachineInformation length</td><td>Machine information</td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Frame Length</strong></th><th><strong>Data Length</strong></th><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>9</td><td>2 + structs</td><td>11</td><td>65535</td></tr>
</tbody></table>
</div>
<p><strong>MESMachineInformation</strong></p>
<p>Machine information.</p>
<div class="table-wrapper"><table><thead><tr><th><strong>Field Name</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>ID</td><td>int32</td><td>4</td><td>ID of machine</td></tr>
<tr><td>TypeId</td><td>int32</td><td>4</td><td>ID of machine type</td></tr>
<tr><td>NameStringLength</td><td>uint16</td><td>2</td><td>Length machine name</td></tr>
<tr><td>Name</td><td>string</td><td>0...50</td><td>Name of machine</td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>10</td><td>60</td></tr>
</tbody></table>
</div>
<h4 id="symbolicpointinformationreply-id--338"><a class="header" href="#symbolicpointinformationreply-id--338">SymbolicPointInformationReply (ID = 338)</a></h4>
<p>Message sent as reply to GetProductionAreaInformation (ID = 52). Contains information about currently active symbolic points.</p>
<p>Available from Navithor server versions 2.21.0.0 onwards.</p>
<div class="table-wrapper"><table><thead><tr><th><strong>Field Name</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>Frame</td><td>header</td><td>9</td><td>Every message has a frame that consists of the same data</td></tr>
<tr><td>NumberOfMachineEntries</td><td>uint16</td><td>2</td><td>How many MESSymbolicPointInformation data structures are included</td></tr>
<tr><td>Information</td><td>SPInformation[]</td><td>NumberOfMachineEntries * SPInformation length</td><td>Symbolic point information</td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Frame Length</strong></th><th><strong>Data Length</strong></th><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>9</td><td>2 + structs</td><td>11</td><td>65535</td></tr>
</tbody></table>
</div>
<p><strong>SPInformation</strong></p>
<p>Symbolic point information. Max length can be determined from 62 + (number of machine types in production area * 4).</p>
<div class="table-wrapper"><table><thead><tr><th><strong>Field Name</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>ID</td><td>int32</td><td>4</td><td>ID of symbolic point</td></tr>
<tr><td>Type</td><td>int32</td><td>4</td><td>Type of symbolic point</td></tr>
<tr><td>AvailableForMachineTypesCount</td><td>uint16</td><td>2</td><td>How many machine types are valid for this symbolic point</td></tr>
<tr><td>AvailableForMachineTypes</td><td>int32[]</td><td>AvailableForMachineTypesCount * 4</td><td>ID's of machine types that are valid for this symbolic point</td></tr>
<tr><td>NameStringLength</td><td>uint16</td><td>2</td><td>Length of name</td></tr>
<tr><td>Name</td><td>string</td><td>0...50</td><td>Name of symbolic point</td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>12</td><td>102</td></tr>
</tbody></table>
</div>
<h4 id="symbolicpointholdinformationreply-id--339"><a class="header" href="#symbolicpointholdinformationreply-id--339">SymbolicPointHoldInformationReply (ID = 339)</a></h4>
<p>Message sent as reply to GetProductionAreaInformation (ID = 52). Contains hold information of currently active symbolic points.</p>
<p>Available from Navithor server versions 2.21.0.0 onwards.</p>
<div class="table-wrapper"><table><thead><tr><th><strong>Field Name</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>Frame</td><td>header</td><td>9</td><td>Every message has a frame that consists of the same data</td></tr>
<tr><td>NumberOfHoldEntries</td><td>uint16</td><td>2</td><td>How many HoldInformation data structures are included</td></tr>
<tr><td>Information</td><td>HoldInformation[]</td><td>NumberOfHoldEntries * HoldInformation length</td><td>Symbolic point hold information</td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Frame Length</strong></th><th><strong>Data Length</strong></th><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>9</td><td>2 + structs</td><td>11</td><td>65535</td></tr>
</tbody></table>
</div>
<p><strong>HoldInformation</strong></p>
<p>Symbolic point hold information.</p>
<div class="table-wrapper"><table><thead><tr><th><strong>Field Name</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>Id</td><td>int32</td><td>4</td><td>ID of symbolic point</td></tr>
<tr><td>MachineTypeId</td><td>int32</td><td>4</td><td>For which machine type this hold information is for</td></tr>
<tr><td>DefaultReleaseLocation</td><td>int32</td><td>4</td><td>ID of default destination for hold-release. -1 if not defined</td></tr>
<tr><td>Alt1Location</td><td>int32</td><td>4</td><td>ID of first alternative location where AGV will be released to if default location is not available. -1 if not defined</td></tr>
<tr><td>Alt2Location</td><td>int32</td><td>4</td><td>ID of second alternative location where AGV will be release to if first alternative is not available. -1 if not defined</td></tr>
<tr><td>Alt3Location</td><td>int32</td><td>4</td><td>ID of third alternative location where AGV will be released to if second alternative is not available. -1 if not defined</td></tr>
<tr><td>ReleaseTimeOutSecond</td><td>uint32</td><td>4</td><td>How many seconds before AGV will be automatically released from hold location. If not set = 4294967295 (uint32 max value)</td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>28</td><td>28</td></tr>
</tbody></table>
</div>
<h4 id="symbolicpointspatialinformationreply-id--340"><a class="header" href="#symbolicpointspatialinformationreply-id--340">SymbolicPointSpatialInformationReply (ID = 340)</a></h4>
<p>Message sent as reply to GetProductionAreaInformation (ID = 52). Contains spatial information of currently active symbolic points.</p>
<p>Available from Navithor server versions 2.21.0.0 onwards.</p>
<div class="table-wrapper"><table><thead><tr><th><strong>Field Name</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>Frame</td><td>header</td><td>9</td><td>Every message has a frame that consists of the same data</td></tr>
<tr><td>NumberOfEntries</td><td>uint16</td><td>2</td><td>How many SymbolicPointSpatialInformation data structures are included</td></tr>
<tr><td>Information</td><td>SymbolicPoint<br>SpatialInformation[]</td><td>NumberOfEntries * SymbolicPoint<br>SpatialInformation length</td><td>Symbolic point spatial information</td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Frame Length</strong></th><th><strong>Data Length</strong></th><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>9</td><td>2 + structs</td><td>11</td><td>65535</td></tr>
</tbody></table>
</div>
<p><strong>SymbolicPointSpatialInformation</strong></p>
<p>Symbolic point spatial information.</p>
<div class="table-wrapper"><table><thead><tr><th><strong>Field Name</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>Id</td><td>int32</td><td>4</td><td>ID of symbolic point</td></tr>
<tr><td>X</td><td>double</td><td>8</td><td>X coordinate of symbolic point</td></tr>
<tr><td>Y</td><td>double</td><td>8</td><td>Y coordinate of symbolic point</td></tr>
<tr><td>Z</td><td>double</td><td>8</td><td>Z coordinate of symbolic point  Not in use</td></tr>
<tr><td>Level</td><td>int32</td><td>4</td><td>Which level/floor this symbolic point is located at. Not in use</td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>32</td><td>32</td></tr>
</tbody></table>
</div>
<h4 id="resourcetypeinformationreply-id--341"><a class="header" href="#resourcetypeinformationreply-id--341">ResourceTypeInformationReply (ID = 341)</a></h4>
<p>Message sent as reply to GetProductionAreaInformation (ID = 52). Contains information about currently active resource types.</p>
<p>Available from Navithor server versions 2.21.0.0 onwards.</p>
<div class="table-wrapper"><table><thead><tr><th><strong>Field Name</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>Frame</td><td>header</td><td>9</td><td>Every message has a frame that consists of the same data</td></tr>
<tr><td>NumberOfEntries</td><td>uint16</td><td>2</td><td>How many ResourceTypeInformation data structures are included</td></tr>
<tr><td>Information</td><td>ResourceType<br />Information[]</td><td>NumberOfEntries * ResourceTypeInformation length</td><td>Resource type information</td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Frame Length</strong></th><th><strong>Data Length</strong></th><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>9</td><td>2 + structs</td><td>11</td><td>65535</td></tr>
</tbody></table>
</div>
<p><strong>ResourceTypeInformation</strong></p>
<p>Resource type information.</p>
<div class="table-wrapper"><table><thead><tr><th><strong>Field Name</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>Id</td><td>int32</td><td>4</td><td>ID of resource type</td></tr>
<tr><td>NameStringLength</td><td>uint16</td><td>2</td><td>Length of name</td></tr>
<tr><td>Name</td><td>string</td><td>0...50</td><td>Name of resource type</td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>6</td><td>56</td></tr>
</tbody></table>
</div>
<h4 id="resourcetypeoffsetinformationreply-id--342"><a class="header" href="#resourcetypeoffsetinformationreply-id--342">ResourceTypeOffsetInformationReply (ID = 342)</a></h4>
<p>Message sent as reply to GetProductionAreaInformation (ID = 52). Contains offset information of currently active resource types.</p>
<p>Available from Navithor server versions 2.21.0.0 onwards.</p>
<div class="table-wrapper"><table><thead><tr><th><strong>Field Name</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>Frame</td><td>header</td><td>9</td><td>Every message has a frame that consists of the same data</td></tr>
<tr><td>NumberOfOffsetEntries</td><td>uint16</td><td>2</td><td>How many MESResourceTypeOffsetInformation data structures are included</td></tr>
<tr><td>Information</td><td>MESResourceType<br>OffsetInformation[]</td><td>NumberOfOffsetEntries * MESResourceType<br>OffsetInformation length</td><td>Resource type offset information</td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Frame Length</strong></th><th><strong>Data Length</strong></th><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>9</td><td>2 + structs</td><td>11</td><td>65535</td></tr>
</tbody></table>
</div>
<p><strong>MESResourceTypeOffsetInformation</strong></p>
<p>Resource type offset information.</p>
<div class="table-wrapper"><table><thead><tr><th><strong>Field Name</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>Id</td><td>int32</td><td>4</td><td>ID of resource type</td></tr>
<tr><td>AppliesForMachineType</td><td>int32</td><td>4</td><td>ID of machine type these offsets are for</td></tr>
<tr><td>OffsetX</td><td>double</td><td>8</td><td>X offset</td></tr>
<tr><td>OffsetY</td><td>double</td><td>8</td><td>Y offset</td></tr>
<tr><td>OffsetZ</td><td>double</td><td>8</td><td>Z offset. Not used</td></tr>
<tr><td>RotationX</td><td>double</td><td>8</td><td>Rotation around X axis. Not used</td></tr>
<tr><td>RotationY</td><td>double</td><td>8</td><td>Rotation around Y axis Not used</td></tr>
<tr><td>RotationZ</td><td>double</td><td>8</td><td>Rotation around Z axis</td></tr>
<tr><td>ScaleX</td><td>double</td><td>8</td><td>Scale on X axis</td></tr>
<tr><td>ScaleY</td><td>double</td><td>8</td><td>Scale on Y axis</td></tr>
<tr><td>ScaleZ</td><td>double</td><td>8</td><td>Scale on Z axis</td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>80</td><td>80</td></tr>
</tbody></table>
</div>
<h4 id="machineloadcapacityinformationreply-id--343"><a class="header" href="#machineloadcapacityinformationreply-id--343">MachineLoadCapacityInformationReply (ID = 343)</a></h4>
<p>Message sent as reply to GetProductionAreaInformation (ID = 52). Contains load capacity information for currently active machines.</p>
<p>Available from Navithor server versions 2.21.0.0 onwards.</p>
<div class="table-wrapper"><table><thead><tr><th><strong>Field Name</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>Frame</td><td>header</td><td>9</td><td>Every message has a frame that consists of the same data</td></tr>
<tr><td>NumberOfEntries</td><td>uint16</td><td>2</td><td>How many MachineLoadCapacityInformation data structures are included</td></tr>
<tr><td>Information</td><td>Machine<br>LoadCapacityInformation[]</td><td>NumberOfEntries * Machine<br>LoadCapacityInformation length</td><td>Machine load capacity information</td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Frame Length</strong></th><th><strong>Data Length</strong></th><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>9</td><td>2 + structs</td><td>11</td><td>65535</td></tr>
</tbody></table>
</div>
<p><strong>MachineLoadCapacityInformation</strong></p>
<p>Machine load capacity information.</p>
<div class="table-wrapper"><table><thead><tr><th><strong>Field Name</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>MachineId</td><td>int32</td><td>4</td><td>ID of machine</td></tr>
<tr><td>ResourcetypeId</td><td>int32</td><td>4</td><td>ID of resource type</td></tr>
<tr><td>Capacity</td><td>int32</td><td>4</td><td>How many of given resource type AGV is allowed to carry at once</td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>12</td><td>12</td></tr>
</tbody></table>
</div>
<h4 id="symbolicpointloadcapacityinformationreply-id--344"><a class="header" href="#symbolicpointloadcapacityinformationreply-id--344">SymbolicPointLoadCapacityInformationReply (ID = 344)</a></h4>
<p>Message sent as reply to GetProductionAreaInformation (ID = 52). Contains load capacity information for currently active symbolic points.</p>
<p>Available from Navithor server versions 2.21.0.0 onwards.</p>
<div class="table-wrapper"><table><thead><tr><th><strong>Field Name</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>Frame</td><td>header</td><td>9</td><td>Every message has a frame that consists of the same data</td></tr>
<tr><td>NumberOfEntries</td><td>uint16</td><td>2</td><td>How many MachineLoadCapacityInformation data structures are included</td></tr>
<tr><td>Information</td><td>SymbolicPoint<br>LoadCapacityInformation[]</td><td>NumberOfEntries * SymbolicPoint<br>LoadCapacityInformation length</td><td>Symbolic point load capacity information</td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Frame Length</strong></th><th><strong>Data Length</strong></th><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>9</td><td>2 + structs</td><td>11</td><td>65535</td></tr>
</tbody></table>
</div>
<p><strong>SymbolicPointLoadCapacityInformation</strong></p>
<p>Symbolic point load capacity information.</p>
<div class="table-wrapper"><table><thead><tr><th><strong>Field Name</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>SymbolicPointId</td><td>int32</td><td>4</td><td>ID of symbolic point</td></tr>
<tr><td>ResourcetypeId</td><td>int32</td><td>4</td><td>ID of resource type</td></tr>
<tr><td>Capacity</td><td>int32</td><td>4</td><td>How many of given resource type symbolic point is allowed to hold at once</td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>12</td><td>12</td></tr>
</tbody></table>
</div>
<h4 id="symbolicpointresourcestatus-id--345"><a class="header" href="#symbolicpointresourcestatus-id--345">SymbolicPointResourceStatus (ID = 345)</a></h4>
<p>Reply to the RequestSPResourceStatus message (ID = 55).</p>
<p>Valid from Navithor 2.21.0.0.</p>
<p>Included since Navithor version 2.51.0.0,
if you create an empty text file <em>Navithor Server/Overrides/SendRequestFlagsInResourceStatusReply.txt</em> and reload the override files,
this message will contain <em>RequestFlags</em> field as two extra bytes after the frame. These flags match with the requested flags sent in the request this message is replying to.
In this case minimum length of the message is 15 bytes and maximum is 64015.</p>
<div class="table-wrapper"><table><thead><tr><th><strong>Field Name</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>Frame</td><td>header</td><td>9</td><td>Every message has a frame that consists of the same data</td></tr>
<tr><td>SymbolicPointCount</td><td>uint16</td><td>2</td><td>Count of for how many symbolic points the status will be returned. Maximum amount is 500.</td></tr>
<tr><td>ResourceData</td><td>MESResourceData<br>WithIdentifier[]</td><td>SymbolicPointCount * MESResourceData<br>WithIdentifier length</td><td>MESResourceDataWithIdentifier data structure</td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Frame Length</strong></th><th><strong>Data Length</strong></th><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>9</td><td>2 + structs</td><td>13</td><td>64013</td></tr>
</tbody></table>
</div>
<p><strong>MESResourceDataWithIdentifier</strong></p>
<p>MESResourceDataWithIdentifier.</p>
<div class="table-wrapper"><table><thead><tr><th><strong>Field Name</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>SymbolicPointId</td><td>uint32</td><td>4</td><td>Symbolic point ID where status was requested</td></tr>
<tr><td>SPStatus</td><td>uint16</td><td>2</td><td>Status of the symbolic point. 0 = Disabled, 1 = Enabled</td></tr>
<tr><td>NoOfResources</td><td>uint16</td><td>2</td><td>The value of this field depends on the bits enabled in the RequestFlags field of the RequestSPResourceStatus message.<br/>- Bit 3 = 0: The value is the total number of resources at the location.<br/>- Bit 3 = 1: The value is the number of items for the individual resource.</td></tr>
<tr><td>ResourceType</td><td>uint16</td><td>2</td><td>Resource type ID. Returned as 0, if no resources at SP. If multiple resource types, only the last type is returned</td></tr>
<tr><td>ResIdentifierLength</td><td>uint16</td><td>2</td><td>Length of the resource identifier. 0 if resource identifier is not defined. If multiple resource identifiers found, only the last is returned.</td></tr>
<tr><td>ResIdentifier</td><td>string</td><td>0...ResIdentifierLength</td><td>Resource identifier. Maximum length is limited to 100.</td></tr>
<tr><td>DateStringLength</td><td>uint16</td><td>2</td><td><strong>Optional field, send only if requested</strong> Length of the date string. If no resource present, length is 0, otherwise 14</td></tr>
<tr><td>ResourceCreationDate</td><td>String</td><td>0-14</td><td><strong>Optional field, send only if requested</strong>  Format: Year, month, day, hours, minutes, seconds (yyyymmddhhmmss) using 24-hour UTC time (not adjusted to local time zone). If location has multiple resources, the creation date of last resource added to the symbolic point is given.</td></tr>
<tr><td>ResourceShelf</td><td>uint16</td><td>2</td><td><strong>Optional field, send only if requested</strong>. Resource shelf index, if resource is located in rack or in resource buffer. In buffer lane, the shelf index represents the resource y-position from the ground, so that resources on the ground have shelf index 0, and if resource is stacked, it will have value 1 or higher. To be used with a requestFlag <em>AllResources</em>.</td></tr>
<tr><td>ResourceSlot</td><td>uint16</td><td>2</td><td><strong>Optional field, send only if requested</strong>. Resource slot index, if resource is located on buffer lane. Slot index 0 is closest to symbolicpoint. To be used with a requestFlag <em>AllResources</em>.</td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>12</td><td>132</td></tr>
</tbody></table>
</div>
<h4 id="trafficlightstatusrequest-id--346-1"><a class="header" href="#trafficlightstatusrequest-id--346-1">TrafficLightStatusRequest (ID = 346)</a></h4>
<p>Message is sent by Navithor to inform requested status for a trafficlight.</p>
<div class="table-wrapper"><table><thead><tr><th>Field Name</th><th>Type</th><th>Length</th><th>Description</th></tr></thead><tbody>
<tr><td>TrafficLightID</td><td>uint32</td><td>4</td><td>ID of the traffic light</td></tr>
<tr><td>GroupID</td><td>uint32</td><td>4</td><td>ID of the group containing the trafficlight</td></tr>
<tr><td>RequestedStatus</td><td>uint16</td><td>2</td><td>0 = None, 1 = Green, 2 = Yellow, 3 = Red</td></tr>
<tr><td>Priority</td><td>int16</td><td>2</td><td>Highest priority of the AGVs in queue</td></tr>
<tr><td>QueueCount</td><td>uint16</td><td>2</td><td>Amount of AGVs queued behind this light within the trafficlight distance</td></tr>
<tr><td>PassCount</td><td>uint16</td><td>2</td><td>Amount of AGVS passing the intersection that have passed this light.</td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th>Frame</th><th>Data Length</th><th>Min Length</th><th>Max Length</th></tr></thead><tbody>
<tr><td>9</td><td>16</td><td>25</td><td>25</td></tr>
</tbody></table>
</div>
<h4 id="errorsv2-id--349"><a class="header" href="#errorsv2-id--349">ErrorsV2 (ID = 349)</a></h4>
<p>This message is sent as a response to ErrorsV2 request (ID = 56).</p>
<div class="table-wrapper"><table><thead><tr><th><strong>Field Name</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>Frame</td><td>header</td><td>9</td><td>Every message has a frame that consists of the same data</td></tr>
<tr><td>NumberOfErrors</td><td>uint16</td><td>2</td><td>Max 1000 entries, or number of entries that can fit the message frame</td></tr>
<tr><td>ErrorData</td><td>ErrorDataV2[]</td><td>NumberOfErrors * ErrorDataV2 length</td><td>ErrorDataV2-struct below. Length of individual data entry will vary</td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Frame Length</strong></th><th><strong>Data Length</strong></th><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>9</td><td>2 + structs</td><td>11</td><td>65535</td></tr>
</tbody></table>
</div>
<p><strong>ErrorDataV2</strong></p>
<p>Error Data V2 struct.</p>
<div class="table-wrapper"><table><thead><tr><th><strong>Field Name</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>Id</td><td>uint16/uint32</td><td>2-4</td><td>Error ID. NOTE: <strong>Error ID is not globally unique</strong>, instead it depends on the source of the error. Meaning that error from the Supervisor can have the same ID as error from the Fleet Control.<br><strong>By default ID is sent as uint16. If MES_StatusMessageProtocolVersion is set to at least 8, ID is sent as uint32.</strong></td></tr>
<tr><td>NameStringLength</td><td>uint16</td><td>2</td><td>Length of the following Name-field. Limited by Server parameter: MESStringFieldFillMaxLen</td></tr>
<tr><td>Name</td><td>string</td><td>0...X</td><td>Error name / identifier</td></tr>
<tr><td>ErrorType</td><td>uint16</td><td>2</td><td>Unknown = 0,<br />SystemAlarm = 1,<br />EntityAlarm = 2,<br />MachineAlarm = 3,<br />SymbolicPointAlarm = 4,<br />WaypointAlarm = 5</td></tr>
<tr><td>EntityID</td><td>uint32</td><td>4</td><td>0 = not defined, otherwise tells entity ID. EntityID reflects the ID of the machine (ErrorType = 3) or symbolic point (ErrorType = 4), depending on what the errorType is. If errorType is System alarm, then EntityID is 0.</td></tr>
<tr><td>Source</td><td>byte</td><td>1</td><td>Unknown = 0,<br />FleetControl = 1,<br />Machine = 2,<br />Supervisor = 3,<br />Component = 4,<br />MES = 5</td></tr>
<tr><td>Level</td><td>byte</td><td>1</td><td>1 = warning, 2 = error, 3 = fatal error</td></tr>
<tr><td>Value</td><td>uint16</td><td>2</td><td>Error value</td></tr>
<tr><td>Priority</td><td>int16</td><td>2</td><td>Error priority</td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>16</td><td>18 + MESStringFieldFillMaxLen</td></tr>
</tbody></table>
</div>
<h4 id="elevatorrequest-id--352"><a class="header" href="#elevatorrequest-id--352">ElevatorRequest (ID = 352)</a></h4>
<p>Message is sent by Navithor to specific MES client to request <strong>ElevatorStatus</strong> (ID = 351) message or to request elevator to specific floor. Both requestTypes should be always replied with <strong>ElevatorStatus</strong> message.</p>
<p>MES Client which is responsible for controlling the specific elevator should subscribe these messages by sending <strong>MESMessageSubscription</strong> (ID = 348) message to Navithor once connection is established.</p>
<div class="table-wrapper"><table><thead><tr><th>Field Name</th><th>Type</th><th>Length</th><th>Description</th></tr></thead><tbody>
<tr><td>RequestType</td><td>uint16</td><td>2</td><td>Type of the request: 0 = status request, 1 = request to drive to given <em>RequestToFloor</em>.</td></tr>
<tr><td>ElevatorId</td><td>uint16</td><td>2</td><td>ID of the elevator (symbolic point group ID)</td></tr>
<tr><td>RequestId</td><td>uint16</td><td>2</td><td>ID of the request to distinguish different requests (currently always 0).</td></tr>
<tr><td>-</td><td>-</td><td>-</td><td>Following data is sent only if RequestType = 1.</td></tr>
<tr><td>MachineId</td><td>uint16</td><td>2</td><td>ID of the machine which is going to use elevator first.</td></tr>
<tr><td>RequestToFloor</td><td>uint16</td><td>2</td><td>Floor ID where elevator is required. ID should match to ones defined in the Navithor Tools.</td></tr>
<tr><td>MachineTargetFloor</td><td>uint16</td><td>2</td><td>Target floor ID which machine is supposed to reach. If elevator has only two levels, this can be ignored, as machine will always change the level.</td></tr>
<tr><td>Priority</td><td>uint16</td><td>2</td><td>Priority of the request, value between 1 and 7. Default value is MED priority (4).</td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th>Frame</th><th>Data Length</th><th>Min Length</th><th>Max Length</th></tr></thead><tbody>
<tr><td>9</td><td>6-14</td><td>15</td><td>23</td></tr>
</tbody></table>
</div>
<h4 id="transferrequestreply-id--356"><a class="header" href="#transferrequestreply-id--356">TransferRequestReply (ID = 356)</a></h4>
<p>Response that is sent after receiving a transfer request message to signal success of creation.</p>
<p>More specific statuses describing reason for failure may be implemented at a later date.</p>
<div class="table-wrapper"><table><thead><tr><th><strong>FieldName</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>Frame</td><td>header</td><td>9</td><td>Every message has a frame that consists of the same data</td></tr>
<tr><td>RequestID</td><td>uint32</td><td>4</td><td>ID sent by the planner in TransferRequest message to identify reply to that specific request. 0 if ID was not given.</td></tr>
<tr><td>Status</td><td>uint16</td><td>2</td><td>1 = Success,<br />2 = Failure</td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Frame Length</strong></th><th><strong>Data Length</strong></th><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>9</td><td>6</td><td>15</td><td>15</td></tr>
</tbody></table>
</div>
<h4 id="validateload-id--357"><a class="header" href="#validateload-id--357">ValidateLoad (ID = 357)</a></h4>
<p>Message is used by Fleet Control to request load verification from the MES Client (ie. WMS of the host).</p>
<p>The message includes the data fields that needs to be matched with the load to be picked up.</p>
<p>There can be multiple sources for this data, ie. MES interface or configuration file in Navithor or Navitrol/Supervisor if sent by Navitrol to Navithor.</p>
<p>Navithor expects to receive the message ValidateLoadReply (ID = 358) in response to this message.
If no reply is received, Navithor periodically once per second requests the validation again.</p>
<p>The response can either indicate success or error. A successful respond can also contain a new transfer target for the load.</p>
<div class="table-wrapper"><table><thead><tr><th><strong>Field Name</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>MessageContents</td><td>uint32</td><td>4</td><td>Bit flags of included message contents<br> 1 &lt;&lt; 0 = RequestLoadValidationWithBarcode<br>1 &lt;&lt; 1 = RackData (sent if the load is on a rack)<br> Bits 3 to 32 reserved for later use.</td></tr>
</tbody></table>
</div>
<p><strong>RequestLoadValidationWithBarcode</strong></p>
<div class="table-wrapper"><table><thead><tr><th><strong>Field Name</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>ProductionOrderID</td><td>uint32</td><td>4</td><td>OrderID, unique for each order. 0 if no linked order.</td></tr>
<tr><td>RequestingAgvID</td><td>uint16</td><td>2</td><td>ID of the AGV requesting the validation of the load.</td></tr>
<tr><td>SymbolicPointID</td><td>uint16</td><td>2</td><td>Symbolic point ID of the location of the load.</td></tr>
<tr><td>LoadTypeID</td><td>int32</td><td>4</td><td>ID of the load type.</td></tr>
<tr><td>BarcodeStringLength</td><td>uint16</td><td>2</td><td>Barcode string length.</td></tr>
<tr><td>Barcode</td><td>string</td><td>0...255</td><td>Barcode of the load. If not available, nothing is sent. Minimum length is 0, maximum 255.</td></tr>
</tbody></table>
</div>
<p><strong>RackData</strong></p>
<div class="table-wrapper"><table><thead><tr><th><strong>Field Name</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>ShelfId</td><td>uint16</td><td>2</td><td>Shelf ID of the pickup location.</td></tr>
<tr><td>RackIdLength</td><td>uint16</td><td>2</td><td>Length of the rack identifier. 0 if no rack ID given.</td></tr>
<tr><td>RackId</td><td>string</td><td>0...255</td><td>Rack identifier, max 255 chars. Sent if the pickup location has any rack ID defined.</td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Frame Length</strong></th><th><strong>Data Length</strong></th><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>9</td><td>4 + Packet Lengths</td><td>13</td><td>541</td></tr>
</tbody></table>
</div>
<h3 id="message-acknowledgement"><a class="header" href="#message-acknowledgement">Message acknowledgement</a></h3>
<p>These messages can be sent either end of the communication to verify message receival. Navithor replies with message ID = 200 to all successfully parsed messages.</p>
<h4 id="ackorreject-id--200"><a class="header" href="#ackorreject-id--200">AckOrReject (ID = 200)</a></h4>
<p>This message can be sent either by Navithor or MES Client as a reply to all received messages. Navithor sends automatically AckOrReject (acknowledging) after receiving a correctly formatted message. Navithor can still later send another AckOrReject-message (rejecting) in case the received message cannot be fulfilled for some reason. In case MES Client does not receive an AckOrReject-message after successfully sending a message to Navithor, then the message data is not in correct format or network is blocking the message.</p>
<div class="table-wrapper"><table><thead><tr><th><strong>Field Name</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>Frame</td><td>header</td><td>9</td><td>Every message has a frame that consists of the same data</td></tr>
<tr><td>AckReject</td><td>byte</td><td>1</td><td>0 for Ack, 1-254 rejection reason. See section ErrorIDs for information about possible reasons for rejected message</td></tr>
<tr><td>MessageID</td><td>uint16</td><td>2</td><td>Acked/Rejected message ID</td></tr>
<tr><td>ResponseID</td><td>uint16</td><td>2</td><td>0 do not wait, 1-65535 response ID</td></tr>
<tr><td>ResponseTimeOut</td><td>uint32</td><td>4</td><td>Amount of time to wait for response (ms)</td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Frame Length</strong></th><th><strong>Data Length</strong></th><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>9</td><td>9</td><td>18</td><td>18</td></tr>
</tbody></table>
</div>
<h4 id="ackorrejrequest-id--201"><a class="header" href="#ackorrejrequest-id--201">AckOrRejRequest (ID = 201)</a></h4>
<p>This message should be send as a reply to request messages that have a RequestID-field specified. For example MES client is required to reply to RequestResourceStatusAtLocation-message with this message.</p>
<div class="table-wrapper"><table><thead><tr><th><strong>Field Name</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>Frame</td><td>header</td><td>9</td><td>Every message has a frame that consists of the same data</td></tr>
<tr><td>AckReject</td><td>byte</td><td>1</td><td>0 for Ack, 1-254 rejection reason. See section ErrorIDs for information about possible rejection reasons</td></tr>
<tr><td>MessageID</td><td>uint16</td><td>2</td><td>Acked/Rejected message ID</td></tr>
<tr><td>RequestID</td><td>uint16</td><td>2</td><td>Running ID number copied from the received request message</td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Frame Length</strong></th><th><strong>Data Length</strong></th><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>9</td><td>5</td><td>14</td><td>14</td></tr>
</tbody></table>
</div>
<h3 id="heartbeat"><a class="header" href="#heartbeat">Heartbeat</a></h3>
<p>These messages can be sent between Navithor Server and MES Clients to verify communication socket is still open. On default heartbeat is not required, but it can be activated with parameters from Navithor:</p>
<p><code>MES_HeartbeatRequired</code>: Signals whether MES communication requires periodic heartbeat messages to clients.</p>
<p><code>MES_HeartbeatInterval</code>: Interval to send heartbeat in seconds, received heartbeat is valid for three times this interval. Once heartbeat is no longer valid, MES connection will be closed to the client. <em>HeartbeatRequired</em> must be set true for this to apply.</p>
<h4 id="heartbeat-id--203"><a class="header" href="#heartbeat-id--203">Heartbeat (ID = 203)</a></h4>
<p>This is sent as a heartbeat from MES to all connected Clients. It has to be answered with message ID = 204 HeartbeatResponse, or the communication will close after a time.</p>
<div class="table-wrapper"><table><thead><tr><th><strong>Field Name</strong></th><th><strong>Type</strong></th><th><strong>Length</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>Frame</td><td>header</td><td>9</td><td>Every message has a frame that consists of the same data</td></tr>
<tr><td>NavithorStatus</td><td>uint16</td><td>2</td><td>Flags:<p></p>Bit 0: AreaOK<br/>Bit 1: DatabaseOK<br/>Bit 2: TrafficControllerOk<br/>Bit 3: AGVCommsOk<br/>All OK = 15 in decimal format</td></tr>
<tr><td>Count</td><td>uint16</td><td>2</td><td>Running index for heartbeat, starts from 0 for each Client and increases by one for each heartbeat. Each Client has its own heartbeat counter</td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th><strong>Frame Length</strong></th><th><strong>Data Length</strong></th><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>9</td><td>4</td><td>13</td><td>13</td></tr>
</tbody></table>
</div>
<h4 id="heartbeatresponse-id--204"><a class="header" href="#heartbeatresponse-id--204">HeartbeatResponse (ID = 204)</a></h4>
<p>This is sent as a reply to Heartbeat message (ID = 203). No additional data in the message.</p>
<div class="table-wrapper"><table><thead><tr><th><strong>Frame Length</strong></th><th><strong>Data Length</strong></th><th><strong>Min Length</strong></th><th><strong>Max Length</strong></th></tr></thead><tbody>
<tr><td>9</td><td>0</td><td>9</td><td>9</td></tr>
</tbody></table>
</div>
<h3 id="error-ids"><a class="header" href="#error-ids">Error IDs</a></h3>
<h4 id="rejecting-a-received-message-with-ackorreject-message"><a class="header" href="#rejecting-a-received-message-with-ackorreject-message">Rejecting a received message with AckOrReject-message</a></h4>
<p>Following error IDs can be informed to MES Client when rejecting a received message.</p>
<div class="table-wrapper"><table><thead><tr><th><strong>Error ID</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>1</td><td>Bad input</td></tr>
<tr><td>2</td><td>Resource not at the location</td></tr>
<tr><td>3</td><td>Machine was not found</td></tr>
<tr><td>4</td><td>Symbolic point with specified ID was not found</td></tr>
<tr><td>5</td><td>Database error</td></tr>
<tr><td>6</td><td>MES Client connection not found</td></tr>
<tr><td>7</td><td>Resource not valid for pickup</td></tr>
<tr><td>8</td><td>Received message not supported</td></tr>
<tr><td>9</td><td>Machine is disabled</td></tr>
<tr><td>10</td><td>Symbolic Point is disabled</td></tr>
<tr><td>11</td><td>Order is not found</td></tr>
<tr><td>12</td><td>Bad state</td></tr>
<tr><td>254</td><td>Logic error</td></tr>
</tbody></table>
</div>
<h4 id="rejecting-a-request-type-message-with-ackorrejrequest-message"><a class="header" href="#rejecting-a-request-type-message-with-ackorrejrequest-message">Rejecting a request-type message with AckOrRejRequest-message</a></h4>
<p>Following reject reasons are handled by Navithor when Navithor is sending a request-message to MES Client(s). MES Client can reject the request with following reasons in AckOrRejRequest-message:</p>
<div class="table-wrapper"><table><thead><tr><th>**Reject reason</th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>4</td><td>Request cannot be fulfilled at the moment. Postpone related order (Transfer request)</td></tr>
<tr><td>5</td><td>Request cannot be fulfilled at all. Cancel related order</td></tr>
</tbody></table>
</div>
<h2 id="building-a-data-message-in-navithor-mes-interface---example"><a class="header" href="#building-a-data-message-in-navithor-mes-interface---example">Building a data message in Navithor-MES interface - Example</a></h2>
<p>In this chapter you will find an example of communication between Navithor Server and Manufacturing Execution System (MES).
All values follow little-endian format (LSB first).
First, the overall structure is shown and then same thing byte by byte written to TCP/IP socket.</p>
<p>The example is represented with Production status message (ID = 313).
Server sends Production status message periodically.
The message includes both Frame and Message Data.</p>
<h3 id="structure"><a class="header" href="#structure">Structure</a></h3>
<div class="table-wrapper"><table><thead><tr><th></th><th>Length</th></tr></thead><tbody>
<tr><td>Frame</td><td>9</td></tr>
<tr><td>Message Data</td><td>0-65535</td></tr>
</tbody></table>
</div>
<h4 id="frame-1"><a class="header" href="#frame-1">Frame</a></h4>
<div class="table-wrapper"><table><thead><tr><th>Field</th><th>Type</th><th>Length (bytes)</th><th>Value</th><th>Description</th></tr></thead><tbody>
<tr><td>ID</td><td>uint16</td><td>2</td><td>0-65535</td><td>Message ID</td></tr>
<tr><td>Sender ID</td><td>uint16</td><td>2</td><td>0-65535</td><td>Unique ID of the sender</td></tr>
<tr><td>Receiver ID</td><td>uint16</td><td>2</td><td>0 Any, 1-65535 receiver ID</td><td>Unique ID of the receiver</td></tr>
<tr><td>Message type</td><td>byte</td><td>1</td><td>1 reply needed, 2 reply not needed</td><td>Tells if the message needs to be replied</td></tr>
<tr><td>Data length</td><td>uint16</td><td>2</td><td>0-65535</td><td>Message data length in bytes (0 means that no other data than frame is sent)</td></tr>
</tbody></table>
</div>
<h4 id="message-data-1"><a class="header" href="#message-data-1">Message Data</a></h4>
<div class="table-wrapper"><table><thead><tr><th>Field Name</th><th>Type</th><th>Length</th><th>Description</th></tr></thead><tbody>
<tr><td>numberOfProductionOrders</td><td>uint16</td><td>2</td><td>Number of ProductionOrderData-structures in this message. Max 200</td></tr>
<tr><td>ProductionOrderData</td><td>ProductionOrderData[]</td><td>numberOfProductionOrders * ProductionOrderData length</td><td>Production Order Data structure below</td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th>Frame Length</th><th>Data Length</th><th>Min Length</th><th>Max Length</th></tr></thead><tbody>
<tr><td>9</td><td>2 + structs</td><td>11</td><td>44411</td></tr>
</tbody></table>
</div>
<p><strong>Production Order Data</strong></p>
<p>Production order data struct containing information from a single production order.</p>
<div class="table-wrapper"><table><thead><tr><th>Field Name</th><th>Type</th><th>Length</th><th>Description</th></tr></thead><tbody>
<tr><td>NameStringLength</td><td>uint16</td><td>2</td><td>Max 200 characters</td></tr>
<tr><td>Name</td><td>string</td><td>0...200</td><td>Production Order Name</td></tr>
<tr><td>Id</td><td>uint32</td><td>4</td><td>Production order ID</td></tr>
<tr><td>TargetSymbol</td><td>int32</td><td>4</td><td></td></tr>
<tr><td>AssignedToMachineId</td><td>uint16</td><td>2</td><td>0 if not assigned, machine ID if assigned machine</td></tr>
<tr><td>PickupSymbol</td><td>int32</td><td>4</td><td>-1 if no pickup symbol</td></tr>
<tr><td>ItemTypeToDeliver</td><td>int32</td><td>4</td><td>-1 if no items</td></tr>
<tr><td>CurrentStatus</td><td>byte</td><td>1</td><td>new_order = 0, loaded = 1, waiting = 2, executing = 3, interrupted = 4, completed = 5, cancelled = 6, paused = 7</td></tr>
<tr><td>ExecutionStatus</td><td>byte</td><td>1</td><td>none = 0, drive to load = 1, at load = 2, loading = 3, loaded = 4, driving to target = 5, at target = 6, unloading = 7, unloaded = 8, at hold = 9</td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th>Min Length</th><th>Max Length</th></tr></thead><tbody>
<tr><td>22</td><td>222</td></tr>
</tbody></table>
</div>
<h3 id="byte-by-byte"><a class="header" href="#byte-by-byte">Byte by byte</a></h3>
<p>The message example is represented with the following structure:</p>
<pre><code>&lt;Index of byte value in message&gt; : &lt;Byte value in HEX&gt;    Description
</code></pre>
<p>Empty lines are used to differentiate each item/variable in the message.</p>
<p><strong>Production status (Frame + MessageData):</strong></p>
<pre><code>00 : 39
01 : 01    Message ID = 313

02 : E8
03 : 03    Sender ID = 1000

04 : E9
05 : 03    Receiver ID = 1001

06 : 01    Message type = 1 (this can be ignored)

07 : 23 	 
08 : 00    Data Length = 36 bytes

09 : 01 	
10 : 00    Number of production orders = 1

11 : 0C 	
12 : 00    Name string length = 12

13 : 4D    'M'
14 : 61    'a'
15 : 6E    'n'
16 : 75    'u'
17 : 61    'a'
18 : 6C    'l'
19 : 20    ' '
20 : 6F    'o'
21 : 72    'r'
22 : 64    'd'
23 : 65    'e'
24 : 72    'r' (Production Order Name = &quot;Manual order&quot;)

25 : D9
26 : 80
27 : 00
28 : 00    Production order ID = 32985

29 : 13
30 : 00
31 : 00
32 : 00    Target symbol = 19

33 : F5
34 : 06    Assigned to machine ID = 1781

35 : FF
36 : FF
37 : FF
38 : FF    Pickup symbol = -1 (no pickup symbol target)

39 : FF
40 : FF
41 : FF
42 : FF    Item type to deliver = -1 (no items)

43 : 03    Current status = 3 (executing)

44 : 05    Execution status = 5 (driving to target)
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="http-api"><a class="header" href="#http-api">HTTP API</a></h1>
<p>This document contains information on how to configure and use the Navithor HTTP Rest API.</p>
<p>Updated 14.10.2022</p>
<h2 id="version-history-42"><a class="header" href="#version-history-42">Version History</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Version</th><th>Date</th><th>Author</th><th>Change</th></tr></thead><tbody>
<tr><td>1.0</td><td>07.12.2021</td><td>Tero Laakso</td><td>First version of the API</td></tr>
<tr><td>1.1</td><td>04.02.2022</td><td>Tero Laakso-Pitkäkoski</td><td>Navithor Server.exe configuration moved to ServerSettings.json</td></tr>
<tr><td>1.2</td><td>14.02.2022</td><td>Tero Laakso-Pitkäkoski</td><td>Header levels changed, document main header changed</td></tr>
<tr><td>1.3</td><td>23.05.2022</td><td>Tero Laakso-Pitkäkoski</td><td>CORS parameter description added</td></tr>
<tr><td>1.4</td><td>14.10.2022</td><td>Aleksi Ålander</td><td>Extended the API with new messages</td></tr>
</tbody></table>
</div>
<hr />
<h2 id="general-api-information"><a class="header" href="#general-api-information">General API information</a></h2>
<p>HTTP API is a software interface designed to provide an easy way to control and to gain data from the fleet control system. It serves as an alternative for Navithor MES interface, with a purpose to ease the integration to high level production systems and custom user interfaces. Communication is using HTTP protocol and messages are in JSON format, making them easy to compose and parse with almost any programming language or by human. Basic understanding of these technologies is expected in this documentation.</p>
<h2 id="server-configuration"><a class="header" href="#server-configuration">Server configuration</a></h2>
<p>The API has to be enabled before it can be accessed. Interface is also bundled with Navithor Web Client license, the license file has to provided by Navitec before the API can be used.</p>
<p>To enable API, change the <strong>UseWebServer</strong> option to <strong>true</strong> in <strong>ConfigFiles/ServerSettings.json</strong>. <strong>UseHttps</strong> can be set to <strong>true</strong> if secure communication is desired. Secure communication requires certificates to be installed. HTTP API uses the same communication certificates as the Web Client, setting up those certificates is described in ** Setting up Web server to enable Web client** document. Although in production environment the secure communication in encouraged, integration to the API is usually easier to start without secure communication enabled. Server has to be restarted after the settings have been changed. The API will start responding soon after the server is up.</p>
<h3 id="cross-origin-resource-sharing-cors"><a class="header" href="#cross-origin-resource-sharing-cors">Cross-Origin Resource Sharing (CORS)</a></h3>
<p>When implementing a custom web application that uses HTTP API, server has to allow the application to communicate with it even when the application is not hosted by the server. This mechanism is called CORS and it can be enabled through <strong>ConfigFiles/ServerSettings.json</strong> by setting <strong>AllowCors</strong> option to <strong>true</strong>.</p>
<h2 id="http-verbs-and-headers"><a class="header" href="#http-verbs-and-headers">HTTP verbs and headers</a></h2>
<p>When making requests to the API four different information types has to be defined by the requesting client. Client has to define the HTTP verb used, this API only uses two of those: <strong>GET</strong> for only receiving info from the server, and <strong>POST</strong> for making the requests to change the state of the system. API path specification section describes a verb for each message.</p>
<p>URL path is the second information that has to be filled by the client application. URL format is the same that is used in web browsing, only difference is the port that has to be manually defined. When requesting version information of the server configured with default settings, and running on same host as the requesting client, url path would look like this: 'http://localhost:1234/api/GetVersion'.</p>
<p>Headers are a way to provide parameters as a part of the HTTP request. As JSON is the format supported by Navithor in the HTTP body to both directions, <strong>Content-type: application/json</strong> header is expected to be given in every request. The other header expected depends on the authentication method used, those methods are described in following sections.</p>
<p>HTTP body is the field used to provide path specific request parameters for the server. The same body also contains response message created by the server. In all cases body follows the JSON format, and all the information expected in the requests and to be expected in the responses is documented in <strong>API path specification</strong> section.</p>
<h2 id="authentication"><a class="header" href="#authentication">Authentication</a></h2>
<p>Using the API paths requires always authentication. There are two methods for authentication:</p>
<ul>
<li>Username and password authentication (Basic)</li>
<li>API Key authentication</li>
</ul>
<p>API key authentication is the recommended way to ensure the client application is authorized as it is the most simple approach.</p>
<h3 id="api-key"><a class="header" href="#api-key">API key</a></h3>
<p>API key authentication is based on fixed HTTP header provided when making requests to the API. Multiple keys can be configured to the system. Keys are configured in the file located in <strong>ConfigFiles/ServerSettings.json</strong> found in Fleet control installation folder. File with default values is created on first server execution. <strong>RestApiKeys</strong> key is used to define an array of key strings.</p>
<p>HTTP requests should contain the header <strong>ApiKey</strong> with value matching with one of the values defined in <strong>ServerSettings.json</strong>.</p>
<h3 id="authentication-with-username-and-password"><a class="header" href="#authentication-with-username-and-password">Authentication with username and password</a></h3>
<p>This authentication method makes it possible to authenticate using the same user accounts that are used to login to Fleet control clients (Navithor Client and Web Client). For that purpose there is a specific '/api/token' path. To that path client should POST a form with following text parameters: <strong>username</strong>, <strong>password</strong> and <strong>grant_type</strong>. grant_type should always have value <strong>password</strong>, and the user information has to match with server login credentials. <strong>Content-Type</strong> header also should have value <strong>application/x-www-form-urlencoded</strong>. The following screen capture will show the example with default user credentials.</p>
<p><img src="./Images/HttpApi/TokenPost.png" alt="" /></p>
<blockquote>
<p>Figure: Toke successfully requested</p>
</blockquote>
<p>The string token received with <strong>access_token</strong> should be then set as value for <strong>Authorization</strong> header in the requests to the API. Note that the token has an expiration time after which a new token has to be requested.</p>
<h2 id="api-specification-for-general-messages"><a class="header" href="#api-specification-for-general-messages">API specification for general messages</a></h2>
<h3 id="fleet-control-software-version"><a class="header" href="#fleet-control-software-version">Fleet control software version</a></h3>
<p>Get version information of server.</p>
<p><strong>URL</strong> : <code>/api/GetVersion</code></p>
<p><strong>Method</strong> : <code>GET</code></p>
<h4 id="success-response"><a class="header" href="#success-response">Success Response</a></h4>
<p><strong>Code</strong> : <code>200 OK</code></p>
<p><strong>Response example</strong></p>
<pre><code class="language-json">{
    &quot;Major&quot;: 2,
    &quot;Minor&quot;: 23,
    &quot;Build&quot;: 0,
    &quot;Revision&quot;: 0
}
</code></pre>
<h3 id="request-server-to-save-logs"><a class="header" href="#request-server-to-save-logs">Request server to save logs</a></h3>
<p>Request server to save logs. Request can optionally include a description that is included with the log package and machine names. If machines are defined, server tries to get the AGV specific logs from them.</p>
<p><strong>URL</strong> : <code>/api/DumpLogs</code></p>
<p><strong>Method</strong> : <code>POST</code></p>
<p><strong>Request body parameters</strong></p>
<pre><code class="language-json">{
    &quot;machineNames&quot;: &quot;array of strings: Names of the machines - optional&quot;,
    &quot;description&quot;: &quot;string: Reason why the logs were requested to be saved - optional&quot;
}
</code></pre>
<p><strong>Request body example</strong></p>
<pre><code class="language-json">{
    &quot;machineNames&quot;: [&quot;AGV 1&quot;, &quot;AGV 2&quot;],
    &quot;description&quot;: &quot;AGVs are having problems with XX&quot;
</code></pre>
<h4 id="success-response-1"><a class="header" href="#success-response-1">Success Response</a></h4>
<p><strong>Code</strong> : <code>200 OK</code></p>
<p><strong>Response body example</strong></p>
<p>Value of <strong>success</strong> indicates if request to save logs was successfully received.</p>
<pre><code class="language-json">{
    &quot;success&quot;: true
}
</code></pre>
<h3 id="get-area-data"><a class="header" href="#get-area-data">Get area data</a></h3>
<p>Get area data of given machine type.</p>
<p><strong>URL</strong> : <code>/api/GetAreas</code></p>
<p><strong>Method</strong> : <code>GET</code></p>
<p><strong>Request body parameters</strong></p>
<pre><code class="language-json">{
    &quot;machineType&quot;: &quot;string: Machine type name&quot;
}
</code></pre>
<p><strong>Request body example</strong></p>
<pre><code class="language-json">{
    &quot;machineType&quot;: &quot;Omni_demo&quot;
}
</code></pre>
<h4 id="success-response-2"><a class="header" href="#success-response-2">Success Response</a></h4>
<p><strong>Code</strong> : <code>200 OK</code></p>
<p><strong>Response body example</strong></p>
<pre><code class="language-json">{
    &quot;AreaName&quot;: &quot;string: Name of the area&quot;,
    &quot;AreaVersion&quot;: &quot;number: Version number of the area&quot;,
    &quot;Level&quot;: &quot;number: Level id of the area&quot;,
    &quot;Coordinates&quot;: &quot;list of points: Coordinates of the area's outside edges&quot;,
        &quot;x&quot;: &quot;decimal: X-coordinate&quot;,
        &quot;y&quot;: &quot;decimal: Y-coordinate&quot;,
    &quot;Zones&quot;: &quot;list of zones: Zones configured in the area&quot;,
       &quot;Name&quot;: &quot;string: Name of the zone&quot;,
       &quot;Coordinates&quot;: &quot;list of points: Points of the edges of the polygon&quot;,
            &quot;x&quot;: &quot;decimal: X-coordinate&quot;,
            &quot;y&quot;: &quot;decimal: Y-coordinate&quot;,
        &quot;ZoneID&quot;: &quot;number: ID of the zone&quot;,
        &quot;Configurations&quot;: &quot;list of decimals: Values for zone configuration&quot;
}
</code></pre>
<h3 id="get-environment-points"><a class="header" href="#get-environment-points">Get environment points</a></h3>
<p>Get environment points of given machine type.</p>
<p><strong>URL</strong> : <code>/api/GetEnvironmentPoints</code></p>
<p><strong>Method</strong> : <code>GET</code></p>
<p><strong>Request body parameters</strong></p>
<pre><code class="language-json">{
    &quot;machineType&quot;: &quot;string: Machine type name&quot;,
}
</code></pre>
<p><strong>Request body example</strong></p>
<pre><code class="language-json">{
    &quot;machineType&quot;: &quot;Omni_demo&quot;
}
</code></pre>
<h4 id="success-response-3"><a class="header" href="#success-response-3">Success Response</a></h4>
<p><strong>Code</strong> : <code>200 OK</code></p>
<p><strong>Response body example</strong></p>
<pre><code class="language-json">{
    &quot;Coordinates&quot;: &quot;list of points: Represents the static environment points of the area&quot;,
        &quot;x&quot;: &quot;decimal: X-coordinate of the envrionment point&quot;,
        &quot;y&quot;: &quot;decimal: Y-coordinate of the envrionment point&quot;,
    &quot;MinX&quot;: &quot;decimal: Minimum X-value of all environment points&quot;,
    &quot;MaxX&quot;: &quot;decimal: Maximum X-value of all environment points&quot;,
    &quot;MinY&quot;: &quot;decimal: Minimum Y-value of all environment points&quot;,
    &quot;MinY&quot;: &quot;decimal: Maximum Y-value of all environment points&quot;,
}
</code></pre>
<h3 id="get-zones-of-the-area"><a class="header" href="#get-zones-of-the-area">Get zones of the area</a></h3>
<p>Get all zones congfigured for the area.</p>
<p><strong>URL</strong> : <code>/api/GetEnvironmentZones</code></p>
<p><strong>Method</strong> : <code>GET</code></p>
<h4 id="success-response-4"><a class="header" href="#success-response-4">Success Response</a></h4>
<p><strong>Code</strong> : <code>200 OK</code></p>
<p><strong>Response body example</strong></p>
<pre><code class="language-json">{
    &quot;ZoneResults&quot;: &quot;list of ZoneResults: Zones configured in the area&quot;,
       &quot;Name&quot;: &quot;string: Name of the zone&quot;,
       &quot;Coordinates&quot;: &quot;list of points: Points of the edges of the polygon&quot;,
            &quot;x&quot;: &quot;float: X-coordinate&quot;,
            &quot;y&quot;: &quot;float: Y-coordinate&quot;,
        &quot;ZoneType&quot;: &quot;number: Type of the zone&quot;,
        &quot;ZoneID&quot;: &quot;number: ID of the zone&quot;,
        &quot;Configurations&quot;: &quot;list of doubles: Values for zone configuration&quot;
}
</code></pre>
<h2 id="api-specification-for-agvs"><a class="header" href="#api-specification-for-agvs">API specification for AGVs</a></h2>
<h3 id="agv-position-initialization"><a class="header" href="#agv-position-initialization">AGV position initialization</a></h3>
<p>Initialize the position of the AGV to given location.</p>
<p><strong>URL</strong> : <code>/api/InitializePosition</code></p>
<p><strong>Method</strong> : <code>POST</code></p>
<p><strong>Request body parameters</strong></p>
<pre><code class="language-json">{
    &quot;machineId&quot;: &quot;number: identification number integer&quot;,
    &quot;x&quot;: &quot;number: X coordinate&quot;,
    &quot;y&quot;: &quot;number: Y coordinate&quot;,
    &quot;heading&quot;: &quot;number: AGV heading in radians&quot;
}
</code></pre>
<p><strong>Request body example</strong></p>
<pre><code class="language-json">{
    &quot;machineId&quot;: 2,
    &quot;x&quot;: 4,
    &quot;y&quot;: 12.2,
    &quot;heading&quot;: 3.13}
</code></pre>
<h4 id="success-response-5"><a class="header" href="#success-response-5">Success Response</a></h4>
<p><strong>Code</strong> : <code>200 OK</code></p>
<p><strong>Response body example</strong></p>
<p>Value of <strong>success</strong> indicates if position initialization message was successfully delivered to AGV. It does not guarantee that position was accepted as a valid position.</p>
<pre><code class="language-json">{
    &quot;success&quot;: true
}
</code></pre>
<h3 id="change-agv-production-status"><a class="header" href="#change-agv-production-status">Change AGV production status</a></h3>
<p>Take machines into production, or out of production.</p>
<p><strong>URL</strong> : <code>/api/TakeMachineIntoProduction</code> - To take machine into production</p>
<p><strong>URL</strong> : <code>/api/TakeMachineOutOfProduction</code> - To take machine out of production</p>
<p><strong>Method</strong> : <code>POST</code></p>
<p><strong>Request body parameters</strong></p>
<pre><code class="language-json">{
    &quot;machineIds&quot;: &quot;array of numbers: identification number integers. null value will control the production status of the complete enabled fleet&quot;,
}
</code></pre>
<p><strong>Request body example</strong></p>
<pre><code class="language-json">{
    &quot;machineIds&quot;: [5],
}
</code></pre>
<h4 id="success-response-6"><a class="header" href="#success-response-6">Success Response</a></h4>
<p><strong>Code</strong> : <code>200 OK</code></p>
<p><strong>Response body example</strong></p>
<p>Value of <strong>success</strong> indicates if AGVs with given ID(s) were found and could be taken into production, or released from production.</p>
<pre><code class="language-json">{
    &quot;success&quot;: true
}
</code></pre>
<h3 id="enable-and-disable-agv"><a class="header" href="#enable-and-disable-agv">Enable and disable AGV</a></h3>
<p>Change the AGV state to enabled or to disabled.</p>
<p><strong>URL</strong> : <code>/api/EnableMachine</code> - To enable</p>
<p><strong>URL</strong> : <code>/api/DisableMachine</code> - To disable</p>
<p><strong>Method</strong> : <code>POST</code></p>
<p><strong>Request body parameters</strong></p>
<pre><code class="language-json">{
    &quot;machineId&quot;: &quot;number: identification number integer&quot;,
}
</code></pre>
<p><strong>Request body example</strong></p>
<pre><code class="language-json">{
    &quot;machineId&quot;: 5,
}
</code></pre>
<h4 id="success-response-7"><a class="header" href="#success-response-7">Success Response</a></h4>
<p><strong>Code</strong> : <code>200 OK</code></p>
<p><strong>Response body example</strong></p>
<p>Value of <strong>success</strong> indicates if AGV with the given ID was found and the vehicle state was changed to enabled or disabled.</p>
<pre><code class="language-json">{
    &quot;success&quot;: true
}
</code></pre>
<h4 id="failure-response"><a class="header" href="#failure-response">Failure Response</a></h4>
<p><strong>Code</strong> : <code>400 BadRequest</code></p>
<p><strong>Response body example</strong></p>
<p>Machine with given ID was not found.</p>
<pre><code class="language-json">{
    &quot;success&quot;: false
}
</code></pre>
<h3 id="release-agv-from-hold-at-location"><a class="header" href="#release-agv-from-hold-at-location">Release AGV from hold at location</a></h3>
<p>Releases machine currently in hold state at given symbolic point to the given target symbolic point.</p>
<p><strong>URL</strong> : <code>/api/ReleaseHold</code></p>
<p><strong>Method</strong> : <code>POST</code></p>
<p><strong>Request body parameters</strong></p>
<pre><code class="language-json">{
    &quot;fromId&quot;: &quot;number: Identification of symbolic point AGV is released from&quot;,
    &quot;targetId&quot;: &quot;number: Identification of target symbolic point&quot;
}
</code></pre>
<p><strong>Request body example</strong></p>
<pre><code class="language-json">{
    &quot;fromId&quot;: 1008,
    &quot;targetId&quot;: 1009
}
</code></pre>
<h4 id="success-response-8"><a class="header" href="#success-response-8">Success Response</a></h4>
<p><strong>Code</strong> : <code>200 OK</code></p>
<p><strong>Response body example</strong></p>
<p>Currently with all the parameters defined the response is always <strong>true</strong>.</p>
<pre><code class="language-json">{
    &quot;success&quot;: true
}
</code></pre>
<h4 id="failure-response-1"><a class="header" href="#failure-response-1">Failure Response</a></h4>
<p><strong>Code</strong> : <code>400 BadRequest</code></p>
<p><strong>Response body example</strong></p>
<p>Parameters missing.</p>
<pre><code class="language-json">{
    &quot;success&quot;: false
}
</code></pre>
<h3 id="release-agv-from-stop-and-hold-location"><a class="header" href="#release-agv-from-stop-and-hold-location">Release AGV from stop-and-hold location</a></h3>
<p>Releases given AGV from stop-and-hold state (if Navitrol allows this!). Note that stop-and-hold symbolic point has different behaviour than a normal symbolic point, that has hold-rule enabled. Refer to other documentation to understand the different use cases.</p>
<p><strong>URL</strong> : <code>/api/ReleaseStopAndHold</code></p>
<p><strong>Method</strong> : <code>POST</code></p>
<p><strong>Request body parameters</strong></p>
<pre><code class="language-json">{
    &quot;machineName&quot;: &quot;string: AGV name&quot;,
}
</code></pre>
<p><strong>Request body example</strong></p>
<pre><code class="language-json">{
    &quot;machineName&quot;: &quot;AGV 1&quot;,
}
</code></pre>
<h4 id="success-response-9"><a class="header" href="#success-response-9">Success Response</a></h4>
<p><strong>Code</strong> : <code>200 OK</code></p>
<p><strong>Response body example</strong></p>
<p><strong>success</strong> value indicates if request for the release stop-and-hold was received.</p>
<pre><code class="language-json">{
    &quot;success&quot;: true
}
</code></pre>
<h3 id="set-resource-status-at-agv"><a class="header" href="#set-resource-status-at-agv">Set resource status at AGV</a></h3>
<p>Set resource to be carried by given AGV. Setting <strong>amount</strong> value to zero will clear the resource status of the AGV.</p>
<p><strong>URL</strong> : <code>/api/ResourceAtMachine</code></p>
<p><strong>Method</strong> : <code>POST</code></p>
<p><strong>Request body parameters</strong></p>
<pre><code class="language-json">{
    &quot;machineId&quot;: &quot;number: AGV ID&quot;,
    &quot;resourceType&quot;: &quot;number: Resource type ID&quot;,
    &quot;amount&quot;: &quot;number: Number of created resources&quot;
}
</code></pre>
<p><strong>Request body example</strong></p>
<pre><code class="language-json">{
    &quot;machineId&quot;: 3,
    &quot;resourceType&quot;: 2,
    &quot;amount&quot;: 2
}
</code></pre>
<h4 id="success-response-10"><a class="header" href="#success-response-10">Success Response</a></h4>
<p><strong>Code</strong> : <code>200 OK</code></p>
<p><strong>Response body example</strong></p>
<p><strong>success</strong> value will indicate if resource was created.</p>
<pre><code class="language-json">{
    &quot;success&quot;: true
}
</code></pre>
<h3 id="drive-agv-to-a-symbolic-point"><a class="header" href="#drive-agv-to-a-symbolic-point">Drive AGV to a symbolic point</a></h3>
<p>Creates an order to drive AGV to the given symbolic point.</p>
<p><strong>URL</strong> : <code>/api/DriveToSymbol</code></p>
<p><strong>Method</strong> : <code>POST</code></p>
<p><strong>Request body parameters</strong></p>
<pre><code class="language-json">{
    &quot;machineName&quot;: &quot;string: AGV name&quot;,
    &quot;machineId&quot;: &quot;number: AGV ID&quot;,
    &quot;symbolName&quot;: &quot;string: Name of the symbolic point&quot;
}
</code></pre>
<p><strong>Request body example</strong></p>
<pre><code class="language-json">{
    &quot;machineName&quot;: &quot;AGV 1&quot;,
    &quot;machineId&quot;: 1,
    &quot;symbolName&quot;: &quot;Pickup Location 1&quot;
}
</code></pre>
<h4 id="success-response-11"><a class="header" href="#success-response-11">Success Response</a></h4>
<p><strong>Code</strong> : <code>200 OK</code></p>
<p><strong>Response body example</strong></p>
<p><strong>success</strong> value will indicate if request for the drive order was received.</p>
<pre><code class="language-json">{
    &quot;success&quot;: true
}
</code></pre>
<h3 id="drive-agv-to-xy-location"><a class="header" href="#drive-agv-to-xy-location">Drive AGV to XY-location</a></h3>
<p>Creates an order to drive AGV to the given coordinates. The given target needs to be close to a route for it to be accepted.</p>
<p><strong>URL</strong> : <code>/api/SendDriveOrder</code></p>
<p><strong>Method</strong> : <code>POST</code></p>
<p><strong>Request body parameters</strong></p>
<pre><code class="language-json">{
    &quot;machineName&quot;: &quot;string: AGV name&quot;,
    &quot;endPointX&quot;: &quot;decimal: X-coordinate of the drive target&quot;,
    &quot;endPointY&quot;: &quot;string: Y-coordinate of the drive target&quot;
}
</code></pre>
<p><strong>Request body example</strong></p>
<pre><code class="language-json">{
    &quot;machineName&quot;: &quot;AGV 1&quot;,
    &quot;endPointX&quot;: 124.503,
    &quot;endPointY&quot;: -50.234&quot;
}
</code></pre>
<h4 id="success-response-12"><a class="header" href="#success-response-12">Success Response</a></h4>
<p><strong>Code</strong> : <code>200 OK</code></p>
<p><strong>Response body example</strong></p>
<p><strong>success</strong> value will indicate if request for the drive order was received.</p>
<pre><code class="language-json">{
    &quot;success&quot;: true
}
</code></pre>
<h3 id="request-agv-to-pickup-or-dropoff-a-load"><a class="header" href="#request-agv-to-pickup-or-dropoff-a-load">Request AGV to pickup or dropoff a load</a></h3>
<p>Requests AGV to pickup (LoadMachine) or dropoff (UnloadMachine) a load. AGV has to be already at the correct location before the request.</p>
<p><strong>URL</strong> : <code>/api/LoadMachine</code> - to pickup load
<strong>URL</strong> : <code>/api/UnloadMachine</code> - to dropoff load</p>
<p><strong>Method</strong> : <code>POST</code></p>
<p><strong>Request body parameters</strong></p>
<pre><code class="language-json">{
    &quot;machineName&quot;: &quot;string: AGV name&quot;,
}
</code></pre>
<p><strong>Request body example</strong></p>
<pre><code class="language-json">{
    &quot;machineName&quot;: &quot;AGV 1&quot;,
}
</code></pre>
<h4 id="success-response-13"><a class="header" href="#success-response-13">Success Response</a></h4>
<p><strong>Code</strong> : <code>200 OK</code></p>
<p><strong>Response body example</strong></p>
<p><strong>success</strong> value will indicate if request for pickup/dropoff command was received.</p>
<pre><code class="language-json">{
    &quot;success&quot;: true
}
</code></pre>
<h3 id="request-agv-to-abort-current-action"><a class="header" href="#request-agv-to-abort-current-action">Request AGV to abort current action</a></h3>
<p>Requests AGV to abort drive order, pickup or dropoff action. In case AGV is not in correct state, request does nothing.
AbortDrive tries to abort all current tasks and takes AGV out of production.</p>
<p><strong>URL</strong> : <code>/api/AbortDrive</code> - to abort drive order (AGV is also taken out of production)
<strong>URL</strong> : <code>/api/AbortLoadMachine</code> - to abort pickup action
<strong>URL</strong> : <code>/api/AbortUnloadMachine</code> - to abort dropoff action</p>
<p><strong>Method</strong> : <code>POST</code></p>
<p><strong>Request body parameters</strong></p>
<pre><code class="language-json">{
    &quot;machineName&quot;: &quot;string: AGV name&quot;,
}
</code></pre>
<p><strong>Request body example</strong></p>
<pre><code class="language-json">{
    &quot;machineName&quot;: &quot;AGV 1&quot;,
}
</code></pre>
<h4 id="success-response-14"><a class="header" href="#success-response-14">Success Response</a></h4>
<p><strong>Code</strong> : <code>200 OK</code></p>
<p><strong>Response body example</strong></p>
<p><strong>success</strong> value will indicate if abort command was received.</p>
<pre><code class="language-json">{
    &quot;success&quot;: true
}
</code></pre>
<h3 id="request-agv-to-fstop-or-release-fstop"><a class="header" href="#request-agv-to-fstop-or-release-fstop">Request AGV to FSTOP or release FSTOP</a></h3>
<p>Requests AGV to do FSTOP triggered by a software. AGV can be released only by another release FSTOP request.</p>
<p><strong>URL</strong> : <code>/api/FSTOPMachine</code> - to FTSOP the AGV
<strong>URL</strong> : <code>/api/ReleaseFSTOPMachine</code> - to release AGV from FSTOP</p>
<p><strong>Method</strong> : <code>POST</code></p>
<p><strong>Request body parameters</strong></p>
<pre><code class="language-json">{
    &quot;machineName&quot;: &quot;string: AGV name&quot;,
}
</code></pre>
<p><strong>Request body example</strong></p>
<pre><code class="language-json">{
    &quot;machineName&quot;: &quot;AGV 1&quot;,
}
</code></pre>
<h4 id="success-response-15"><a class="header" href="#success-response-15">Success Response</a></h4>
<p><strong>Code</strong> : <code>200 OK</code></p>
<p><strong>Response body example</strong></p>
<p><strong>success</strong> value will indicate if command was received.</p>
<pre><code class="language-json">{
    &quot;success&quot;: true
}
</code></pre>
<h3 id="request-all-agvs-to-fstop"><a class="header" href="#request-all-agvs-to-fstop">Request all AGVs to FSTOP</a></h3>
<p>Requests all AGVs to do FSTOP triggered by a software. AGV can be released only by giving each of them a separate command to be released from FSTOP.</p>
<p><strong>URL</strong> : <code>/api/FSTOPAllMachines</code></p>
<p><strong>Method</strong> : <code>POST</code></p>
<h4 id="success-response-16"><a class="header" href="#success-response-16">Success Response</a></h4>
<p><strong>Code</strong> : <code>200 OK</code></p>
<p><strong>Response body example</strong></p>
<p><strong>success</strong> value will indicate if request to FSTOP all AGVs was received.</p>
<pre><code class="language-json">{
    &quot;success&quot;: true
}
</code></pre>
<h3 id="request-agv-to-return-to-route"><a class="header" href="#request-agv-to-return-to-route">Request AGV to return to route</a></h3>
<p>Requests AGV to return to route. AGV controller / navigation software is responsible for choosing the optimal trajectory back to the route.
Fleet control just gives the request to the controller.</p>
<p><strong>URL</strong> : <code>/api/ReturnToRoute</code></p>
<p><strong>Method</strong> : <code>POST</code></p>
<p><strong>Request body parameters</strong></p>
<pre><code class="language-json">{
    &quot;machineName&quot;: &quot;string: AGV name&quot;,
}
</code></pre>
<p><strong>Request body example</strong></p>
<pre><code class="language-json">{
    &quot;machineName&quot;: &quot;AGV 1&quot;,
}
</code></pre>
<h4 id="success-response-17"><a class="header" href="#success-response-17">Success Response</a></h4>
<p><strong>Code</strong> : <code>200 OK</code></p>
<p><strong>Response body example</strong></p>
<p><strong>success</strong> value will indicate if request to return AGV to route was received.</p>
<pre><code class="language-json">{
    &quot;success&quot;: true
}
</code></pre>
<h3 id="request-agv-to-go-to-charge"><a class="header" href="#request-agv-to-go-to-charge">Request AGV to go to charge</a></h3>
<p>Requests AGV to go to charge. Fleet control is responsible for checking if this is possible and choosing the charging location.</p>
<p><strong>URL</strong> : <code>/api/RequestChargingForMachine</code></p>
<p><strong>Method</strong> : <code>POST</code></p>
<p><strong>Request body parameters</strong></p>
<pre><code class="language-json">{
    &quot;machineName&quot;: &quot;string: AGV name&quot;,
}
</code></pre>
<p><strong>Request body example</strong></p>
<pre><code class="language-json">{
    &quot;machineName&quot;: &quot;AGV 1&quot;,
}
</code></pre>
<h4 id="success-response-18"><a class="header" href="#success-response-18">Success Response</a></h4>
<p><strong>Code</strong> : <code>200 OK</code></p>
<p><strong>Response body example</strong></p>
<p><strong>success</strong> value will indicate if request to take AGV to charge was received.</p>
<pre><code class="language-json">{
    &quot;success&quot;: true
}
</code></pre>
<h3 id="request-agv-to-go-to-sleep-mode"><a class="header" href="#request-agv-to-go-to-sleep-mode">Request AGV to go to sleep mode</a></h3>
<p>Requests AGV to go to sleep mode. AGV needs to support this feature, fleet control will give the request to the AGV controller.
Can be used also to give the request to the whole fleet of AGVs.</p>
<p><strong>URL</strong> : <code>/api/SleepMode</code></p>
<p><strong>Method</strong> : <code>POST</code></p>
<p><strong>Request body parameters</strong></p>
<pre><code class="language-json">{
    &quot;machineName&quot;: &quot;string: AGV name - optional&quot;,
    &quot;sleepMode&quot;: &quot;boolean: Whether to activate sleep mode (true) or to wake up the AGV from sleep (false)&quot;,
    &quot;allMachines&quot;: &quot;boolean: Whether to give the request to a single or all AGVs - optional&quot;
}
</code></pre>
<p><strong>Request body example</strong></p>
<pre><code class="language-json">{
    &quot;machineName&quot;: &quot;AGV 1&quot;,
    &quot;sleepMode&quot;: true
}
</code></pre>
<h4 id="success-response-19"><a class="header" href="#success-response-19">Success Response</a></h4>
<p><strong>Code</strong> : <code>200 OK</code></p>
<p><strong>Response body example</strong></p>
<p><strong>success</strong> value will indicate if request to take AGV to charge was received.</p>
<pre><code class="language-json">{
    &quot;success&quot;: true
}
</code></pre>
<h4 id="failure-response-2"><a class="header" href="#failure-response-2">Failure Response</a></h4>
<p><strong>Code</strong> : <code>400 BadRequest</code></p>
<p><strong>Response body example</strong></p>
<p>Request body had neither machine name defined or boolean commandAllMachines as true.</p>
<pre><code class="language-json">{
    &quot;success&quot;: false
}
</code></pre>
<h2 id="api-specification-for-order-management"><a class="header" href="#api-specification-for-order-management">API specification for order management</a></h2>
<h3 id="create-orders"><a class="header" href="#create-orders">Create orders</a></h3>
<p>Two kind of orders can be created. If AGV ID is defined in the request normal production order is created. When machine is not defined, the system will select the suitable AGV for the task. That kind of order is called transfer request. With resource defined, it is moved from pickup locations to target. By just defining target location for the AGV it is possible to order machine to the destination without a resource.</p>
<p><strong>URL</strong> : <code>/api/AddProductionOrder</code> - To create orders for specific machines, or transfer requests</p>
<p><strong>Method</strong> : <code>POST</code></p>
<p><strong>Request body parameters</strong></p>
<pre><code class="language-json">{
    &quot;machineId&quot;: &quot;number: AGV identification - optional&quot;,
    &quot;targetLocationId&quot;: &quot;number: Target symbolic point identification&quot;,
    &quot;pickupLocationId&quot;: &quot;number: Pickup location symbolic point identification - optional&quot;,
    &quot;resourceTypeId&quot;: &quot;number: Type identification of resource - optional&quot;,
    &quot;resourceCount&quot;: &quot;number: Number of resources - optional&quot;,
    &quot;targetShelfId&quot;: &quot;number: Target shelf level, -1 if target is not a shelf - optional&quot;,
    &quot;targetShelfOrientation&quot;: &quot;string: Orientation at target rack, if using a sideloader. Options: None, Left, Right - optional&quot;,
    &quot;priority&quot;: &quot;number: Priority of the order (min 1, max 8) - optional&quot;
}
</code></pre>
<p><strong>Request body example</strong></p>
<pre><code class="language-json">{
    &quot;machineId&quot;: 1,
    &quot;targetLocationId&quot;: 1009,
    &quot;pickupLocationId&quot;: 1008,
    &quot;resourceTypeId&quot;: 1,
    &quot;resourceCount&quot;: 1
}
</code></pre>
<h4 id="success-response-20"><a class="header" href="#success-response-20">Success Response</a></h4>
<p><strong>Code</strong> : <code>200 OK</code></p>
<p><strong>Response body example</strong></p>
<p>Value of <strong>result</strong> can have following numberical values:</p>
<pre><code>SUCCESS = 0,
INVALID_PICKUP_LOC = 1,
INVALID_TARGET_LOC = 2,
DATABASE_FAILURE = 3,
RESOURCE_NOT_FOUND = 4,
GENERIC_FAILURE = 5,
</code></pre>
<p><strong>createdId</strong> is a unique identification number for created order. Identification can be used to delete orders.</p>
<pre><code class="language-json">{
    &quot;result&quot;: 0,
    &quot;createdId&quot;: 9
}
</code></pre>
<h3 id="delete-any-production-order"><a class="header" href="#delete-any-production-order">Delete any production order</a></h3>
<p><strong>URL</strong> : <code>/api/DeleteProductionOrder</code> - To delete order with specified ID</p>
<p><strong>Method</strong> : <code>POST</code></p>
<p><strong>Request body parameters</strong></p>
<pre><code class="language-json">{
    &quot;orderId&quot;: &quot;number: Identification number received when creating order&quot;,
}
</code></pre>
<p><strong>Request body example</strong></p>
<pre><code class="language-json">{
    &quot;orderId&quot;: 9,
}
</code></pre>
<h4 id="success-response-21"><a class="header" href="#success-response-21">Success Response</a></h4>
<p><strong>Code</strong> : <code>200 OK</code></p>
<p><strong>Response body example</strong></p>
<p>Value of <strong>success</strong> indicates if request for production order deletion was received. </p>
<pre><code class="language-json">{
    &quot;success&quot;: true
}
</code></pre>
<h3 id="delete-transfer-request"><a class="header" href="#delete-transfer-request">Delete transfer request</a></h3>
<p><strong>URL</strong> : <code>/api/DeleteTransferRequest</code> - To delete transfer request</p>
<p><strong>Method</strong> : <code>POST</code></p>
<p><strong>Request body parameters</strong></p>
<pre><code class="language-json">{
    &quot;orderId&quot;: &quot;number: Identification number received when creating order&quot;,
}
</code></pre>
<p><strong>Request body example</strong></p>
<pre><code class="language-json">{
    &quot;orderId&quot;: 22232,
}
</code></pre>
<h4 id="success-response-22"><a class="header" href="#success-response-22">Success Response</a></h4>
<p><strong>Code</strong> : <code>200 OK</code></p>
<p><strong>Response body example</strong></p>
<p>Value of <strong>success</strong> indicates if request for transfer request deletion was received. </p>
<pre><code class="language-json">{
    &quot;success&quot;: true
}
</code></pre>
<h3 id="request-pickup-of-the-resource-at-location"><a class="header" href="#request-pickup-of-the-resource-at-location">Request pickup of the resource at location</a></h3>
<p>Fleet control is able to generate production orders based on resource pickup requests.</p>
<p><strong>URL</strong> : <code>/api/ResourcePickupRequest</code>
<strong>URL</strong> : <code>/api/RequestPickupAtSymbolicPoint</code></p>
<p><strong>Method</strong> : <code>POST</code></p>
<p><strong>Request body parameters</strong></p>
<pre><code class="language-json">{
    &quot;symbolicPointId&quot;: &quot;number: Symbolic point ID&quot;,
    &quot;shelfId&quot;: &quot;number: Rack shelf identification - optional&quot;,
    &quot;orientation&quot;: &quot;string: Target rack orientation. Options: None, Left, Right - optional&quot;
}
</code></pre>
<p><strong>Request body example</strong></p>
<pre><code class="language-json">{
    &quot;symbolicPointId&quot;: 3007
}
</code></pre>
<h4 id="success-response-23"><a class="header" href="#success-response-23">Success Response</a></h4>
<p><strong>Code</strong> : <code>200 OK</code></p>
<p><strong>Response body example</strong></p>
<p><strong>success</strong> value is always set <strong>true</strong> regardless of the resource status of the location.</p>
<pre><code class="language-json">{
    &quot;success&quot;: true
}
</code></pre>
<h3 id="pause-production-order"><a class="header" href="#pause-production-order">Pause production order</a></h3>
<p>Fleet control pauses the current order of the AGV and aborts the current drive order. The order can be later continued. AGV does not execute other orders, while the current order is paused.</p>
<p><strong>URL</strong> : <code>/api/PauseProductionOrder</code></p>
<p><strong>Method</strong> : <code>POST</code></p>
<p><strong>Request body parameters</strong></p>
<pre><code class="language-json">{
    &quot;orderId&quot;: &quot;number: Identification number received when creating order&quot;,
}
</code></pre>
<p><strong>Request body example</strong></p>
<pre><code class="language-json">{
    &quot;orderId&quot;: 10123,
}
</code></pre>
<h4 id="success-response-24"><a class="header" href="#success-response-24">Success Response</a></h4>
<p><strong>Code</strong> : <code>200 OK</code></p>
<p><strong>Response body example</strong></p>
<p>Value of <strong>success</strong> indicates if request to pause the order was received. </p>
<pre><code class="language-json">{
    &quot;success&quot;: true
}
</code></pre>
<h3 id="continue-production-order"><a class="header" href="#continue-production-order">Continue production order</a></h3>
<p>Paused order is requested to be continued. AGV continues execution of the current order that was paused.</p>
<p><strong>URL</strong> : <code>/api/ContinueProductionOrder</code></p>
<p><strong>Method</strong> : <code>POST</code></p>
<p><strong>Request body parameters</strong></p>
<pre><code class="language-json">{
    &quot;orderId&quot;: &quot;number: Identification number received when creating order&quot;,
}
</code></pre>
<p><strong>Request body example</strong></p>
<pre><code class="language-json">{
    &quot;orderId&quot;: 10123,
}
</code></pre>
<h4 id="success-response-25"><a class="header" href="#success-response-25">Success Response</a></h4>
<p><strong>Code</strong> : <code>200 OK</code></p>
<p><strong>Response body example</strong></p>
<p>Value of <strong>success</strong> indicates if request to continue the order was received. </p>
<pre><code class="language-json">{
    &quot;success&quot;: true
}
</code></pre>
<h3 id="activate-or-deactivate-production-break"><a class="header" href="#activate-or-deactivate-production-break">Activate or deactivate production break</a></h3>
<p>Fleet control either activates or deactivates production break mode based on this message. Refer to 'Production break' documentation to learn more about the feature.</p>
<p><strong>URL</strong> : <code>/api/ProductionBreakMode</code></p>
<p><strong>Method</strong> : <code>POST</code></p>
<p><strong>Request body parameters</strong></p>
<pre><code class="language-json">{
    &quot;enabled&quot;: &quot;boolean: Indicates whether production break mode should be activated&quot;,
}
</code></pre>
<p><strong>Request body example</strong></p>
<pre><code class="language-json">{
    &quot;enabled&quot;: true,
}
</code></pre>
<h4 id="success-response-26"><a class="header" href="#success-response-26">Success Response</a></h4>
<p><strong>Code</strong> : <code>200 OK</code></p>
<p><strong>Response body example</strong></p>
<p>Value of <strong>success</strong> indicates if request was successfully received. </p>
<pre><code class="language-json">{
    &quot;success&quot;: true
}
</code></pre>
<h3 id="get-status-of-production-orders"><a class="header" href="#get-status-of-production-orders">Get status of production orders</a></h3>
<p>Request status of all active production orders from the fleet control. The body does not have any parameters.</p>
<p><strong>URL</strong> : <code>/api/GetProductionOrders</code></p>
<p><strong>Method</strong> : <code>GET</code></p>
<h4 id="success-response-27"><a class="header" href="#success-response-27">Success Response</a></h4>
<p><strong>Code</strong> : <code>200 OK</code></p>
<p><strong>Response body example</strong></p>
<p>Response contains a list of active orders with following information. Below example body of one production order</p>
<pre><code class="language-json">{
    &quot;StartTime&quot;: &quot;&quot;,
    &quot;MachineName&quot;: &quot;Omni_demo 1&quot;,
    &quot;PickupLocation&quot;: null,
    &quot;ResourceName&quot;: null,
    &quot;Target&quot;: &quot;Elevator1 Door1 (17)&quot;,
    &quot;OrderStatus&quot;: &quot;waiting&quot;,
    &quot;Status&quot;: 2,
    &quot;Priority&quot;: 4,
    &quot;Description&quot;: &quot;Status set to waiting.&quot;,
    &quot;OrderName&quot;: &quot;Manual order&quot;,
    &quot;Id&quot;: 1,
    &quot;PlannerId&quot;: null,
    &quot;TakeOutOfProdAfterFinish&quot;: false,
    &quot;OrderPaused&quot;: false,
    &quot;OrderTypeId&quot;: 1,
    &quot;PlannedPickupTime&quot;: &quot;&quot;,
    &quot;PlannedDeliveryTime&quot;: &quot;&quot;,
    &quot;EstimateTotalExecutionTime&quot;: &quot;&quot;
}
</code></pre>
<h2 id="api-specification-for-symbolic-points"><a class="header" href="#api-specification-for-symbolic-points">API specification for symbolic points</a></h2>
<h3 id="disable-or-enable-symbolic-point"><a class="header" href="#disable-or-enable-symbolic-point">Disable or enable symbolic point</a></h3>
<p><strong>URL</strong> : <code>/api/EnableDisableSymbolicPoint</code></p>
<p><strong>Method</strong> : <code>POST</code></p>
<p><strong>Request body parameters</strong></p>
<pre><code class="language-json">{
    &quot;symbolicPointId&quot;: &quot;number: Symbolic point ID&quot;,
    &quot;enabled&quot;: &quot;boolean: Is enabled or not&quot;
}
</code></pre>
<p><strong>Request body example</strong></p>
<pre><code class="language-json">{
    &quot;symbolicPointId&quot;: 1008,
    &quot;enabled&quot;: true
}
</code></pre>
<h4 id="success-response-28"><a class="header" href="#success-response-28">Success Response</a></h4>
<p><strong>Code</strong> : <code>200 OK</code></p>
<p><strong>Response body example</strong></p>
<p>Request will succeed always when given symbolic point identification is a valid numeric value.</p>
<pre><code class="language-json">{
    &quot;success&quot;: true
}
</code></pre>
<h3 id="set-resource-status-at-location"><a class="header" href="#set-resource-status-at-location">Set resource status at location</a></h3>
<p>Set resource at certain location. Setting <strong>amount</strong> value to zero will clear the location.</p>
<p><strong>URL</strong> : <code>/api/ResourceAtLocation</code></p>
<p><strong>Method</strong> : <code>POST</code></p>
<p><strong>Request body parameters</strong></p>
<pre><code class="language-json">{
    &quot;symbolicPointId&quot;: &quot;number: Symbolic point ID&quot;,
    &quot;resourceType&quot;: &quot;number: Resource type ID&quot;,
    &quot;amount&quot;: &quot;number: Number of created resources&quot;,
    &quot;shelfId&quot;: &quot;number: Rack shelf identification - optional&quot;
    &quot;orientation&quot;: &quot;string: Target rack orientation. Options: None, Left, Right - optional&quot;
}
</code></pre>
<p><strong>Request body example</strong></p>
<pre><code class="language-json">{
    &quot;symbolicPointId&quot;: 1003,
    &quot;resourceType&quot;: 2,
    &quot;amount&quot;: 2,
    &quot;shelfId&quot;: -1
}
</code></pre>
<h4 id="success-response-29"><a class="header" href="#success-response-29">Success Response</a></h4>
<p><strong>Code</strong> : <code>200 OK</code></p>
<p><strong>Response body example</strong></p>
<p><strong>success</strong> value will indicate if resource was created.</p>
<pre><code class="language-json">{
    &quot;success&quot;: true
}
</code></pre>
<h3 id="report-current-door-status"><a class="header" href="#report-current-door-status">Report current door status</a></h3>
<p>Doors are special type of symbolic points, defined using Navithor Tools. To report the current status of the door, this request can be used. Refer to Navithor document &quot;Tag Statuses&quot; for configuring the doors.</p>
<p><strong>URL</strong> : <code>/api/DoorStatus</code></p>
<p><strong>Method</strong> : <code>POST</code></p>
<p><strong>Request body parameters</strong></p>
<p>Either the name or ID of the symbolic point has to be defined. Name is prioritized when both values are defined.</p>
<pre><code class="language-json">{
    &quot;symbolicPointId&quot;: &quot;number: Symbolic point ID - optional&quot;,
    &quot;SymbolicPointName&quot;: &quot;string: Symbolic point name - optional&quot;,
    &quot;doorState&quot;: &quot;number: Status of the door&quot;
}
</code></pre>
<p>Door status can have one of these values:</p>
<pre><code>offline = 0,
closed = 1,
closing = 2,
opening = 3,
open = 4,
</code></pre>
<p><strong>Request body example</strong></p>
<pre><code class="language-json">{
    &quot;symbolicPointId&quot;: 3007,
    &quot;doorState&quot;: 4
}
</code></pre>
<h4 id="success-response-30"><a class="header" href="#success-response-30">Success Response</a></h4>
<p><strong>Code</strong> : <code>200 OK</code></p>
<p><strong>Response body example</strong></p>
<p><strong>success</strong> value is always set to <strong>true</strong> when request is responded with code 200.</p>
<pre><code class="language-json">{
    &quot;success&quot;: true
}
</code></pre>
<h4 id="failure-response-3"><a class="header" href="#failure-response-3">Failure Response</a></h4>
<p><strong>Code</strong> : <code>400 BadRequest</code></p>
<p><strong>Response body example</strong></p>
<p>Request body had no symbolic point ID defined or symbolic point with the given ID does not exist in the system.</p>
<pre><code class="language-json">{
    &quot;success&quot;: false
}
</code></pre>
<h2 id="api-specification-for-resources"><a class="header" href="#api-specification-for-resources">API specification for resources</a></h2>
<h3 id="create-a-resource-to-entity"><a class="header" href="#create-a-resource-to-entity">Create a resource to entity</a></h3>
<p>Create a resource to a certain entity, which can be either a location or a machine. Setting <strong>amount</strong> value to zero will clear the entity from resources.</p>
<p><strong>URL</strong> : <code>/api/CreateResource</code></p>
<p><strong>Method</strong> : <code>POST</code></p>
<p><strong>Request body parameters</strong></p>
<pre><code class="language-json">{
    &quot;entityId&quot;: &quot;number: Entity ID that defines where the resource is set at&quot;,
    &quot;symbolicPointId&quot;: &quot;number: Symbolic point ID - optional&quot;,
    &quot;machineId&quot;: &quot;number: Machine ID - optional&quot;,
    &quot;resourceType&quot;: &quot;number: Resource type ID&quot;,
    &quot;amount&quot;: &quot;number: Number of created resources&quot;,
    &quot;shelfId&quot;: &quot;number: Rack shelf identification - optional&quot;,
    &quot;orientation&quot;: &quot;string: Target rack orientation. Options: None, Left, Right - optional&quot;,
    &quot;stackOnPrevious&quot;: &quot;boolean: Whether the new resource is stacked on top of previous resource on the entity or not - optional (default: false)&quot;
}
</code></pre>
<p><strong>Request body example</strong></p>
<pre><code class="language-json">{
    &quot;entityId&quot;: 100,
    &quot;resourceType&quot;: 2,
    &quot;amount&quot;: 2,
    &quot;shelfId&quot;: 2,
    &quot;orientation&quot;: &quot;Left&quot;
}
</code></pre>
<h4 id="success-response-31"><a class="header" href="#success-response-31">Success Response</a></h4>
<p><strong>Code</strong> : <code>200 OK</code></p>
<p><strong>Response body example</strong></p>
<p><strong>success</strong> value will indicate if resource was created.</p>
<pre><code class="language-json">{
    &quot;success&quot;: true
}
</code></pre>
<h3 id="modify-resource-type"><a class="header" href="#modify-resource-type">Modify resource type</a></h3>
<p>Modifies resource type of an existing resource in the system.</p>
<p><strong>URL</strong> : <code>/api/ModifyResourceType</code></p>
<p><strong>Method</strong> : <code>POST</code></p>
<p><strong>Request body parameters</strong></p>
<pre><code class="language-json">{
    &quot;resourceId&quot;: &quot;number: Resource ID&quot;,
    &quot;nextResourceTypeId&quot;: &quot;number: New resource type ID&quot;
}
</code></pre>
<p><strong>Request body example</strong></p>
<pre><code class="language-json">{
    &quot;resourceId&quot;: 20301,
    &quot;nextResourceTypeId&quot;: 25,
}
</code></pre>
<h4 id="success-response-32"><a class="header" href="#success-response-32">Success Response</a></h4>
<p><strong>Code</strong> : <code>200 OK</code></p>
<p><strong>Response body example</strong></p>
<p><strong>success</strong> value will indicate if resource type was modified.</p>
<pre><code class="language-json">{
    &quot;success&quot;: true
}
</code></pre>
<h3 id="modify-resource-quantity"><a class="header" href="#modify-resource-quantity">Modify resource quantity</a></h3>
<p>Modifies resource quantity of an existing resource in the system.</p>
<p><strong>URL</strong> : <code>/api/ModifyResourceQuantity</code></p>
<p><strong>Method</strong> : <code>POST</code></p>
<p><strong>Request body parameters</strong></p>
<pre><code class="language-json">{
    &quot;resourceId&quot;: &quot;number: Resource ID&quot;,
    &quot;nextResourceQuantity&quot;: &quot;number: New resource quantity&quot;
}
</code></pre>
<p><strong>Request body example</strong></p>
<pre><code class="language-json">{
    &quot;resourceId&quot;: 20301,
    &quot;nextResourceQuantity&quot;: 3,
}
</code></pre>
<h4 id="success-response-33"><a class="header" href="#success-response-33">Success Response</a></h4>
<p><strong>Code</strong> : <code>200 OK</code></p>
<p><strong>Response body example</strong></p>
<p><strong>success</strong> value will indicate if resource quantity was modified.</p>
<pre><code class="language-json">{
    &quot;success&quot;: true
}
</code></pre>
<h3 id="delete-resource"><a class="header" href="#delete-resource">Delete resource</a></h3>
<p>Removes resource from the system completely.</p>
<p><strong>URL</strong> : <code>/api/UntrackResource</code></p>
<p><strong>Method</strong> : <code>POST</code></p>
<p><strong>Request body parameters</strong></p>
<pre><code class="language-json">{
    &quot;resourceId&quot;: &quot;number: Resource ID&quot;,
}
</code></pre>
<p><strong>Request body example</strong></p>
<pre><code class="language-json">{
    &quot;resourceId&quot;: 20301,
}
</code></pre>
<h4 id="success-response-34"><a class="header" href="#success-response-34">Success Response</a></h4>
<p><strong>Code</strong> : <code>200 OK</code></p>
<p><strong>Response body example</strong></p>
<p><strong>success</strong> value will indicate if resource was deleted.</p>
<pre><code class="language-json">{
    &quot;success&quot;: true
}
</code></pre>
<h3 id="get-status-of-a-resource"><a class="header" href="#get-status-of-a-resource">Get status of a resource</a></h3>
<p>Request status of a resource from Fleet control.</p>
<p><strong>URL</strong> : <code>/api/GetResourceStatus</code></p>
<p><strong>Method</strong> : <code>GET</code></p>
<p><strong>Request body parameters</strong></p>
<pre><code class="language-json">{
    &quot;resourceId&quot;: &quot;number: Resource ID&quot;,
}
</code></pre>
<p><strong>Request body example</strong></p>
<pre><code class="language-json">{
    &quot;resourceId&quot;: 20301
}
</code></pre>
<h4 id="success-response-35"><a class="header" href="#success-response-35">Success Response</a></h4>
<p><strong>Code</strong> : <code>200 OK</code></p>
<p><strong>Response body example</strong></p>
<pre><code class="language-json">{
    &quot;ResourceId&quot;: 234,
    &quot;ResourceTypeId&quot;: 2,
    &quot;PreviousHolder&quot;: null,
    &quot;CurrentHolder&quot;: 100,
    &quot;CurrentQuantity&quot;: 1,
    &quot;Deleted&quot;: 2,
    &quot;ShelfId&quot;: -1,
    &quot;ResourceIdentifier&quot;: &quot;&quot;
}
</code></pre>
<h2 id="getting-started-with-the-integration"><a class="header" href="#getting-started-with-the-integration">Getting started with the integration</a></h2>
<p>Because the nature of the HTTP protocol and how the JSON messages are composed, testing the interface is easy without writing any software. There are a plenty of tools that allow you to easily create HTTP requests with a correct body and headers. Just use your web search engine to find one. Using this kind of manual tools is usually a good first step to make sure the server is configured properly, you have understood the specification and the request is performing as you are expecting it to work.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="web-api"><a class="header" href="#web-api">Web API</a></h1>
<p>This document contains information on how to install and use services of the Navithor Web API.</p>
<p>Updated 04.10.2021</p>
<h2 id="version-history-43"><a class="header" href="#version-history-43">Version History</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Version</th><th>Date</th><th>Author</th><th>Change</th></tr></thead><tbody>
<tr><td>1.0</td><td>04.10.2021</td><td>Samuli Vaara</td><td>Document created</td></tr>
</tbody></table>
</div>
<hr />
<h2 id="settings"><a class="header" href="#settings">Settings</a></h2>
<p>Settings are defined in WebApiSettings.json, it is located in the the ConfigFiles folder.</p>
<p>If it does not exist a default configuration is created when the server is started.</p>
<div class="table-wrapper"><table><thead><tr><th>Setting</th><th>Default</th><th>Values</th><th>Description</th></tr></thead><tbody>
<tr><td>Enabled</td><td>false</td><td>true/false</td><td>Enables the web API server</td></tr>
<tr><td>Port</td><td>4199</td><td>any valid port number</td><td>Port of the web API server</td></tr>
<tr><td>BufferSize</td><td>1024</td><td>1-65535</td><td>Maximum frame size for the data buffer.</td></tr>
<tr><td>Secure</td><td>false</td><td>true/false</td><td>Enables secure websockets. Must bind certificate to the port first.</td></tr>
<tr><td>Services</td><td>{<br />&quot;Example&quot;: &quot;Basic&quot;,<br />}</td><td>List of service:authentication pairs</td><td>Service name i.e. &quot;UniversalAGV&quot;, supported authentication methods are &quot;Basic&quot; and &quot;Anonymous&quot;.</td></tr>
<tr><td>ApiKeys</td><td>{<br />&quot;defaultuser&quot;:&quot;password&quot;,<br />}</td><td>List of valid ClientID:Api-Key pairs</td><td>Credentials for connecting to the API when using Basic authentication.</td></tr>
</tbody></table>
</div>
<hr />
<h2 id="installation-1"><a class="header" href="#installation-1">Installation</a></h2>
<p>Only installation step required is creating an URL registration for the user account. This can be done using netsh via commandline.</p>
<p>This is not required if NavithorServer is run as admin.</p>
<blockquote>
<p>netsh http add urlacl url=http://+:4199/ user=everyone</p>
</blockquote>
<p>Port number must be same as defined in the settings. User can be specified as a specific windows user. group &quot;everyone&quot; is operation language specific and might be different on a non english operating system.</p>
<p>More information:</p>
<p>https://docs.microsoft.com/en-us/windows-server/networking/technologies/netsh/netsh-http#add-urlacl</p>
<h2 id="available-services"><a class="header" href="#available-services">Available Services</a></h2>
<p>This document does not provide information about the API provided by the service. Here is a list of available services.</p>
<p>When adding a service to the settings file, please remember that it is case sensitive.</p>
<div class="table-wrapper"><table><thead><tr><th>Service Name</th><th>Service Path</th></tr></thead><tbody>
<tr><td>UniversalAGV</td><td>/ws/universalAGV</td></tr>
</tbody></table>
</div>
<hr />
<h2 id="basic-authentication"><a class="header" href="#basic-authentication">Basic authentication</a></h2>
<p>If basic authentication is defined as the authentication method, the websocket request must contain the basic authorization header.</p>
<p>The username and password must match those defined in Settings -&gt; ApiKeys.</p>
<p><em>It is recommended to setup secure websockets when using basic access authentication.</em></p>
<h3 id="authorization-header-field"><a class="header" href="#authorization-header-field">Authorization header field</a></h3>
<p>from https://en.wikipedia.org/wiki/Basic_access_authentication</p>
<p>The <em>Authorization</em> header field is constructed as follows:</p>
<ol>
<li>The username and password are combined with a single colon (:). This means that the username itself cannot contain a colon.</li>
<li>The resulting string is encoded into an octet sequence. The character set to use for this encoding is by default unspecified, as long as it is compatible with US-ASCII, but the server may suggest use of UTF-8 by sending the <em>charset</em> parameter.</li>
<li>The resulting string is encoded using a variant of Base64 (+/ and with padding).</li>
<li>The authorization method and a space (e.g. &quot;Basic &quot;) is then prepended to the encoded string.</li>
</ol>
<p>For example, if the browser uses <em>Aladdin</em> as the username and <em>open sesame</em> as the password, then the field's value is the Base64 encoding of <em>Aladdin:open sesame</em>, or <em>QWxhZGRpbjpvcGVuIHNlc2FtZQ==</em>. Then the <em>Authorization</em> header field will appear as:</p>
<blockquote>
<p>Authorization: Basic QWxhZGRpbjpvcGVuIHNlc2FtZQ==</p>
</blockquote>
<hr />
<h2 id="configuring-secure-websockets"><a class="header" href="#configuring-secure-websockets">Configuring secure websockets</a></h2>
<p>To enable secure communication, you must specify https when registering the URL as in the installation step. </p>
<blockquote>
<p>netsh http add urlacl url=https://+:4199/ user=everyone</p>
</blockquote>
<p>Additionally you must bind a valid certificate to the port. You must specify the cert hash of a trusted certifcate inside the certificate store. This document does not provide means to create a certificate. If you wish yo use secure websockets you must provide a trusted certifcate by yourself. Appid can be anything, it can be used to identify the owning application.</p>
<blockquote>
<p>netsh http add sslcert ipport=0.0.0.0:4199 certhash=0102030405060708090A0B0C0D0E0F1011121314 appid={00112233-4455-6677-8899-AABBCCDDEEFF}</p>
</blockquote>
<p>More information. https://docs.microsoft.com/en-us/windows-server/networking/technologies/netsh/netsh-http#add-sslcert</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="opc-ua-server-interface"><a class="header" href="#opc-ua-server-interface">OPC UA Server interface</a></h1>
<p>Describes OPC UA Server implemented in Navithor Server</p>
<p>Updated 24.11.2022</p>
<h2 id="version-history-44"><a class="header" href="#version-history-44">Version History</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Version</th><th>Date</th><th>Author</th><th>Change</th></tr></thead><tbody>
<tr><td>1.0</td><td>23.07.2020</td><td>Antti Parkkonen</td><td>Initial document</td></tr>
<tr><td>1.1</td><td>29.07.2020</td><td>Aleksi Ålander</td><td>Minor corrections</td></tr>
<tr><td>1.2</td><td>30.09.2020</td><td>Antti Parkkonen</td><td>Update for new spec</td></tr>
<tr><td>1.3</td><td>08.10.2020</td><td>Aleksi Ålander</td><td>Added 'Name' node for errors</td></tr>
<tr><td>1.4</td><td>28.10.2020</td><td>Antti Parkkonen</td><td>Changed from rolling numbering to ID numbering</td></tr>
<tr><td>1.5</td><td>02.12.2020</td><td>Aleksi Ålander</td><td>Updated to reflect support for translation</td></tr>
<tr><td>1.6</td><td>08.07.2021</td><td>Elena Sgonova</td><td>Added datatypes for nodes</td></tr>
<tr><td>1.7</td><td>13.12.2021</td><td>Aleksi Ålander</td><td>Added description of different node configuration options</td></tr>
<tr><td>1.8</td><td>08.02.2022</td><td>Aleksi Ålander</td><td>Added description of possible XML file generation</td></tr>
<tr><td>1.9</td><td>27.07.2022</td><td>Tero Laakso-Pitkäkoski</td><td>Added 'System information' node with ProductionBreakMode state</td></tr>
<tr><td>2.0</td><td>24.11.2022</td><td>Toni Liski</td><td>Added comment about supported OPC Watch versions</td></tr>
</tbody></table>
</div>
<hr />
<h2 id="current-standard-implementation"><a class="header" href="#current-standard-implementation">Current standard implementation</a></h2>
<p>In the current form Navithor Server exposes AGV errors, symbolic point errors and Navithor Server system errors as nodes in OPC UA Server. Some extra information like operation state and position are shown for the AGVs and symbolic points.</p>
<p>Navithor Server supports currently two different options for node configuration. This chapter and all sub-chapters under it describe the standard configuration, that is enabled by default. The alternative option is discussed separately in chapter <em>Alternative node configuration: SimpleStaticConfiguration</em>.</p>
<p>Navithor Server also creates a node OpcUaSettings, if the standard configuration is used. In the current version only child node is for selecting language for the alarm descriptions and names, that are written to the OPC UA Server. OPC UA Client can write to this node to select the language they wish to use from the list of the supported languages.</p>
<p>The created nodes are stored for the full lifetime of the Navithor Server application, even if the OPC UA Server is shutdown and restarted the nodes will exist.</p>
<p>The nodes are stored in the OPC UA Server under the Objects root folder in the form shown in subsections below. The numbering on each AGV and station folder comes from the ID of the AGV or symbolic point. So AGV with ID 23 will have the OpcFolder AGV23. Stations follow the same numbering as AGVs, meaning that each station folder is based on the ID of the symbolic point that represents the station. If the symbolic point ID is 105, OPC UA folder will be called Station105.</p>
<p>Current standard implementation has a fixed amount of 20 error folders under System errors and under each AGV and station. Error folders are numbered from Error001 to Error020. If a new error is activated, Navithor Server selects the lowest ID error node from the collection, that does not have active error. The selected error node is used for this error until it is deactivated, meaning that no sorting is done after the node has been first time selected. If the error deactivates and shortly activates again, the system chooses again the lowest free error node ID, so the error might be linked now into a different node.</p>
<h3 id="agv-information"><a class="header" href="#agv-information">AGV information</a></h3>
<pre><code>Objects
|
|--&gt; AGVs
||
||--&gt;AGV1
|  |
|  |--&gt;Errors
|  | |
|  | |--&gt;Error001
|  |   |---&gt; Active: bool
|  |   |---&gt; Description: string
|  |   |---&gt; ErrorLevel: int
|  |   |---&gt; ErrorName: string
|  |   |---&gt; Id: int
|  |   |---&gt; LastActivated: DateTime
|  | |
|  | |--&gt;Error002
|  |   |---&gt; Active: bool
|  |   |---&gt; Description: string
|  |   |---&gt; ErrorLevel: int
|  |   |---&gt; ErrorName: string
|  |   |---&gt; Id: int
|  |   |---&gt; LastActivated: DateTime
|  |   |
|  | .
|  | .
|  | .
|  | |--&gt;Error020
|  |   |---&gt; Active: bool
|  |   |---&gt; Description: string
|  |   |---&gt; ErrorLevel: int
|  |   |---&gt; ErrorName: string
|  |   |---&gt; Id: int
|  |   |---&gt; LastActivated: DateTime
|  |
|  |--&gt;State
|  | |---&gt; NextTarget: string
|  | |---&gt; OperationMode: string
|  | |---&gt; OperationState: string
|  | |---&gt; PositionX: float
|  | |---&gt; PositionY: float
|  |--&gt;ID: int
|  |--&gt;Name: string
|  |--&gt;Type: int
||       
||--&gt;AGV2
|  |
|  |--&gt;Errors
|  |
|  |--&gt;State
|  |
|  |--&gt;ID: int
|  |--&gt;Name: string
|  |--&gt;Type: int
|  .
|  .
|  .
</code></pre>
<h3 id="symbolic-point-information"><a class="header" href="#symbolic-point-information">Symbolic point information</a></h3>
<pre><code>Objects
|
|--&gt; Stations
||
||--&gt;Station1
|  |
|  |--&gt;Errors
|  | |
|  | |--&gt;Error001
|  |   |---&gt; Active: bool
|  |   |---&gt; Description: string
|  |   |---&gt; ErrorLevel: int
|  |   |---&gt; ErrorName: string
|  |   |---&gt; Id: int
|  |   |---&gt; LastActivated: DateTime
|  | |
|  | |--&gt;Error002
|  |   |---&gt; Active: bool
|  |   |---&gt; Description: string
|  |   |---&gt; ErrorLevel: int
|  |   |---&gt; ErrorName: string
|  |   |---&gt; Id: int
|  |   |---&gt; LastActivated: DateTime
|  |   |
|  | .
|  | .
|  | .
|  | |--&gt;Error020
|  |   |---&gt; Active: bool
|  |   |---&gt; Description: string
|  |   |---&gt; ErrorLevel: int
|  |   |---&gt; ErrorName: string
|  |   |---&gt; Id: int
|  |   |---&gt; LastActivated: DateTime
|  |
|  |
|  |--&gt;State
|  | |---&gt; OperationState: string
|  |--&gt;ID: int
|  |--&gt;Name: string
|  |--&gt;Type: string
</code></pre>
<h3 id="system-information"><a class="header" href="#system-information">System information</a></h3>
<pre><code>Objects
|
|--&gt; System errors
|  |--&gt;Error001
|  | |---&gt; Active: bool
|  | |---&gt; Description: string
|  | |---&gt; ErrorLevel: int
|  | |---&gt; ErrorName: string
|  | |---&gt; Id: int
|  | |---&gt; LastActivated: DateTime
|  |
|  |--&gt;Error002
|  | |---&gt; Active: bool
|  | |---&gt; Description: string
|  | |---&gt; ErrorLevel: int
|  | |---&gt; ErrorName: string
|  | |---&gt; Id: int
|  | |---&gt; LastActivated: DateTime
|  |
|  | .
|  | .
|  | .
|  |--&gt;Error020
|  | |---&gt; Active: bool
|  | |---&gt; Description: string
|  | |---&gt; ErrorLevel: int
|  | |---&gt; ErrorName: string
|  | |---&gt; Id: int
|  | |---&gt; LastActivated: DateTime
|--&gt; System information
|  |---&gt; ProductionBreakMode: string
</code></pre>
<p>Node IDs for each AGV error will be of form:
ns=2;s=AGVs/AGV00001/Errors/Error001</p>
<p>for stations:
ns=2;s=Stations/Station00001/Errors/Error001</p>
<p>and for system errors:
ns=2;s=System errors/Errors/Error001</p>
<p>All error nodes contain the 6 data variable nodes Active, LastActivated, Name, Description, ErrorLevel and id. The Error information is filled up when an error is active and the data is cleared after the error has been deactivated for one full update cycle.</p>
<h4 id="production-break-variable-values"><a class="header" href="#production-break-variable-values">Production Break variable values</a></h4>
<div class="table-wrapper"><table><thead><tr><th>Value</th><th>Description</th></tr></thead><tbody>
<tr><td>None</td><td>Production break is not activated, system allows normal operation.</td></tr>
<tr><td>MovingToProductionBreak</td><td>System is in progress of driving AGVs to production break.</td></tr>
<tr><td>ProductionBreak</td><td>System has production break active. AGVs are driven to production break locations and set to sleep when possible.</td></tr>
</tbody></table>
</div>
<h3 id="opc-ua-settings"><a class="header" href="#opc-ua-settings">OPC UA settings</a></h3>
<pre><code>Objects
|
|--&gt;OpcUaSettings
| |---&gt; AlarmsLanguage: string
</code></pre>
<p>AlarmsLanguage node is a node where OPC UA Client can write the language for the error names and descriptions, that Navithor Server writes to the OPC UA nodes. Navithor Server is constantly monitoring the node and selects the translations based on this node. If the language is changed by the Client, Navithor Server will update the translations for the errors that are active. Non-active folders are not translated.</p>
<p>Default language is English. OPC UA Server doesn't save the active language anywhere, so in case of Navithor system rebooting, the language goes back to default. OPC UA Client should monitor the AlarmsLanguage node and in case it is not what the Client wants, write the correct value.</p>
<p>OPC UA Server language is a global setting, so if one OPC UA Client changes the setting, it will affect also other OPC UA Clients.</p>
<p>Language should be written as a string and in a right format, which is in this document called as a language identifier. Currently supported languages are English and German. Check the languages Navithor supports and their identifiers from the table below:</p>
<div class="table-wrapper"><table><thead><tr><th>Language</th><th>Identifier</th></tr></thead><tbody>
<tr><td>English</td><td>en-EN</td></tr>
<tr><td>German</td><td>de-DE</td></tr>
</tbody></table>
</div>
<h3 id="example-of-reserving-error-folders"><a class="header" href="#example-of-reserving-error-folders">Example of reserving error folders</a></h3>
<p>Example with 5 possible error nodes to choose from. The same logic is valid for all types of the errors.</p>
<pre><code>|--&gt; Errors
|  |--&gt;Error001 - Free
|  |--&gt;Error002 - Free
|  |--&gt;Error003 - Free
|  |--&gt;Error004 - Free
|  |--&gt;Error005 - Free
</code></pre>
<p>3 errors are activated in order of Err200, Err100 and last Err400.</p>
<pre><code>|--&gt; Errors
|  |--&gt;Error001 - Err200
|  |--&gt;Error002 - Err100
|  |--&gt;Error003 - Err400
|  |--&gt;Error004 - Free
|  |--&gt;Error005 - Free
</code></pre>
<p>Error Err100 is now deactivated. Err200 and Err400 keep the folders they have been assigned into.</p>
<pre><code>|--&gt; Errors
|  |--&gt;Error001 - Err200
|  |--&gt;Error002 - Free
|  |--&gt;Error003 - Err400
|  |--&gt;Error004 - Free
|  |--&gt;Error005 - Free
</code></pre>
<p>Now two more errors Err90 and Err50 are activated.</p>
<pre><code>|--&gt; Errors
|  |--&gt;Error001 - Err200
|  |--&gt;Error002 - Err90
|  |--&gt;Error003 - Err400
|  |--&gt;Error004 - Err50
|  |--&gt;Error005 - Free
</code></pre>
<hr />
<h2 id="alternative-node-configuration-simplestaticconfiguration"><a class="header" href="#alternative-node-configuration-simplestaticconfiguration">Alternative node configuration: SimpleStaticConfiguration</a></h2>
<p>This chapter describes the node configuration of an alternative OPC UA node manager implemented in Navithor Server. This alternative can be chosen by setting Navithor Server parameter <em>OpcUa_NodeManagerConfiguration</em> to option <em>SimpleStaticConfiguration</em> and restarting Navithor Server.</p>
<p>All nodes are created with fixed names. All nodes are data variables with boolean data type. Each node can have only two states depending if the described error is currently active or not: False or True.</p>
<p>The naming of the nodes follows these rules:</p>
<ul>
<li>All AGVs configured in the system will have fixed error nodes for:</li>
<li>Every node name follows the format: &quot;FTFXXXXX - Error YYYYYY&quot;, where XXXXX is defined machine ID and YYYYYY is the error ID that the node is representing.</li>
<li>Nodes from 1 to 999 are always created. These can contain Supervisor and Navitrol errors. All of the nodes are not currently used, but are reserved in case of upcoming updates. Exact description which errors are currently used need to be checked from Navitrol documentation matching with the Navitrol version and from the </li>
<li>Nodes starting from 100000 upwards are reserved for AGV alarms triggered by Navithor Server. These are created based on the alarms defined in the current Navithor Server version. The exact IDs used can be found from * Alarms* documentation.</li>
<li>All System alarms will have a fixed error node:
<ul>
<li>Every node name follows the format: &quot;System - Error YYYYYY&quot;, where YYYYYY is the error ID that the node is representing.</li>
<li>Alarm IDs can be anything from 1 to 999999 defined by the current Navithor Server version. The exact IDs used can be found from * Alarms* documentation.</li>
</ul>
</li>
</ul>
<p>SimpleStaticConfiguration creates all nodes inside a single folder called <em>Errors</em> directly under the root <em>Objects</em> folder.</p>
<p>Below is an example of the node structure in this configuration.</p>
<pre><code>Objects
|
|--&gt; Errors
|  |--&gt;FTF00001 - Error 000001
|  |--&gt;FTF00001 - Error 000002
|  | .
|  | .
|  |--&gt;FTF00001 - Error 000998
|  |--&gt;FTF00001 - Error 000999
|  |--&gt;FTF00001 - Error 100000
|  |--&gt;FTF00001 - Error 100001
|  | .
|  | .
|  |--&gt;FTF00002 - Error 000001
|  |--&gt;FTF00002 - Error 000002
|  | .
|  | .
|  |--&gt;FTF00002 - Error 000998
|  |--&gt;FTF00002 - Error 000999
|  |--&gt;FTF00002 - Error 100000
|  |--&gt;FTF00002 - Error 100001
|  | .
|  | .
|  |--&gt;FTFXXXXX - Error 000001
|  |--&gt;FTFXXXXX - Error 000002
|  | .
|  | .
|  |--&gt;FTFXXXXX - Error 000998
|  |--&gt;FTFXXXXX - Error 000999
|  |--&gt;FTFXXXXX - Error 100000
|  |--&gt;FTFXXXXX - Error 100001
|  | .
|  | .
|  |--&gt;System - Error 000100
|  |--&gt;System - Error 000102
|  |--&gt;System - Error 000103
|  | .
|  | .
|  |--&gt;System - Error XXXXXX

</code></pre>
<h3 id="xml-file-generated"><a class="header" href="#xml-file-generated">XML File generated</a></h3>
<p>If node manager is configured to use <em>SimpleStaticConfiguration</em>, Navithor Server will automatically generate on start up an XML file that describes the node configuration inside the OPC UA Server with the current software version. The file is written into <em>Navithor Server/ConfigFiles/OpcUaSimpleStaticNodes.xml</em>.</p>
<p>Example of the format:</p>
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;UANodeSet&gt;
  &lt;UAVariable NodeId=&quot;ns=2;s=Errors/FTF00013 - Error 000001&quot;&gt;
    &lt;Description&gt;FTF00013 - Error 000001&lt;/Description&gt;
  &lt;/UAVariable&gt;
  &lt;UAVariable NodeId=&quot;ns=2;s=Errors/FTF00013 - Error 000002&quot;&gt;
    &lt;Description&gt;FTF00013 - Error 000002&lt;/Description&gt;
  &lt;/UAVariable&gt;
  &lt;UAVariable NodeId=&quot;ns=2;s=Errors/FTF00013 - Error 000003&quot;&gt;
    &lt;Description&gt;FTF00013 - Error 000003&lt;/Description&gt;
  &lt;/UAVariable&gt;
&lt;/UANodeSet&gt;
</code></pre>
<h2 id="related-parameters"><a class="header" href="#related-parameters">Related parameters</a></h2>
<p>The following Navithor Server parameters affect how the OPC UA Server works.</p>
<h3 id="opcua_serverport"><a class="header" href="#opcua_serverport">OpcUa_ServerPort</a></h3>
<p>Tells on which port the OPC UA Server is launched on. The default value for this is 4840. This port value was chosen as it was used in the OPC Foundation's official examples in their Github repository.</p>
<h3 id="opcua_serverendpointname"><a class="header" href="#opcua_serverendpointname">OpcUa_ServerEndPointName</a></h3>
<p>Defines the a string name for the endpoint. This name is also used as the namespace in the OPC UA Server's node manager. The name can not contain special characters or spaces.  Default value for this is NavithorServer.</p>
<h3 id="opcua_endpointconfiguration"><a class="header" href="#opcua_endpointconfiguration">OpcUa_EndPointConfiguration</a></h3>
<p>Flag parameter that tells which OPC Security algorithms are used for the endpoints. If multiple values are selected then multiple endpoints are also opened.</p>
<h3 id="opcua_nodemanagerconfiguration"><a class="header" href="#opcua_nodemanagerconfiguration">OpcUa_NodeManagerConfiguration</a></h3>
<p>Defines which node manager is used for OPC UA Server. This defines the structure of folders and nodes in the server. Currently supported modes are:</p>
<ul>
<li>StandardConfiguration: Standard configuration, which includes subfolders for AGV errors, location errors, system alarms and OPC UA settings. This document is based on this configuration, unless the chapter specifically mentions an alternative configuration.</li>
<li>SimpleStaticConfiguration: Only AGV and System alarms are represented as a single boolean node inside the same object folder. Detailed configuration is discussed in chapter <em>Alternative node configuration: SimpleStaticConfiguration</em>.</li>
</ul>
<p>Changing the parameter requires restarting Navithor Server to recreate the OPC UA nodes in the new configuration.</p>
<h3 id="opcua_serverenabled"><a class="header" href="#opcua_serverenabled">OpcUa_ServerEnabled</a></h3>
<p>Finally when this parameter is set to True, the OPC UA Server is started using the parameters set above. Only changing the OpcUa_ServerEndPointName requires a full server restart.</p>
<p>For example using default value starting OPC UA server creates an endpoint with None as the security algorithm and to the address opc.tcp://server_ip:4840/NavithorServer</p>
<h2 id="current-limitations"><a class="header" href="#current-limitations">Current limitations</a></h2>
<p>Current implementation supports only anonymous users. The OPC security algorithms Basic256 and Basic256Sha256 have not been tested.</p>
<h2 id="testing"><a class="header" href="#testing">Testing</a></h2>
<p>OPC connection can be tested with a client called OPC Watch, developed by the company Traeger. Latest version is available at https://docs.traeger.de/en/software/sdk/opc-ua/net/net#download</p>
<p><strong>Note:</strong> OPC Watch version 2.17 has issues with auto updating of the nodes. Connection has been tested to be working with versions 2.10, 2.20, and 2.29 at least.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="alarms-2"><a class="header" href="#alarms-2">Alarms</a></h1>
<p>This document contains the alarms that can be raised from fleet control.</p>
<p>Updated 12.07.2022</p>
<h2 id="version-history-45"><a class="header" href="#version-history-45">Version History</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Version</th><th>Date</th><th>Author</th><th>Change</th></tr></thead><tbody>
<tr><td>1.0</td><td>21.06.2021</td><td>Simon Clement</td><td>Document created</td></tr>
<tr><td>1.1</td><td>01.10.2021</td><td>Benard Gathimba</td><td>Added new alarm MESInvalidProductionOrderId</td></tr>
<tr><td>1.2</td><td>11.01.2022</td><td>Tero Laakso</td><td>Missing errors added, error levels changed to match default levels</td></tr>
<tr><td>1.3</td><td>07.02.2022</td><td>Aleksi Ålander</td><td>Added new ResourceVerificationError</td></tr>
<tr><td>1.4</td><td>12.07.2022</td><td>Aleksi Ålander</td><td>Updated the document for Navithor 2.51.0.0 release</td></tr>
</tbody></table>
</div>
<hr />
<h2 id="alarms-3"><a class="header" href="#alarms-3">Alarms</a></h2>
<div class=wide-table-wrapper>
<div class="table-wrapper"><table><thead><tr><th>Error Source</th><th>Error ID</th><th>Error identifier</th><th>Error type</th><th>Error level</th><th>Description</th></tr></thead><tbody>
<tr><td>FLEET CONTROL</td><td>100</td><td>SQLConnectionFailure</td><td>System Alarm</td><td>FATAL ERROR</td><td>Problem with database connection.</td></tr>
<tr><td>FLEET CONTROL</td><td>102</td><td>MESConnectionFailure</td><td>System Alarm</td><td>WARNING</td><td>MES Clients were disconnected.</td></tr>
<tr><td>FLEET CONTROL</td><td>103</td><td>MESConnectionFailureExtended</td><td>System Alarm</td><td>ERROR</td><td>MES Client disconnected for longer than parameters allow, logs saved!</td></tr>
<tr><td>FLEET CONTROL</td><td>104</td><td>MQNotConnected</td><td>System Alarm</td><td>ERROR</td><td>MQ Activated but not connected.</td></tr>
<tr><td>FLEET CONTROL</td><td>105</td><td>FailedToOpenServiceHost</td><td>System Alarm</td><td>FATAL ERROR</td><td>Failed to open service host. Client communication not operational.</td></tr>
<tr><td>FLEET CONTROL</td><td>106</td><td>FailedToOpenServiceStreamHost</td><td>System Alarm</td><td>FATAL ERROR</td><td>Failed to open service stream host. Unable to transfer files between Server and Client.</td></tr>
<tr><td>FLEET CONTROL</td><td>107</td><td>FailedToStartOPCUA</td><td>System Alarm</td><td>ERROR</td><td>Failed to open OPC UA service.</td></tr>
<tr><td>FLEET CONTROL</td><td>108</td><td>FailedToStartWebServerMissingStaticFiles</td><td>System Alarm</td><td>ERROR</td><td>Failed to start the web server. Static files are missing.</td></tr>
<tr><td>FLEET CONTROL</td><td>109</td><td>FailedToStartWebServerBadConfiguration</td><td>System Alarm</td><td>ERROR</td><td>Failed to start the web server. Unable to reserve url.</td></tr>
<tr><td>FLEET CONTROL</td><td>200</td><td>ProductionAreaNotOperational</td><td>System Alarm</td><td>ERROR</td><td>Production area not operational. Something wrong with loading area files.</td></tr>
<tr><td>FLEET CONTROL</td><td>201</td><td>TaskGenerationDisabled</td><td>System Alarm</td><td>ERROR</td><td>Task generation disabled. Area not yet loaded.</td></tr>
<tr><td>FLEET CONTROL</td><td>202</td><td>ProductionAreaHasWarnings</td><td>System Alarm</td><td>ERROR</td><td>Possible bad configuration with load capacity. Some symbolic points will not be able to handle specified resource types. See ProductionAreaInformation for more details.</td></tr>
<tr><td>FLEET CONTROL</td><td>203</td><td>MachineTypesNotDefined</td><td>System Alarm</td><td>ERROR</td><td>Missing machine types. Check that there are active machines with valid and active machine type parameters.</td></tr>
<tr><td>FLEET CONTROL</td><td>204</td><td>MachinesNotDefined</td><td>System Alarm</td><td>ERROR</td><td>No machines defined with valid machine type.</td></tr>
<tr><td>FLEET CONTROL</td><td>205</td><td>NoProductionAreasDefined</td><td>System Alarm</td><td>ERROR</td><td>Area is not ok, because no production areas are defined or active.</td></tr>
<tr><td>FLEET CONTROL</td><td>206</td><td>MultipleProductionAreasDefined</td><td>System Alarm</td><td>ERROR</td><td>Area is not ok, because multiple production areas are defined and active.</td></tr>
<tr><td>FLEET CONTROL</td><td>207</td><td>NoSegmentsLoaded</td><td>System Alarm</td><td>ERROR</td><td>Area is not ok, because no segments were loaded.</td></tr>
<tr><td>FLEET CONTROL</td><td>208</td><td>NoWaypointsLoaded</td><td>System Alarm</td><td>ERROR</td><td>Area is not ok, because no waypoints were loaded.</td></tr>
<tr><td>FLEET CONTROL</td><td>209</td><td>SegmentOverlapsNotCalculated</td><td>System Alarm</td><td>ERROR</td><td>Overlaps not calculated. Check that all machine types are configured and active.</td></tr>
<tr><td>FLEET CONTROL</td><td>210</td><td>MachineNotAllowedToHandleAnyResourceType</td><td>System Alarm</td><td>ERROR</td><td>Configuration issue: Machine not allowed to handle any resource type.</td></tr>
<tr><td>FLEET CONTROL</td><td>300</td><td>MachineError</td><td>System Alarm</td><td>ERROR</td><td>Generic id for all Navitrol errors sent through MES message Errors (ID: 309)</td></tr>
<tr><td>FLEET CONTROL</td><td>409</td><td>InvalidMachineTypeParameters</td><td>System Alarm</td><td>ERROR</td><td>Failed to parse all machine type parameters defined in the project.</td></tr>
<tr><td>FLEET CONTROL</td><td>411</td><td>OverrideFileError</td><td>System Alarm</td><td>WARNING</td><td>Error parsing override files. Check logs for more details.</td></tr>
<tr><td>FLEET CONTROL</td><td>412</td><td>MissingMachineTypeParameters</td><td>System Alarm</td><td>ERROR</td><td>Missing machine type parameters. Check that all machine types defined in the project are uploaded and active.</td></tr>
<tr><td>FLEET CONTROL</td><td>413</td><td>InvalidTransferRequestLocations</td><td>System Alarm</td><td>WARNING</td><td>Transfer request has no valid locations.</td></tr>
<tr><td>FLEET CONTROL</td><td>414</td><td>OverrideFileWarning</td><td>System Alarm</td><td>WARNING</td><td>Warnings raised while parsing override files. The override files where parsed successfully, but some lines where invalid and not read. Check logs for more details.</td></tr>
<tr><td>FLEET CONTROL</td><td>500</td><td>SystemMonitorNotRunning</td><td>System Alarm</td><td>ERROR</td><td>Cannot start SystemStatusMonitor.</td></tr>
<tr><td>FLEET CONTROL</td><td>501</td><td>ServiceHostFaulted</td><td>System Alarm</td><td>ERROR</td><td>Service host for Client communications faulted, trying to restart the service.</td></tr>
<tr><td>FLEET CONTROL</td><td>503</td><td>FailedToStartChargingManager</td><td>System Alarm</td><td>ERROR</td><td>Unable to initialize charging manager.</td></tr>
<tr><td>FLEET CONTROL</td><td>504</td><td>FailedToWriteStatistics</td><td>System Alarm</td><td>ERROR</td><td>Statistics writer thread was stopped and restarted.</td></tr>
<tr><td>FLEET CONTROL</td><td>1014</td><td>MissionManagerNotReady</td><td>System Alarm</td><td>ERROR</td><td>Mission manager is not ready, production on hold!</td></tr>
<tr><td>FLEET CONTROL</td><td>2000</td><td>LowDiskSpace</td><td>System Alarm</td><td>WARNING</td><td>Current Disk has below 10GB of free space left!</td></tr>
<tr><td>FLEET CONTROL</td><td>2004</td><td>LogWriteNotDetected</td><td>System Alarm</td><td>WARNING</td><td>No writes detected to server text logs.</td></tr>
<tr><td>FLEET CONTROL</td><td>3001</td><td>TargetSymbolicPointIdNotValid</td><td>System Alarm</td><td>WARNING</td><td>Not valid target given for TransferRequest, symbolic point not found.</td></tr>
<tr><td>FLEET CONTROL</td><td>3004</td><td>PickupSymbolicPointIdNotValid</td><td>System Alarm</td><td>WARNING</td><td>Invalid symbolic point ID given.</td></tr>
<tr><td>FLEET CONTROL</td><td>3007</td><td>SetRackStatusSymbolicPointIdNotValid</td><td>System Alarm</td><td>WARNING</td><td>SetRackStatus: Given symbolic point ID is not rack.</td></tr>
<tr><td>FLEET CONTROL</td><td>3009</td><td>MESDriveMachineToSymbolicPoint</td><td>System Alarm</td><td>WARNING</td><td>Something wrong with MES message DriveMachineToSymbolicPoint.</td></tr>
<tr><td>FLEET CONTROL</td><td>3013</td><td>MESEnableDisableSymbolicPoint</td><td>System Alarm</td><td>WARNING</td><td>Could not find symbolic point with the ID given in MES message to enable or disable location.</td></tr>
<tr><td>FLEET CONTROL</td><td>3014</td><td>MESSymbolicPointIdNotValid</td><td>System Alarm</td><td>WARNING</td><td>Could not find symbolic point with given ID.</td></tr>
<tr><td>FLEET CONTROL</td><td>3015</td><td>MESInvalidMessageReceived</td><td>System Alarm</td><td>WARNING</td><td>Invalid MES message received. Check logs or entity alarms for more detailed information.</td></tr>
<tr><td>FLEET CONTROL</td><td>3016</td><td>MESInvalidProductionOrderId</td><td>System Alarm</td><td>WARNING</td><td>Could not find production order with given ID.</td></tr>
<tr><td>FLEET CONTROL</td><td>3017</td><td>MESInitPositionToSymbolicPointNotValid</td><td>System Alarm</td><td>WARNING</td><td>MES init position: Given machine or symbolic point not found.</td></tr>
<tr><td>FLEET CONTROL</td><td>5001</td><td>AttemptToOverridePermanentResourceServer</td><td>System Alarm</td><td>WARNING</td><td>Server is attempting to remove resource while permanent resources is on.</td></tr>
<tr><td>FLEET CONTROL</td><td>5002</td><td>AttemptToOverridePermanentResourceClient</td><td>System Alarm</td><td>WARNING</td><td>Client user attempted to remove resource while permanent resources is on.</td></tr>
<tr><td>FLEET CONTROL</td><td>5003</td><td>AttemptToOverridePermanentResourceSimulator</td><td>System Alarm</td><td>WARNING</td><td>Simulator attempted to remove resource while permanent resources is on.</td></tr>
<tr><td>FLEET CONTROL</td><td>6001</td><td>InvalidChargingParametersLoaded</td><td>System Alarm</td><td>ERROR</td><td>Invalid charging manager parameters configured. Charging manager is not operational.</td></tr>
<tr><td>FLEET CONTROL</td><td>7001</td><td>LicenseDoesNotCoverAllMachines</td><td>System Alarm</td><td>ERROR</td><td>License does not cover all enabled machines. Excess machines are forcefully disabled.</td></tr>
<tr><td>FLEET CONTROL</td><td>7002</td><td>LicenseDoesNotCoverAllVDAMachines</td><td>System Alarm</td><td>ERROR</td><td>License does not cover all enabled VDA machines. Excess machines are forcefully disabled.</td></tr>
<tr><td>FLEET CONTROL</td><td>7003</td><td>LicenseDoesNotAllowSingleLevelBlockStacking</td><td>System Alarm</td><td>ERROR</td><td>License does not allow single level block stacking.</td></tr>
<tr><td>FLEET CONTROL</td><td>7004</td><td>LicenseDoesNotAllowMultiLevelBlockStacking</td><td>System Alarm</td><td>ERROR</td><td>License does not allow multi level block stacking.</td></tr>
<tr><td>FLEET CONTROL</td><td>7005</td><td>LicenseDoesNotCoverAllVNAMachines</td><td>System Alarm</td><td>ERROR</td><td>License does not cover all machine with VNA machine type. Excess machines are forcefully disabled.</td></tr>
<tr><td>FLEET CONTROL</td><td>7006</td><td>LicenseDoesNotCoverAllSideLoaderMachines</td><td>System Alarm</td><td>ERROR</td><td>License does not cover all machine with sideloader machine type. Excess machines are forcefully disabled.</td></tr>
<tr><td>FLEET CONTROL</td><td>7007</td><td>LicenseDoesNotCoverWebClient</td><td>System Alarm</td><td>ERROR</td><td>License does not cover web client. Web client not in use.</td></tr>
<tr><td>FLEET CONTROL</td><td>7008</td><td>LicenseDoesNotCoverFleetSimulator</td><td>System Alarm</td><td>ERROR</td><td>License does not cover fleet simulator. Fleet simulator not in use.</td></tr>
<tr><td>FLEET CONTROL</td><td>100000</td><td>SimulatedMachineWarning</td><td>Machine Alarm</td><td>WARNING</td><td>Warning received from simulated machine.</td></tr>
<tr><td>FLEET CONTROL</td><td>100001</td><td>NoMachineConnection</td><td>Machine Alarm</td><td>ERROR</td><td>No connection to the machine.</td></tr>
<tr><td>FLEET CONTROL</td><td>100002</td><td>ReplyNotReceived</td><td>Machine Alarm</td><td>WARNING</td><td>Reply not received from machine.</td></tr>
<tr><td>FLEET CONTROL</td><td>100003</td><td>MessageRejected</td><td>Machine Alarm</td><td>WARNING</td><td>Machine rejected message.</td></tr>
<tr><td>FLEET CONTROL</td><td>100004</td><td>StartingSegNotFound</td><td>Machine Alarm</td><td>ERROR</td><td>Valid route not found. Machine has wrong heading or is too far away from the route.</td></tr>
<tr><td>FLEET CONTROL</td><td>100005</td><td>MachineIdDoesNotMatch</td><td>Machine Alarm</td><td>WARNING</td><td>Received machine ID does not match with the expected ID.</td></tr>
<tr><td>FLEET CONTROL</td><td>100007</td><td>BatteryTemperatureCritical</td><td>Machine Alarm</td><td>FATAL ERROR</td><td>Battery Temperature of the machine too high.</td></tr>
<tr><td>FLEET CONTROL</td><td>100009</td><td>MachineTypeIdConflict</td><td>Machine Alarm</td><td>ERROR</td><td>Defined machine type ID does not match between the machine and the fleet control.</td></tr>
<tr><td>FLEET CONTROL</td><td>100010</td><td>CommunicationVersionDoesNotMatch</td><td>Machine Alarm</td><td>ERROR</td><td>Communication protocol version between the machine and fleet control does not match.</td></tr>
<tr><td>FLEET CONTROL</td><td>100011</td><td>FileTransferFailed</td><td>Machine Alarm</td><td>ERROR</td><td>Uploading files to the machine failed.</td></tr>
<tr><td>FLEET CONTROL</td><td>101001</td><td>MachineIsNotAtLoadPoint</td><td>Machine Alarm</td><td>ERROR</td><td>Resource was not found because machine is not at symbolic point suitable for loading. System will try to create a new resource for loading.</td></tr>
<tr><td>FLEET CONTROL</td><td>101002</td><td>MachineIsNotAtUnloadPoint</td><td>Machine Alarm</td><td>ERROR</td><td>Machine is not at symbolic point suitable for unloading. System will try to remove the resource after unloading.</td></tr>
<tr><td>FLEET CONTROL</td><td>101003</td><td>MachineIsCarryingAnotherResource</td><td>Machine Alarm</td><td>ERROR</td><td>Machine is carrying a resource of different type and will try to unload it.</td></tr>
<tr><td>FLEET CONTROL</td><td>101004</td><td>MachineIsNotCarryingAnyResource</td><td>Machine Alarm</td><td>ERROR</td><td>Machine is not carrying any resource. System will try to add a new resource or replace existing for unloading.</td></tr>
<tr><td>FLEET CONTROL</td><td>101005</td><td>LoadingNotPossible</td><td>Machine Alarm</td><td>ERROR</td><td>Machine is not allowed to pick up the resource. Check that location has a resource and machine can load it.</td></tr>
<tr><td>FLEET CONTROL</td><td>101006</td><td>UnloadingNotPossible</td><td>Machine Alarm</td><td>ERROR</td><td>Machine is not allowed to unload. Check that location is free and machine has a resource on board.</td></tr>
<tr><td>FLEET CONTROL</td><td>102001</td><td>NoRouteFound</td><td>Machine Alarm</td><td>ERROR</td><td>Cannot find a valid route to the target location.</td></tr>
<tr><td>FLEET CONTROL</td><td>102002</td><td>Deadlock</td><td>Machine Alarm</td><td>WARNING</td><td>Machine cannot advance the drive task, because of the traffic ahead.</td></tr>
<tr><td>FLEET CONTROL</td><td>102003</td><td>MachineNotMovingInAuto</td><td>Machine Alarm</td><td>WARNING</td><td>Machine is not moving with drive order active.</td></tr>
<tr><td>FLEET CONTROL</td><td>102004</td><td>TargetLocationBlocked</td><td>Machine Alarm</td><td>WARNING</td><td>Target location is blocked by another machine.</td></tr>
<tr><td>FLEET CONTROL</td><td>102005</td><td>ObstAvoidanceNoProgress</td><td>Machine Alarm</td><td>WARNING</td><td>Machine is trying to bypass obstacle, but is not moving.</td></tr>
<tr><td>FLEET CONTROL</td><td>103001</td><td>TargetLocationNotAvailable</td><td>Machine Alarm</td><td>ERROR</td><td>Task end location is not available for unload and no wait location available.</td></tr>
<tr><td>FLEET CONTROL</td><td>103002</td><td>BadProductionOrderData</td><td>Machine Alarm</td><td>ERROR</td><td>Cannot execute production order.</td></tr>
<tr><td>FLEET CONTROL</td><td>103003</td><td>ChargingError</td><td>Machine Alarm</td><td>ERROR</td><td>Something is wrong with charging of the battery.</td></tr>
<tr><td>FLEET CONTROL</td><td>103004</td><td>CouplingNotPossibleNotAtSymbolicPoint</td><td>Machine Alarm</td><td>ERROR</td><td>Coupling not allowed, machine is not at coupling point.</td></tr>
<tr><td>FLEET CONTROL</td><td>103005</td><td>CouplingNotPossibleErrorsActive</td><td>Machine Alarm</td><td>ERROR</td><td>Coupling not allowed, machine has active errors.</td></tr>
<tr><td>FLEET CONTROL</td><td>103006</td><td>CouplingNotPossibleInvalidFormation</td><td>Machine Alarm</td><td>ERROR</td><td>Coupling not allowed, invalid formation arguments given.</td></tr>
<tr><td>FLEET CONTROL</td><td>103007</td><td>CouplingNotPossibleMachineRejected</td><td>Machine Alarm</td><td>ERROR</td><td>Coupling not allowed, machine rejected request.</td></tr>
<tr><td>FLEET CONTROL</td><td>103008</td><td>ChargeLocationNotAvailable</td><td>Machine Alarm</td><td>WARNING</td><td>No charging location available for the machine.</td></tr>
<tr><td>FLEET CONTROL</td><td>120001</td><td>TargetShelfNotValidForMoveResource</td><td>Symbolic Point Alarm</td><td>ERROR</td><td>Tried to move resource to rack symbolic point without defining shelf.</td></tr>
<tr><td>FLEET CONTROL</td><td>120002</td><td>ResourceMissingForLoading</td><td>Symbolic Point Alarm</td><td>ERROR</td><td>Resource is missing from symbolic point. System will try to add a new resource or replace existing for loading.</td></tr>
<tr><td>FLEET CONTROL</td><td>120003</td><td>ResourceMissingForUnloading</td><td>Machine Alarm</td><td>ERROR</td><td>Resource is missing from AGV. No unload will be performed.</td></tr>
<tr><td>FLEET CONTROL</td><td>120004</td><td>ResourceVerificationError</td><td>Machine Alarm</td><td>ERROR</td><td>Error in resource verification data. Check configuration file.</td></tr>
<tr><td>FLEET CONTROL</td><td>150001</td><td>PickupShelfIdNotValid</td><td>Symbolic Point Alarm</td><td>WARNING</td><td>Could not find the pickup shelf ID given.</td></tr>
<tr><td>FLEET CONTROL</td><td>150002</td><td>PickUpIsRackButNoShelfGiven</td><td>Symbolic Point Alarm</td><td>WARNING</td><td>Pickup location is a rack but no shelf ID was given.</td></tr>
<tr><td>FLEET CONTROL</td><td>150003</td><td>PickUpIsNotRackButShelfWasGiven</td><td>Symbolic Point Alarm</td><td>WARNING</td><td>Pickup is not rack but shelf ID was given.</td></tr>
<tr><td>FLEET CONTROL</td><td>150004</td><td>TargetShelfIdNotValid</td><td>Symbolic Point Alarm</td><td>WARNING</td><td>Could not find the target shelf ID given.</td></tr>
<tr><td>FLEET CONTROL</td><td>150005</td><td>TargetIsRackButShelfNotGiven</td><td>Symbolic Point Alarm</td><td>WARNING</td><td>Target is rack but no shelf ID was given.</td></tr>
<tr><td>FLEET CONTROL</td><td>150006</td><td>TargetIsNotRackButShelfWasGiven</td><td>Symbolic Point Alarm</td><td>WARNING</td><td>Target is not rack but shelf ID was given.</td></tr>
<tr><td>FLEET CONTROL</td><td>150007</td><td>SetRackStatusShelfIdNotValid</td><td>Symbolic Point Alarm</td><td>WARNING</td><td>SetRackStatus: Given shelf ID not found for the symbolic point.</td></tr>
<tr><td>FLEET CONTROL</td><td>150008</td><td>ResourceNotFoundAtSymbolicPoint</td><td>Symbolic Point Alarm</td><td>WARNING</td><td>Specified symbolic point is empty.</td></tr>
<tr><td>FLEET CONTROL</td><td>150009</td><td>ResourceNotFoundAtPickUpShelf</td><td>Symbolic Point Alarm</td><td>WARNING</td><td>Shelf with specified ID is empty for specified rack symbolic point.</td></tr>
<tr><td>FLEET CONTROL</td><td>150010</td><td>SetRackStatusNotRack</td><td>Symbolic Point Alarm</td><td>WARNING</td><td>The given symbolic point is not a rack.</td></tr>
<tr><td>FLEET CONTROL</td><td>150011</td><td>SetRackStatusInvalidResource</td><td>Symbolic Point Alarm</td><td>WARNING</td><td>The given resource type is not valid for the symbolic point.</td></tr>
<tr><td>FLEET CONTROL</td><td>151001</td><td>OverrideFileLocationError</td><td>Symbolic Point Alarm</td><td>ERROR</td><td>Parsing override file for this symbolic point failed, check the override files.</td></tr>
<tr><td>FLEET CONTROL</td><td>151002</td><td>QRCodeNotVerified</td><td>Symbolic Point Alarm</td><td>ERROR</td><td>QR Code Not Verified</td></tr>
<tr><td>AGV</td><td>101</td><td>ERROR_SCANNER_PROTOCOL_ERROR</td><td>Machine Alarm</td><td>ERROR</td><td>Sick S300 scanner protocol differs from 1.2 or 1.3</td></tr>
<tr><td>AGV</td><td>102</td><td>ERROR_MAP_FILE_READ</td><td>Machine Alarm</td><td>ERROR</td><td>Could not read map file</td></tr>
<tr><td>AGV</td><td>103</td><td>ERROR_MULTIPLE_MAPS_PER_FLOOR</td><td>Machine Alarm</td><td>ERROR</td><td>More than one map found for a floor</td></tr>
<tr><td>AGV</td><td>104</td><td>ERROR_TOO_MANY_MAP_FILES</td><td>Machine Alarm</td><td>ERROR</td><td>More than supported number of map files</td></tr>
<tr><td>AGV</td><td>105</td><td>ERROR_PARAM_PARSE</td><td>Machine Alarm</td><td>ERROR</td><td>Error parsing parameter file</td></tr>
<tr><td>AGV</td><td>106</td><td>ERROR_NO_LICENSE_CODE</td><td>Machine Alarm</td><td>ERROR</td><td>License key is invalid</td></tr>
<tr><td>AGV</td><td>107</td><td>ERROR_THREAD_NON_RESPONSIVE</td><td>Machine Alarm</td><td>ERROR</td><td>One of the threads is not responding as expected</td></tr>
<tr><td>AGV</td><td>201</td><td>ERROR_VEH_INTE_MSG_PARSE</td><td>Machine Alarm</td><td>ERROR</td><td>Message parsing error in veh_inte</td></tr>
<tr><td>AGV</td><td>202</td><td>ERROR_SCANNER_MSG_PARSE</td><td>Machine Alarm</td><td>ERROR</td><td>Scanner message parsing error</td></tr>
<tr><td>AGV</td><td>203</td><td>ERROR_NO_SCAN_FROM_FRONT_SCANNER</td><td>Machine Alarm</td><td>ERROR</td><td>Front scanner hasn't received scans</td></tr>
<tr><td>AGV</td><td>204</td><td>ERROR_NO_SCAN_FROM_REAR_SCANNER</td><td>Machine Alarm</td><td>ERROR</td><td>Rear scanner hasn't received scans</td></tr>
<tr><td>AGV</td><td>205</td><td>ERROR_MEAS_CNT_MISMATCH_FRONT</td><td>Machine Alarm</td><td>ERROR</td><td>Measurement in single scan does not match MAX_LMS_POINTS, check configuration of the front scanner</td></tr>
<tr><td>AGV</td><td>206</td><td>ERROR_MEAS_CNT_MISMATCH_REAR</td><td>Machine Alarm</td><td>ERROR</td><td>Measurement in single scan does not match MAX_LMS_POINTS, check configuration of the rear scanner</td></tr>
<tr><td>AGV</td><td>207</td><td>ERROR_POSITION_CONFIDENCE_LOW</td><td>Machine Alarm</td><td>ERROR</td><td>Position confidence is too low</td></tr>
<tr><td>AGV</td><td>208</td><td>ERROR_NOT_ENOUGH_REF_DET</td><td>Machine Alarm</td><td>ERROR</td><td>NotEnough reflectors detected</td></tr>
<tr><td>AGV</td><td>209</td><td>ERROR_POSITION_NOT_INITIALIZED</td><td>Machine Alarm</td><td>ERROR</td><td>Position hasn't been initialized</td></tr>
<tr><td>AGV</td><td>210</td><td>ERROR_LOCALIZE_NOT_READY</td><td>Machine Alarm</td><td>ERROR</td><td>Localization task is not ready</td></tr>
<tr><td>AGV</td><td>211</td><td>ERROR_DEADREC_HIGH_DT</td><td>Machine Alarm</td><td>ERROR</td><td>Too long since last deadrec update</td></tr>
<tr><td>AGV</td><td>212</td><td>ERROR_POSCONT_HIGH_DT</td><td>Machine Alarm</td><td>ERROR</td><td>Too long since last position control update</td></tr>
<tr><td>AGV</td><td>213</td><td>ERROR_SCANNER_FRONT_HIGH_DT</td><td>Machine Alarm</td><td>ERROR</td><td>Interval between received front laser scans is too high</td></tr>
<tr><td>AGV</td><td>214</td><td>ERROR_NO_SCAN_FROM_SAFETY_SCANNER</td><td>Machine Alarm</td><td>ERROR</td><td>Safety scanner hasn't received scans</td></tr>
<tr><td>AGV</td><td>215</td><td>ERROR_MEAS_CNT_MISMATCH_SAFETY</td><td>Machine Alarm</td><td>ERROR</td><td>Measurement in single scan does not match MAX_LMS_POINTS, check configuration of the safety scanners</td></tr>
<tr><td>AGV</td><td>216</td><td>ERROR_ENC_DATA</td><td>Machine Alarm</td><td>ERROR</td><td>Invalid encoder data</td></tr>
<tr><td>AGV</td><td>217</td><td>ERROR_LICENSE_OPTION_MISSING</td><td>Machine Alarm</td><td>ERROR</td><td>Current license doesn't include permission to use a feature that is being activated</td></tr>
<tr><td>AGV</td><td>218</td><td>ERROR_POS_INI_NOT_ENOUGH_REF_DET</td><td>Machine Alarm</td><td>ERROR</td><td>Not enough reflectors detected during position initialization</td></tr>
<tr><td>AGV</td><td>219</td><td>ERROR_CONFIG_PARAMETER_VALUE</td><td>Machine Alarm</td><td>ERROR</td><td>Incorrect parameter value in verification</td></tr>
<tr><td>AGV</td><td>220</td><td>ERROR_POS_INI_NOT_ENOUGH_REF_DET_DRIV</td><td>Machine Alarm</td><td>ERROR</td><td>Not enough reflectors detected after position initialization while driving</td></tr>
<tr><td>AGV</td><td>221</td><td>ERROR_NO_DATA_FROM_EXT_LOC_SENSOR</td><td>Machine Alarm</td><td>ERROR</td><td>No data received from external localization sensor</td></tr>
<tr><td>AGV</td><td>222</td><td>ERROR_EXT_LOC_SENSOR_MSG_PARSE</td><td>Machine Alarm</td><td>ERROR</td><td>Message parsing error in external localization sensor</td></tr>
<tr><td>AGV</td><td>223</td><td>ERROR_EXT_LOC_TOO_LONG_SINCE_VALID_MEASUREMENT</td><td>Machine Alarm</td><td>ERROR</td><td>No valid measurement from external sensor when inside area</td></tr>
<tr><td>AGV</td><td>224</td><td>ERROR_SCANNER_REAR_HIGH_DT</td><td>Machine Alarm</td><td>ERROR</td><td>Interval between received rear laser scans is too high</td></tr>
<tr><td>AGV</td><td>225</td><td>ERROR_NO_DATA_FROM_LINE_FOLLOWING_SENSOR</td><td>Machine Alarm</td><td>ERROR</td><td>No data received from line following sensor</td></tr>
<tr><td>AGV</td><td>226</td><td>ERROR_MSG_PARSE_LINE_FOLLOWING_SENSOR</td><td>Machine Alarm</td><td>ERROR</td><td>Error parsing line following sensor message</td></tr>
<tr><td>AGV</td><td>227</td><td>ERROR_LINE_FOLLOWING_NO_MEASUREMENT</td><td>Machine Alarm</td><td>ERROR</td><td>No measurement received from sensor</td></tr>
<tr><td>AGV</td><td>300</td><td>WARNING_UNAUTHORIZED_SETTING</td><td>Machine Alarm</td><td>WARNING</td><td>Parameter with authorized access changed</td></tr>
<tr><td>AGV</td><td>301</td><td>WARNING_NO_LICENSE</td><td>Machine Alarm</td><td>WARNING</td><td>No license file or invalid license key</td></tr>
<tr><td>AGV</td><td>302</td><td>WARNING_TOO_MANY_LOG_FILES</td><td>Machine Alarm</td><td>WARNING</td><td>There are too many log files in logs -directory, oldest was overwritten</td></tr>
<tr><td>AGV</td><td>303</td><td>WARNING_LOG_DUMP</td><td>Machine Alarm</td><td>WARNING</td><td>Log dump failed</td></tr>
<tr><td>AGV</td><td>304</td><td>WARNING_NOT_ENOUGH_FREE_SPACE</td><td>Machine Alarm</td><td>WARNING</td><td>Not enough free disk space</td></tr>
<tr><td>AGV</td><td>305</td><td>WARNING_TEACHING_ALREADY_ON</td><td>Machine Alarm</td><td>WARNING</td><td>Teaching is already on</td></tr>
<tr><td>AGV</td><td>306</td><td>WARNING_FRONT_SCANNER_PROTECTION_ZONE</td><td>Machine Alarm</td><td>WARNING</td><td>Front laser scanner protection zone violated</td></tr>
<tr><td>AGV</td><td>307</td><td>WARNING_REAR_SCANNER_PROTECTION_ZONE</td><td>Machine Alarm</td><td>WARNING</td><td>Rear laser scanner protection zone violated</td></tr>
<tr><td>AGV</td><td>308</td><td>WARNING_FRONT_SCANNER_WARNING_ZONE1</td><td>Machine Alarm</td><td>WARNING</td><td>Front laser scanner warning zone 1 violated</td></tr>
<tr><td>AGV</td><td>309</td><td>WARNING_REAR_SCANNER_WARNING_ZONE1</td><td>Machine Alarm</td><td>WARNING</td><td>Rear laser scanner warning zone 1 violated</td></tr>
<tr><td>AGV</td><td>310</td><td>WARNING_FRONT_SCANNER_WARNING_ZONE2</td><td>Machine Alarm</td><td>WARNING</td><td>Front laser scanner warning zone 2 violated</td></tr>
<tr><td>AGV</td><td>311</td><td>WARNING_REAR_SCANNER_WARNING_ZONE2</td><td>Machine Alarm</td><td>WARNING</td><td>Rear laser scanner warning zone 2 violated</td></tr>
<tr><td>AGV</td><td>312</td><td>WARNING_FRONT_SCANNER_DIRTY</td><td>Machine Alarm</td><td>WARNING</td><td>Front laser scanner reports dirty window</td></tr>
<tr><td>AGV</td><td>313</td><td>WARNING_REAR_SCANNER_DIRTY</td><td>Machine Alarm</td><td>WARNING</td><td>Rear laser scanner reports dirty window</td></tr>
<tr><td>AGV</td><td>314</td><td>WARNING_HIGH_LOGGING_RATE</td><td>Machine Alarm</td><td>WARNING</td><td>Text log write rate is high and may affect performance</td></tr>
<tr><td>AGV</td><td>315</td><td>WARNING_TOO_LARGE_AUTO_ANG_RATE_CORR</td><td>Machine Alarm</td><td>WARNING</td><td>Too large odometry turning rate auto correction</td></tr>
<tr><td>AGV</td><td>316</td><td>WARNING_TOO_LARGE_AUTO_ODO_CORR</td><td>Machine Alarm</td><td>WARNING</td><td>Too large odometry distance auto correction</td></tr>
<tr><td>AGV</td><td>317</td><td>WARNING_TEACH_MODE_ENABLED</td><td>Machine Alarm</td><td>WARNING</td><td>Position correcting is disabled while teaching</td></tr>
<tr><td>AGV</td><td>318</td><td>WARNING_TOO_LARGE_AUTO_ANG_CORR</td><td>Machine Alarm</td><td>WARNING</td><td>Too large odometry heading auto correction</td></tr>
<tr><td>AGV</td><td>319</td><td>WARNING_INITIALIZING_POSITION</td><td>Machine Alarm</td><td>WARNING</td><td>Position is being initialized</td></tr>
<tr><td>AGV</td><td>320</td><td>WARNING_LARGE_CUM_XY_CORRECTION</td><td>Machine Alarm</td><td>WARNING</td><td>Large cumulative position correction over last meter</td></tr>
<tr><td>AGV</td><td>321</td><td>WARNING_LARGE_CUM_HEADING_CORRECTION</td><td>Machine Alarm</td><td>WARNING</td><td>Large cumulative heading correction over last meter</td></tr>
<tr><td>AGV</td><td>322</td><td>WARNING_SAFETY_SCANNER_PROTECTION_ZONE</td><td>Machine Alarm</td><td>WARNING</td><td>Safety laser scanner protection zone violated</td></tr>
<tr><td>AGV</td><td>323</td><td>WARNING_SAFETY_SCANNER_WARNING_ZONE1</td><td>Machine Alarm</td><td>WARNING</td><td>Safety laser scanner warning zone 1 violated</td></tr>
<tr><td>AGV</td><td>324</td><td>WARNING_SAFETY_SCANNER_WARNING_ZONE2</td><td>Machine Alarm</td><td>WARNING</td><td>Safety laser scanner warning zone 2 violated</td></tr>
<tr><td>AGV</td><td>325</td><td>WARNING_SAFETY_SCANNER_DIRTY</td><td>Machine Alarm</td><td>WARNING</td><td>Safety laser scanner reports dirty window</td></tr>
<tr><td>AGV</td><td>326</td><td>WARNING_CANNOT_RUN_MONITOR</td><td>Machine Alarm</td><td>WARNING</td><td>No scanner and odometry data to update to monitoring software</td></tr>
<tr><td>AGV</td><td>327</td><td>WARNING_DEADREC_HIGH_DT_STDEV</td><td>Machine Alarm</td><td>WARNING</td><td>Vehicle motor controller interface update interval standard deviance is too high</td></tr>
<tr><td>AGV</td><td>328</td><td>WARNING_ODOMETRY_SLIPPING</td><td>Machine Alarm</td><td>WARNING</td><td>Wheels are slipping or odometry is incorrect, increasing correction gains temporarily</td></tr>
<tr><td>AGV</td><td>329</td><td>WARNING_GENERIC</td><td>Machine Alarm</td><td>WARNING</td><td>Generic warning, check log for more details</td></tr>
<tr><td>AGV</td><td>330</td><td>WARNING_FRONT_SCANNER_WRONG_MODE</td><td>Machine Alarm</td><td>WARNING</td><td>Front laser scanner in wrong operating mode</td></tr>
<tr><td>AGV</td><td>331</td><td>WARNING_REAR_SCANNER_WRONG_MODE</td><td>Machine Alarm</td><td>WARNING</td><td>Rear laser scanner in wrong operating mode</td></tr>
<tr><td>AGV</td><td>332</td><td>WARNING_FRONT_SCANNER_NO_ZONE_INFO</td><td>Machine Alarm</td><td>WARNING</td><td>Front laser scanner, no protection/warning zone info</td></tr>
<tr><td>AGV</td><td>333</td><td>WARNING_REAR_SCANNER_NO_ZONE_INFO</td><td>Machine Alarm</td><td>WARNING</td><td>Rear laser scanner, no protection/warning zone info</td></tr>
<tr><td>AGV</td><td>334</td><td>WARNING_NO_REMOTE_CONTROL</td><td>Machine Alarm</td><td>WARNING</td><td>Remote control via web not available - version mismatch</td></tr>
<tr><td>AGV</td><td>335</td><td>WARNING_POSITION_NOT_INITIALIZED</td><td>Machine Alarm</td><td>WARNING</td><td>Position hasn't been initialized but vehicle can be driven as pos init not required</td></tr>
<tr><td>AGV</td><td>336</td><td>WARNING_POS_INIT_TIMEOUT</td><td>Machine Alarm</td><td>WARNING</td><td>Position initialization stopped due to timout</td></tr>
<tr><td>AGV</td><td>337</td><td>WARNING_CHARGER_FAULT</td><td>Machine Alarm</td><td>WARNING</td><td>Fault received from charger</td></tr>
<tr><td>AGV</td><td>338</td><td>WARNING_BMS</td><td>Machine Alarm</td><td>WARNING</td><td>Warning received from BMS</td></tr>
<tr><td>AGV</td><td>339</td><td>WARNING_NO_SCAN_FROM_FRONT_SCANNER</td><td>Machine Alarm</td><td>WARNING</td><td>Front scanner hasn't received scans</td></tr>
<tr><td>AGV</td><td>340</td><td>WARNING_NO_SCAN_FROM_REAR_SCANNER</td><td>Machine Alarm</td><td>WARNING</td><td>Rear scanner hasn't received scans</td></tr>
<tr><td>AGV</td><td>341</td><td>WARNING_SCANNER_FRONT_HIGH_DT</td><td>Machine Alarm</td><td>WARNING</td><td>Interval between received front laser scans is too high</td></tr>
<tr><td>AGV</td><td>342</td><td>WARNING_SCANNER_REAR_HIGH_DT</td><td>Machine Alarm</td><td>WARNING</td><td>Interval between received rear laser scans is too high</td></tr>
<tr><td>AGV</td><td>343</td><td>WARNING_DISTANCE_TO_TARGET</td><td>Machine Alarm</td><td>WARNING</td><td>AGV has driven too far away from unload point. Distance calculation is impossible</td></tr>
<tr><td>AGV</td><td>344</td><td>WARNING_NO_SCAN_FROM_MEAS_SCANNER</td><td>Machine Alarm</td><td>WARNING</td><td>One of the measurement scanners hasn't received scans</td></tr>
<tr><td>AGV</td><td>345</td><td>WARNING_LOADING_ENVIRONMENT</td><td>Machine Alarm</td><td>WARNING</td><td>Loading environment and segment file data. Loading has to be finished before driving can continue</td></tr>
<tr><td>AGV</td><td>346</td><td>WARNING_COUPLED_FORMATION_OFFSET_DETECTION</td><td>Machine Alarm</td><td>WARNING</td><td>Coupled formation offset detection measurement failure</td></tr>
<tr><td>AGV</td><td>347</td><td>WARNING_LARGE_FORMATION_ERR</td><td>Machine Alarm</td><td>WARNING</td><td>Formation error is larger than configured limits</td></tr>
<tr><td>AGV</td><td>348</td><td>WARNING_EXT_LOC_DOCKING_POSITION_CONFIDENCE_LOW</td><td>Machine Alarm</td><td>WARNING</td><td>Position confidence is low while docking with external localization</td></tr>
<tr><td>AGV</td><td>349</td><td>WARNING_PARAMETER_ZONE_PARAMETERS_NOT_FOUND</td><td>Machine Alarm</td><td>WARNING</td><td>AGV is inside parameter zone and but related params_zoneX.txt was not found</td></tr>
<tr><td>AGV</td><td>401</td><td>ERROR_VEH_INTE_HIGH_DT</td><td>Machine Alarm</td><td>ERROR</td><td>Vehicle motor controller interface update interval is too high</td></tr>
<tr><td>AGV</td><td>402</td><td>ERROR_MOTOR_CONTROL_FAULT</td><td>Machine Alarm</td><td>ERROR</td><td>Drive motor controller indicates fault</td></tr>
<tr><td>AGV</td><td>403</td><td>ERROR_MOTOR_CONTROL_COMMS</td><td>Machine Alarm</td><td>ERROR</td><td>Drive motor controller communication fault</td></tr>
<tr><td>AGV</td><td>404</td><td>ERROR_IO</td><td>Machine Alarm</td><td>ERROR</td><td>I/O interface is in error state</td></tr>
<tr><td>AGV</td><td>405</td><td>ERROR_POS_CONT_SEG_FILE_PARSING_ERROR</td><td>Machine Alarm</td><td>ERROR</td><td>Pos cont segment file parsing failed</td></tr>
<tr><td>AGV</td><td>501</td><td>ERROR_POS_CONT_HEADING_ERR</td><td>Machine Alarm</td><td>ERROR</td><td>Pos Cont too high heading error</td></tr>
<tr><td>AGV</td><td>502</td><td>ERROR_POS_CONT_POS_ERR</td><td>Machine Alarm</td><td>ERROR</td><td>Pos cont too high position error</td></tr>
<tr><td>AGV</td><td>503</td><td>ERROR_VEH_INTE_NOT_READY</td><td>Machine Alarm</td><td>ERROR</td><td>Vehicle motor interface task is not ready</td></tr>
<tr><td>AGV</td><td>504</td><td>ERROR_VEH_INTE_CONNECTION</td><td>Machine Alarm</td><td>ERROR</td><td>Communication to vehicle motor controller not working</td></tr>
<tr><td>AGV</td><td>505</td><td>ERROR_POS_CONT_FORK_TIME_ERR</td><td>Machine Alarm</td><td>ERROR</td><td>Pos Cont fork value did not reach reference value within time limit</td></tr>
<tr><td>AGV</td><td>506</td><td>ERROR_POS_CONT_SPEED_HIGH</td><td>Machine Alarm</td><td>ERROR</td><td>Speed value difference too high above the reference value</td></tr>
<tr><td>AGV</td><td>507</td><td>ERROR_POS_CONT_SPEED_LOW</td><td>Machine Alarm</td><td>ERROR</td><td>Speed value difference too high below the reference value</td></tr>
<tr><td>AGV</td><td>508</td><td>ERROR_POS_CONT_FORK_LIMIT_ERR</td><td>Machine Alarm</td><td>ERROR</td><td>Pos Cont fork value outside of hard limits</td></tr>
<tr><td>AGV</td><td>509</td><td>ERROR_POS_CONT_SEG_ERROR</td><td>Machine Alarm</td><td>ERROR</td><td>Pos cont segment error</td></tr>
<tr><td>AGV</td><td>510</td><td>ERROR_ACTUATOR_DATA_MISSING_FROM_SEGMENTS</td><td>Machine Alarm</td><td>ERROR</td><td>Segment file does not actuator control values</td></tr>
<tr><td>AGV</td><td>511</td><td>ERROR_MOTOR_TEMP_SENSOR</td><td>Machine Alarm</td><td>ERROR</td><td>Motor over temperature</td></tr>
<tr><td>AGV</td><td>512</td><td>ERROR_SAFETY_CIRCUIT_COMMS</td><td>Machine Alarm</td><td>ERROR</td><td>Safety circuit communication fault</td></tr>
<tr><td>AGV</td><td>513</td><td>ERROR_DEAD_RECK_JUMP</td><td>Machine Alarm</td><td>ERROR</td><td>Deadreckoning detected a jump in raw odometry</td></tr>
<tr><td>AGV</td><td>514</td><td>ERROR_LOAD_POSITION_ERROR</td><td>Machine Alarm</td><td>ERROR</td><td>Actuator activation blocked, because AGV is too far away from the symbolic point</td></tr>
<tr><td>AGV</td><td>515</td><td>ERROR_ACTUATOR_USE_NOT_ALLOWED</td><td>Machine Alarm</td><td>ERROR</td><td>Tried to activate actuator on wrong location,<br>E.g. load on unload symbolic point or load not detected when it should be</td></tr>
<tr><td>AGV</td><td>516</td><td>ERROR_RACKING_WRONG_PARAMETERS</td><td>Machine Alarm</td><td>ERROR</td><td>Racking parameters are limiting drive mission to given height</td></tr>
<tr><td>AGV</td><td>517</td><td>ERROR_ACTUATOR_SAFE_ZONE_VIOLATION</td><td>Machine Alarm</td><td>ERROR</td><td>Too high difference between target and measured value in actuator safe zone</td></tr>
<tr><td>AGV</td><td>518</td><td>ERROR_RACKING_AGV_TOO_CLOSE_RACK</td><td>Machine Alarm</td><td>ERROR</td><td>AGV too close to rack to be able to move actuator</td></tr>
<tr><td>AGV</td><td>519</td><td>ERROR_PALLET_DET_FOUND_AND_SEARCHED_MISMATCH</td><td>Machine Alarm</td><td>ERROR</td><td>Target detection - found target does not match the searched ones set in Supervisor message 3032</td></tr>
<tr><td>AGV</td><td>520</td><td>ERROR_BATTERY_HIGH_TEMPERATURE</td><td>Machine Alarm</td><td>ERROR</td><td>Battery temperature has exeeded the error limit</td></tr>
<tr><td>AGV</td><td>521</td><td>ERROR_CANNOT_CHANGE_RACKING_STATE</td><td>Machine Alarm</td><td>ERROR</td><td>AGV does not fulfill the required criteria to change the current state and move to next in racking drive order</td></tr>
<tr><td>AGV</td><td>522</td><td>ERROR_RACKING_EMPTY_SPACE_NOT_DETECTED</td><td>Machine Alarm</td><td>ERROR</td><td>Unload area not free, cannot continue driving</td></tr>
<tr><td>AGV</td><td>523</td><td>ERROR_PALLET_POCKET_NOT_FOUND</td><td>Machine Alarm</td><td>ERROR</td><td>Couldn't find suitable pocket</td></tr>
<tr><td>AGV</td><td>524</td><td>ERROR_RACKING_BEAM_DETECTION_FAILED</td><td>Machine Alarm</td><td>ERROR</td><td>Couldn't find suitable beam for detecting the shelf height</td></tr>
<tr><td>AGV</td><td>525</td><td>ERROR_PALLET_DET_FAILURE</td><td>Machine Alarm</td><td>ERROR</td><td>Couldn't find pallet or target is too far away from expected location</td></tr>
<tr><td>AGV</td><td>526</td><td>ERROR_ACTUATOR_OUT_OF_TOLERANCES_CLOSE_RACK</td><td>Machine Alarm</td><td>ERROR</td><td>Too high difference between target and measured value close to rack</td></tr>
<tr><td>AGV</td><td>527</td><td>ERROR_RACKING_PALLET_LOADING_UNLOADING_ISSUE</td><td>Machine Alarm</td><td>ERROR</td><td>The pallet is either being pushed or dragged during loading or unloading respectively</td></tr>
<tr><td>AGV</td><td>528</td><td>ERROR_LOAD_SENSOR_CONFLICT_WITH_NAVITHOR</td><td>Machine Alarm</td><td>ERROR</td><td>Load sensor does not match with Navithor load status</td></tr>
<tr><td>AGV</td><td>529</td><td>ERROR_VEHICLE_POSITION_NOT_CHANGING_WHILE_DRIVING</td><td>Machine Alarm</td><td>ERROR</td><td>Odometry data is indicating a change, but position is not changing</td></tr>
<tr><td>AGV</td><td>530</td><td>ERROR_CURVATURE_TOO_HIGH</td><td>Machine Alarm</td><td>ERROR</td><td>AGV can't drive the curvature, because it has limited steer angle</td></tr>
<tr><td>AGV</td><td>531</td><td>ERROR_RACKING_PALLET_DETECTION_DATA_NOT_UPDATED</td><td>Machine Alarm</td><td>ERROR</td><td>The pallet detection data is not available for detecting pushing/dragging of pallet</td></tr>
<tr><td>AGV</td><td>532</td><td>ERROR_RACKING_DISABLED</td><td>Machine Alarm</td><td>ERROR</td><td>Received drive order to Rack point, but racking is disabled</td></tr>
<tr><td>AGV</td><td>533</td><td>ERROR_MODBUS_COMMS</td><td>Machine Alarm</td><td>ERROR</td><td>Modbus connection error</td></tr>
<tr><td>AGV</td><td>534</td><td>ERROR_STACKLOADING_TARGET_TOO_HIGH</td><td>Machine Alarm</td><td>ERROR</td><td>The scanning height is over the maximum limit</td></tr>
<tr><td>AGV</td><td>535</td><td>ERROR_COUPLED_DRIVE_COMMS</td><td>Machine Alarm</td><td>ERROR</td><td>Communication error with one or more machines in coupled drive</td></tr>
<tr><td>AGV</td><td>536</td><td>ERROR_LARGE_FORMATION_ERR</td><td>Machine Alarm</td><td>ERROR</td><td>Formation error is larger than configured limits</td></tr>
<tr><td>AGV</td><td>537</td><td>ERROR_NAVI_COMM_VERSION</td><td>Machine Alarm</td><td>ERROR</td><td>Version mismatch in Navitrol-Navitrol communication, which is used for example in synchronous driving</td></tr>
<tr><td>AGV</td><td>538</td><td>ERROR_COUPLED_DRIVE_CONFIG</td><td>Machine Alarm</td><td>ERROR</td><td>Invalid configuration for coupled drive</td></tr>
<tr><td>AGV</td><td>539</td><td>ERROR_CANNOT_CREATE_CUSTOM_ROUTE</td><td>Machine Alarm</td><td>ERROR</td><td>AGV is too close to target to create custom route</td></tr>
<tr><td>AGV</td><td>540</td><td>ERROR_LOAD_BUFFER_STOP_POINT_NOT_INSIDE_BUFFER_AREA</td><td>Machine Alarm</td><td>ERROR</td><td>Stop point is not calculated inside the buffer area, cannot perform load there</td></tr>
<tr><td>AGV</td><td>541</td><td>ERROR_DRIVE_ORDER_TOO_CLOSE_TO_RACK</td><td>Machine Alarm</td><td>ERROR</td><td>Drive order given too close to rack, cannot drive closer</td></tr>
<tr><td>AGV</td><td>542</td><td>ERROR_RACKING_SHELF_ID_NOT_VALID</td><td>Machine Alarm</td><td>ERROR</td><td>Received shelf id 0 from Navithor, cannot continue driving</td></tr>
<tr><td>AGV</td><td>543</td><td>ERROR_COUPLED_DRIVE_ACTIVE_ERRORS</td><td>Machine Alarm</td><td>ERROR</td><td>Errors are active on one or more machines in coupled drive</td></tr>
<tr><td>AGV</td><td>544</td><td>ERROR_EXT_LOC_NOT_SAFE_TO_DRIVE</td><td>Machine Alarm</td><td>ERROR</td><td>Driving safety using external localization is not guaranteed</td></tr>
<tr><td>AGV</td><td>545</td><td>ERROR_EXT_LOC_STOP_POINT_NOT_REACHED</td><td>Machine Alarm</td><td>ERROR</td><td>AGV has not reached the external localization stop point</td></tr>
<tr><td>AGV</td><td>546</td><td>ERROR_POCKET_DET_TARGET_TOO_HIGH</td><td>Machine Alarm</td><td>ERROR</td><td>Pocket detection target goes higher than actuator_max_val</td></tr>
<tr><td>AGV</td><td>547</td><td>ERROR_BARRIER_STOP_FAILED</td><td>Machine Alarm</td><td>ERROR</td><td>Barrier stop failed</td></tr>
<tr><td>AGV</td><td>548</td><td>ERROR_AGV_AT_RACK_AFTER_STARTUP</td><td>Machine Alarm</td><td>ERROR</td><td>AGV is too close to rack after start. Cannot do anything.</td></tr>
<tr><td>AGV</td><td>549</td><td>ERROR_STACKLOADING_POCKET_FOUND_TOO_LOW</td><td>Machine Alarm</td><td>ERROR</td><td>The found pocket was found too low</td></tr>
<tr><td>AGV</td><td>550</td><td>ERROR_LOAD_UNLOAD_HEIGHT_TOO_LOW</td><td>Machine Alarm</td><td>ERROR</td><td>The loading or unloading target height is too low. Cannot perform load or unload.</td></tr>
<tr><td>AGV</td><td>551</td><td>ERROR_RTR_AND_VECTOR_DRIVE_CONFLICT</td><td>Machine Alarm</td><td>ERROR</td><td>Return to route is not possible when vector drive is used, turn off vector drive to use rerturn to route</td></tr>
<tr><td>AGV</td><td>552</td><td>ERROR_OBSTACLE_DETECTED</td><td>Machine Alarm</td><td>ERROR</td><td>Detected an obstacle within zone</td></tr>
<tr><td>AGV</td><td>601</td><td>WARNING_AGV_LOW_BATTERY</td><td>Machine Alarm</td><td>WARNING</td><td>AGV battery level low</td></tr>
<tr><td>AGV</td><td>602</td><td>WARNING_POS_CONT_FORK_WAR</td><td>Machine Alarm</td><td>WARNING</td><td>Pos cont fork value not within limits. Move not allowed</td></tr>
<tr><td>AGV</td><td>603</td><td>WARNING_ESTOP_ACTIVE</td><td>Machine Alarm</td><td>WARNING</td><td>Emergency stop is active</td></tr>
<tr><td>AGV</td><td>604</td><td>WARNING_FW_OBSTACLE</td><td>Machine Alarm</td><td>WARNING</td><td>Obstacle detected in front of vehicle. Speed may be limited</td></tr>
<tr><td>AGV</td><td>605</td><td>WARNING_BW_OBSTACLE</td><td>Machine Alarm</td><td>WARNING</td><td>Obstacle detected behind of vehicle. Speed may be limited</td></tr>
<tr><td>AGV</td><td>606</td><td>WARNING_SLOWED_DOWN_EXTERNAL_SOURCE</td><td>Machine Alarm</td><td>WARNING</td><td>Slow down request received from External source (e.g. PLC or IO)</td></tr>
<tr><td>AGV</td><td>607</td><td>WARNING_SAFETY_SCANNER_OBSTACLE</td><td>Machine Alarm</td><td>WARNING</td><td>Obstacle detected by one of safety scanners. Speed may be limited</td></tr>
<tr><td>AGV</td><td>608</td><td>WARNING_VEH_INTE_HIGH_DT_STDEV</td><td>Machine Alarm</td><td>WARNING</td><td>Vehicle motor controller interface update interval standard deviance is too high</td></tr>
<tr><td>AGV</td><td>609</td><td>WARNING_STANDALONE_DISABLED</td><td>Machine Alarm</td><td>WARNING</td><td>Standalone feature disabled. Possible reasons Fleet control is connected or Production simulation is Enabled in monitoring software</td></tr>
<tr><td>AGV</td><td>610</td><td>WARNING_NO_SEG_FILE</td><td>Machine Alarm</td><td>WARNING</td><td>Segment file not found</td></tr>
<tr><td>AGV</td><td>611</td><td>WARNING_AGV_NO_BATTERY_LEVEL</td><td>Machine Alarm</td><td>WARNING</td><td>AGV battery level unknown</td></tr>
<tr><td>AGV</td><td>612</td><td>WARNING_TARGET_NOT_DETECTED</td><td>Machine Alarm</td><td>WARNING</td><td>Target for docking not detected</td></tr>
<tr><td>AGV</td><td>613</td><td>WARNING_TARGET_APPROACH_ERROR</td><td>Machine Alarm</td><td>WARNING</td><td>Target location differs too much fromExpected</td></tr>
<tr><td>AGV</td><td>614</td><td>WARNING_DRIVING_WITH_ONLY_ODOMETRY</td><td>Machine Alarm</td><td>WARNING</td><td>Location correction disabled, driving with only odometry</td></tr>
<tr><td>AGV</td><td>615</td><td>WARNING_LOW_POS_CONF_SLOWED_DOWN</td><td>Machine Alarm</td><td>WARNING</td><td>Slowing down due to low position confidence</td></tr>
<tr><td>AGV</td><td>616</td><td>WARNING_NAVITHOR_NOT_CONNECTED</td><td>Machine Alarm</td><td>WARNING</td><td></td></tr>
<tr><td>AGV</td><td>617</td><td>WARNING_SPEED_LIMITED</td><td>Machine Alarm</td><td>WARNING</td><td>Speed limitedE.g. because of load status</td></tr>
<tr><td>AGV</td><td>618</td><td>WARNING_LOAD_POSITION_ERROR</td><td>Machine Alarm</td><td>WARNING</td><td>Actuator activation was blocked, because AGV is too far away from the symbolic point</td></tr>
<tr><td>AGV</td><td>619</td><td>WARNING_ACTUATOR_USE_NOT_ALLOWED</td><td>Machine Alarm</td><td>WARNING</td><td>Tried to activate actuator on wrong location, e.g. load on unload symbolic point</td></tr>
<tr><td>AGV</td><td>620</td><td>WARNING_SYMBOL_POINT_OCCUPIED</td><td>Machine Alarm</td><td>WARNING</td><td>Object detected in occupancy check area</td></tr>
<tr><td>AGV</td><td>621</td><td>WARNING_DRIVE_ORDER_DISABLED</td><td>Machine Alarm</td><td>WARNING</td><td>Drive order was disabled by an external source</td></tr>
<tr><td>AGV</td><td>622</td><td>WARNING_OBSTACLE_DETECTED</td><td>Machine Alarm</td><td>WARNING</td><td>Detected an obstacle</td></tr>
<tr><td>AGV</td><td>623</td><td>WARNING_OBSTACLE_BYPASS_FAILED</td><td>Machine Alarm</td><td>WARNING</td><td>Not enough free disk space</td></tr>
<tr><td>AGV</td><td>624</td><td>WARNING_WAITING_OBSTACLE_BYPASS_PERMISSION</td><td>Machine Alarm</td><td>WARNING</td><td>Waiting for permission to bypass obstacles</td></tr>
<tr><td>AGV</td><td>625</td><td>WARNING_NO_OBSTACLE_ZONES</td><td>Machine Alarm</td><td>WARNING</td><td>Cannot perform bypass because no obstacle zones have been defined</td></tr>
<tr><td>AGV</td><td>626</td><td>WARNING_MOVING_OBSTACLE</td><td>Machine Alarm</td><td>WARNING</td><td>Cannot perform bypass because obstacle is moving. Stopping and waiting that it stops</td></tr>
<tr><td>AGV</td><td>627</td><td>WARNING_BYPASS_ROUTE_OUT_OF_ZONE</td><td>Machine Alarm</td><td>WARNING</td><td>Cannot perform bypass because the trajectory would be outside obstacle avoidance zone. Trying the other side if possible</td></tr>
<tr><td>AGV</td><td>628</td><td>WARNING_OBSTACLE_TOO_CLOSE</td><td>Machine Alarm</td><td>WARNING</td><td>Cannot drive around the obstacle because it is too close to the AGV</td></tr>
<tr><td>AGV</td><td>629</td><td>WARNING_CANNOT_BYPASS_REVERSING_TO_NOMINAL_ROUTE</td><td>Machine Alarm</td><td>WARNING</td><td>Cannot drive around the obstacle. Reversing back to nominal route</td></tr>
<tr><td>AGV</td><td>630</td><td>WARNING_CANNOT_BYPASS_DID_NOT_GET_FLEET_CONTROL_PERMISSION</td><td>Machine Alarm</td><td>WARNING</td><td>Cannot drive around the obstacle because fleet control did not give permission</td></tr>
<tr><td>AGV</td><td>631</td><td>WARNING_BEGINNING_DRIVING_AROUND_OBSTACLE</td><td>Machine Alarm</td><td>WARNING</td><td>Beginning to drive around the obstacle. The AGV will drive outside the nominal route</td></tr>
<tr><td>AGV</td><td>632</td><td>WARNING_COULD_NOT_CREATE_EXTEND_DRIVE_WHILE_BYPASSING</td><td>Machine Alarm</td><td>WARNING</td><td>Extend drive while bypassing failed</td></tr>
<tr><td>AGV</td><td>633</td><td>WARNING_WRONG_AGV_STATUS_MESSAGE_VERSION</td><td>Machine Alarm</td><td>WARNING</td><td>Cannot use obstacle avoidance with fleet control because agv status message version is wrong</td></tr>
<tr><td>AGV</td><td>634</td><td>WARNING_CANNOT_BYPASS_OBSTACLE_TOO_WIDE</td><td>Machine Alarm</td><td>WARNING</td><td>Cannot drive around the obstacle because it is too wide: the AGV would have to make too sharp turn and get too far away from the nominal trajectory</td></tr>
<tr><td>AGV</td><td>635</td><td>WARNING_BATTERY_FULL_CHARGE_NEEDED</td><td>Machine Alarm</td><td>WARNING</td><td>Battery charge to full is needed to maintain battery</td></tr>
<tr><td>AGV</td><td>636</td><td>WARNING_BATTERY_ERROR_OR_WARNING_ACTIVE</td><td>Machine Alarm</td><td>WARNING</td><td>Battery has an active error</td></tr>
<tr><td>AGV</td><td>637</td><td>WARNING_LOAD_DETECTION_CONFLICT</td><td>Machine Alarm</td><td>WARNING</td><td>Load detection sensor conflicts with Navithor's loading status</td></tr>
<tr><td>AGV</td><td>638</td><td>WARNING_SENSOR_FAILURE_IN_LOADING</td><td>Machine Alarm</td><td>WARNING</td><td>Load detection sensor did not recognise a load</td></tr>
<tr><td>AGV</td><td>639</td><td>WARNING_CHARGING_ACTIVE</td><td>Machine Alarm</td><td>WARNING</td><td>Vehicle is stopped because of charging</td></tr>
<tr><td>AGV</td><td>640</td><td>WARNING_INACCNAV_MODE_ACTIVE</td><td>Machine Alarm</td><td>WARNING</td><td>AGV changed to inaccurate navigation mode</td></tr>
<tr><td>AGV</td><td>641</td><td>WARNING_PUSHING_PALLET</td><td>Machine Alarm</td><td>WARNING</td><td>AGV stopped due possible pushing of pallet</td></tr>
<tr><td>AGV</td><td>642</td><td>WARNING_EXTERNAL_SPEED_LIMITATION</td><td>Machine Alarm</td><td>WARNING</td><td>Speed is limited below reference byExternal source</td></tr>
<tr><td>AGV</td><td>643</td><td>WARNING_OBSTACLE_TOO_LONG</td><td>Machine Alarm</td><td>WARNING</td><td>Length of bypassed obstacle is limited</td></tr>
<tr><td>AGV</td><td>644</td><td>WARNING_CHANGING_LOAD_OR_UNLOAD_HEIGHT</td><td>Machine Alarm</td><td>WARNING</td><td>The correct height is detected with sensor</td></tr>
<tr><td>AGV</td><td>645</td><td>WARNING_LOAD_ABOARD_WHEN_DRIVING_TO_LOAD_BUFFER</td><td>Machine Alarm</td><td>WARNING</td><td>Navitrol load status is load aboard. Can't drive to load buffer with load.</td></tr>
<tr><td>AGV</td><td>646</td><td>WARNING_BATTERY_HIGH_TEMPERATURE</td><td>Machine Alarm</td><td>WARNING</td><td>Battery temperature has exceeded the warning limit</td></tr>
<tr><td>AGV</td><td>647</td><td>WARNING_DECREASING_FORK_TO_ROUTE_LEVEL</td><td>Machine Alarm</td><td>WARNING</td><td>Vehicle is stopped until fork reaches the route height</td></tr>
<tr><td>AGV</td><td>648</td><td>WARNING_RACKING_PRECHECKS</td><td>Machine Alarm</td><td>WARNING</td><td>AGV stopped due to racking prechecks</td></tr>
<tr><td>AGV</td><td>649</td><td>WARNING_BARRIER_STOP_FAILED</td><td>Machine Alarm</td><td>WARNING</td><td>Barrier stop failed</td></tr>
<tr><td>AGV</td><td>650</td><td>WARNING_SLOWED_DOWN_SOURCE_MONITOR</td><td>Machine Alarm</td><td>WARNING</td><td>Slow down request received from monitoring software</td></tr>
<tr><td>AGV</td><td>651</td><td>WARNING_SLOWED_DOWN_SOURCE_SUPERVISOR</td><td>Machine Alarm</td><td>WARNING</td><td>Slow down request received from supervisor interface</td></tr>
<tr><td>AGV</td><td>652</td><td>WARNING_SLOWED_DOWN_SOURCE_FLEET_CONTROL</td><td>Machine Alarm</td><td>WARNING</td><td>Slow down request received from fleet control</td></tr>
<tr><td>AGV</td><td>653</td><td>WARNING_SLOWED_DOWN_SOURCE_CONSOLE</td><td>Machine Alarm</td><td>WARNING</td><td>Slow down request received from console</td></tr>
<tr><td>AGV</td><td>654</td><td>WARNING_SLOWED_DOWN_SOURCE_ACTIVE_ERROR</td><td>Machine Alarm</td><td>WARNING</td><td>Slow down request because of active error</td></tr>
<tr><td>AGV</td><td>655</td><td>WARNING_SLOWED_DOWN_COUPLED_DRIVE_COMM</td><td>Machine Alarm</td><td>WARNING</td><td>Slow down because of coupled drive communication issues</td></tr>
<tr><td>AGV</td><td>656</td><td>WARNING_SLOWED_DOWN_AUTO_MOVE_DELAY</td><td>Machine Alarm</td><td>WARNING</td><td>Slow down because of auto move delay</td></tr>
<tr><td>AGV</td><td>657</td><td>WARNING_RETURN_TO_ROUTE_FAILED</td><td>Machine Alarm</td><td>WARNING</td><td>Return to route feature could not find a suitable return point or command was rejected as the AGV was not in standby state.</td></tr>
<tr><td>AGV</td><td>701</td><td>ERROR_SCANNER_PARAMS_NOT_VALID</td><td>Machine Alarm</td><td>ERROR</td><td>Scanner parameters are not valid</td></tr>
<tr><td>AGV</td><td>702</td><td>ERROR_FRONT_SCANNER_FAULT</td><td>Machine Alarm</td><td>ERROR</td><td>Front scanner reports internal hardware fault</td></tr>
<tr><td>AGV</td><td>703</td><td>ERROR_REAR_SCANNER_FAULT</td><td>Machine Alarm</td><td>ERROR</td><td>Rear scanner reports internal hardware fault</td></tr>
<tr><td>AGV</td><td>704</td><td>ERROR_LIFT_CTRL_NOCOMMS</td><td>Machine Alarm</td><td>ERROR</td><td>Lift motor controller communication failure</td></tr>
<tr><td>AGV</td><td>705</td><td>ERROR_LIFT_CTRL_CONTROLLER_FAULT</td><td>Machine Alarm</td><td>ERROR</td><td>Lift motor controller indicates fault</td></tr>
<tr><td>AGV</td><td>706</td><td>ERROR_LIFT_CTRL_CALIB_FAILED_OUT_OF_LIMITS</td><td>Machine Alarm</td><td>ERROR</td><td>Lift height measurement calibration failed to move lift so limit switches would be released</td></tr>
<tr><td>AGV</td><td>707</td><td>ERROR_PLC_FAILURE</td><td>Machine Alarm</td><td>ERROR</td><td>PLC error</td></tr>
<tr><td>AGV</td><td>708</td><td>ERROR_NO_PLC_DATA</td><td>Machine Alarm</td><td>ERROR</td><td>No communication to PLC</td></tr>
<tr><td>AGV</td><td>709</td><td>ERROR_CAN_FAILURE</td><td>Machine Alarm</td><td>ERROR</td><td>CAN bus, hw or driver error</td></tr>
<tr><td>AGV</td><td>710</td><td>ERROR_TOO_LARGE_STEER_ANGLE</td><td>Machine Alarm</td><td>ERROR</td><td>Measured Steering angle too large</td></tr>
<tr><td>AGV</td><td>711</td><td>ERROR_SAFETY_SCANNER_FAULT</td><td>Machine Alarm</td><td>ERROR</td><td>Safety scanner reports internal hardware fault</td></tr>
<tr><td>AGV</td><td>712</td><td>ERROR_SAFE_OUTPUTS_ACTIVE</td><td>Machine Alarm</td><td>ERROR</td><td>Safe outputs active - velocities set to zero</td></tr>
<tr><td>AGV</td><td>713</td><td>ERROR_TRAILER_TRANSPORT_COUPLING</td><td>Machine Alarm</td><td>ERROR</td><td>Failure in trailer coupling or uncoupling sequence</td></tr>
<tr><td>AGV</td><td>714</td><td>ERROR_TRAILER_STATUS_NOT_RECEIVED</td><td>Machine Alarm</td><td>ERROR</td><td>Valid trailer transport status not received</td></tr>
<tr><td>AGV</td><td>715</td><td>ERROR_TRAILER_ANGLE_NOT_DETECTED</td><td>Machine Alarm</td><td>ERROR</td><td>Failed to detect the trailer angle</td></tr>
<tr><td>AGV</td><td>716</td><td>ERROR_TRAILER_ANGLE_TOO_LARGE</td><td>Machine Alarm</td><td>ERROR</td><td>Detected trailer angle exceeds the set limits</td></tr>
<tr><td>AGV</td><td>801</td><td>ERROR_PLC_COMMS_STOP</td><td>Machine Alarm</td><td>ERROR</td><td>PLC stopped machine due to communication break</td></tr>
<tr><td>AGV</td><td>802</td><td>ERROR_GENERIC_IO_DEFINITIONS</td><td>Machine Alarm</td><td>ERROR</td><td>Error or problem in generic I/O definitions</td></tr>
<tr><td>AGV</td><td>803</td><td>ERROR_ETH_ERROR</td><td>Machine Alarm</td><td>ERROR</td><td>Error on AGV</td></tr>
<tr><td>AGV</td><td>804</td><td>ERROR_ETH_UNKNOWN_STATUS</td><td>Machine Alarm</td><td>ERROR</td><td>AGV sent unknown error status</td></tr>
<tr><td>AGV</td><td>805</td><td>ERROR_CAN_ALL_NODES_NOT_OPER</td><td>Machine Alarm</td><td>ERROR</td><td>One or more nodes not operational or all receive messages not detected</td></tr>
<tr><td>AGV</td><td>806</td><td>ERROR_CAN_RX_TIMEOUT</td><td>Machine Alarm</td><td>ERROR</td><td>Received timeout in one or more receive messages</td></tr>
<tr><td>AGV</td><td>807</td><td>ERROR_CAN_DATA</td><td>Machine Alarm</td><td>ERROR</td><td>Invalid data in CAN msg</td></tr>
<tr><td>AGV</td><td>808</td><td>ERROR_CAN_CONFIG</td><td>Machine Alarm</td><td>ERROR</td><td>CAN slave configuration failure</td></tr>
<tr><td>AGV</td><td>809</td><td>ERROR_AGV_CONTROLLER</td><td>Machine Alarm</td><td>ERROR</td><td>AGV controller alarm</td></tr>
<tr><td>AGV</td><td>810</td><td>ERROR_RLS_SENSOR</td><td>Machine Alarm</td><td>ERROR</td><td>RLS sensor failure</td></tr>
<tr><td>AGV</td><td>811</td><td>ERROR_HITCH_TONGUE_PRESENT_TIMEOUT</td><td>Machine Alarm</td><td>ERROR</td><td>Hitch tongue wasn't detected within time limit</td></tr>
<tr><td>AGV</td><td>812</td><td>ERROR_HITCH_OPEN_TIMEOUT</td><td>Machine Alarm</td><td>ERROR</td><td>Hitch error: Hitch Open not detected</td></tr>
<tr><td>AGV</td><td>813</td><td>ERROR_HITCH_CLOSE_TIMEOUT</td><td>Machine Alarm</td><td>ERROR</td><td>Hitch error: Hitch Closed not detected</td></tr>
<tr><td>AGV</td><td>814</td><td>ERROR_HITCH_TONGUE_NOT_DETECTED</td><td>Machine Alarm</td><td>ERROR</td><td>Hitch error: Tongue is not detected</td></tr>
<tr><td>AGV</td><td>815</td><td>ERROR_HITCH_PIN_OPENED</td><td>Machine Alarm</td><td>ERROR</td><td>Hitch pin openedEven though it should stay closed</td></tr>
<tr><td>AGV</td><td>816</td><td>ERROR_HITCH_PIN_CLOSED</td><td>Machine Alarm</td><td>ERROR</td><td>Hitch pin closedEven though it should stay open</td></tr>
<tr><td>AGV</td><td>817</td><td>ERROR_HITCH_ALREADY_CLOSED</td><td>Machine Alarm</td><td>ERROR</td><td>Hitch pin was already closed when trying to close it</td></tr>
<tr><td>AGV</td><td>818</td><td>ERROR_CAN_CONFIG_SYNC</td><td>Machine Alarm</td><td>ERROR</td><td>CAN error - no rx sync objects defined</td></tr>
<tr><td>AGV</td><td>819</td><td>ERROR_PLC</td><td>Machine Alarm</td><td>ERROR</td><td>PLC error received</td></tr>
<tr><td>AGV</td><td>820</td><td>ERROR_CAN_CONFIG_PARAM</td><td>Machine Alarm</td><td>ERROR</td><td>CAN configuration parameter failure</td></tr>
<tr><td>AGV</td><td>821</td><td>ERROR_NO_SUPERVISOR_COMMS</td><td>Machine Alarm</td><td>ERROR</td><td>Safety scanner hasn't received scans</td></tr>
<tr><td>AGV</td><td>822</td><td>ERROR_ETHERNET_FEEDBACK_DATA_ISNAN</td><td>Machine Alarm</td><td>ERROR</td><td>Ethernet vehicle feedback data is NAN or INF</td></tr>
<tr><td>AGV</td><td>823</td><td>ERROR_ETHERNET_FEEDBACK_EXCEEDING_LIMIT</td><td>Machine Alarm</td><td>ERROR</td><td>Ethernet vehicle feedback data exceeds limits</td></tr>
<tr><td>AGV</td><td>824</td><td>ERROR_CAN_SDO_FILE</td><td>Machine Alarm</td><td>ERROR</td><td>CAN SDO write configuration file failure</td></tr>
<tr><td>AGV</td><td>825</td><td>ERROR_IMU_FAILURE</td><td>Machine Alarm</td><td>ERROR</td><td>IMU error or no connection</td></tr>
<tr><td>AGV</td><td>826</td><td>ERROR_CAN_HIGH_DT</td><td>Machine Alarm</td><td>ERROR</td><td>Vehicle interface to CAN update interval is too high</td></tr>
<tr><td>AGV</td><td>827</td><td>ERROR_STOPPED_BY_ULTRASONIC_SENSORS</td><td>Machine Alarm</td><td>ERROR</td><td>AGV stopped by ultrasonic sensors</td></tr>
<tr><td>AGV</td><td>828</td><td>ERROR_EXTERNAL_TARGET_DETECTION_SENSOR</td><td>Machine Alarm</td><td>ERROR</td><td>External target detection sensor error</td></tr>
<tr><td>AGV</td><td>829</td><td>ERROR_ETHERNET_FEEDBACK_INVALID</td><td>Machine Alarm</td><td>ERROR</td><td>Ethernet vehicle feedback data is regarded to be invalid</td></tr>
<tr><td>AGV</td><td>830</td><td>ERROR_GPS_NO_CONNECTION</td><td>Machine Alarm</td><td>ERROR</td><td>Could not connect to the GPS receiver</td></tr>
<tr><td>AGV</td><td>831</td><td>ERROR_COUPLED_FORMATION_OFFSET_DETECTION</td><td>Machine Alarm</td><td>ERROR</td><td>Coupled formation offset detection measurement failure</td></tr>
<tr><td>AGV</td><td>832</td><td>ERROR_ETHERNET_CONTROL_MESSAGE_TIMEOUT</td><td>Machine Alarm</td><td>ERROR</td><td>Ethernet control data timeout</td></tr>
<tr><td>AGV</td><td>833</td><td>ERROR_ACTUATOR_UPDATE_MEASUREMENT_TIMEOUT</td><td>Machine Alarm</td><td>ERROR</td><td>Actuator measurement timeout</td></tr>
<tr><td>AGV</td><td>834</td><td>ERROR_HOMING_IN_PROCESS</td><td>Machine Alarm</td><td>ERROR</td><td>Homing in process. Driving is not yet possible</td></tr>
<tr><td>AGV</td><td>835</td><td>ERROR_ROS_NO_CONNECTION</td><td>Machine Alarm</td><td>ERROR</td><td>No messages received from ROS</td></tr>
<tr><td>AGV</td><td>836</td><td>ERROR_ROS_OBST_AV_NO_PATH</td><td>Machine Alarm</td><td>ERROR</td><td>Too long since valid path is received from ROS during bypass</td></tr>
<tr><td>AGV</td><td>840</td><td>ERROR_ETHERCAT_NO_COMMS</td><td>Machine Alarm</td><td>ERROR</td><td>EtherCAT communication not working as expected</td></tr>
<tr><td>AGV</td><td>841</td><td>ERROR_CAN_SUPERVISOR_INVALID_COMMAND</td><td>Machine Alarm</td><td>ERROR</td><td>Invalid command received from CAN supervisor interface</td></tr>
<tr><td>AGV</td><td>842</td><td>ERROR_CONFIG_GENERIC</td><td>Machine Alarm</td><td>ERROR</td><td>Generic configuration error. Check log for more details</td></tr>
<tr><td>AGV</td><td>843</td><td>ERROR_ETHERCAT_CONFIG</td><td>Machine Alarm</td><td>ERROR</td><td>Ethercat slave configuration failure</td></tr>
<tr><td>AGV</td><td>901</td><td>WARNING_LIFT_CTRL_ENC_FILE_FAIL</td><td>Machine Alarm</td><td>WARNING</td><td>Lift height encoder configuration file parsing failed</td></tr>
<tr><td>AGV</td><td>902</td><td>WARNING_LIFT_CTRL_CFG_FAILED</td><td>Machine Alarm</td><td>WARNING</td><td>Lift motor controller configuration failure</td></tr>
<tr><td>AGV</td><td>903</td><td>WARNING_LIFT_CTRL_CALIB_FAILED</td><td>Machine Alarm</td><td>WARNING</td><td>Lift height measurement calibration failure</td></tr>
<tr><td>AGV</td><td>904</td><td>WARNING_LIFT_CTRL_MOVE_TIMEOUT</td><td>Machine Alarm</td><td>WARNING</td><td>Lift movement timeout</td></tr>
<tr><td>AGV</td><td>905</td><td>WARNING_LIFT_CTRL_CALIB_NOTDONE</td><td>Machine Alarm</td><td>WARNING</td><td>Lift height measurement not calibrated</td></tr>
<tr><td>AGV</td><td>906</td><td>WARNING_LIFT_CTRL_DISABLED</td><td>Machine Alarm</td><td>WARNING</td><td>Lift height control disabled</td></tr>
<tr><td>AGV</td><td>907</td><td>WARNING_UI_NOT_CONNECTED</td><td>Machine Alarm</td><td>WARNING</td><td>No connection to UI</td></tr>
<tr><td>AGV</td><td>908</td><td>WARNING_PLC_SAFETY_SCANNER_STOP</td><td>Machine Alarm</td><td>WARNING</td><td>Safety scanner stop on PLC</td></tr>
<tr><td>AGV</td><td>909</td><td>WARNING_PLC_SOFT_STOP</td><td>Machine Alarm</td><td>WARNING</td><td>Soft stop activated on PLC</td></tr>
<tr><td>AGV</td><td>910</td><td>WARNING_PLC_SLOW_DOWN</td><td>Machine Alarm</td><td>WARNING</td><td>PLC slowing down due to obstacle</td></tr>
<tr><td>AGV</td><td>911</td><td>WARNING_DEAD_RECK_HIGH_RATE</td><td>Machine Alarm</td><td>WARNING</td><td>Excessive movement rate detected</td></tr>
<tr><td>AGV</td><td>912</td><td>WARNING_ETH_MANUAL_MODE</td><td>Machine Alarm</td><td>WARNING</td><td>AGV on manual mode</td></tr>
<tr><td>AGV</td><td>913</td><td>WARNING_AGV_EM_STOP</td><td>Machine Alarm</td><td>WARNING</td><td>Emergency stop on AGV</td></tr>
<tr><td>AGV</td><td>914</td><td>WARNING_AGV_CONTROLLER</td><td>Machine Alarm</td><td>WARNING</td><td>AGV controller warning</td></tr>
<tr><td>AGV</td><td>915</td><td>WARNING_DYN_MAP_SERVER_NOT_CONNECTED</td><td>Machine Alarm</td><td>WARNING</td><td>No connection to dynamic mapping server</td></tr>
<tr><td>AGV</td><td>916</td><td>WARNING_DYN_MAP_SERVER_MAP_MISMATCH</td><td>Machine Alarm</td><td>WARNING</td><td>Dynamic mapping server map doesn't match Fleet control map</td></tr>
<tr><td>AGV</td><td>917</td><td>WARNING_DYN_MAP_SERVER_STORAGE_ERROR</td><td>Machine Alarm</td><td>WARNING</td><td>Dynamic mapping server storage read/write error</td></tr>
<tr><td>AGV</td><td>918</td><td>WARNING_RLS_SENSOR</td><td>Machine Alarm</td><td>WARNING</td><td>RLS sensor warning</td></tr>
<tr><td>AGV</td><td>919</td><td>WARNING_NO_SUPERVISOR_COMS</td><td>Machine Alarm</td><td>WARNING</td><td>No communication to Supervisor</td></tr>
<tr><td>AGV</td><td>920</td><td>WARNING_UI_PARSING_ERROR</td><td>Machine Alarm</td><td>WARNING</td><td>UI data parsing failed</td></tr>
<tr><td>AGV</td><td>921</td><td>WARNING_EXT_BATTERY</td><td>Machine Alarm</td><td>WARNING</td><td>No external battery status available</td></tr>
<tr><td>AGV</td><td>922</td><td>WARNING_PLC</td><td>Machine Alarm</td><td>WARNING</td><td>PLC Warning received</td></tr>
<tr><td>AGV</td><td>923</td><td>WARNING_CAN2_FAILURE</td><td>Machine Alarm</td><td>WARNING</td><td>CAN secondary bus, hw or driver error</td></tr>
<tr><td>AGV</td><td>924</td><td>WARNING_IMU_FAILURE</td><td>Machine Alarm</td><td>WARNING</td><td>IMU error or no connection</td></tr>
<tr><td>AGV</td><td>925</td><td>WARNING_NO_SUPERVISOR_SEC_COMS</td><td>Machine Alarm</td><td>WARNING</td><td>No communication to secondary Supervisor</td></tr>
<tr><td>AGV</td><td>926</td><td>WARNING_FSTOP_FLEET_CONTROL</td><td>Machine Alarm</td><td>WARNING</td><td>FSTOP activated by fleet control</td></tr>
<tr><td>AGV</td><td>927</td><td>WARNING_DRIVE_MOTOR_CONTROL_LIMIT</td><td>Machine Alarm</td><td>WARNING</td><td>Motor controller operation/speed is limited</td></tr>
<tr><td>AGV</td><td>928</td><td>WARNING_ETHERNET_FEEDBACK_EXCEEDING_LIMIT</td><td>Machine Alarm</td><td>WARNING</td><td>Warning vehicle feedback dataExceeds limits</td></tr>
<tr><td>AGV</td><td>929</td><td>WARNING_SLOWED_DOWN_ULTRASONIC_SENSORS</td><td>Machine Alarm</td><td>WARNING</td><td>Slow down triggered by ultrasonic sensors facing forwards</td></tr>
<tr><td>AGV</td><td>931</td><td>WARNING_OMNI_STEER_LIMIT_ADJUSTING_WHEELS</td><td>Machine Alarm</td><td>WARNING</td><td>Omni steer limit reached stopping and readjusting the wheel(s)</td></tr>
<tr><td>AGV</td><td>932</td><td>WARNING_LIMITED_STEERING_ACTIVE</td><td>Machine Alarm</td><td>WARNING</td><td>Required steer angles exceed defined limits. AGV may drift out of the path.</td></tr>
<tr><td>AGV</td><td>933</td><td>WARNING_CONFLICTING_MOTOR_CONTROLLER_TYPES</td><td>Machine Alarm</td><td>WARNING</td><td>Motor controller type given as a parameter conflicts with the one coming from the controller</td></tr>
<tr><td>AGV</td><td>934</td><td>WARNING_NO_GPS_FIX</td><td>Machine Alarm</td><td>WARNING</td><td>Too long since last GPS fix, driving without it</td></tr>
<tr><td>AGV</td><td>935</td><td>WARNING_CAN_ENCODER</td><td>Machine Alarm</td><td>WARNING</td><td>CAN encoder initialization error</td></tr>
<tr><td>AGV</td><td>936</td><td>WARNING_ROS_OBST_AV_PATH_ENDED</td><td>Machine Alarm</td><td>WARNING</td><td>Reached the end of the ROS path during bypass, stopping and waiting for new one</td></tr>
<tr><td>AGV</td><td>941</td><td>WARNING_CODE_READER_NO_COMMS</td><td>Machine Alarm</td><td>WARNING</td><td>Code reader communication is not working</td></tr>
<tr><td>AGV</td><td>942</td><td>WARNING_CODE_READER_STATUS_NOT_OK</td><td>Machine Alarm</td><td>WARNING</td><td>Code reader reports a device problem</td></tr>
<tr><td>SUPERVISOR (AGV PLC)</td><td>Custom</td><td>ERROR_PLC_XXX (XXX is the custom ID)</td><td>SUPERVISOR ERROR</td><td></td><td></td></tr>
</tbody></table>
</div></div><div style="break-before: page; page-break-before: always;"></div><h1 id="alarms-configuration-override"><a class="header" href="#alarms-configuration-override">Alarms configuration override</a></h1>
<p>This document contains the description of alarms configuration override functionality and instructions for applying overrides for filtering on the server or Client side.</p>
<p>Updated 23.11.2022</p>
<h2 id="version-history-46"><a class="header" href="#version-history-46">Version History</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Version</th><th>Date</th><th>Author</th><th>Change</th></tr></thead><tbody>
<tr><td>1.0</td><td>15.04.2021</td><td>Elena Sgonova</td><td>Document created</td></tr>
<tr><td>1.1</td><td>31.05.2021</td><td>Evgenii Kuzminskii</td><td>Update the related parameter name</td></tr>
<tr><td>1.2</td><td>11.06.2021</td><td>Aleksi Ålander</td><td>Renamed title</td></tr>
<tr><td>1.3</td><td>21.07.2021</td><td>Elena Sgonova</td><td>Added detailed description for AlarmConfigurationOverride file input sources</td></tr>
<tr><td>1.4</td><td>10.01.2022</td><td>Tero Laakso</td><td>Updated override file creation section. Default error levels may vary</td></tr>
<tr><td>1.5</td><td>23.11.2022</td><td>Elena Sgonova</td><td>Updated section about Supervisor alarms override. Setting default supervisor alarm level logic has changed</td></tr>
</tbody></table>
</div>
<hr />
<h2 id="introduction-23"><a class="header" href="#introduction-23">Introduction</a></h2>
<p>It is possible to override error levels and priorities of system alarms with a configuration override file. Error level and priority values can be used for filtering alarms on the server side or in the Client.</p>
<h2 id="alarm-configurations-in-navithor-server"><a class="header" href="#alarm-configurations-in-navithor-server">Alarm configurations in Navithor Server</a></h2>
<p>This functionality is available starting from <strong>version 2.21.4.60</strong> of Navithor server.</p>
<h3 id="configuration-override-file"><a class="header" href="#configuration-override-file">Configuration override file</a></h3>
<p><strong>File location:</strong> server_executable_path/Overrides/</p>
<p><strong>File name:</strong> AlarmConfigurationOverride.txt</p>
<p>This file is created automatically when Navithor server is started and is initially filled with default overrides values collected from the system. More detailed overview can be read in the <a href="Alarms%20configuration%20override.html#override-file-input-sources">Override file input sources</a> section. Overrides in the file can be edited and new overrides can be added in the following format:</p>
<p><code>AlarmId:AlarmSource:AlarmInitialLevel:AlarmOverrideLevel:AlarmPriority:AlarmInformationId</code></p>
<div class="table-wrapper"><table><thead><tr><th>Parameter</th><th>Description</th></tr></thead><tbody>
<tr><td>AlarmId</td><td>Number, ID of an alarm</td></tr>
<tr><td>AlarmSource</td><td>String, alarm source: <br/> FleetControl <br/> NavigationSoftware <br/> Supervisor <br/> MachineDevice</td></tr>
<tr><td>AlarmInitialLevel</td><td>Number, initial alarm level: <br/>1 - Warning<br/>2 - Error<br/>3 - Fatal error<br/>Initial level has no effect on alarms in the system and is used for information purposes only</td></tr>
<tr><td>AlarmOverrideLevel</td><td>Number, override alarm level: <br/>1 - Warning<br/>2 - Error<br/>3 - Fatal error<br/>OverrideLevel defines how this alarm would be represented in the system</td></tr>
<tr><td>AlarmPriority</td><td>Number, alarm priority value: <br/>1 - Lowest<br/>2 - Very low<br/>3 - Low<br/>4 - Medium<br/>5 - High<br/>6 - Very high<br/>7 - Highest<br/>Default value is Medium = 4</td></tr>
<tr><td>AlarmInformationId</td><td>Link to a help-page to solve issue related to this alarm in the Client (reserved for future use)</td></tr>
</tbody></table>
</div>
<p>Example line:</p>
<p><code>100000:FleetControl:2:2:4:0</code></p>
<p>In order to apply the changes, restart the server or in the Client navigate to Settings-&gt;Production settings-&gt;Area files and click &quot;Reload overrides&quot; button.</p>
<h3 id="alarms-prefiltering-in-server"><a class="header" href="#alarms-prefiltering-in-server">Alarms prefiltering in server</a></h3>
<p>Alarm priority can be used for prefiltering in server.</p>
<ul>
<li>
<p>To enable alarm prefiltering set server parameter <strong>Alarms_LowestAllowedPriorityToFilterOutAlarms</strong> to a value from 1 to 7. Alarms and updates for alarms with lower priority value than <strong>Alarms_LowestAllowedPriorityToFilterOutAlarms</strong> will not be sent to OPC UA.</p>
</li>
<li>
<p>To disable alarm prefiltering set server parameter <strong>Alarms_LowestAllowedPriorityToFilterOutAlarms</strong> to 0.</p>
</li>
</ul>
<h2 id="alarm-configurations-in-navithor-client"><a class="header" href="#alarm-configurations-in-navithor-client">Alarm configurations in Navithor Client</a></h2>
<p>This functionality is available starting from <strong>version 2.21.4.60</strong> of Navithor Client.</p>
<h3 id="alarms-filtering-in-navithor-client"><a class="header" href="#alarms-filtering-in-navithor-client">Alarms filtering in Navithor Client</a></h3>
<p>Navithor Client supports filtering alarms by priority and new filtering by alarm level and source is introduced.</p>
<p>Operator can choose alarms with which priorities need to be displayed. If no selection is done, no filtering will be performed.</p>
<p><img src="./Images/AlarmConfigurationOverride/filtering_1.png" alt="" /></p>
<blockquote>
<p>Figure: Alarm priority filtering selection.</p>
</blockquote>
<p>Also, operator can choose more than one alarm level and source as a filter.</p>
<p><img src="./Images/AlarmConfigurationOverride/filtering_2.png" alt="" /></p>
<blockquote>
<p>Figure: Alarm error level filter selection</p>
</blockquote>
<p><img src="./Images/AlarmConfigurationOverride/filtering_3.png" alt="" /></p>
<blockquote>
<p>Figure: Alarm source filter selection</p>
</blockquote>
<p>Selected filtering options are stored in the Client settings and will be kept after exiting the Client application.
&gt;Figure: Alarms view with custom color settings applied</p>
<h2 id="override-file-input-sources"><a class="header" href="#override-file-input-sources">Override file input sources</a></h2>
<h3 id="1-configuration-override-file-initialization"><a class="header" href="#1-configuration-override-file-initialization">1 Configuration override file initialization</a></h3>
<p><strong>a) Configuration override file does not exist</strong>. Navithor creates the file and fills it with all the system errors defined in the Navithor code (FleetControl alarms). InitialLevel and OverrideLevel values are set to correspond to the default level of the error in Navithor. See _ Alarms_ document for more information.</p>
<p><strong>b) Configuration override file exists</strong>. Navithor reads defined overrides from the file. Then fills it with FleetControl alarms if they were not yet defined in the file. Then the file is saved.</p>
<blockquote>
<p><strong>Note:</strong> What is defined in the <strong>file has bigger priority</strong> than what is sent from the system. Example: in the file the following line is defined - <em>603:NavigationSoftware:3:2:4:0</em>. If Navitrol later will send this error with the InitialLevel 1, it will not be updated in the memory.</p>
</blockquote>
<p>Order of lines in the file does not matter for Navithor, but lines which contain typos will be ignored.</p>
<p>If AlarmsConfigurationOverride file is changed with the server running, you have to press Reload Overrides in the Client for the changes to take effect. It is better though to edit the file before the server is started to avoid accidental loss of data.</p>
<p>Navithor saves the file on each exit from server and also when a new alarm is appended for example from the Supervisor, the file is also updated.</p>
<h3 id="2-other-alarms-added-by-navithor"><a class="header" href="#2-other-alarms-added-by-navithor">2 Other alarms added by Navithor</a></h3>
<h4 id="navigationsoftware-alarms"><a class="header" href="#navigationsoftware-alarms">NavigationSoftware alarms</a></h4>
<p>When AGV is connected to Navithor, it sends its errors list and errors which are not yet in the file will be added to AlarmsConfigurationOverride file. Default InitialLevel and OverrideLevel value in this case depends on which ErrorLevel is defined in Navitrol for this alarm.</p>
<blockquote>
<p><strong>Note:</strong> New errors from Navitrol will only be added if Navitrol version is different from the one which is defined in the file (see line which starts with CURRENT_NAVITROL_VERSION).</p>
</blockquote>
<h4 id="supervisor-alarms"><a class="header" href="#supervisor-alarms">Supervisor alarms</a></h4>
<p>An override record for Supervisor alarm is added automatically when it is first triggered in the system and such alarm is not defined in the AlarmsConfigurationOverride file. Default OverrideLevel value will be recorded according to the level assigned to a triggered alarm. Next time alarm with the same ID is triggered, Navithor will use the recorded OverrideLevel.</p>
<h4 id="not-applied-overrides"><a class="header" href="#not-applied-overrides">Not applied overrides</a></h4>
<p>When the override information is requested for an alarm which is not defined in the AlarmsConfigurationOverride file, this alarm information is saved in the memory as not applied override. When exiting the server, not applied overrides are written to the configuration override file under &quot;OVERRIDES NOT APPLIED TO ALARMS&quot; section. On the next start of the server these lines will be read into the memory.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
            </nav>

        </div>

        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        <script type="text/javascript">
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>
    </body>
</html>
