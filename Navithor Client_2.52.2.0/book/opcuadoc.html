<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>OPC UA Server interface - NAVITHOR USER INSTRUCTIONS</title>
        <!-- Custom HTML head -->
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">
        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="index.html">Front page</a></li><li class="chapter-item expanded affix "><li class="part-title">Configuration</li><li class="chapter-item expanded "><a href="Installation_NavithorHardwareRequirements.html"><strong aria-hidden="true">1.</strong> System Hardware Requirement Specifications</a></li><li class="chapter-item expanded "><a href="Installation_SQLServerAndDatabaseInstallationGuide.html"><strong aria-hidden="true">2.</strong> Configuring database</a></li><li class="chapter-item expanded "><a href="fleetSim.html"><strong aria-hidden="true">3.</strong> Fleet Simulator - Setup and Configuration</a></li><li class="chapter-item expanded "><a href="Installation_NavithorServerAsAService.html"><strong aria-hidden="true">4.</strong> Server as a service</a></li><li class="chapter-item expanded "><a href="Installation_ConfiguringHotSwap.html"><strong aria-hidden="true">5.</strong> Server Hot Swap with Failover Cluster</a></li><li class="chapter-item expanded "><a href="Installation_RebrandingNavithor.html"><strong aria-hidden="true">6.</strong> Server and Client Rebranding</a></li><li class="chapter-item expanded "><a href="Machinetool.html"><strong aria-hidden="true">7.</strong> Machine Tool</a></li><li class="chapter-item expanded "><a href="MesTester3.html"><strong aria-hidden="true">8.</strong> MES Tester</a></li><li class="chapter-item expanded affix "><li class="part-title">Desktop client</li><li class="chapter-item expanded "><a href="navithorServerAndClientMegaDocument.html"><strong aria-hidden="true">9.</strong> System Overview and user instructions for Client UI</a></li><li class="chapter-item expanded "><a href="Feature_ClientUpdater.html"><strong aria-hidden="true">10.</strong> Client Updater</a></li><li class="chapter-item expanded affix "><li class="part-title">Web client</li><li class="chapter-item expanded "><a href="Installation_SettingUpNavithorWebServer.html"><strong aria-hidden="true">11.</strong> Setting up Web server to enable Web client</a></li><li class="chapter-item expanded "><a href="webClient.html"><strong aria-hidden="true">12.</strong> Web Client - User Instructions</a></li><li class="chapter-item expanded affix "><li class="part-title">Guides</li><li class="chapter-item expanded "><a href="bestProductionPractices.html"><strong aria-hidden="true">13.</strong> Best Practices for Creating Production Area</a></li><li class="chapter-item expanded affix "><li class="part-title">Logs</li><li class="chapter-item expanded "><a href="Navithor logs.html"><strong aria-hidden="true">14.</strong> Navithor Logs</a></li><li class="chapter-item expanded "><a href="Feature_VisualReplay.html"><strong aria-hidden="true">15.</strong> Visual Replay</a></li><li class="chapter-item expanded "><a href="Feature_DownloadManager.html"><strong aria-hidden="true">16.</strong> Log Download Manager</a></li><li class="chapter-item expanded affix "><li class="part-title">Users</li><li class="chapter-item expanded "><a href="Installation_UsingActiveDirectoryForAuthentication.html"><strong aria-hidden="true">17.</strong> User authentication against Active Directory</a></li><li class="chapter-item expanded "><a href="userRoles.html"><strong aria-hidden="true">18.</strong> User Management</a></li><li class="chapter-item expanded "><a href="userRolesRightsMatrix.html"><strong aria-hidden="true">19.</strong> Default User roles and User rights matrix</a></li><li class="chapter-item expanded affix "><li class="part-title">Features</li><li class="chapter-item expanded "><a href="symbolicPointGroups.html"><strong aria-hidden="true">20.</strong> Symbolic Point Groups</a></li><li class="chapter-item expanded "><a href="ResourceHandling.html"><strong aria-hidden="true">21.</strong> Resource handling</a></li><li class="chapter-item expanded "><a href="hold-release.html"><strong aria-hidden="true">22.</strong> Hold-Release reasoning and production order lists</a></li><li class="chapter-item expanded "><a href="transfer requests.html"><strong aria-hidden="true">23.</strong> Transfer requests</a></li><li class="chapter-item expanded "><a href="racking.html"><strong aria-hidden="true">24.</strong> Using warehouse racking feature</a></li><li class="chapter-item expanded "><a href="bufferLanes.html"><strong aria-hidden="true">25.</strong> Using Buffer Lanes</a></li><li class="chapter-item expanded "><a href="Feature_ChargingManagement.html"><strong aria-hidden="true">26.</strong> Managing Battery Levels</a></li><li class="chapter-item expanded "><a href="oneMachineZones.html"><strong aria-hidden="true">27.</strong> Using One Machine Zones</a></li><li class="chapter-item expanded "><a href="distanceControlZones.html"><strong aria-hidden="true">28.</strong> Distance Control Zones</a></li><li class="chapter-item expanded "><a href="FireAlarmZones.html"><strong aria-hidden="true">29.</strong> Fire Alarm Zones</a></li><li class="chapter-item expanded "><a href="Zone status use cases.html"><strong aria-hidden="true">30.</strong> Zone status use cases</a></li><li class="chapter-item expanded "><a href="tagStatuses.html"><strong aria-hidden="true">31.</strong> Tag Statuses</a></li><li class="chapter-item expanded "><a href="Trafficlights.html"><strong aria-hidden="true">32.</strong> Traffic Lights</a></li><li class="chapter-item expanded "><a href="Feature_Elevators.html"><strong aria-hidden="true">33.</strong> Elevators</a></li><li class="chapter-item expanded "><a href="ProductionBreak.html"><strong aria-hidden="true">34.</strong> Production Break</a></li><li class="chapter-item expanded "><a href="DynamicSafetyBounds.html"><strong aria-hidden="true">35.</strong> Virtual Dynamic Safety Bounds</a></li><li class="chapter-item expanded "><a href="WaitingSlots.html"><strong aria-hidden="true">36.</strong> Wait Queue Locations</a></li><li class="chapter-item expanded "><a href="CoupledDrive.html"><strong aria-hidden="true">37.</strong> Coupled Drive</a></li><li class="chapter-item expanded "><a href="Feature_StoppingPointOffsetsForSymbolicPoints.html"><strong aria-hidden="true">38.</strong> Stopping Point Offsets</a></li><li class="chapter-item expanded "><a href="TCStopPoint.html"><strong aria-hidden="true">39.</strong> Safe stopping point calculation</a></li><li class="chapter-item expanded "><a href="Navithor statistics.html"><strong aria-hidden="true">40.</strong> System Statistics</a></li><li class="chapter-item expanded "><a href="MachineInterfaces.html"><strong aria-hidden="true">41.</strong> Machine Interfaces</a></li><li class="chapter-item expanded affix "><li class="part-title">Interfaces</li><li class="chapter-item expanded "><a href="Communication specification between Navithor and MES.html"><strong aria-hidden="true">42.</strong> MES Interface</a></li><li class="chapter-item expanded "><a href="NavithorHttpApi.html"><strong aria-hidden="true">43.</strong> HTTP API</a></li><li class="chapter-item expanded "><a href="NavithorWebApi.html"><strong aria-hidden="true">44.</strong> WebSocket API</a></li><li class="chapter-item expanded "><a href="opcuadoc.html" class="active"><strong aria-hidden="true">45.</strong> OPC UA Server interface</a></li><li class="chapter-item expanded affix "><li class="part-title">Alarms</li><li class="chapter-item expanded "><a href="Fleet Control Alarms.html"><strong aria-hidden="true">46.</strong> Alarms</a></li><li class="chapter-item expanded "><a href="Alarms configuration override.html"><strong aria-hidden="true">47.</strong> Alarms configuration override</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="dark">Dark</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">NAVITHOR USER INSTRUCTIONS</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="opc-ua-server-interface"><a class="header" href="#opc-ua-server-interface">OPC UA Server interface</a></h1>
<p>Describes OPC UA Server implemented in Navithor Server</p>
<p>Updated 24.11.2022</p>
<h2 id="version-history"><a class="header" href="#version-history">Version History</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Version</th><th>Date</th><th>Author</th><th>Change</th></tr></thead><tbody>
<tr><td>1.0</td><td>23.07.2020</td><td>Antti Parkkonen</td><td>Initial document</td></tr>
<tr><td>1.1</td><td>29.07.2020</td><td>Aleksi Ålander</td><td>Minor corrections</td></tr>
<tr><td>1.2</td><td>30.09.2020</td><td>Antti Parkkonen</td><td>Update for new spec</td></tr>
<tr><td>1.3</td><td>08.10.2020</td><td>Aleksi Ålander</td><td>Added 'Name' node for errors</td></tr>
<tr><td>1.4</td><td>28.10.2020</td><td>Antti Parkkonen</td><td>Changed from rolling numbering to ID numbering</td></tr>
<tr><td>1.5</td><td>02.12.2020</td><td>Aleksi Ålander</td><td>Updated to reflect support for translation</td></tr>
<tr><td>1.6</td><td>08.07.2021</td><td>Elena Sgonova</td><td>Added datatypes for nodes</td></tr>
<tr><td>1.7</td><td>13.12.2021</td><td>Aleksi Ålander</td><td>Added description of different node configuration options</td></tr>
<tr><td>1.8</td><td>08.02.2022</td><td>Aleksi Ålander</td><td>Added description of possible XML file generation</td></tr>
<tr><td>1.9</td><td>27.07.2022</td><td>Tero Laakso-Pitkäkoski</td><td>Added 'System information' node with ProductionBreakMode state</td></tr>
<tr><td>2.0</td><td>24.11.2022</td><td>Toni Liski</td><td>Added comment about supported OPC Watch versions</td></tr>
</tbody></table>
</div>
<hr />
<h2 id="current-standard-implementation"><a class="header" href="#current-standard-implementation">Current standard implementation</a></h2>
<p>In the current form Navithor Server exposes AGV errors, symbolic point errors and Navithor Server system errors as nodes in OPC UA Server. Some extra information like operation state and position are shown for the AGVs and symbolic points.</p>
<p>Navithor Server supports currently two different options for node configuration. This chapter and all sub-chapters under it describe the standard configuration, that is enabled by default. The alternative option is discussed separately in chapter <em>Alternative node configuration: SimpleStaticConfiguration</em>.</p>
<p>Navithor Server also creates a node OpcUaSettings, if the standard configuration is used. In the current version only child node is for selecting language for the alarm descriptions and names, that are written to the OPC UA Server. OPC UA Client can write to this node to select the language they wish to use from the list of the supported languages.</p>
<p>The created nodes are stored for the full lifetime of the Navithor Server application, even if the OPC UA Server is shutdown and restarted the nodes will exist.</p>
<p>The nodes are stored in the OPC UA Server under the Objects root folder in the form shown in subsections below. The numbering on each AGV and station folder comes from the ID of the AGV or symbolic point. So AGV with ID 23 will have the OpcFolder AGV23. Stations follow the same numbering as AGVs, meaning that each station folder is based on the ID of the symbolic point that represents the station. If the symbolic point ID is 105, OPC UA folder will be called Station105.</p>
<p>Current standard implementation has a fixed amount of 20 error folders under System errors and under each AGV and station. Error folders are numbered from Error001 to Error020. If a new error is activated, Navithor Server selects the lowest ID error node from the collection, that does not have active error. The selected error node is used for this error until it is deactivated, meaning that no sorting is done after the node has been first time selected. If the error deactivates and shortly activates again, the system chooses again the lowest free error node ID, so the error might be linked now into a different node.</p>
<h3 id="agv-information"><a class="header" href="#agv-information">AGV information</a></h3>
<pre><code>Objects
|
|--&gt; AGVs
||
||--&gt;AGV1
|  |
|  |--&gt;Errors
|  | |
|  | |--&gt;Error001
|  |   |---&gt; Active: bool
|  |   |---&gt; Description: string
|  |   |---&gt; ErrorLevel: int
|  |   |---&gt; ErrorName: string
|  |   |---&gt; Id: int
|  |   |---&gt; LastActivated: DateTime
|  | |
|  | |--&gt;Error002
|  |   |---&gt; Active: bool
|  |   |---&gt; Description: string
|  |   |---&gt; ErrorLevel: int
|  |   |---&gt; ErrorName: string
|  |   |---&gt; Id: int
|  |   |---&gt; LastActivated: DateTime
|  |   |
|  | .
|  | .
|  | .
|  | |--&gt;Error020
|  |   |---&gt; Active: bool
|  |   |---&gt; Description: string
|  |   |---&gt; ErrorLevel: int
|  |   |---&gt; ErrorName: string
|  |   |---&gt; Id: int
|  |   |---&gt; LastActivated: DateTime
|  |
|  |--&gt;State
|  | |---&gt; NextTarget: string
|  | |---&gt; OperationMode: string
|  | |---&gt; OperationState: string
|  | |---&gt; PositionX: float
|  | |---&gt; PositionY: float
|  |--&gt;ID: int
|  |--&gt;Name: string
|  |--&gt;Type: int
||       
||--&gt;AGV2
|  |
|  |--&gt;Errors
|  |
|  |--&gt;State
|  |
|  |--&gt;ID: int
|  |--&gt;Name: string
|  |--&gt;Type: int
|  .
|  .
|  .
</code></pre>
<h3 id="symbolic-point-information"><a class="header" href="#symbolic-point-information">Symbolic point information</a></h3>
<pre><code>Objects
|
|--&gt; Stations
||
||--&gt;Station1
|  |
|  |--&gt;Errors
|  | |
|  | |--&gt;Error001
|  |   |---&gt; Active: bool
|  |   |---&gt; Description: string
|  |   |---&gt; ErrorLevel: int
|  |   |---&gt; ErrorName: string
|  |   |---&gt; Id: int
|  |   |---&gt; LastActivated: DateTime
|  | |
|  | |--&gt;Error002
|  |   |---&gt; Active: bool
|  |   |---&gt; Description: string
|  |   |---&gt; ErrorLevel: int
|  |   |---&gt; ErrorName: string
|  |   |---&gt; Id: int
|  |   |---&gt; LastActivated: DateTime
|  |   |
|  | .
|  | .
|  | .
|  | |--&gt;Error020
|  |   |---&gt; Active: bool
|  |   |---&gt; Description: string
|  |   |---&gt; ErrorLevel: int
|  |   |---&gt; ErrorName: string
|  |   |---&gt; Id: int
|  |   |---&gt; LastActivated: DateTime
|  |
|  |
|  |--&gt;State
|  | |---&gt; OperationState: string
|  |--&gt;ID: int
|  |--&gt;Name: string
|  |--&gt;Type: string
</code></pre>
<h3 id="system-information"><a class="header" href="#system-information">System information</a></h3>
<pre><code>Objects
|
|--&gt; System errors
|  |--&gt;Error001
|  | |---&gt; Active: bool
|  | |---&gt; Description: string
|  | |---&gt; ErrorLevel: int
|  | |---&gt; ErrorName: string
|  | |---&gt; Id: int
|  | |---&gt; LastActivated: DateTime
|  |
|  |--&gt;Error002
|  | |---&gt; Active: bool
|  | |---&gt; Description: string
|  | |---&gt; ErrorLevel: int
|  | |---&gt; ErrorName: string
|  | |---&gt; Id: int
|  | |---&gt; LastActivated: DateTime
|  |
|  | .
|  | .
|  | .
|  |--&gt;Error020
|  | |---&gt; Active: bool
|  | |---&gt; Description: string
|  | |---&gt; ErrorLevel: int
|  | |---&gt; ErrorName: string
|  | |---&gt; Id: int
|  | |---&gt; LastActivated: DateTime
|--&gt; System information
|  |---&gt; ProductionBreakMode: string
</code></pre>
<p>Node IDs for each AGV error will be of form:
ns=2;s=AGVs/AGV00001/Errors/Error001</p>
<p>for stations:
ns=2;s=Stations/Station00001/Errors/Error001</p>
<p>and for system errors:
ns=2;s=System errors/Errors/Error001</p>
<p>All error nodes contain the 6 data variable nodes Active, LastActivated, Name, Description, ErrorLevel and id. The Error information is filled up when an error is active and the data is cleared after the error has been deactivated for one full update cycle.</p>
<h4 id="production-break-variable-values"><a class="header" href="#production-break-variable-values">Production Break variable values</a></h4>
<div class="table-wrapper"><table><thead><tr><th>Value</th><th>Description</th></tr></thead><tbody>
<tr><td>None</td><td>Production break is not activated, system allows normal operation.</td></tr>
<tr><td>MovingToProductionBreak</td><td>System is in progress of driving AGVs to production break.</td></tr>
<tr><td>ProductionBreak</td><td>System has production break active. AGVs are driven to production break locations and set to sleep when possible.</td></tr>
</tbody></table>
</div>
<h3 id="opc-ua-settings"><a class="header" href="#opc-ua-settings">OPC UA settings</a></h3>
<pre><code>Objects
|
|--&gt;OpcUaSettings
| |---&gt; AlarmsLanguage: string
</code></pre>
<p>AlarmsLanguage node is a node where OPC UA Client can write the language for the error names and descriptions, that Navithor Server writes to the OPC UA nodes. Navithor Server is constantly monitoring the node and selects the translations based on this node. If the language is changed by the Client, Navithor Server will update the translations for the errors that are active. Non-active folders are not translated.</p>
<p>Default language is English. OPC UA Server doesn't save the active language anywhere, so in case of Navithor system rebooting, the language goes back to default. OPC UA Client should monitor the AlarmsLanguage node and in case it is not what the Client wants, write the correct value.</p>
<p>OPC UA Server language is a global setting, so if one OPC UA Client changes the setting, it will affect also other OPC UA Clients.</p>
<p>Language should be written as a string and in a right format, which is in this document called as a language identifier. Currently supported languages are English and German. Check the languages Navithor supports and their identifiers from the table below:</p>
<div class="table-wrapper"><table><thead><tr><th>Language</th><th>Identifier</th></tr></thead><tbody>
<tr><td>English</td><td>en-EN</td></tr>
<tr><td>German</td><td>de-DE</td></tr>
</tbody></table>
</div>
<h3 id="example-of-reserving-error-folders"><a class="header" href="#example-of-reserving-error-folders">Example of reserving error folders</a></h3>
<p>Example with 5 possible error nodes to choose from. The same logic is valid for all types of the errors.</p>
<pre><code>|--&gt; Errors
|  |--&gt;Error001 - Free
|  |--&gt;Error002 - Free
|  |--&gt;Error003 - Free
|  |--&gt;Error004 - Free
|  |--&gt;Error005 - Free
</code></pre>
<p>3 errors are activated in order of Err200, Err100 and last Err400.</p>
<pre><code>|--&gt; Errors
|  |--&gt;Error001 - Err200
|  |--&gt;Error002 - Err100
|  |--&gt;Error003 - Err400
|  |--&gt;Error004 - Free
|  |--&gt;Error005 - Free
</code></pre>
<p>Error Err100 is now deactivated. Err200 and Err400 keep the folders they have been assigned into.</p>
<pre><code>|--&gt; Errors
|  |--&gt;Error001 - Err200
|  |--&gt;Error002 - Free
|  |--&gt;Error003 - Err400
|  |--&gt;Error004 - Free
|  |--&gt;Error005 - Free
</code></pre>
<p>Now two more errors Err90 and Err50 are activated.</p>
<pre><code>|--&gt; Errors
|  |--&gt;Error001 - Err200
|  |--&gt;Error002 - Err90
|  |--&gt;Error003 - Err400
|  |--&gt;Error004 - Err50
|  |--&gt;Error005 - Free
</code></pre>
<hr />
<h2 id="alternative-node-configuration-simplestaticconfiguration"><a class="header" href="#alternative-node-configuration-simplestaticconfiguration">Alternative node configuration: SimpleStaticConfiguration</a></h2>
<p>This chapter describes the node configuration of an alternative OPC UA node manager implemented in Navithor Server. This alternative can be chosen by setting Navithor Server parameter <em>OpcUa_NodeManagerConfiguration</em> to option <em>SimpleStaticConfiguration</em> and restarting Navithor Server.</p>
<p>All nodes are created with fixed names. All nodes are data variables with boolean data type. Each node can have only two states depending if the described error is currently active or not: False or True.</p>
<p>The naming of the nodes follows these rules:</p>
<ul>
<li>All AGVs configured in the system will have fixed error nodes for:</li>
<li>Every node name follows the format: &quot;FTFXXXXX - Error YYYYYY&quot;, where XXXXX is defined machine ID and YYYYYY is the error ID that the node is representing.</li>
<li>Nodes from 1 to 999 are always created. These can contain Supervisor and Navitrol errors. All of the nodes are not currently used, but are reserved in case of upcoming updates. Exact description which errors are currently used need to be checked from Navitrol documentation matching with the Navitrol version and from the </li>
<li>Nodes starting from 100000 upwards are reserved for AGV alarms triggered by Navithor Server. These are created based on the alarms defined in the current Navithor Server version. The exact IDs used can be found from * Alarms* documentation.</li>
<li>All System alarms will have a fixed error node:
<ul>
<li>Every node name follows the format: &quot;System - Error YYYYYY&quot;, where YYYYYY is the error ID that the node is representing.</li>
<li>Alarm IDs can be anything from 1 to 999999 defined by the current Navithor Server version. The exact IDs used can be found from * Alarms* documentation.</li>
</ul>
</li>
</ul>
<p>SimpleStaticConfiguration creates all nodes inside a single folder called <em>Errors</em> directly under the root <em>Objects</em> folder.</p>
<p>Below is an example of the node structure in this configuration.</p>
<pre><code>Objects
|
|--&gt; Errors
|  |--&gt;FTF00001 - Error 000001
|  |--&gt;FTF00001 - Error 000002
|  | .
|  | .
|  |--&gt;FTF00001 - Error 000998
|  |--&gt;FTF00001 - Error 000999
|  |--&gt;FTF00001 - Error 100000
|  |--&gt;FTF00001 - Error 100001
|  | .
|  | .
|  |--&gt;FTF00002 - Error 000001
|  |--&gt;FTF00002 - Error 000002
|  | .
|  | .
|  |--&gt;FTF00002 - Error 000998
|  |--&gt;FTF00002 - Error 000999
|  |--&gt;FTF00002 - Error 100000
|  |--&gt;FTF00002 - Error 100001
|  | .
|  | .
|  |--&gt;FTFXXXXX - Error 000001
|  |--&gt;FTFXXXXX - Error 000002
|  | .
|  | .
|  |--&gt;FTFXXXXX - Error 000998
|  |--&gt;FTFXXXXX - Error 000999
|  |--&gt;FTFXXXXX - Error 100000
|  |--&gt;FTFXXXXX - Error 100001
|  | .
|  | .
|  |--&gt;System - Error 000100
|  |--&gt;System - Error 000102
|  |--&gt;System - Error 000103
|  | .
|  | .
|  |--&gt;System - Error XXXXXX

</code></pre>
<h3 id="xml-file-generated"><a class="header" href="#xml-file-generated">XML File generated</a></h3>
<p>If node manager is configured to use <em>SimpleStaticConfiguration</em>, Navithor Server will automatically generate on start up an XML file that describes the node configuration inside the OPC UA Server with the current software version. The file is written into <em>Navithor Server/ConfigFiles/OpcUaSimpleStaticNodes.xml</em>.</p>
<p>Example of the format:</p>
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;UANodeSet&gt;
  &lt;UAVariable NodeId=&quot;ns=2;s=Errors/FTF00013 - Error 000001&quot;&gt;
    &lt;Description&gt;FTF00013 - Error 000001&lt;/Description&gt;
  &lt;/UAVariable&gt;
  &lt;UAVariable NodeId=&quot;ns=2;s=Errors/FTF00013 - Error 000002&quot;&gt;
    &lt;Description&gt;FTF00013 - Error 000002&lt;/Description&gt;
  &lt;/UAVariable&gt;
  &lt;UAVariable NodeId=&quot;ns=2;s=Errors/FTF00013 - Error 000003&quot;&gt;
    &lt;Description&gt;FTF00013 - Error 000003&lt;/Description&gt;
  &lt;/UAVariable&gt;
&lt;/UANodeSet&gt;
</code></pre>
<h2 id="related-parameters"><a class="header" href="#related-parameters">Related parameters</a></h2>
<p>The following Navithor Server parameters affect how the OPC UA Server works.</p>
<h3 id="opcua_serverport"><a class="header" href="#opcua_serverport">OpcUa_ServerPort</a></h3>
<p>Tells on which port the OPC UA Server is launched on. The default value for this is 4840. This port value was chosen as it was used in the OPC Foundation's official examples in their Github repository.</p>
<h3 id="opcua_serverendpointname"><a class="header" href="#opcua_serverendpointname">OpcUa_ServerEndPointName</a></h3>
<p>Defines the a string name for the endpoint. This name is also used as the namespace in the OPC UA Server's node manager. The name can not contain special characters or spaces.  Default value for this is NavithorServer.</p>
<h3 id="opcua_endpointconfiguration"><a class="header" href="#opcua_endpointconfiguration">OpcUa_EndPointConfiguration</a></h3>
<p>Flag parameter that tells which OPC Security algorithms are used for the endpoints. If multiple values are selected then multiple endpoints are also opened.</p>
<h3 id="opcua_nodemanagerconfiguration"><a class="header" href="#opcua_nodemanagerconfiguration">OpcUa_NodeManagerConfiguration</a></h3>
<p>Defines which node manager is used for OPC UA Server. This defines the structure of folders and nodes in the server. Currently supported modes are:</p>
<ul>
<li>StandardConfiguration: Standard configuration, which includes subfolders for AGV errors, location errors, system alarms and OPC UA settings. This document is based on this configuration, unless the chapter specifically mentions an alternative configuration.</li>
<li>SimpleStaticConfiguration: Only AGV and System alarms are represented as a single boolean node inside the same object folder. Detailed configuration is discussed in chapter <em>Alternative node configuration: SimpleStaticConfiguration</em>.</li>
</ul>
<p>Changing the parameter requires restarting Navithor Server to recreate the OPC UA nodes in the new configuration.</p>
<h3 id="opcua_serverenabled"><a class="header" href="#opcua_serverenabled">OpcUa_ServerEnabled</a></h3>
<p>Finally when this parameter is set to True, the OPC UA Server is started using the parameters set above. Only changing the OpcUa_ServerEndPointName requires a full server restart.</p>
<p>For example using default value starting OPC UA server creates an endpoint with None as the security algorithm and to the address opc.tcp://server_ip:4840/NavithorServer</p>
<h2 id="current-limitations"><a class="header" href="#current-limitations">Current limitations</a></h2>
<p>Current implementation supports only anonymous users. The OPC security algorithms Basic256 and Basic256Sha256 have not been tested.</p>
<h2 id="testing"><a class="header" href="#testing">Testing</a></h2>
<p>OPC connection can be tested with a client called OPC Watch, developed by the company Traeger. Latest version is available at https://docs.traeger.de/en/software/sdk/opc-ua/net/net#download</p>
<p><strong>Note:</strong> OPC Watch version 2.17 has issues with auto updating of the nodes. Connection has been tested to be working with versions 2.10, 2.20, and 2.29 at least.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="NavithorWebApi.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                            <a rel="next" href="Fleet Control Alarms.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="NavithorWebApi.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                    <a rel="next" href="Fleet Control Alarms.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>

        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
    </body>
</html>
