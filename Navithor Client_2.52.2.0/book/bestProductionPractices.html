<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Best Practices for Creating Production Area - NAVITHOR USER INSTRUCTIONS</title>
        <!-- Custom HTML head -->
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">
        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="index.html">Front page</a></li><li class="chapter-item expanded affix "><li class="part-title">Configuration</li><li class="chapter-item expanded "><a href="Installation_NavithorHardwareRequirements.html"><strong aria-hidden="true">1.</strong> System Hardware Requirement Specifications</a></li><li class="chapter-item expanded "><a href="Installation_SQLServerAndDatabaseInstallationGuide.html"><strong aria-hidden="true">2.</strong> Configuring database</a></li><li class="chapter-item expanded "><a href="fleetSim.html"><strong aria-hidden="true">3.</strong> Fleet Simulator - Setup and Configuration</a></li><li class="chapter-item expanded "><a href="Installation_NavithorServerAsAService.html"><strong aria-hidden="true">4.</strong> Server as a service</a></li><li class="chapter-item expanded "><a href="Installation_ConfiguringHotSwap.html"><strong aria-hidden="true">5.</strong> Server Hot Swap with Failover Cluster</a></li><li class="chapter-item expanded "><a href="Installation_RebrandingNavithor.html"><strong aria-hidden="true">6.</strong> Server and Client Rebranding</a></li><li class="chapter-item expanded "><a href="Machinetool.html"><strong aria-hidden="true">7.</strong> Machine Tool</a></li><li class="chapter-item expanded "><a href="MesTester3.html"><strong aria-hidden="true">8.</strong> MES Tester</a></li><li class="chapter-item expanded affix "><li class="part-title">Desktop client</li><li class="chapter-item expanded "><a href="navithorServerAndClientMegaDocument.html"><strong aria-hidden="true">9.</strong> System Overview and user instructions for Client UI</a></li><li class="chapter-item expanded "><a href="Feature_ClientUpdater.html"><strong aria-hidden="true">10.</strong> Client Updater</a></li><li class="chapter-item expanded affix "><li class="part-title">Web client</li><li class="chapter-item expanded "><a href="Installation_SettingUpNavithorWebServer.html"><strong aria-hidden="true">11.</strong> Setting up Web server to enable Web client</a></li><li class="chapter-item expanded "><a href="webClient.html"><strong aria-hidden="true">12.</strong> Web Client - User Instructions</a></li><li class="chapter-item expanded affix "><li class="part-title">Guides</li><li class="chapter-item expanded "><a href="bestProductionPractices.html" class="active"><strong aria-hidden="true">13.</strong> Best Practices for Creating Production Area</a></li><li class="chapter-item expanded affix "><li class="part-title">Logs</li><li class="chapter-item expanded "><a href="Navithor logs.html"><strong aria-hidden="true">14.</strong> Navithor Logs</a></li><li class="chapter-item expanded "><a href="Feature_VisualReplay.html"><strong aria-hidden="true">15.</strong> Visual Replay</a></li><li class="chapter-item expanded "><a href="Feature_DownloadManager.html"><strong aria-hidden="true">16.</strong> Log Download Manager</a></li><li class="chapter-item expanded affix "><li class="part-title">Users</li><li class="chapter-item expanded "><a href="Installation_UsingActiveDirectoryForAuthentication.html"><strong aria-hidden="true">17.</strong> User authentication against Active Directory</a></li><li class="chapter-item expanded "><a href="userRoles.html"><strong aria-hidden="true">18.</strong> User Management</a></li><li class="chapter-item expanded "><a href="userRolesRightsMatrix.html"><strong aria-hidden="true">19.</strong> Default User roles and User rights matrix</a></li><li class="chapter-item expanded affix "><li class="part-title">Features</li><li class="chapter-item expanded "><a href="symbolicPointGroups.html"><strong aria-hidden="true">20.</strong> Symbolic Point Groups</a></li><li class="chapter-item expanded "><a href="ResourceHandling.html"><strong aria-hidden="true">21.</strong> Resource handling</a></li><li class="chapter-item expanded "><a href="hold-release.html"><strong aria-hidden="true">22.</strong> Hold-Release reasoning and production order lists</a></li><li class="chapter-item expanded "><a href="transfer requests.html"><strong aria-hidden="true">23.</strong> Transfer requests</a></li><li class="chapter-item expanded "><a href="racking.html"><strong aria-hidden="true">24.</strong> Using warehouse racking feature</a></li><li class="chapter-item expanded "><a href="bufferLanes.html"><strong aria-hidden="true">25.</strong> Using Buffer Lanes</a></li><li class="chapter-item expanded "><a href="Feature_ChargingManagement.html"><strong aria-hidden="true">26.</strong> Managing Battery Levels</a></li><li class="chapter-item expanded "><a href="oneMachineZones.html"><strong aria-hidden="true">27.</strong> Using One Machine Zones</a></li><li class="chapter-item expanded "><a href="distanceControlZones.html"><strong aria-hidden="true">28.</strong> Distance Control Zones</a></li><li class="chapter-item expanded "><a href="FireAlarmZones.html"><strong aria-hidden="true">29.</strong> Fire Alarm Zones</a></li><li class="chapter-item expanded "><a href="Zone status use cases.html"><strong aria-hidden="true">30.</strong> Zone status use cases</a></li><li class="chapter-item expanded "><a href="tagStatuses.html"><strong aria-hidden="true">31.</strong> Tag Statuses</a></li><li class="chapter-item expanded "><a href="Trafficlights.html"><strong aria-hidden="true">32.</strong> Traffic Lights</a></li><li class="chapter-item expanded "><a href="Feature_Elevators.html"><strong aria-hidden="true">33.</strong> Elevators</a></li><li class="chapter-item expanded "><a href="ProductionBreak.html"><strong aria-hidden="true">34.</strong> Production Break</a></li><li class="chapter-item expanded "><a href="DynamicSafetyBounds.html"><strong aria-hidden="true">35.</strong> Virtual Dynamic Safety Bounds</a></li><li class="chapter-item expanded "><a href="WaitingSlots.html"><strong aria-hidden="true">36.</strong> Wait Queue Locations</a></li><li class="chapter-item expanded "><a href="CoupledDrive.html"><strong aria-hidden="true">37.</strong> Coupled Drive</a></li><li class="chapter-item expanded "><a href="Feature_StoppingPointOffsetsForSymbolicPoints.html"><strong aria-hidden="true">38.</strong> Stopping Point Offsets</a></li><li class="chapter-item expanded "><a href="TCStopPoint.html"><strong aria-hidden="true">39.</strong> Safe stopping point calculation</a></li><li class="chapter-item expanded "><a href="Navithor statistics.html"><strong aria-hidden="true">40.</strong> System Statistics</a></li><li class="chapter-item expanded "><a href="MachineInterfaces.html"><strong aria-hidden="true">41.</strong> Machine Interfaces</a></li><li class="chapter-item expanded affix "><li class="part-title">Interfaces</li><li class="chapter-item expanded "><a href="Communication specification between Navithor and MES.html"><strong aria-hidden="true">42.</strong> MES Interface</a></li><li class="chapter-item expanded "><a href="NavithorHttpApi.html"><strong aria-hidden="true">43.</strong> HTTP API</a></li><li class="chapter-item expanded "><a href="NavithorWebApi.html"><strong aria-hidden="true">44.</strong> WebSocket API</a></li><li class="chapter-item expanded "><a href="opcuadoc.html"><strong aria-hidden="true">45.</strong> OPC UA Server interface</a></li><li class="chapter-item expanded affix "><li class="part-title">Alarms</li><li class="chapter-item expanded "><a href="Fleet Control Alarms.html"><strong aria-hidden="true">46.</strong> Alarms</a></li><li class="chapter-item expanded "><a href="Alarms configuration override.html"><strong aria-hidden="true">47.</strong> Alarms configuration override</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="dark">Dark</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">NAVITHOR USER INSTRUCTIONS</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="best-practices-for-creating-production-area"><a class="header" href="#best-practices-for-creating-production-area">Best Practices for Creating Production Area</a></h1>
<p>This document contains information on best practices for creating production area in Navithor.</p>
<p>Updated 09.04.2021</p>
<h2 id="version-history"><a class="header" href="#version-history">Version History</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Version</th><th>Date</th><th>Author</th><th>Change</th></tr></thead><tbody>
<tr><td>1.0</td><td>24.08.2020</td><td>Ashhal Tahir</td><td>First version</td></tr>
<tr><td>1.1</td><td>10.12.2020</td><td>Aleksi Ålander</td><td>Document updated</td></tr>
<tr><td>1.2</td><td>08.03.2021</td><td>Elena Sgonova</td><td>Converted to markdown</td></tr>
<tr><td>1.3</td><td>09.04.2021</td><td>Aleksi Ålander</td><td>Small additions</td></tr>
<tr><td>1.4</td><td>11.06.2021</td><td>Aleksi Ålander</td><td>Renamed title</td></tr>
</tbody></table>
</div>
<hr />
<h2 id="glossary"><a class="header" href="#glossary">Glossary</a></h2>
<div class="table-wrapper"><table><thead><tr><th><strong>Term</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td>Waypoint</td><td>One traffic area that is scheduled based on driving times and other reservations. Waypoint is called either Node (intersection) or Link (pathway connecting two intersections)</td></tr>
<tr><td>Segment</td><td>One part of driving route. Created automatically by Tools from route network. Directional: Segment IDs that are even numbered are for forward driving and odd numbers are for reversing</td></tr>
<tr><td>Overlapping reservation</td><td>Driving route has points that collides with other active driving route or stationary task</td></tr>
<tr><td>Blocking reservation</td><td>AGV that ends it driving task or is performing a stationary task in a location that is on the path of another AGV</td></tr>
</tbody></table>
</div>
<h2 id="introduction"><a class="header" href="#introduction">Introduction</a></h2>
<p>The purpose of this document is to provide instructions and practices for creating production area that will allow the AGVs to have minimum number of deadlocks as possible and have a good production flow.</p>
<p>The document starts by describing basic functions and terms used by the Scheduler.
In addition to this, scheduler settings and parameters that affect the scheduling of the AGVs are explained.</p>
<p>The second part of the document covers guidelines for defining routes that would provide the best flow of traffic.
This includes starting from the basics of defining route segments, lane directions and orientations, route properties and correct use of different types of symbolic points (SPs), one-machine-zones and segment splitting.</p>
<p>All this will depend on the type of production logic being used. The last chapter of the document covers topics that should be considered, when planning the layout for the production to make sure the production flow would be as smooth as possible. This should be done always in advance before the integration of the project.</p>
<h2 id="navithor-scheduler"><a class="header" href="#navithor-scheduler">Navithor Scheduler</a></h2>
<h3 id="scheduler-description"><a class="header" href="#scheduler-description">Scheduler description</a></h3>
<p>Part of the best scheduling practices is to understand the Navithor scheduler and set the correct settings
for a production. Navithor scheduler is used to create timetables for each drive task. It manages:</p>
<ul>
<li>Entry and exit times to waypoints;</li>
<li>Entering order - linking to other drive tasks that need same Waypoint or overlapping Waypoint(s).</li>
</ul>
<p>Navithor scheduler takes in different inputs and provides corresponding outputs. The inputs and outputs to Navithor scheduler are described below:</p>
<ul>
<li>Input:
<ul>
<li>Drive route containing one or many driving segments;</li>
<li>Other tasks: drive - or stationary tasks.</li>
</ul>
</li>
<li>Output:
<ul>
<li>Scheduled drive task that is allowed to be driven;</li>
<li>Partially scheduled drive task that is allowed to be started but may not be finished due to blockings;</li>
<li>Re-routed drive task:
<ul>
<li>Constant failure of scheduling increases AGV's Deadlock-state;</li>
<li>Alternative routes may be generated and scheduled;</li>
<li>Yielding path may be added to a drive task to give way to other reservations.</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="waypoint-reservations"><a class="header" href="#waypoint-reservations">Waypoint Reservations</a></h3>
<ul>
<li>Scheduler performs scheduling of all tasks dynamically when traffic situations change or AGV is not driving according to schedule;</li>
<li>Scheduler performs scheduling for each route waypoint marking them as scheduled when succeeding. ONLY scheduled waypoints can be driven by AGV;</li>
<li>Navithor Tools creates Waypoints automatically based on AGV dimensions and route lane configurations.</li>
</ul>
<p><img src="./Images/bestProductionPractices/waypointReservations1.png" alt="" /></p>
<blockquote>
<p>AGV dimensions and overlaps highlighted</p>
</blockquote>
<p>Other AGVs may use the red-marked areas at the same time if parameter <strong>Node_RESERVERS_MAXIMUM_COUNT</strong> is more than 1 AND</p>
<ul>
<li>AGVs use the same route through the area and it does not contain direction changes OR</li>
<li>AGVs drive route does not contain drive segments that would overlap with other AGVs current drive segments</li>
</ul>
<p>Otherwise the reservations cannot be timewise overlapping. Parameter <strong>Scheduler_DELTA_T</strong> is inserted between all reservations that cannot be scheduled to occupy the waypoint at the same time.</p>
<p><img src="./Images/bestProductionPractices/waypointReservations2.png" alt="" /></p>
<blockquote>
<p>Drive segment highlighted</p>
</blockquote>
<ul>
<li>Waypoint type (Node or Link) affect how it is being compared to other reservations.
Link has only two other Waypoints that have overlapping segments with its segments (the Nodes that connect to each end of the link).
For this reason the scheduling of Link is simpler than scheduling of Node;</li>
<li>Route layout design is the key for good traffic flow:
<ul>
<li>Minimizing route overlaps (red-marked areas in previous slide)
<ul>
<li>In dense route networks minimizing overlaps is more important than minimizing driving distances between stations.
I.e. route with less overlap is usually faster than shorter route but with high likelihood for traffic and thus waiting;</li>
</ul>
</li>
<li>Favouring one-way traffic;</li>
<li>Reservation for one-way Waypoint can be done even if full scheduling fails. One-way Links can be used as waiting queues.</li>
</ul>
</li>
</ul>
<p><img src="./Images/bestProductionPractices/waypointReservations3.png" alt="" /></p>
<p>Nodes are marked with bold green path and Links are paths that look as original network. Cutting marks are showing the points where segments will start and end and also where Waypoints change.</p>
<h3 id="parameters-affecting-waypoint-scheduling"><a class="header" href="#parameters-affecting-waypoint-scheduling">Parameters affecting Waypoint scheduling</a></h3>
<ul>
<li>
<p><strong>Scheduler_LEAVE_WAYPOINTS_AHEAD_FREE_COUNT</strong> - affects how far in route AGVs are allowed to be scheduled in case full scheduling is not possible. Other scheduling rules may apply to the last valid Waypoint that is allowed to be marked as scheduled. A good value for this parameter depends on route network type: dense network with lot of small Nodes should have value &gt;= 2 otherwise &gt;= 1. Also if AGV is tugger-type with simulated trailers then this parameter should also be &gt;=2, in some cases even 4-5.</p>
</li>
<li>
<p><strong>Scheduler_LEAVE_FREE_WAYPOINTS_BETWEEN_CROSSING_TRAFFIC</strong> - Affects how many waypoints needs to be left unscheduled if last successfully scheduled waypoint is Node and it has overlapping route with other tasks. The value for this parameter should be &gt;= 1. For tugger-type AGVs the value should be &gt;= 2.</p>
</li>
<li>
<p><strong>Scheduler_TRIGGER_WP_FREE_DIST_TO_EXIT</strong> - Affects the moment when AGV releases waypoint reservation when it is driving from one waypoint to another. Larger parameter values allow other AGVs to enter the Waypoint sooner. Default is 1 meter.</p>
</li>
<li>
<p><strong>Scheduler_DELTA_T</strong> - time that is added between all reservations for the same or overlapping waypoint when common reservation is not possible. Default is 1 second.</p>
</li>
<li>
<p><strong>Scheduler_SAFE_SIDE_DISTANCE_BOUND</strong> - Used for possible crossing reservation check. A rough minimum distance between two AGVs that is used for checking if AGVs are on each others way. Default value is 1.2 meters but normally this is reduced to 0.3-0.5.</p>
</li>
<li>
<p><strong>Scheduler_NODE_RESERVERS_MAX_COUNT</strong> - Affects how many AGVs are allowed to reserve one Node at the same time. Default is 1 but normally 2 is set. More than 2 does not have much affect as Nodes tend to be so small that it is physically not possible for more than 2 AGVs occupy one Node at the same time.</p>
</li>
<li>
<p><strong>Scheduler_ALLOW_WP_MULTI_LOCK_TIME_LIMIT_SECS</strong> - Affect the possibility for multiple AGVs reserving same Waypoint or overlapping Waypoints. Scheduled entry times needs to be within this limit. Default value is 10 seconds but it can be increased to e.g. 20 seconds.</p>
</li>
<li>
<p><strong>Scheduler_BLOCKED_MIN_WAIT_TIME_MINUTES</strong> - Time that is added to a blocking reservations end time and other blocking situations when times cannot be calculated due to unknown outcome. Default value is 48 seconds but this can be reduced to e.g. 30 or even 20 seconds if production flow is fast in each station.</p>
</li>
<li>
<p><strong>Scheduler_DEADLOCK_WAIT_TIME_MINUTES</strong> - This parameter is used for triggering a deadlock-alert that will also increase Deadlock-state of an AGV. Default value is 1 minute and 30 seconds but this can be reduced to e.g. 30-40 seconds for faster deadlock handling.</p>
</li>
<li>
<p><strong>Scheduler_DRIVE_TASK_SCHEDULING_MODE</strong> - This is explained further in scheduling rules section.</p>
</li>
</ul>
<h3 id="scheduling-rules"><a class="header" href="#scheduling-rules">Scheduling Rules</a></h3>
<p>1.  Parameter <strong>Scheduler_DRIVE_TASK_SCHEDULING_MODE</strong> has rules for scheduling. Following rules can be enabled or disabled:</p>
<ul>
<li>none = 0;</li>
<li>yieldingEna = 1 &lt;&lt; 0;</li>
<li>stopOnLinksOnly = 1 &lt;&lt; 1;</li>
<li>schedToNonOverlapping = 1 &lt;&lt; 2;</li>
<li>reqStopPointsForSchedEndRwp = 1 &lt;&lt; 3;</li>
<li>acceptPartialSchedulingAlways = 1 &lt;&lt; 4; <em>// When not fully scheduled, ignore checks about overlapping tasks. This makes sense only when route network is oneway</em></li>
<li>cutDriveToNextNoStop = 1 &lt;&lt; 5;</li>
<li>cutDriveToNextNoStopAlways = 1 &lt;&lt; 6;</li>
<li>cutDriveToWaitUnloadOnPath = 1 &lt;&lt; 7;</li>
</ul>
<p>The parameter is currently presented as an integer. Default value is 1. Following rules can be enabled or disabled:</p>
<ul>
<li><strong>cutDriveToNextNoStop</strong>-rule is usually advised and also <strong>schedToNonOverlapping</strong>-rule is useful if route network is not too dense.</li>
</ul>
<p>For example, if parameter value is set to 37 then these rules are enabled: <strong>yieldingEna</strong>, <strong>schedToNonOverlapping</strong> and <strong>cutDriveToNextNoStop</strong>. This is because 37 == 0010 0101. Windows Calculator has build-in programmer mode for converting values between number formats.</p>
<ul>
<li><strong>Yielding enable/disable - yieldingEna</strong></li>
</ul>
<p>Yielding is used in scheduling situations when two AGVs cannot fulfil priority rules for using common routes. Lower priority AGV may be ordered to yield another AGV in cases when both AGVs are on path of each other or if lower AGVs current position and destination point blocks higher AGV from reaching its target point.</p>
<p>Yielding means AGVs route is tried to be manipulated so that it will drive away from current drive path so that it will not be in way of the AGV that requires free path to target. Once AGV reaches created yielding point it will wait until higher priority AGV has passed location where yielding AGV left its original route.</p>
<p>2.  Parameter <strong>Scheduler_YIELD_DISTANCE_SECONDS</strong> affects how far is yielding point created after leaving original route. A route back to original path is required to be available for successful yield. If yielding route cannot be calculated, then scheduling needs to define the situation either as blocking or favor lower priority AGV. Disabling this rule affects scheduling results. Some situations may favor lower priority AGVs but in cases when both AGVs block each other the scheduling will fail. Failure for scheduling leads eventually re-planning of route and finally to drive-tasks out of way of others if allowed by parameter <strong>Scheduler_NeverAllowForceMove</strong>.</p>
<p>3.  <strong>Stop on Links Only - stopOnLinksOnly</strong> - If full scheduling of drive task is not possible (e.g. due to common target location with another AGV or stationary AGV on path) this rule is checked when possible stopping location is looked along successfully scheduled path. If this rule is enabled only Link-type traffic areas (Waypoints) are allowed as stopping locations. This rule is disabled by default and is advised to be enabled only in areas with lots of long straight paths without overlapping paths.</p>
<p>4.  <strong>Schedule to Non-Overlapping Waypoint - schedToNonOverlapping.</strong> If full scheduling of drive task fails, this rule allows advancing to a waypoint that has been scheduled and is not overlapping with other reservations. By default, this rule is disabled. Enabling this rule gives more possibilities for advancing drive tasks when full scheduling fails. Enabling is safe in one-way oriented route networks but in bi-directional route networks this rule may cause more blockings.</p>
<p>5.  Require Pre-calculated StoppingPoint for Last successfully Scheduled Waypoint - <strong>reqStopPointnForSchedEndRwp</strong></p>
<ul>
<li>If full scheduling of drive task is not possible this rule will affect which of the scheduled waypoints are allowed to be driven into. If rule is enabled only waypoints that have pre-calculated stopping points (small dots along paths in Client's map when zoomed in close to routes). Stopping points are only possible in routes that do not cross with other routes thus are safe for stopping.</li>
<li>Enabling this rule prevents stopping mostly to intersection areas thus the effect is more or less the same as with <strong>stopOnLinksOnly</strong>. The difference is that some intersection nodes may have pre-calculated stopping points and this rule is then more balanced.</li>
</ul>
<p>6. Accept Partial Scheduling Always - <strong>acceptPartialSchedulingAlways</strong> - If full scheduling of drive task fails, this rule allows driving of all the waypoints that were successfully scheduled. Enabling this rule is not advised but it can work in special route networks with one-way traffic and OneMachineZones defined to prevent driving to a location where AGV will block others needing way out.</p>
<p>7. Cut Drive Task to Next NoStop-Symbolic Point - <strong>cutDriveToNextNoStop</strong></p>
<ul>
<li>
<p>If this rule is enabled Scheduler will check the drive path for next NoStop-Symbolic Point that is further than <strong>Scheduler_LEAVE_WAYPOINTS_AHEAD_FREE_COUNT</strong> waypoints ahead and also not too near current Target location. The drive task is cut to the NoStop-location and rest of the waypoints are cleared from the task. Now the drive task is only scheduled to the NoStop. This will help in many situations when traffic situations in future waypoints are not interesting when the original route is given to Scheduler.</p>
</li>
<li>
<p>When the AGV is executing the drive task to the NoStop-location and final DriveExtension-message is given to reach the NoStop-location the drive task is again dynamically extended to the target location and the task extension will be scheduled.</p>
</li>
<li>
<p>When scheduling again the task it may be possible that the task will be cut again to a next NoStop-location on path. Finally, the AGV has the route to the target location of the production order.</p>
</li>
<li>
<p>Enabling this rule is safe and this has been found very effective in many areas where driving distances are long. This rule gives also more control where AGVs can advance in their drive tasks. Commonly the NoStop-Symbolic Points are set to be in one-way paths where it is safe driving to.</p>
</li>
</ul>
<p>8. <strong>cutDriveToNextNoStopAlways</strong> - Similar to rule above, but the maximum distance to the current NoStop before the drive order can be extended to the next symbolic point can be limited with parameter <strong>MissionManager_DIST_FROM_NOSTOP_TO_EXTEND_IF_DRIVE_CUT_ALWAYS</strong>. If there is any pivot points along the route, the scheduler tries to first finish the pivot before extending the drive to next target to avoid blocking routes earlier than necessary. This rule should be used only if recommended by Navitec and instead use the rule <strong>cutDriveToNextNoStop</strong>.</p>
<p>9. Cut Drive Task to WaitUnload-Symbolic Point on the path - <strong>cutDriveToWaitUnloadOnPath</strong> - Drive order is cut first always to WaitUnload location, if it is along the way. When machine is close to the WaitUnload, the drive order can be extended to the end location.</p>
<p>10. Disabling Scheduler
Disabling scheduler means all tasks are set scheduled from start to end without any checking for overlapping reservation. Disabling is done by setting parameter <strong>Scheduler_DRIVE_TASK_SCHEDULING_MODE</strong> to negative value. When disabled traffic controlling is based on segment overlap checks and OneMachineZone-checks. Disabling scheduler is only advised in route networks with working OneMachineZone-design. Segment overlap check can be disabled with parameter <strong>TrafficControl_SEGMENT_OVERLAP_CHECK_MODE</strong>.</p>
<h3 id="scheduler-driving-rules-and-priorities"><a class="header" href="#scheduler-driving-rules-and-priorities">Scheduler driving rules and priorities</a></h3>
<ul>
<li>All Driving tasks are scheduled FIFO. Automatically generated production orders have common priority unless location priorities are used and thus priority order of all tasks depend on order of the scheduled tasks;</li>
<li>Priority is taken into account when overlapping and/or blocking reservations are being scheduled. Priority affects the entry order to a Waypoint, but priority is ignored in these cases (roughly):
<ul>
<li>Calculated entry times are not overlapping, and reservations are not blocking each other;</li>
<li>One AGV is blocking other or will block with its route.</li>
</ul>
</li>
<li>As all system parameters are global some traffic areas may need One Machine Zones to better traffic management. One Machine Zones have also FIFO entry rules;</li>
<li>If route cannot be fully scheduled due to other AGV blocking, then scheduler is allowed to reroute AGVs to their targets or move them away from the current path.</li>
</ul>
<h3 id="scheduler-rerouting"><a class="header" href="#scheduler-rerouting">Scheduler Rerouting</a></h3>
<ul>
<li>Rerouting is done for drive tasks that are not progressing i.e. AGVs deadlock-state is increasing. Following parameter affect if alternative routes can be used:
<ul>
<li><strong>RoutePlanner_SECONDARY_ROUTES_SELECTION_MAX</strong> - how many alternative routes are calculated by Route Planner. Default is 0 but this can be increased to e.g. 5 if rerouting is needed;</li>
<li><strong>RoutePlanner_MAX_ROUTE_LOOPS_COUNT</strong> - how many times same waypoint with same segments is allowed to be in the route. Default is 0. Increasing to 1 is needed in cases when loops are really needed for deadlock handling;</li>
<li><strong>RoutePlanner_MAX_SECONDARY_ROUTE_DISTANCE_DIFF</strong> - how much in difference the new route can be compared to the original. Default is 1.5 but this can be increased to e.g. 5 when secondary routes are used;</li>
<li><strong>RoutePlanner_MAX_SECONDARY_ROUTE_ADDITIONAL_DISTANCE_METERS</strong> - how much longer in meters the secondary route is allowed to be compared to the original. Default is 100 meters but this can be increased to what ever is sensible in the production area;</li>
</ul>
</li>
<li>If AGVs deadlock-state goes over parameter <strong>Scheduler_MachineDeadlockStateLimit</strong> then AGV is tried to be moved to a location that is not on path of others. Parameter <strong>Scheduler_NeverAllowForceMove</strong> can be set to true is this action is not desired.</li>
</ul>
<h3 id="scheduler-giving-penalty-to-routes"><a class="header" href="#scheduler-giving-penalty-to-routes">Scheduler Giving Penalty to Routes</a></h3>
<ul>
<li>Fastest route is calculated based on the route lengths and defined route speeds;</li>
<li>There are several different parameters to give penalty for the estimated driving time. Positive value means penalty is added to the driving time, negative values means the rule makes the driving time estimate lower (route planner favors routes with this rule);</li>
<li>Penalties for driving through certain symbolic points:
<ul>
<li><strong>RoutePlanner_STOP_LOC_PASSING_PENALTY_SEC</strong>;</li>
<li><strong>RoutePlanner_NOSTOP_LOC_PASSING_PENALTY_SEC</strong>;</li>
<li><strong>RoutePlanner_LOAD_LOC_PASSING_PENALTY_SEC</strong>;</li>
<li><strong>RoutePlanner_UNLOAD_LOC_PASSING_PENALTY_SEC</strong>;</li>
<li><strong>RoutePlanner_WAIT_LOC_PASSING_PENALTY_SEC</strong>;</li>
<li><strong>RoutePlanner_CHARGE_LOC_PASSING_PENALTY_SEC</strong>;</li>
</ul>
</li>
<li>Other penalty parameters:</li>
<li><strong>RoutePlanner_SEGMENT_DRIVE_BWD_TIME_PENALTY_SECS</strong> - Affects how much extra time penalty is added to segments that are reversing;</li>
<li><strong>Scheduler_SEGMENT_COST_GAIN</strong> - Cost penalty gain added to route points with high curvature. 1.00 means curves have no penalty compared to straight waypoints, values under 1 means that curves have a penalty;</li>
<li><strong>Waypoint_BLOCKED_PENALTY_SEC</strong> - Penalty added when planning route through blocked waypoint;</li>
<li><strong>RoutePlanner_SEGMENT_DRIVE_BLOCKED_TIME_PENALTY_SECS</strong> - Affects how much time penalty is added to segments that are set forbidden for drive through (e.g. AGV stationary at segment).</li>
</ul>
<h3 id="dynamic-virtual-safety-bounds"><a class="header" href="#dynamic-virtual-safety-bounds">Dynamic Virtual Safety Bounds</a></h3>
<p>Navithor Fleet Control System controls AGVs in a safe way by not allocating routes for AGVs if the routes are overlapping. As an additional safety feature Navithor also calculates dynamic safety- and speed bounds online.</p>
<p>These bounds are used to prevent collisions and are used also to limit speeds when two AGVs are moving very close to each other.</p>
<p>This is a feature that is strictly independent from Navitrol and is available only in Navithor Fleet Control. AGV (Navitrol) does not have the information of the virtual bounds and thus it cannot be used to checked against live laser data.</p>
<p>The feature uses two separate bounds that create polygon around the AGV in Navithor Fleet Control System:</p>
<ul>
<li>Safety bounds;</li>
<li>Speed warning bounds.</li>
</ul>
<p><img src="./Images/bestProductionPractices/safetyBounds1.png" alt="" /></p>
<p>Gray polygon around AGV defines safe bounds that should not be violated by another AGVs safety bounds.</p>
<ul>
<li>Safety bound takes turns in the route into account and expands in the direction of the turns;</li>
<li>Safety bounds grow bigger with higher speeds, depending on the parameters.</li>
</ul>
<p>Violation of safety bounds between two AGVs causes abort-signal to be commanded to the AGVs.</p>
<p>Violation check is done between safety bounds of two AGVs that are near each other.</p>
<p>Navithor Traffic Controller performs cross-checks of safety bound violations during each process cycle (5Hz).</p>
<p><img src="./Images/bestProductionPractices/safetyBounds2.png" alt="" /></p>
<p>Speed warning bounds is the second type of safety bounds</p>
<ul>
<li>Green polygon around AGV defines virtual speed warning bounds.</li>
</ul>
<p>Speed warning zones are checked against the gray safety bounds of other AGVs close by.</p>
<p>Violation of speed bounds causes speed reductions in steps:</p>
<ul>
<li>First reduction is to 50% speed of max speed of current route;</li>
<li>Second reduction is to 25% speed of max speed of current route.</li>
</ul>
<p>Speed warning bounds expand when speed increases, if default calculation mode is used</p>
<ul>
<li>All violations that causes speed reductions also make bounds smaller thus further reductions may be avoided.</li>
</ul>
<p>Parameters that should be enabled to use the dynamic virtual safety zones:</p>
<p><strong>TrafficController_Safetybounds_calculation_mode -&gt; DynamicBounds</strong></p>
<ul>
<li>Defines which algorithm is used for safety speed and speed bound calculations. Dynamic bounds is the recommended mode, as in this mode the bounds increase based on speed, position confidence, frame heading and takes curves into account. Default mode does not work correctly with different frame headings on the routes (omni-AGVs) but for steer-drive and differentially driven AGVs the default-mode works as good as Dynamic Bounds-mode.</li>
</ul>
<p><strong>ServiceInterface_SendSafetyAreaBoundsToClient -&gt; True</strong></p>
<ul>
<li>Parameter to enable/disable sending of safety bounds to Navithor Clients. If Clients are used in WIFI network with poor data transfer rates, then this is one way to limit data from Navithor Server to Clients.</li>
</ul>
<h2 id="guidelines-for-routing"><a class="header" href="#guidelines-for-routing">Guidelines for Routing</a></h2>
<h3 id="one-way-streets-are-easier-to-schedule"><a class="header" href="#one-way-streets-are-easier-to-schedule">One-way streets are easier to schedule</a></h3>
<p>One-way streets are easier to schedule efficiently, because there is no fear of other machines needing to wait for another machine that is driving to the opposite direction.</p>
<p>For example a layout with multiple aisles or grid like route network is more efficient, if as many routes as possible are driven as one-way only.</p>
<p>Exception to this rule is that, two-way street is still better than having two separate one-way streets (that overlap each other) going opposite directions.</p>
<p>This is because the two overlapping routes may create two very long intersection areas that are not managed as well as a single two-way intersection or pathway</p>
<ul>
<li>Bad (two different routes):</li>
</ul>
<p><img src="./Images/bestProductionPractices/routing1.png" alt="" /></p>
<ul>
<li>Good (one route, both lanes allowed):</li>
</ul>
<p><img src="./Images/bestProductionPractices/routing2.png" alt="" /></p>
<h3 id="plan-routes-and-intersection-areas-so-that-there-would-be-as-little-overlaps-as-possible"><a class="header" href="#plan-routes-and-intersection-areas-so-that-there-would-be-as-little-overlaps-as-possible">Plan routes and intersection areas so that there would be as little overlaps as possible</a></h3>
<ul>
<li>Try to minimize the routes marked red when hovering over route that can be tuned;</li>
<li>If pivot point is not really needed then a tight curve is better option:</li>
<li>Positioning on the route is more precise;</li>
<li>Wheels (with omni AGV) do not turn on spot.</li>
<li>With Omni-AGVs utilize possibility to have frame heading different than route heading:</li>
</ul>
<p>AGV Driving along green arrow blocks oncoming traffic (red arrow):</p>
<p><img src="./Images/bestProductionPractices/routing3.png" alt="" /></p>
<p>Using frame heading to turn AGVs frame towards 'North' in the pictures makes lane on left possible for parallel driving:</p>
<p><img src="./Images/bestProductionPractices/routing4.png" alt="" /></p>
<p><img src="./Images/bestProductionPractices/routing5.png" alt="" /></p>
<h3 id="create-as-clean-intersection-areas-as-possible"><a class="header" href="#create-as-clean-intersection-areas-as-possible">Create as clean intersection areas as possible</a></h3>
<ul>
<li>Least amount of intersection route-nodes possible;</li>
<li>Least amount of route links possible;</li>
<li>&quot;Spider-web&quot; intersections:</li>
</ul>
<p>Bad:</p>
<p><img src="./Images/bestProductionPractices/routing6.png" alt="" /></p>
<ul>
<li>Too many route options between different stations -&gt; Unpredictable behavior;</li>
<li>Extra route options do not solve any routing related issues.</li>
</ul>
<p>Good:</p>
<p><img src="./Images/bestProductionPractices/routing7.png" alt="" /></p>
<ul>
<li>All destinations are reachable from every station and always same routes are used -&gt; Predictable behavior</li>
</ul>
<h3 id="using-nostop-symbolic-points-to-cut-drive-tasks"><a class="header" href="#using-nostop-symbolic-points-to-cut-drive-tasks">Using NoStop symbolic points to cut drive tasks</a></h3>
<ul>
<li>Add always to one-way streets;</li>
<li>Should not be placed too near intersections nor on two-way streets.</li>
</ul>
<p>NoStop points can be used to improve scheduling performance over intersections or long routes. NoStop points become active when scheduling rules has the flag <em>cutDriveToNextNoStop</em> (1 &lt;&lt; 5) or <em>cutDriveToNextNoStopAlways</em> (1 &lt;&lt; 6) enabled.</p>
<p>When either of these flags is enabled Navithor will schedule the drive only to the next NoStop location.
This means that other drives happening beyond the NoStop location are not affected by the schedule of the drive cut to a NoStop point.</p>
<p>This often means that especially long drives and traffic in intersection areas become smoother. An example is shown below.</p>
<blockquote>
<p>AGV3 does not need to care about AGV1's drive to the intersection as the drive is cut to the NoStop point 601.</p>
</blockquote>
<p><img src="./Images/bestProductionPractices/routing8.png" alt="" /></p>
<p>NoStop points should be always used only on one-way routes and they should not be placed in intersection areas.</p>
<p>Placing a NoStop point on a two-way route creates certain deadlock situations when two AGV's drive the route against each other but the scheduler does not care about this since the drive is cut to a NoStop location.</p>
<p>An example of a poorly placed NoStopping location is shown below. In this case AGV on the left is trying to drive to the area on the right and AGV on the right is driving to the area on the left.</p>
<p>The only way to drive between these two areas is through the two-way route.
As both drives are cut to a NoStop location in the middle, they will end up in a deadlock in the two-way street.</p>
<p>If there is no NoStop point on the two-way route section, the two AGVs are not allowed to drive on the two-way route section simultaneously.</p>
<p><img src="./Images/bestProductionPractices/routing9.png" alt="" /></p>
<blockquote>
<p>NoStop on two-way route leading to a deadlock</p>
</blockquote>
<p><img src="./Images/bestProductionPractices/routing10.png" alt="" /></p>
<blockquote>
<p>Without a NoStop a two-way route works better</p>
</blockquote>
<p>In intersection areas it is good to check that the NoStop point is set far enough from the intersection so that when an AGV arrives to the NoStop location it is not overlapping with the route points in the intersection.</p>
<p>Checking this is easiest in Tools when hovering on the route sections.</p>
<p>Below the left one has the NoStop point far enough (not covered by the red line) and the right one is too close and will let the AGV drive too close to the intersection without checking overlaps correctly.</p>
<p><img src="./Images/bestProductionPractices/routing11.png" alt="" /></p>
<p>In case there are overlapping sections in long one-way routes that are to be driven in different directions it makes sense to make NoStop locations before the overlapping area.</p>
<p>Without the NoStop points in case there is something delaying the AGV that is supposed to enter the overlapping area first the other AGV will need to wait still until the delayed AGV has driven past the overlapping area.</p>
<p>With the NoStop points set before the overlapping area whichever AGV first reaches the overlapping section will drive over it first.</p>
<p><img src="./Images/bestProductionPractices/routing12.png" alt="" /></p>
<h3 id="one-machine-zones"><a class="header" href="#one-machine-zones">One Machine Zones</a></h3>
<ul>
<li>When they should be used and when to avoid using them?</li>
</ul>
<p>One machine zones can be used to prevent causing deadlocks in some routes that the scheduler may not handle correctly. Whether or not it is required to use one machines zones in certain places depends entirely on the parameters that are set for the scheduler. Below are a few examples of where one machine zones could be used.</p>
<p><img src="./Images/bestProductionPractices/routing13.png" alt="" /></p>
<p>Dead end that is split into multiple intersections. AGV may be allowed to drive into the dead end to block another one without this one machine zone if for example <strong>Scheduler_LEAVE_WAYPOINTS_AHEAD_FREE_COUNT</strong> would be 1 or 2.</p>
<p><img src="./Images/bestProductionPractices/routing14.png" alt="" /></p>
<p>One machine zone is defined to prevent AGV to drive to block the intersection while there is an another AGV waiting inside or just outside of it. AGVs are only allowed to drive inside zone if their path inside the zone is free from collisions. Thus one machine zones can also be used to mark areas that should be left clear of traffic.</p>
<h3 id="splitting-segments"><a class="header" href="#splitting-segments">Splitting segments</a></h3>
<ul>
<li>Enable segment splitting from Tools:</li>
</ul>
<p><img src="./Images/bestProductionPractices/routing15.png" alt="" /></p>
<p>The length of the split segments (in meters) can be configured in the <em>defaultParams.xml</em> file located in the Navithor Tools executables directory:</p>
<p><em>&lt;SegmentSplitParams&gt;</em><br>
<em>&lt;MaxSegmentLength&gt;4&lt;/MaxSegmentLength&gt;</em><br>
<em>&lt;/SegmentSplitParams&gt;</em></p>
<p>Segment splitting makes the calculated segment overlaps more reliable in the sense that with split segments, we don't end up in a situation where a very long segment is overlapping with a segment tens of meters from it, because it is split into smaller parts.
Because of the way the segment overlaps are defined, two segments are considered overlapping if any of their points overlap (the AGV outlines when standing on the respective points overlap), very long segments overlap with all segments at the start and end point of the segment.
This means that if an AGV is driving down a long segment connected by intersections at both ends, both intersections would be considered overlapped until the AGV has reached the end and leaves the long segment.</p>
<p>When the option in the figure above is checked, segments will be automatically split when uploading / exporting the production area.</p>
<ul>
<li>Enable using overlaps from Server parameters:</li>
</ul>
<p><img src="./Images/bestProductionPractices/routing16.png" alt="" /></p>
<p>Set the <strong>TrafficController_UseMachineSegmentOverlap</strong> parameter to true in Settings-&gt;Configuration-&gt;Parameters in Navithor Client. This parameter enables using the calculated segment overlaps in the scheduling.</p>
<p>Navithor can also consider overlaps separately for machines that are carrying a resource and for machines that are empty. This option should be used, if machines are carrying resources that have bigger dimensions than the machine itself. Navithor calculates the overlaps based on the biggest resource dimensions on the system, so smaller resources than the biggest one might have slightly bigger overlaps than necessary.</p>
<ul>
<li>Resource based overlaps:</li>
</ul>
<p><img src="./Images/bestProductionPractices/routing17.png" alt="" /></p>
<h3 id="splitting-waypoints-with-fake-intersections"><a class="header" href="#splitting-waypoints-with-fake-intersections">Splitting waypoints with fake intersections</a></h3>
<p><img src="./Images/bestProductionPractices/routing18.png" alt="" /></p>
<p>If long routes overlap, but do not intersect, like in the figure to the left, the whole route segment will become one waypoint from the intersection to the end of the route.
This means that an AGV that is driving the outgoing segment will also reserve the whole intersection.
In order to avoid this, fake intersections can be drawn to split the long route waypoints.
In the figure to the right, there would be a separate waypoint where the fake intersection splits the route, hence the intersection will not be reserved after that point.</p>
<p>Fake intersections are created by:</p>
<ul>
<li>Creating intersections by drawing short routes that extend from the main route;</li>
<li>Define these routes as Disabled by checking the Disable Lane and clicking on both lanes. The routes should be grey when disabled.</li>
</ul>
<p><img src="./Images/bestProductionPractices/routing19.png" alt="" /></p>
<h2 id="planning-good-flow-for-production"><a class="header" href="#planning-good-flow-for-production">Planning good flow for production</a></h2>
<h3 id="define-production-layout-and-concept-before-integration"><a class="header" href="#define-production-layout-and-concept-before-integration">Define production layout and concept before integration</a></h3>
<ul>
<li>What has to be done and where? I.e. Picking up resources and bringing them somewhere, or is the production logic based on picking list or hold-release reasoning?</li>
<li>Define signals that should be used. What messages in MES cover this?</li>
<li>How the traffic should be handled? Is there any bottlenecks that might cause problems?</li>
<li>Is there any special conditions to consider, like doors or traffic lights that have to be monitored or controlled along the routes?</li>
<li>Where should the machines be waiting, when they have nothing else to do? Where should the chargers be located?</li>
<li>Plan enough waiting and charge locations to support the whole fleet!</li>
<li>Wait-symbolic points should be on one-way streets or dead ends if possible. If on two-way streets or intersections, machine would block others.</li>
</ul>
<h3 id="how-to-use-allowed-destinations"><a class="header" href="#how-to-use-allowed-destinations">How to use allowed destinations</a></h3>
<ul>
<li>Limit driving from wait locations to unwanted destinations;</li>
<li>Resource types can be also used to limit.</li>
</ul>
<p>Parameter: <strong>MissionManager_WAITINGLOC_ALLOWED_DEST_LINK_MODE</strong></p>
<ul>
<li>
<p><strong>Option: LinkToLoadingTarget</strong></p>
<ul>
<li>WaitLoad locations can be linked to allowed Load locations;</li>
<li>If AGV has been assigned to a WaitLoad location and it is waiting for production, it can be assigned and order only from Load locations that are on the Allowed destinations list for the assigned WaitLoad. The normal rules for order to be valid are still checked in addition to this;</li>
<li>The normal rules for order to be valid are still checked in addition to this;</li>
<li>If no Allowed destinations have been defined, the possible Load location are not restricted;</li>
<li>If AGV has not been yet assigned to a Wait location, no restriction is set. Maximum distance to a valid order can be set with If no Allowed destinations have been defined, the possible Load location are not restricted <strong>ProductionManager_MaxDistToAllowLoadingIfNotAtWait</strong> (meters through segments);</li>
<li>A generic parameter to restrict maximum distance from WaitLoad to Load locations: <strong>MissionManager_MAX_WAIT_DIST_FROM_TARGET_BOUND</strong> (meters through segments, default 200).</li>
</ul>
</li>
<li>
<p><strong>Option: LinkToUnloadingTarget</strong></p>
<ul>
<li>WaitUnload locations can be linked to possible Unload locations;</li>
<li>If AGV has active production order into Unload location that is currently reserved or blocked, AGV is allowed to drive instead into WaitUnload that has the target location as allowed destination;</li>
<li>Depending on parameters, assigning production order can be allowed to a target that is currently reserved or blocked, if there is an available and valid WaitUnload location. It can be also defined that this is not allowed;</li>
<li><strong>TrafficControl_WAIT_LOCATION_ALLOWED_DIST_OFFSET</strong> (meters through segments, default 0) defines minimum distance needed between (un)load location and wait location to allow driving to the wait instead of target. Negative values means AGV can drive to wait location that is further away than the target location;</li>
<li>A generic parameter to restrict maximum distance from WaitUnload to Unload locations: <strong>MissionManager_MAX_WAIT_DIST_FROM_TARGET_BOUND</strong> (meters through segments, default 200).</li>
</ul>
</li>
<li>
<p><strong>Option: LinkUnloadToWaitLoad</strong></p>
<ul>
<li>Unload locations can be linked to allowed WaitLoad locations. If previous target of AGV was unload location and it has allowed destinations defined, allow driving only to these wait locations;</li>
<li>If no wait locations available, stays on this symbolic point and waits for production;</li>
<li>If unhandled order becomes available within distance defined by <strong>ProductionManager_MaxDistToAllowLoadingIfNotAtWait</strong> (meters through segments), order can be assigned to the AGV;</li>
<li>If AGV is driven away from symbolic point, allowed destinations don't restrict it anymore and it can select a wait location within distance defined by <strong>ProductionManager_MaxDistToValidLocations</strong> (meters through segments);</li>
<li>If no WaiLoad locations selected in allowed destinations for the unload location, next WaitLoad location is selected with normal rules (can be limited with <strong>ProductionManager_MaxDistToValidLocations</strong> (meters through segments).</li>
</ul>
</li>
<li>
<p><strong>Option: LinkWaitToWait</strong></p>
<ul>
<li>Other wait locations can be linked wait locations.</li>
<li>If change wait is enabled by <strong>MissionManager_ChangeWaitTriggerRules</strong> and the location has allowed destinations, then the allowed destinations define which wait locations are possible from that location.</li>
</ul>
<p><img src="./Images/bestProductionPractices/routing20.png" alt="" /></p>
</li>
</ul>
<p><strong>Summary of allowed destination options:</strong></p>
<ul>
<li>Link Load location to allowed Unload locations;</li>
<li>Link WaitLoad location to allowed Load locations;</li>
<li>Link WaitUnload location to allowed Unload locations;</li>
<li>Link Unload location to allowed WaitLoad locations.</li>
<li>Link Wait locations to any Wait locations</li>
</ul>
<p>Does not work on stop or no-stop locations!</p>
<p>Can't be used to &quot;link&quot; any other symbolic points to stopping points, stopping points to other points or several stopping points into each other.</p>
<h3 id="route-rules"><a class="header" href="#route-rules">Route rules</a></h3>
<ul>
<li>Limit driving certain routes on special situations;</li>
</ul>
<p>Route rules can be used to make sure that the AGVs do not drive in unwanted route sections unless it is allowed by rules. There are 5 different possible route rules:</p>
<ul>
<li>No resource onboard;</li>
<li>Resource on board;</li>
<li>Fire alarm active;</li>
<li>Drive only when target within segments;</li>
<li>Fire alarm inactive.</li>
</ul>
<p>The first two resource rules are mutually exclusive. This means that if both rules are set on a route section this route can never be driven.
The same applies also for the two fire alarm rules.
However, drive only when target within segments rule can be set on a route that already has another rule defined on it.</p>
<p>Drive only when target within segments rule can be used to block driving through a route section.
This means that an AGV can enter a section marked with this rule only if the end target of the mission is within the section.
For example, in the picture below the highlighted section cannot be driven through even if the route is shorter than the alternative.</p>
<p><img src="./Images/bestProductionPractices/routing21.png" alt="" /></p>
<p>The resource rules are used to allow driving on specific route sections only when the AGV is either empty or carrying an item.
This is useful when the item the AGV moves is larger than the AGV.
In such cases it is often necessary to maneuver the AGV differently based on the load status or allow certain route sections only when AGV is empty.
In the example below the AGV carries item's that are multiple meters longer than the AGV body.
When the AGV is empty it can drive a simple turn to the main aisle but when it is carrying the long item it needs to drive slower and turn closer to the corner as it would not fit otherwise.</p>
<p><img src="./Images/bestProductionPractices/routing22.png" alt="" /></p>
<p><img src="./Images/bestProductionPractices/routing23.png" alt="" /></p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="webClient.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                            <a rel="next" href="Navithor logs.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="webClient.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                    <a rel="next" href="Navithor logs.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>

        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
    </body>
</html>
