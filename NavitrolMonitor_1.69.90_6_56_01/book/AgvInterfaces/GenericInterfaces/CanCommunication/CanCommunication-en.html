<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>CAN communication - NAVITROL USER INSTRUCTIONS - Navitec Systems Oy CONFIDENTIAL</title>
                

        <!-- Custom HTML head -->
        

        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

                <link rel="icon" href="../../../favicon.svg">
                        <link rel="shortcut icon" href="../../../favicon.png">
                <link rel="stylesheet" href="../../../css/variables.css">
        <link rel="stylesheet" href="../../../css/general.css">
        <link rel="stylesheet" href="../../../css/chrome.css">
                <link rel="stylesheet" href="../../../css/print.css" media="print">
        
        <!-- Fonts -->
        <link rel="stylesheet" href="../../../FontAwesome/css/font-awesome.css">
                <link rel="stylesheet" href="../../../fonts/fonts.css">
        
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../../../highlight.css">
        <link rel="stylesheet" href="../../../tomorrow-night.css">
        <link rel="stylesheet" href="../../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        
                <!-- MathJax -->
        <script async type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
            </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../../../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="../../../MdBook/MdbookFrontPage.html">Front page</a></li><li class="chapter-item expanded affix "><li class="part-title">Introduction</li><li class="chapter-item expanded "><a href="../../../Introduction/NavitrolUserInstructions/NavitrolUserInstructions-en.html"><strong aria-hidden="true">1.</strong> Navitrol user instructions</a></li><li class="chapter-item expanded "><a href="../../../Introduction/Licensing/Licensing-en.html"><strong aria-hidden="true">2.</strong> Licensing</a></li><li class="chapter-item expanded "><a href="../../../Introduction/OdometrySource/OdometrySource-en.html"><strong aria-hidden="true">3.</strong> Odometry source</a></li><li class="chapter-item expanded "><a href="../../../Introduction/InitialCalibrationGuide/InitialCalibrationGuide-en.html"><strong aria-hidden="true">4.</strong> Initial calibration guide</a></li><li class="chapter-item expanded "><a href="../../../Miscellaneous/ParameterReconfiguration/ParameterReconfiguration-en.html"><strong aria-hidden="true">5.</strong> Parameter reconfiguration</a></li><li class="chapter-item expanded "><a href="../../../Introduction/Parameters/Parameters.html"><strong aria-hidden="true">6.</strong> Parameter listing</a></li><li class="chapter-item expanded "><a href="../../../Introduction/Parameters/JsonConfigurationFile-en.html"><strong aria-hidden="true">7.</strong> JSON configuration file</a></li><li class="chapter-item expanded "><a href="../../../Introduction/TeachingInstructions/TeachingInstructions-en.html"><strong aria-hidden="true">8.</strong> Teaching instructions</a></li><li class="chapter-item expanded "><a href="../../../Introduction/FeatureMatrix/FeatureMatrix-en.html"><strong aria-hidden="true">9.</strong> Feature Matrix</a></li><li class="chapter-item expanded affix "><li class="part-title">Device interfaces</li><li class="chapter-item expanded "><a href="../../../AgvInterfaces/SupportedDevices/SupportedDevices-en.html"><strong aria-hidden="true">10.</strong> Supported devices</a></li><li class="chapter-item expanded "><a href="../../../AgvInterfaces/GenericInterfaces/GenericInterfacesHeading.html"><strong aria-hidden="true">11.</strong> Generic interfaces</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../AgvInterfaces/GenericInterfaces/EthernetSupervisorInterface/EthernetSupervisorInterface-en.html"><strong aria-hidden="true">11.1.</strong> Ethernet Supervisor</a></li><li class="chapter-item expanded "><a href="../../../AgvInterfaces/GenericInterfaces/CanCommunication/CanCommunication-en.html" class="active"><strong aria-hidden="true">11.2.</strong> CAN communication</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../AgvInterfaces/GenericInterfaces/CanSupervisorInterface/CanSupervisorInterface-en.html"><strong aria-hidden="true">11.2.1.</strong> CAN Supervisor</a></li></ol></li><li class="chapter-item expanded "><a href="../../../AgvInterfaces/GenericInterfaces/EthercatCommunication/EthercatCommunication-en.html"><strong aria-hidden="true">11.3.</strong> EtherCAT Communication</a></li><li class="chapter-item expanded "><a href="../../../AgvInterfaces/GenericInterfaces/Simove/SimoveInterface-en.html"><strong aria-hidden="true">11.4.</strong> SIMOVE</a></li></ol></li><li class="chapter-item expanded "><a href="../../../AgvInterfaces/MotorControllers/MotorControllersHeading.html"><strong aria-hidden="true">12.</strong> Motor controllers</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../AgvInterfaces/MotorControllers/MotorControllersCommon/MotorControllersCommon-en.html"><strong aria-hidden="true">12.1.</strong> Motor controller common</a></li><li class="chapter-item expanded "><a href="../../../AgvInterfaces/MotorControllers/Schwarzmueller/SchwarzmuellerSetupInstructions/SchwarzmuellerSetupInstructions-en.html"><strong aria-hidden="true">12.2.</strong> Schwarzmueller setup</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../AgvInterfaces/MotorControllers/Schwarzmueller/SchwarzmuellerParameterSetupInstructions/SchwarzmuellerParameterSetupInstructions-en.html"><strong aria-hidden="true">12.2.1.</strong> Schwarzmueller parameters</a></li><li class="chapter-item expanded "><a href="../../../AgvInterfaces/MotorControllers/Schwarzmueller/SchwarzmuellerTroubleshooting/SchwarzmuellerTroubleshooting-en.html"><strong aria-hidden="true">12.2.2.</strong> Schwarzmueller troubleshooting</a></li></ol></li><li class="chapter-item expanded "><a href="../../../AgvInterfaces/MotorControllers/Curtis/CurtisMotorController-en.html"><strong aria-hidden="true">12.3.</strong> Curtis</a></li><li class="chapter-item expanded "><a href="../../../AgvInterfaces/MotorControllers/Engel/EngelMotorController-en.html"><strong aria-hidden="true">12.4.</strong> Engel</a></li><li class="chapter-item expanded "><a href="../../../AgvInterfaces/MotorControllers/Kinco/KincoMotorController-en.html"><strong aria-hidden="true">12.5.</strong> Kinco</a></li><li class="chapter-item expanded "><a href="../../../AgvInterfaces/MotorControllers/Nanotec/NanotecMotorController-en.html"><strong aria-hidden="true">12.6.</strong> Nanotec</a></li><li class="chapter-item expanded "><a href="../../../AgvInterfaces/MotorControllers/Oriental/OrientalMotorController-en.html"><strong aria-hidden="true">12.7.</strong> Oriental</a></li><li class="chapter-item expanded "><a href="../../../AgvInterfaces/MotorControllers/Synapticon/SynapticonMotorController-en.html"><strong aria-hidden="true">12.8.</strong> Synapticon</a></li><li class="chapter-item expanded "><a href="../../../AgvInterfaces/MotorControllers/Roboteq/RoboteqOpenLoopControllerConfiguration-en.html"><strong aria-hidden="true">12.9.</strong> Roboteq Open loop</a></li><li class="chapter-item expanded "><a href="../../../AgvInterfaces/MotorControllers/Roboteq/RoboteqClosedLoopControllerConfiguration-en.html"><strong aria-hidden="true">12.10.</strong> Roboteq Closed loop</a></li><li class="chapter-item expanded "><a href="../../../AgvInterfaces/MotorControllers/MiControl/MiControlMotorController-en.html"><strong aria-hidden="true">12.11.</strong> MiControl</a></li></ol></li><li class="chapter-item expanded "><a href="../../../AgvInterfaces/ScannerConfigurations/ScannerHeading.html"><strong aria-hidden="true">13.</strong> Laser scanners</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../AgvInterfaces/ScannerConfigurations/ScannerConfigurations-en.html"><strong aria-hidden="true">13.1.</strong> Scanner configurations</a></li><li class="chapter-item expanded "><a href="../../../AgvInterfaces/ScannerCommunicationTroubleshoot/ScannerCommunicationTroubleshoot-en.html"><strong aria-hidden="true">13.2.</strong> Scanner communication troubleshooting</a></li></ol></li><li class="chapter-item expanded "><a href="../../../AgvInterfaces/OpticalCodeReader/OpticalCodeReader.html"><strong aria-hidden="true">14.</strong> Optical code reader</a></li><li class="chapter-item expanded "><a href="../../../AgvInterfaces/Encoders/EncoderHeading.html"><strong aria-hidden="true">15.</strong> Encoders</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../AgvInterfaces/Encoders/EthercatEncoders/EthercatEncoders-en.html"><strong aria-hidden="true">15.1.</strong> EtherCAT encoders</a></li></ol></li><li class="chapter-item expanded "><li class="part-title">User interfaces</li><li class="chapter-item expanded "><a href="../../../CustomerUis/NavitrolMonitor/NavitrolMonitor-en.html"><strong aria-hidden="true">16.</strong> Navitrol Monitor</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../CustomerUis/NavitrolMonitor3rdPartyLicenses/NavitrolMonitor3rdPartyLicenses-en.html"><strong aria-hidden="true">16.1.</strong> Navitrol Monitor third party licenses</a></li></ol></li><li class="chapter-item expanded "><a href="../../../CustomerUis/WebInterface/WebInterface-en.html"><strong aria-hidden="true">17.</strong> Navitrol web interface</a></li><li class="chapter-item expanded "><a href="../../../CustomerUis/Parameter Tool/ParameterTool-en.html"><strong aria-hidden="true">18.</strong> Parameter Tool Beta</a></li><li class="chapter-item expanded affix "><li class="part-title">Localization</li><li class="chapter-item expanded "><a href="../../../Localization/PositionConfidence/PositionConfidence-en.html"><strong aria-hidden="true">19.</strong> Position confidence</a></li><li class="chapter-item expanded "><a href="../../../Localization/ScannerCalibration/ScannerCalibration-en.html"><strong aria-hidden="true">20.</strong> Scanner calibration</a></li><li class="chapter-item expanded "><a href="../../../Localization/EnvironmentGuidelines/EnvironmentGuidelines-en.html"><strong aria-hidden="true">21.</strong> Environment guidelines</a></li><li class="chapter-item expanded "><a href="../../../Localization/AutomaticOdometryCorrection/AutomaticOdometryCorrection-en.html"><strong aria-hidden="true">22.</strong> Automatic odometry correction</a></li><li class="chapter-item expanded "><a href="../../../Localization/ReflectorBasedPositionInitialization/ReflectorBasedPositionInitialization-en.html"><strong aria-hidden="true">23.</strong> Reflector based position initialization</a></li><li class="chapter-item expanded "><a href="../../../Localization/PrecisionPositioning/PrecisionPositioning-en.html"><strong aria-hidden="true">24.</strong> Precision positioning</a></li><li class="chapter-item expanded "><a href="../../../Localization/LocalizationScannerChangeOnTheFly/LocalizationScannerChangeOnTheFly-en.html"><strong aria-hidden="true">25.</strong> Changing scanner on the fly</a></li><li class="chapter-item expanded "><a href="../../../Localization/RampZones/RampZones-en.html"><strong aria-hidden="true">26.</strong> Ramp zones</a></li><li class="chapter-item expanded "><a href="../../../Localization/GpsPositioning/GpsPositioning-en.html"><strong aria-hidden="true">27.</strong> GPS Positioning</a></li><li class="chapter-item expanded "><a href="../../../Localization/ImuAndSensorFusion/ImuAndSensorFusion-en.html"><strong aria-hidden="true">28.</strong> IMU and sensor fusion</a></li><li class="chapter-item expanded "><a href="../../../Localization/ExternalLocalization/ExternalLocalization-en.html"><strong aria-hidden="true">29.</strong> External localization</a></li><li class="chapter-item expanded "><a href="../../../Localization/DynamicMapping/DynamicMappingServer/DynamicMappingServer-en.html"><strong aria-hidden="true">30.</strong> Dynamic mapping server</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../Localization/DynamicMapping/DynamicMappingServerAndClientCompatibility/DynamicMappingServerAndClientCompatibility-en.html"><strong aria-hidden="true">30.1.</strong> Dynamic mapping client/server compatibility</a></li><li class="chapter-item expanded "><a href="../../../Localization/DynamicMapping/DynamicMappingServerHardwareRequirements/DynamicMappingServerHardwareRequirements.html"><strong aria-hidden="true">30.2.</strong> Dynamic mapping client/server hardware requirements</a></li></ol></li><li class="chapter-item expanded "><a href="../../../Localization/WheelSlipping/WheelSlipping-en.html"><strong aria-hidden="true">31.</strong> Wheel slipping diagnostic</a></li><li class="chapter-item expanded "><a href="../../../Localization/3dPositioning/3dPositioning-en.html"><strong aria-hidden="true">32.</strong> 3D positioning</a></li><li class="chapter-item expanded affix "><li class="part-title">Position control</li><li class="chapter-item expanded "><a href="../../../PositionControl/StartOffsetSlowdown/StartOffsetSlowdown-en.html"><strong aria-hidden="true">33.</strong> Start offset slowdown</a></li><li class="chapter-item expanded "><a href="../../../PositionControl/CoupledDriving/CoupledDrivingFeature-en.html"><strong aria-hidden="true">34.</strong> Coupled driving</a></li><li class="chapter-item expanded "><a href="../../../PositionControl/MagneticLineFollowing/MagneticLineFollowing-en.html"><strong aria-hidden="true">35.</strong> Magnetic line following</a></li><li class="chapter-item expanded "><a href="../../../PositionControl/TrailerTransport/TrailerTransport-en.html"><strong aria-hidden="true">36.</strong> Trailer transport</a></li><li class="chapter-item expanded "><a href="../../../PositionControl/BarrierStop/BarrierStop-en.html"><strong aria-hidden="true">37.</strong> Barrier stop</a></li><li class="chapter-item expanded "><a href="../../../PositionControl/DataMatrixDocking/DataMatrixDockingDMC-en.html"><strong aria-hidden="true">38.</strong> Data Matrix Code Docking V2</a></li><li class="chapter-item expanded "><a href="../../../PositionControl/Docking/Docking-en.html"><strong aria-hidden="true">39.</strong> Docking</a></li><li class="chapter-item expanded affix "><li class="part-title">Drive control</li><li class="chapter-item expanded "><a href="../../../DriveControl/DrivingOptions/DrivingOptions-en.html"><strong aria-hidden="true">40.</strong> Driving options</a></li><li class="chapter-item expanded "><a href="../../../DriveControl/Standalone/Standalone-en.html"><strong aria-hidden="true">41.</strong> Standalone</a></li><li class="chapter-item expanded "><a href="../../../DriveControl/StopAndHold/StopAndHold-en.html"><strong aria-hidden="true">42.</strong> Stop-and-hold</a></li><li class="chapter-item expanded "><a href="../../../DriveControl/VDA5050/VDA5050-en.html"><strong aria-hidden="true">43.</strong> VDA 5050</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../DriveControl/VDA5050/VDA5050FeatureMatrix-en.html"><strong aria-hidden="true">43.1.</strong> VDA 5050 Support status</a></li></ol></li><li class="chapter-item expanded "><a href="../../../DriveControl/ReturnToRoute/ReturnToRoute-en.html"><strong aria-hidden="true">44.</strong> Return to route</a></li><li class="chapter-item expanded "><a href="../../../DriveControl/ObstacleAvoidance/ObstacleAvoidance-en.html"><strong aria-hidden="true">45.</strong> Obstacle avoidance</a></li><li class="chapter-item expanded "><a href="../../../DriveControl/ObstacleAvoidanceV2/ObstacleAvoidanceV2-en.html"><strong aria-hidden="true">46.</strong> Obstacle avoidance V2</a></li><li class="chapter-item expanded "><a href="../../../DriveControl/ContainerDriving/ContainerDriving-en.html"><strong aria-hidden="true">47.</strong> Container driving</a></li><li class="chapter-item expanded "><a href="../../../DriveControl/RecordAndPlay/RecordAndPlay-en.html"><strong aria-hidden="true">48.</strong> Record and Play</a></li><li class="chapter-item expanded "><a href="../../../DriveControl/RouteFreeNavigation/RouteFreeNavigation-en.html"><strong aria-hidden="true">49.</strong> Route free navigation</a></li><li class="chapter-item expanded affix "><li class="part-title">Kinematics</li><li class="chapter-item expanded "><a href="../../../Kinematics/OmniSteerLimit/OmniSteerLimit-en.html"><strong aria-hidden="true">50.</strong> Omni steer limit</a></li><li class="chapter-item expanded "><a href="../../../Kinematics/OneDriveWheelOmni/OneDriveWheelOmni-en.html"><strong aria-hidden="true">51.</strong> Omni one drive wheel</a></li><li class="chapter-item expanded affix "><li class="part-title">Pickup and drop-off</li><li class="chapter-item expanded "><a href="../../../LoadHandling/ActuatorControl/ActuatorControl-en.html"><strong aria-hidden="true">52.</strong> Actuator control</a></li><li class="chapter-item expanded "><a href="../../../LoadHandling/ScannerLiftActuator/ScannerLiftActuator-en.html"><strong aria-hidden="true">53.</strong> Scanner lift actuator</a></li><li class="chapter-item expanded "><a href="../../../LoadHandling/Racking/Racking-en.html"><strong aria-hidden="true">54.</strong> Racking</a></li><li class="chapter-item expanded "><a href="../../../LoadHandling/BufferLanes/BufferLanes-en.html"><strong aria-hidden="true">55.</strong> Buffer lanes</a></li><li class="chapter-item expanded "><a href="../../../LoadHandling/StackLoading/StackLoading-en.html"><strong aria-hidden="true">56.</strong> Loading from a stack</a></li><li class="chapter-item expanded "><a href="../../../LoadHandling/BlockStacking/BlockStacking-en.html"><strong aria-hidden="true">57.</strong> Unloading to a stack</a></li><li class="chapter-item expanded "><a href="../../../LoadHandling/DistanceToTarget/DistanceToTarget-en.html"><strong aria-hidden="true">58.</strong> Distance to target estimation</a></li><li class="chapter-item expanded affix "><li class="part-title">Target and obstacle detection</li><li class="chapter-item expanded "><a href="../../../TargetAndObstacleDetection/PalletDetection/PalletDetection-en.html"><strong aria-hidden="true">59.</strong> Pallet detection</a></li><li class="chapter-item expanded "><a href="../../../TargetAndObstacleDetection/3dTargetDetection/3dTargetDetection-en.html"><strong aria-hidden="true">60.</strong> 3D Target detection</a></li><li class="chapter-item expanded "><a href="../../../TargetAndObstacleDetection/PatternDetection/PatternDetection-en.html"><strong aria-hidden="true">61.</strong> Pattern detection</a></li><li class="chapter-item expanded "><a href="../../../TargetAndObstacleDetection/ObstacleDetection/ObstacleDetection-en.html"><strong aria-hidden="true">62.</strong> Obstacle detection</a></li><li class="chapter-item expanded "><a href="../../../TargetAndObstacleDetection/ExternalTargetDetection/ExternalTargetDetection-en.html"><strong aria-hidden="true">63.</strong> External target detection</a></li><li class="chapter-item expanded "><a href="../../../TargetAndObstacleDetection/TableDetection/TableDetection-en.html"><strong aria-hidden="true">64.</strong> Table detection</a></li><li class="chapter-item expanded "><a href="../../../TargetAndObstacleDetection/Wallmonitoring/Wallmonitoring-en.html"><strong aria-hidden="true">65.</strong> Wall monitoring</a></li><li class="chapter-item expanded "><a href="../../../TargetAndObstacleDetection/OccupancyCheck/OccupancyCheck-en.html"><strong aria-hidden="true">66.</strong> Occupancy check</a></li><li class="chapter-item expanded affix "><li class="part-title">Miscellaneous</li><li class="chapter-item expanded "><a href="../../../Miscellaneous/ErrorDescriptions/ErrorDescriptions-en.html"><strong aria-hidden="true">67.</strong> Error descriptions</a></li><li class="chapter-item expanded "><a href="../../../Miscellaneous/Logging/Logging-en.html"><strong aria-hidden="true">68.</strong> Logging</a></li><li class="chapter-item expanded "><a href="../../../Miscellaneous/LinuxImageInstallation/LinuxImagesHeading.html"><strong aria-hidden="true">69.</strong> Linux image installation</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../Miscellaneous/LinuxImageInstallation/CanDrivers/CanDrivers-en.html"><strong aria-hidden="true">69.1.</strong> CAN drivers</a></li><li class="chapter-item expanded "><a href="../../../Miscellaneous/LinuxImageInstallation/Clonezilla/ClonezillaInstallation-en.html"><strong aria-hidden="true">69.2.</strong> Clonezilla</a></li><li class="chapter-item expanded "><a href="../../../Miscellaneous/LinuxImageInstallation/DebianBuster/DebianBusterInstallation-en.html"><strong aria-hidden="true">69.3.</strong> Debian Buster</a></li><li class="chapter-item expanded "><a href="../../../Miscellaneous/LinuxImageInstallation/DebianBullseye/DebianBullseyeInstallation-en.html"><strong aria-hidden="true">69.4.</strong> Debian Bullseye</a></li></ol></li><li class="chapter-item expanded "><a href="../../../Miscellaneous/ParameterZones/ParameterZones-en.html"><strong aria-hidden="true">70.</strong> Parameter zones</a></li><li class="chapter-item expanded "><a href="../../../Miscellaneous/Reflectors/Reflectors-en.html"><strong aria-hidden="true">71.</strong> Reflectors</a></li><li class="chapter-item expanded "><a href="../../../Miscellaneous/SslCertificates/SslCertificates-en.html"><strong aria-hidden="true">72.</strong> SSL Certificate configuration</a></li><li class="chapter-item expanded "><a href="../../../Miscellaneous/BatteryOvertemperatureActions/BatteryOvertemperatureActions.html"><strong aria-hidden="true">73.</strong> Battery overtemperature actions</a></li><li class="chapter-item expanded "><a href="../../../Miscellaneous/Charging/Charging-en.html"><strong aria-hidden="true">74.</strong> Charging and battery management</a></li><li class="chapter-item expanded "><a href="../../../Miscellaneous/HardwareRequirements/HardwareRequirements-en.html"><strong aria-hidden="true">75.</strong> Hardware requirements</a></li></ol>            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="dark">Dark</button></li>
                        </ul>
                                                <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                                            </div>

                    <h1 class="menu-title">NAVITROL USER INSTRUCTIONS - Navitec Systems Oy CONFIDENTIAL</h1>

                    <div class="right-buttons">
                                                <a href="../../../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                                                                        
                    </div>
                </div>

                                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="can-communication"><a class="header" href="#can-communication">CAN Communication</a></h1>
<p>Updated 29.07.2024</p>
<hr />
<h2 id="overview"><a class="header" href="#overview">Overview</a></h2>
<h3 id="introduction"><a class="header" href="#introduction">Introduction</a></h3>
<h4 id="can"><a class="header" href="#can">CAN</a></h4>
<p>Controller Area Network (CAN) is a robust bus standard designed to enable microcontrollers and devices to communicate with each other without a host computer. It is widely used in automotive and industrial applications due to its ability to provide reliable communication over a simple two-wire bus. CAN ensures data integrity with error detection and retransmission mechanisms, making it ideal for real-time control systems.</p>
<h4 id="canopen"><a class="header" href="#canopen">CANopen</a></h4>
<p>CANopen is a high-level communication protocol and device profile specification that is based on the CAN protocol. The CANopen umbrella covers a network programming framework, device descriptions, interface definitions and application profiles. CANopen provides a protocol which standardizes communication between devices and applications from different manufacturers. It has been used in a wide range of industries, with highlights in automation and motion applications.</p>
<h4 id="can-bus-topology"><a class="header" href="#can-bus-topology">CAN bus topology</a></h4>
<p>CAN communication takes place over two differential lines CAN_L and CAN_H. Topology of the CAN bus is a bus having two ends. Star-shaped or ring-shaped wiring topologies do not work. Two termination resistors (nominally 120 ohm) need to be connected to the bus ends. Measured impedance between CAN_L and CAN_H should then be around 60 ohm. This measurement should be done with the devices powered off.</p>
<p>Some CAN devices have optional CAN bus termination built in. Such a termination can be enabled via a physical switch and sometimes even electronically - follow the manufacturer's instructions for enabling/disabling these terminations. When using such terminations, select devices connected closest to the end of the bus. Navitrol IPC (when using Peak/Kvaser CAN card) does not have any bus termination.</p>
<p><img src="./media-en/image1.png" alt="" /></p>
<p>CAN nodes are connected to bus using T-connector and a short stub or a pass-through connection. Maximum stub length depends on the speed of the communication. Stub lengths being too long result in problems in physical signaling. In addition to active nodes, it is recommended to add one extra connection point to CAN bus -- to be used for CAN analyzer.</p>
<h4 id="can-bus-connection---details"><a class="header" href="#can-bus-connection---details">CAN bus connection - details</a></h4>
<p>Navitrol IPC equipped with a CAN card uses &quot;standard&quot; kind of 9 pin D connector for connecting to CAN bus. Physically CAN is a two-wire differential signal, those two wires being</p>
<ul>
<li>
<p>CAN_L -- Pin #2 in D9 connector</p>
</li>
<li>
<p>CAN_H -- Pin #7 in D9 connector</p>
</li>
<li>
<p><em>GND -- Pin #3 in D9 connector</em></p>
</li>
<li>
<p><em>Note: Other pins -- there is NO true &quot;de-facto&quot; standard -- always check what is the case!</em></p>
</li>
</ul>
<p><img src="./media-en/image2.png" alt="" /></p>
<p><img src="./media-en/image3.png" alt="" /></p>
<blockquote>
<p>Figure 1: Peak D9 pin configuration on the left, Kvaser on the right.</p>
</blockquote>
<p>In many cases connecting two wires (CAN_L/CAN_H) is enough as long as proper type of cable is used. CAN cable should always be a shielded twisted pair cable. In order to improve noise immunity, the shield (in single shielded cable) should be connected to CAN GND in each CAN node and then finally to common ground at one single location.</p>
<p>In Navitrol IPC CAN connection (Peak/Kvaser) CAN_GND is PIN #3 in D9 connector. This is typically regarded as a standard pin for CAN_GND, but it should be noted that it may not be connected at all or may be connected for other purposes in some CAN devices. So, if in doubt, then do not connect.</p>
<p>In extremely noisy conditions -- even double shielded cable can be used.
In such a case inner shield should be connected to CAN_GND as explained before and outer shield again connected to ground at one location.</p>
<p>In many CAN interfaces PIN #5 is used for connecting the outer Shield.
In real life this is even less common than CAN_GND being connected to pin #3. For example in case of Peak pin #5 is not connected. So, be sure before connecting to any CAN node.</p>
<p>In addition to data, ground and shield, CAN connectors may have
connection for power supply out (master) or power supply in (slave).
Navitrol IPC CAN connector does not have supply power capability.</p>
<h3 id="requirements"><a class="header" href="#requirements">Requirements</a></h3>
<ul>
<li>CAN-card with <a href="../../../Miscellaneous/LinuxImageInstallation/CanDrivers/CanDrivers-en.html#socketcan">SocketCAN support</a>. Most common ones used are Kvaser and Peak CAN-cards.</li>
<li>Bitrate for each CAN device on the bus must be the same</li>
<li>CANopen node ID values must be between 1 and 127. In addition, all node IDs must be unique</li>
</ul>
<h3 id="dependencies"><a class="header" href="#dependencies">Dependencies</a></h3>
<ul>
<li><a href="../../../Miscellaneous/HardwareRequirements/HardwareRequirements-en.html">Hardware Requirements</a></li>
<li><a href="../../../Miscellaneous/LinuxImageInstallation/CanDrivers/CanDrivers-en.html">Linux Image Can Drivers</a></li>
</ul>
<h2 id="setup"><a class="header" href="#setup">Setup</a></h2>
<h3 id="quick-start"><a class="header" href="#quick-start">Quick Start</a></h3>
<ul>
<li>Connect CAN bus to the IPC and to other CAN-devices on the same bus. Verify that your <a href="#can-bus-topology">CAN-bus topology</a> is setup correctly</li>
<li>Configure unique node ID for each CANopen device (between 1 and 127)</li>
<li>Set the same bitrate for each CAN-device connected to same bus</li>
<li>Choose the NMT-master and sync-producer of the system. Most often Navitrol</li>
<li>Configure other CAN-devices on the bus</li>
<li>Configure Navitrol CAN interface <a href="#parameters">parameters</a></li>
<li>Start Navitrol. If there are errors in the system, see <a href="#troubleshooting">Troubleshooting</a> section</li>
</ul>
<h3 id="parameters"><a class="header" href="#parameters">Parameters</a></h3>
<!-- The description in the parameter table should work as the starting point for anyone trying to find information about it. If it has been explained in some figures or somewhere else the reader should be pointed there by the description. -->
<table><thead><tr><th>Name</th><th>Type</th><th>Default Value</th><th>Description</th></tr></thead><tbody>
<tr><td>can_enabled</td><td>Int</td><td>1</td><td>Enables CAN communication. <strong>NOTE:</strong> If odometry source is CAN, then CAN is always enabled and this parameter is ignored. For more information on odometry source, see <a href="../../../Introduction/OdometrySource/OdometrySource-en.html">Odometry Source</a></td></tr>
<tr><td>navigation_software_node_id</td><td>Int</td><td>0</td><td>Navitrol IPC CANopen node ID. Mandatory for several machine types as well as for certain functions (like heartbeat) <br> 0 = not defined, 1-127 = valid node ID</td></tr>
<tr><td>can_ch</td><td>Int</td><td>0</td><td>Primary CAN channel number. Assumes device names like can0, can1,... <br> 0 and 1 are the most common channel numbers</td></tr>
<tr><td>can_bitrate_k</td><td>Int</td><td>250</td><td>Primary CAN bus bitrate [Kbit/s]: 125, 250, 500 or 1000</td></tr>
<tr><td>can_nmt_master</td><td>Int</td><td>1</td><td>Enables Navitrol to work as CANopen NMT master on primary CAN. 0 = No 1 = Yes <br> NMT master functionality is required whenever Navitrol configures any slave nodes using CANopen SDO messages</td></tr>
<tr><td>can_sync</td><td>Int</td><td>1</td><td>Navitrol's (Primary CAN) role for CANopen SYNC messages: 0 = None, 1 = SYNC producer, 2 = SYNC consumer <br> Most often Navitrol is the Sync producer</td></tr>
<tr><td>---</td><td>---</td><td>---</td><td>---</td></tr>
<tr><td>can_heartbeat_producer_enable</td><td>Int</td><td>0</td><td>Enables Navitrol to be Heartbeat producer for primary CAN <br> navigation_software_node_id must be defined (&gt;0) for hearbeat messages to be sent</td></tr>
<tr><td>can_sync_rx_mode</td><td>Int</td><td>1</td><td>Select sync receive PDOs: 0 = Legacy (all predefined), 1 = True CANopen SYNC PDOs only. <br> Ignored if can_sync=0 or no CANopen SYNC PDOs exist</td></tr>
<tr><td>can_primary_any_id</td><td>Int</td><td>0</td><td>Primary CAN valid PDO IDs that can be registered: 0 = Only valid PDO IDs can be registered, 1 = Any ID can be registered <br> Any message ID can be registered as RPDO when setting this parameter to 1. There is however a risk that non CANopen compliant ID conflicts with CANopen specification in such a way that the communication won't work properly. <strong>This parameter should never be set to 1 unless Navitec instructs to do so</strong>.</td></tr>
<tr><td>can_send_nmt_start_always</td><td>Int</td><td>0</td><td>Defines when Navitrol (Primary CAN) sends CIA301_NMT_CMD_START: 0 = Only on state change, 1 = Periodically every 1 second <br></td></tr>
<tr><td>can_sdo_interval_ms</td><td>Int</td><td>100</td><td>Primary CAN SDO message interval [ms] used by Navitrol</td></tr>
<tr><td>can_sdo_timeout_ms</td><td>Int</td><td>500</td><td>Primary CAN SDO message response timeout [ms] used by Navitrol</td></tr>
<tr><td>can_sdo_write_from_file</td><td>Int</td><td>0</td><td>Enables SDO writes from file sdo_write.txt for primary CAN. CANopen specific. <br> If set to 1, Navitrol reads the file and sends SDO commands defined in that file (See Appendix <a href="#sdo-write-configuration">SDO Write configuration</a>). This feature enables any CANopen device configuration changes without changes to Navitrol SW.</td></tr>
<tr><td>log_can</td><td>Int</td><td>0</td><td>Log primary CAN bus details, including all messages bytes. 2 = max level</td></tr>
<tr><td>log_can2</td><td>Int</td><td>0</td><td>Log secondary CAN bus details, including all messages bytes. 2 = max level.</td></tr>
<tr><td>log_can_msgs</td><td>Int</td><td>0</td><td>Log parsed and built can message data.</td></tr>
<tr><td>log_can_summary</td><td>Int</td><td>0</td><td>Log CAN msg summary. 0 = on ERR condition only, 1 = periodically.</td></tr>
</tbody></table>
<p><strong>Secondary interface</strong></p>
<p>Sometimes the AGV has a secondary CAN bus as well. These parameters are named with a prefix <code>can2_</code>. Otherwise the parameters are mostly the same as with the primary CAN bus. See <a href="../../../Introduction/Parameters/Parameters.html">Navitrol parameters</a> for Secondary CAN interface parameters.</p>
<h2 id="how-to-use"><a class="header" href="#how-to-use">How to use</a></h2>
<h3 id="can-wiring--configuration-rules"><a class="header" href="#can-wiring--configuration-rules">CAN wiring &amp; configuration rules</a></h3>
<p>The following rules shall be followed when wiring and configurating CAN-network</p>
<ul>
<li>
<p>CAN bus topology must be &quot;two end&quot; bus terminated at both ends using nominally 120 ohm resistor (between CAN_L and CAN_H).</p>
</li>
<li>
<p>CAN cable shall be shielded twisted-pair cable.</p>
</li>
<li>
<p>CAN_GND shall be connected to earth at single point.</p>
</li>
<li>
<p>If connecting outer shield in double shielded cable, it shall be connected to earth at single point.</p>
</li>
<li>
<p>When using T-connectors (or alike), stub lengths shall be kept as short as possible.</p>
</li>
<li>
<p>Pay attention not to place CAN wiring next to major disturbance sources, like inverters and motors.</p>
</li>
<li>
<p>Do not connect CAN devices with different bitrate to same bus.</p>
</li>
<li>
<p>Always assure that all CAN devices are configured to send unique message IDs (unique node IDs in CANopen).</p>
</li>
<li>
<p>Do not connect mixed type CAN devices (like CANopen and non-CANopen) to same bus unless you <em><strong>know</strong></em> that it is ok.</p>
</li>
</ul>
<p><strong>The electrical characteristics of the CAN bus cable restrict the cable length according to the selected bit rate. The High-Speed ISO 11898 Standard specifications are given for a maximum signaling rate of 1 Mbps with a bus length of 40 m and a maximum of 30 nodes. It also recommends a maximum un-terminated stub length of 0.3 m. You can use cabling up to 250 meters with the bitrate of 250 kbit/s. The maximum bus length with a bit rate of 10 kbit/s is 1 km, and the shortest with 1 Mbit/s is 40 meters. In the AGV world this is not a limiting thing.</strong></p>
<p><img src="./media-en/image4.png" alt="" /></p>
<p><strong>Maximum stub length on the other hand is not that simple thing. This depends on many details like transceiver characteristics. Even if the Standard recommends a maximum un-terminated stub length of 0.3 m with a 1 Mbps signaling rate, it is possible to use longer stub lengths in real world -- up to 5 m. It is difficult however to define the limit without knowing lot of details from HW, so the shorter, the better.</strong></p>
<h3 id="can-bus-voltage-levels"><a class="header" href="#can-bus-voltage-levels">CAN bus voltage levels</a></h3>
<p>Nominal voltage levels on CAN bus are shown in picture below. When no data is being sent both CAN_H and CAN_L should be very close to each other around 2.5V. When data is being sent, then voltage for CAN_H should be higher and CAN_L lower for '0' bit on the bus.</p>
<p>CAN is differential signal and therefore the Vdiff is the meaningful value, when detecting data. When the Vdiff value on the bus is less than 0.5V, the bus is considered to be in a recessive state. Vdiff values greater than 0.9V indicate that the bus is in a dominant state. Lastly, for Vdiff values between 0.5V and 0.9V, the bus state is undefined.</p>
<p><img src="./media-en/image5.png" alt="" /></p>
<h3 id="can-nodes--messages"><a class="header" href="#can-nodes--messages">CAN nodes &amp; messages</a></h3>
<p>When setting up CAN bus and configuring CAN devices, one must be careful to have same bitrate set to each connected device and set unique message IDs (in CANopen unique node IDs -- valid node ID range 1...127) for each device.</p>
<p>When having CAN devices of different type (like CANopen, basic CAN,..) on same bus it is even more important to verify already at design/configuration phase that all CAN message IDs are unique.
Duplicated IDs cause both confusion and potentially low level bus errors.</p>
<h3 id="can-drivers"><a class="header" href="#can-drivers">CAN drivers</a></h3>
<p>Navitrol uses SocketCAN as the CAN interface and SocketCAN is currently only supported CAN interface. Linux Debian 9 Stretch and later has SocketCAN supported out of the box. You can see the CAN interface as a &quot;network interface&quot; (command <code>ip a</code> shows can0 for example as an available network interface) on Linux.</p>
<ul>
<li>
<p>Any HW supported by SocketCAN or having SocketCAN drivers installed can be used with <a href="../../../Miscellaneous/LinuxImageInstallation/CanDrivers/CanDrivers-en.html#socketcan">SocketCAN interface</a>.</p>
</li>
<li>
<p>NOTE: SocketCAN and manufacturer specific non SocketCAN compliant drivers are typically mutually exclusive. Installing such SocketCAN conflicting driver may disable (blacklist) SocketCAN drivers completely. See <a href="../../../Miscellaneous/LinuxImageInstallation/CanDrivers/CanDrivers-en.html#uninstalling-kvaser-or-peak-dedicated-character-device-driver">Uninstalling Kvaser or PeakCAN native CAN drivers</a> for more info.</p>
</li>
</ul>
<h3 id="navitrol-supports-two-can-buses"><a class="header" href="#navitrol-supports-two-can-buses">Navitrol supports two CAN buses</a></h3>
<p>Navitrol supports two simultaneous CAN interfaces, although typically only one is used.</p>
<p>Navitrol Primary CAN bus is meant for CANopen type of nodes. In many cases it is assumed that Navitrol is the CANopen bus master as well and Navitrol primary CAN interface expects CANopen compliant messaging from all nodes.</p>
<p>Some non CANopen devices can be connected to CANopen bus without issues.
Some non-CANopen devices however use such non-configurable settings (like message IDs) that they can't or shouldn't be connected to Navitrol Primary CAN bus. If there are non-CANopen devices sending messages with IDs conflicting with CANopen specification, then those devices need to be connected in a separate CAN bus. For that purpose Navitrol supports two simultaneous CAN buses, primary and secondary. Use of two buses makes it also possible to connect to CAN devices with different bitrates.</p>
<p><strong>NOTE:</strong> There are also COTS products (CAN bridges) that make it
possible to connect non-CANopen compliant devices or even devices with
different bitrates to Navitrol Primary CAN bus. CAN-bridges support
message ID translation/filtering that makes this possible.</p>
<p><img src="./media-en/image6.png" alt="" /></p>
<h2 id="troubleshooting"><a class="header" href="#troubleshooting">Troubleshooting</a></h2>
<h3 id="can-bus-message-logging"><a class="header" href="#can-bus-message-logging">CAN bus message logging</a></h3>
<p>Navitrol logs always some amount of events related to CAN communication and CAN related issues. If one wishes to see all data sent to CAN bus and received from CAN bus, byte by byte, this can be accomplished by enabling can logging parameters.</p>
<p>Summary of received/not received objects is logged periodically whenever some of the expected CAN objects are missing. By setting parameter log_can_summary to 1, this summary is logged periodically even if there are no errors.</p>
<p>Examples of logged data are below. All these are subject to change when it comes to details. Key phrases, marked with double quotes in title (like &quot;RX_RAW&quot;), in the log will not change whenever it is possible to do so.</p>
<p><strong>Obligatory receive objects never received i.e. &quot;NotRxed&quot;</strong></p>
<p>0.4447 [08:1] CAN: PRI Node 30 Obj 19Eh NotRxed</p>
<p>0.4447 [08:1] CAN: PRI Node 30 Obj 29Eh NotRxed</p>
<p>0.4447 [08:1] CAN: PRI Node 31 Obj 19Fh NotRxed</p>
<p>0.4447 [08:1] CAN: PRI Node 31 Obj 29Fh NotRxed</p>
<p><strong>NOTE:</strong> Available as shown here starting from Navitrol version 6.30.00</p>
<p>Navitrol versions 6.28 and older log only first missing object without node ID.</p>
<p><strong>Received CAN messages, byte by byte: &quot;RX_RAW&quot; (params.log_can &gt; 0)</strong></p>
<p>234.3283 [08:6] CAN_INTE: RX_RAW PRI 2BCh dlc 8 00 00 00 00 00 00 04 00</p>
<p>234.3324 [23:6] CAN_INTE: RX_RAW SEC 1B2h dlc 8 00 00 00 00 00 00 03 DF</p>
<ul>
<li>
<p>SEC -- PRIMARY/SECONDARY bus</p>
</li>
<li>
<p>1B2h -- Message id in hex</p>
</li>
<li>
<p>dlc 8 -- Message length in bytes</p>
</li>
<li>
<p>00 00 00 00 00 00 03 DF -- Message byte by byte</p>
</li>
</ul>
<p><strong>Transmitted CAN messages, byte by byte: &quot;TX_RAW&quot; (params.log_can &gt; 0)</strong></p>
<p>307.9164 [08:6] CAN_INTE: TX_RAW PRI 1B2h dlc 8 00 00 00 00 00 00 03 63</p>
<p>307.9165 [23:6] CAN_INTE: TX_RAW SEC 2BCh dlc 8 00 00 00 00 00 00 04 00</p>
<p>Log line interpretation is exactly same as before in case of RX message.</p>
<p><strong>NOTE:</strong> you can pick both RX_RAW and TX_RAW, by using &quot;X_RAW&quot; as a key phrase.</p>
<p><strong>&quot;RX_SUM&quot; (ERROR OR params.log_can_summary &gt; 0)</strong></p>
<p>53.4326 [08:6] CAN: RX_SUM</p>
<p>53.4326 [08:6] CAN: RX_SUM PRI node 50 Obj 232h XXX_IN1 rxed/req 0/1, age --- ms</p>
<p>53.4326 [08:6] CAN: RX_SUM PRI node 50 Obj 332h XXX _IN2 rxed/req 0/1, age --- ms</p>
<p>53.4326 [08:6] CAN: RX_SUM PRI node 50 Obj 432h XXX _IN3 rxed/req 1/1, age 732 ms</p>
<p>53.4326 [08:6] CAN: RX_SUM SEC node 60 Obj 23Ch BUS2_1 rxed/req 0/1, age --- ms</p>
<p>53.4326 [08:6] CAN: RX_SUM SEC node 60 Obj 33Ch BUS2_2 rxed/req 0/1, age --- ms</p>
<ul>
<li>
<p>SEC -- PRIMARY/SECONDARY bus</p>
</li>
<li>
<p>60 - node ID of the CAN device</p>
</li>
<li>
<p>33Ch -- Message id in hex</p>
</li>
<li>
<p>rxed/req 0/1 -- Received at least once/required; if required message has not been received at all, then ERROR_CAN_ALL_NODES_NOT_OPER is generated (see troubleshooting section for more information)</p>
</li>
<li>
<p>--- -- Age of the message in ms (--- means that message has never been received)</p>
</li>
</ul>
<p><strong>CAN: &quot;Summary of registered objects&quot; (at startup)</strong></p>
<p>At startup Navitrol logs also a summary of all registered objects, i.e. objects transmitted or parsed by Navitrol. If Navitrol has been running for a long time, this info is not yet available in standard log file, but can still be found in startlog.txt.</p>
<p>0.3924 [08:6] CAN: Summary of registered objects</p>
<p>0.3924 [08:6] CAN: Rx00: PRI node 50 COBid 0232h SYNC 1 TimeoutTime 50</p>
<p>0.3924 [08:6] CAN: Rx01: PRI node 50 COBid 0332h SYNC 1 TimeoutTime 50</p>
<p>0.3924 [08:6] CAN: Rx02: PRI node 50 COBid 0432h SYNC 1 TimeoutTime 50</p>
<p>0.3924 [08:6] CAN: Rx03: PRI node 50 COBid 0532h SYNC 1 TimeoutTime 50</p>
<p>0.3924 [08:6] CAN: Rx04: SEC node 60 COBid 023Ch SYNC 1 TimeoutTime 50</p>
<p>0.3924 [08:6] CAN: Rx05: SEC node 60 COBid 033Ch SYNC 1 TimeoutTime 50</p>
<p>0.3924 [08:6] CAN: Tx00: PRI node 50 COBid 01B2h SYNC 1 TxInterval 30 TxInterval min 10</p>
<p>0.3924 [08:6] CAN: Tx01: PRI node 50 COBid 02B2h SYNC 1 TxInterval 30 TxInterval min 10</p>
<p>0.3924 [08:6] CAN: Tx02: PRI node 50 COBid 03B2h SYNC 1 TxInterval 30 TxInterval min 10</p>
<p>0.3924 [08:6] CAN: Tx03: SEC node 60 COBid 01BCh SYNC 1 TxInterval 30 TxInterval min 10</p>
<p>0.3924 [08:6] CAN: Tx04: SEC node 60 COBid 02BCh SYNC 1 TxInterval 30 TxInterval min 10</p>
<ul>
<li>
<p><strong>Tx04 -- message type (Rx, Tx, Od)</strong></p>
</li>
<li>
<p>SEC -- PRIMARY/SECONDARY bus</p>
</li>
<li>
<p>60 -- node ID of the CAN device whose objects are registered -- typically used as a basis for message parsing and building.</p>
</li>
<li>
<p>1B2h -- Message id in hex</p>
</li>
<li>
<p>SYNC 1 -- Tells whether message is a SYNC object or not. SYNC objects are used for synchronizing all operation in Navitrol.</p>
</li>
<li>
<p>TimeoutTime 50 -- Receive message timeout time. If receive interval exceeds this limit, error ERROR_CAN_RX_TIMEOUT is generated (see troubleshooting section for more information).</p>
</li>
<li>
<p>TxInterval 30 TxInterval min 10 -- Maximum and minimum transit intervals for each transmit object.</p>
</li>
</ul>
<h3 id="troubleshooting-can-communication"><a class="header" href="#troubleshooting-can-communication">Troubleshooting CAN communication</a></h3>
<p>Navitrol itself can detect some CAN related configuration issues, missing CAN nodes/objects and some major issues on the bus. It should be noted that Navitrol does have only limited capability to detect low level CAN bus related issues. Therefore truly comprehensive troubleshooting and analysis requires also other means, like use of a CAN analyzer.</p>
<h4 id="can-communication-issue-checklist"><a class="header" href="#can-communication-issue-checklist">CAN communication issue checklist</a></h4>
<p>Typical problems are</p>
<ul>
<li>
<p>Cabling related issues</p>
<ul>
<li>
<p>Bus topology</p>
</li>
<li>
<p>Termination missing or incorrect</p>
</li>
<li>
<p>CAN_H/CAN_L &quot;cross-connected&quot;</p>
</li>
<li>
<p>Ground/shield connections</p>
</li>
</ul>
</li>
<li>
<p>Sometimes it is assumed that powering through CAN interface is a standard feature (Navitrol IPC CAN connector does not have supply power)</p>
</li>
<li>
<p>CAN node missing or connected in a wrong way</p>
</li>
<li>
<p>One or more CAN nodes configured in wrong way (bitrate or node IDs in CANopen)</p>
</li>
<li>
<p>Mixing basic CAN and CANopen -- resulting in duplicate message IDs, maybe message IDs that conflict with CANopen basic mechanisms.</p>
</li>
<li>
<p>Damaged CAN interface</p>
</li>
</ul>
<p>Additional things to verify:</p>
<ul>
<li>
<p>Check that all devices are powered</p>
</li>
<li>
<p>Verify that <a href="#can-wiring--configuration-rules">CAN wiring &amp; configuration rules</a> have been followed.</p>
</li>
<li>
<p>Verify that configuration for CAN devices is ok</p>
<ul>
<li>
<p>Same bitrate for all devices</p>
</li>
<li>
<p>Unique node ID (1...127) for all CANopen devices</p>
</li>
<li>
<p>Basic CAN message IDs do not conflict with CANopen ones</p>
</li>
</ul>
</li>
<li>
<p>Each CANopen device <strong>should</strong> send bootup message at startup (0x700 + node ID)</p>
</li>
<li>
<p>CAN bus voltages</p>
</li>
<li>
<p>In Navitrol</p>
<ul>
<li>
<p>Verify that Navitrol's CAN related parameters are set up correctly</p>
</li>
<li>
<p>Check for any CAN related ERROR active. See <a href="../../../Miscellaneous/ErrorDescriptions/ErrorDescriptions-en.html#709-error_can_failure">Error Descriptions</a> for different CAN-errors</p>
</li>
<li>
<p>Verify that Navitrol is receiving CAN messages as expected: &quot;RX_RAW&quot; logging</p>
</li>
<li>
<p>Verify that Navitrol is receiving CAN messages from all configured nodes: &quot;RX_SUM&quot; logging</p>
</li>
</ul>
</li>
</ul>
<p>If any of the CAN devices on the bus is configured for wrong bitrate, then it typically messes all communication. In such a case it is often necessary to connect (or disconnect) CAN devices to the bus one by one and first find out which one of the devices causes the issues.</p>
<h4 id="can-analyzer"><a class="header" href="#can-analyzer">CAN Analyzer</a></h4>
<p>Even if the communication seems to work kind of ok, it is possible that there are issues that result in collisions, delays and time jitter in communication. In case of unclear problems, it is often good policy to connect a CAN analyzer to the bus to check if there are detectable issues. For example errors in basic CAN device configuration (different
bitrates, duplicated node IDs,..) often result in &quot;Error frames&quot; or other errors that can be detected using CAN analyzer SW. It is not that clear that all these errors are detected by Navitrol at all. See picture below.</p>
<p><img src="./media-en/image7.png" alt="" /></p>
<p>Most useful windows for troubleshooting are &quot;Bus Statistics&quot; and &quot;Output Window&quot;. Left hand pictures show contents in &quot;normal&quot; case without any issues. Bus Statistics details that should be checked are marked in picture. Right hand side on the other hand shows same windows in a case where physical bus has issues.</p>
<p>In some AGV's it is not that straightforward to physically connect to the bus. In those cases CAN hub (like Kvaser T-Cannector, see pic below) helps a lot.</p>
<p><img src="./media-en/image8.jpeg" alt="" /></p>
<h4 id="sdo-errors"><a class="header" href="#sdo-errors">SDO errors</a></h4>
<p>SDO errors might occur if something was done incorrectly during the commissioning. If SDO Response message starts with 80 instead of 60 the SDO message has failed. The error reason is written to the last four data bytes and in that case the error can be googled.</p>
<table><thead><tr><th>SEND/RESPONSE</th><th>COB ID (in hex 0x)</th><th>dlc</th><th>Data bytes (in hex 0x)</th><th>Description</th></tr></thead><tbody>
<tr><td>SEND</td><td>601</td><td>8</td><td>2F 81 2F 00 <strong>00</strong> 00 00 00</td><td>SDO Upload request:<br>Trying to set baud rate to <strong>0 kbs</strong></td></tr>
<tr><td>RESPONSE</td><td>581</td><td>8</td><td>80 81 2F 00 <strong>32 00 09 06</strong></td><td>Response not ok. Error code <strong>0609 0032h</strong>: Value of parameter written too low.</td></tr>
</tbody></table>
<blockquote>
<p>Failed SDO message example</p>
</blockquote>
<h2 id="appendix-a"><a class="header" href="#appendix-a">Appendix A</a></h2>
<h3 id="sdo-write-configuration"><a class="header" href="#sdo-write-configuration">SDO write configuration</a></h3>
<p>Navitrol supports writing OD parameters at startup time to any CANopen slave. Some of these write commands are &quot;hard-coded&quot; in Navitrol, but it is also possible to define any other SDO writes using ASCII-file <code>sdo_write.txt</code>, format explained below.</p>
<pre><code>#--------------------------------------------------------------------------

# Sample file -- sdo_write.txt

#--------------------------------------------------------------------------

#

# Any data on a line after character '#' is ignored (regarded as comment)

#

# Mode, node ID, type, Idx.SubIdx, value

# - mode shall be

# * WRITE -- absolute write; value is written to OD as specified in file

# - Supported types are: I8 I16 I32 U8 U16 U32 F

# - Idx.SubIdx are both decimal or both hex (not mixed)

# - Integer values can be expressed in decimal or hex, prefix for hex values shall be 'x' or '0x'

# - spaces are ignored - can't have spaces separating items in single value though

#
# NODE 63
#

WRITE, 63,U8,0x4310.1,100 # VEL_Kp - PID-Position Controller - proportional gain

WRITE,63,I16,1500.09,x100

WRITE,63, I32, 0x49A0.20, x6400

WRITE, 40 , U16 , 1500.09 , x300

#
# NODE 22
#

WRITE, 22, I16, 1500.09, x100

#
# NODE 0x20 i.e. 32
#

WRITE,0x20, I16, 1500.09, x100
</code></pre>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                                                    <a rel="prev" href="../../../AgvInterfaces/GenericInterfaces/EthernetSupervisorInterface/EthernetSupervisorInterface-en.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                        
                                                    <a rel="next" href="../../../AgvInterfaces/GenericInterfaces/CanSupervisorInterface/CanSupervisorInterface-en.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                                    <a rel="prev" href="../../../AgvInterfaces/GenericInterfaces/EthernetSupervisorInterface/EthernetSupervisorInterface-en.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                
                                    <a rel="next" href="../../../AgvInterfaces/GenericInterfaces/CanSupervisorInterface/CanSupervisorInterface-en.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
                            </nav>

        </div>

        
        
        
                <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        
        
                <script src="../../../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../../mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../../searcher.js" type="text/javascript" charset="utf-8"></script>
        
        <script src="../../../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../../book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        
        
    </body>
</html>
