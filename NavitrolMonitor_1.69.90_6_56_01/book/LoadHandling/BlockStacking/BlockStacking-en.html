<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Unloading to a stack - NAVITROL USER INSTRUCTIONS - Navitec Systems Oy CONFIDENTIAL</title>
                

        <!-- Custom HTML head -->
        

        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

                <link rel="icon" href="../../favicon.svg">
                        <link rel="shortcut icon" href="../../favicon.png">
                <link rel="stylesheet" href="../../css/variables.css">
        <link rel="stylesheet" href="../../css/general.css">
        <link rel="stylesheet" href="../../css/chrome.css">
                <link rel="stylesheet" href="../../css/print.css" media="print">
        
        <!-- Fonts -->
        <link rel="stylesheet" href="../../FontAwesome/css/font-awesome.css">
                <link rel="stylesheet" href="../../fonts/fonts.css">
        
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../../highlight.css">
        <link rel="stylesheet" href="../../tomorrow-night.css">
        <link rel="stylesheet" href="../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        
                <!-- MathJax -->
        <script async type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
            </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="../../MdBook/MdbookFrontPage.html">Front page</a></li><li class="chapter-item expanded affix "><li class="part-title">Introduction</li><li class="chapter-item expanded "><a href="../../Introduction/NavitrolUserInstructions/NavitrolUserInstructions-en.html"><strong aria-hidden="true">1.</strong> Navitrol user instructions</a></li><li class="chapter-item expanded "><a href="../../Introduction/Licensing/Licensing-en.html"><strong aria-hidden="true">2.</strong> Licensing</a></li><li class="chapter-item expanded "><a href="../../Introduction/OdometrySource/OdometrySource-en.html"><strong aria-hidden="true">3.</strong> Odometry source</a></li><li class="chapter-item expanded "><a href="../../Introduction/InitialCalibrationGuide/InitialCalibrationGuide-en.html"><strong aria-hidden="true">4.</strong> Initial calibration guide</a></li><li class="chapter-item expanded "><a href="../../Miscellaneous/ParameterReconfiguration/ParameterReconfiguration-en.html"><strong aria-hidden="true">5.</strong> Parameter reconfiguration</a></li><li class="chapter-item expanded "><a href="../../Introduction/Parameters/Parameters.html"><strong aria-hidden="true">6.</strong> Parameter listing</a></li><li class="chapter-item expanded "><a href="../../Introduction/Parameters/JsonConfigurationFile-en.html"><strong aria-hidden="true">7.</strong> JSON configuration file</a></li><li class="chapter-item expanded "><a href="../../Introduction/TeachingInstructions/TeachingInstructions-en.html"><strong aria-hidden="true">8.</strong> Teaching instructions</a></li><li class="chapter-item expanded "><a href="../../Introduction/FeatureMatrix/FeatureMatrix-en.html"><strong aria-hidden="true">9.</strong> Feature Matrix</a></li><li class="chapter-item expanded affix "><li class="part-title">Device interfaces</li><li class="chapter-item expanded "><a href="../../AgvInterfaces/SupportedDevices/SupportedDevices-en.html"><strong aria-hidden="true">10.</strong> Supported devices</a></li><li class="chapter-item expanded "><a href="../../AgvInterfaces/GenericInterfaces/GenericInterfacesHeading.html"><strong aria-hidden="true">11.</strong> Generic interfaces</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../AgvInterfaces/GenericInterfaces/EthernetSupervisorInterface/EthernetSupervisorInterface-en.html"><strong aria-hidden="true">11.1.</strong> Ethernet Supervisor</a></li><li class="chapter-item expanded "><a href="../../AgvInterfaces/GenericInterfaces/CanCommunication/CanCommunication-en.html"><strong aria-hidden="true">11.2.</strong> CAN communication</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../AgvInterfaces/GenericInterfaces/CanSupervisorInterface/CanSupervisorInterface-en.html"><strong aria-hidden="true">11.2.1.</strong> CAN Supervisor</a></li></ol></li><li class="chapter-item expanded "><a href="../../AgvInterfaces/GenericInterfaces/EthercatCommunication/EthercatCommunication-en.html"><strong aria-hidden="true">11.3.</strong> EtherCAT Communication</a></li><li class="chapter-item expanded "><a href="../../AgvInterfaces/GenericInterfaces/Simove/SimoveInterface-en.html"><strong aria-hidden="true">11.4.</strong> SIMOVE</a></li></ol></li><li class="chapter-item expanded "><a href="../../AgvInterfaces/MotorControllers/MotorControllersHeading.html"><strong aria-hidden="true">12.</strong> Motor controllers</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../AgvInterfaces/MotorControllers/MotorControllersCommon/MotorControllersCommon-en.html"><strong aria-hidden="true">12.1.</strong> Motor controller common</a></li><li class="chapter-item expanded "><a href="../../AgvInterfaces/MotorControllers/Schwarzmueller/SchwarzmuellerSetupInstructions/SchwarzmuellerSetupInstructions-en.html"><strong aria-hidden="true">12.2.</strong> Schwarzmueller setup</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../AgvInterfaces/MotorControllers/Schwarzmueller/SchwarzmuellerParameterSetupInstructions/SchwarzmuellerParameterSetupInstructions-en.html"><strong aria-hidden="true">12.2.1.</strong> Schwarzmueller parameters</a></li><li class="chapter-item expanded "><a href="../../AgvInterfaces/MotorControllers/Schwarzmueller/SchwarzmuellerTroubleshooting/SchwarzmuellerTroubleshooting-en.html"><strong aria-hidden="true">12.2.2.</strong> Schwarzmueller troubleshooting</a></li></ol></li><li class="chapter-item expanded "><a href="../../AgvInterfaces/MotorControllers/Curtis/CurtisMotorController-en.html"><strong aria-hidden="true">12.3.</strong> Curtis</a></li><li class="chapter-item expanded "><a href="../../AgvInterfaces/MotorControllers/Engel/EngelMotorController-en.html"><strong aria-hidden="true">12.4.</strong> Engel</a></li><li class="chapter-item expanded "><a href="../../AgvInterfaces/MotorControllers/Kinco/KincoMotorController-en.html"><strong aria-hidden="true">12.5.</strong> Kinco</a></li><li class="chapter-item expanded "><a href="../../AgvInterfaces/MotorControllers/Nanotec/NanotecMotorController-en.html"><strong aria-hidden="true">12.6.</strong> Nanotec</a></li><li class="chapter-item expanded "><a href="../../AgvInterfaces/MotorControllers/Oriental/OrientalMotorController-en.html"><strong aria-hidden="true">12.7.</strong> Oriental</a></li><li class="chapter-item expanded "><a href="../../AgvInterfaces/MotorControllers/Synapticon/SynapticonMotorController-en.html"><strong aria-hidden="true">12.8.</strong> Synapticon</a></li><li class="chapter-item expanded "><a href="../../AgvInterfaces/MotorControllers/Roboteq/RoboteqOpenLoopControllerConfiguration-en.html"><strong aria-hidden="true">12.9.</strong> Roboteq Open loop</a></li><li class="chapter-item expanded "><a href="../../AgvInterfaces/MotorControllers/Roboteq/RoboteqClosedLoopControllerConfiguration-en.html"><strong aria-hidden="true">12.10.</strong> Roboteq Closed loop</a></li><li class="chapter-item expanded "><a href="../../AgvInterfaces/MotorControllers/MiControl/MiControlMotorController-en.html"><strong aria-hidden="true">12.11.</strong> MiControl</a></li></ol></li><li class="chapter-item expanded "><a href="../../AgvInterfaces/ScannerConfigurations/ScannerHeading.html"><strong aria-hidden="true">13.</strong> Laser scanners</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../AgvInterfaces/ScannerConfigurations/ScannerConfigurations-en.html"><strong aria-hidden="true">13.1.</strong> Scanner configurations</a></li><li class="chapter-item expanded "><a href="../../AgvInterfaces/ScannerCommunicationTroubleshoot/ScannerCommunicationTroubleshoot-en.html"><strong aria-hidden="true">13.2.</strong> Scanner communication troubleshooting</a></li></ol></li><li class="chapter-item expanded "><a href="../../AgvInterfaces/OpticalCodeReader/OpticalCodeReader.html"><strong aria-hidden="true">14.</strong> Optical code reader</a></li><li class="chapter-item expanded "><a href="../../AgvInterfaces/Encoders/EncoderHeading.html"><strong aria-hidden="true">15.</strong> Encoders</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../AgvInterfaces/Encoders/EthercatEncoders/EthercatEncoders-en.html"><strong aria-hidden="true">15.1.</strong> EtherCAT encoders</a></li></ol></li><li class="chapter-item expanded "><li class="part-title">User interfaces</li><li class="chapter-item expanded "><a href="../../CustomerUis/NavitrolMonitor/NavitrolMonitor-en.html"><strong aria-hidden="true">16.</strong> Navitrol Monitor</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../CustomerUis/NavitrolMonitor3rdPartyLicenses/NavitrolMonitor3rdPartyLicenses-en.html"><strong aria-hidden="true">16.1.</strong> Navitrol Monitor third party licenses</a></li></ol></li><li class="chapter-item expanded "><a href="../../CustomerUis/WebInterface/WebInterface-en.html"><strong aria-hidden="true">17.</strong> Navitrol web interface</a></li><li class="chapter-item expanded "><a href="../../CustomerUis/Parameter Tool/ParameterTool-en.html"><strong aria-hidden="true">18.</strong> Parameter Tool Beta</a></li><li class="chapter-item expanded affix "><li class="part-title">Localization</li><li class="chapter-item expanded "><a href="../../Localization/PositionConfidence/PositionConfidence-en.html"><strong aria-hidden="true">19.</strong> Position confidence</a></li><li class="chapter-item expanded "><a href="../../Localization/ScannerCalibration/ScannerCalibration-en.html"><strong aria-hidden="true">20.</strong> Scanner calibration</a></li><li class="chapter-item expanded "><a href="../../Localization/EnvironmentGuidelines/EnvironmentGuidelines-en.html"><strong aria-hidden="true">21.</strong> Environment guidelines</a></li><li class="chapter-item expanded "><a href="../../Localization/AutomaticOdometryCorrection/AutomaticOdometryCorrection-en.html"><strong aria-hidden="true">22.</strong> Automatic odometry correction</a></li><li class="chapter-item expanded "><a href="../../Localization/ReflectorBasedPositionInitialization/ReflectorBasedPositionInitialization-en.html"><strong aria-hidden="true">23.</strong> Reflector based position initialization</a></li><li class="chapter-item expanded "><a href="../../Localization/PrecisionPositioning/PrecisionPositioning-en.html"><strong aria-hidden="true">24.</strong> Precision positioning</a></li><li class="chapter-item expanded "><a href="../../Localization/LocalizationScannerChangeOnTheFly/LocalizationScannerChangeOnTheFly-en.html"><strong aria-hidden="true">25.</strong> Changing scanner on the fly</a></li><li class="chapter-item expanded "><a href="../../Localization/RampZones/RampZones-en.html"><strong aria-hidden="true">26.</strong> Ramp zones</a></li><li class="chapter-item expanded "><a href="../../Localization/GpsPositioning/GpsPositioning-en.html"><strong aria-hidden="true">27.</strong> GPS Positioning</a></li><li class="chapter-item expanded "><a href="../../Localization/ImuAndSensorFusion/ImuAndSensorFusion-en.html"><strong aria-hidden="true">28.</strong> IMU and sensor fusion</a></li><li class="chapter-item expanded "><a href="../../Localization/ExternalLocalization/ExternalLocalization-en.html"><strong aria-hidden="true">29.</strong> External localization</a></li><li class="chapter-item expanded "><a href="../../Localization/DynamicMapping/DynamicMappingServer/DynamicMappingServer-en.html"><strong aria-hidden="true">30.</strong> Dynamic mapping server</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../Localization/DynamicMapping/DynamicMappingServerAndClientCompatibility/DynamicMappingServerAndClientCompatibility-en.html"><strong aria-hidden="true">30.1.</strong> Dynamic mapping client/server compatibility</a></li><li class="chapter-item expanded "><a href="../../Localization/DynamicMapping/DynamicMappingServerHardwareRequirements/DynamicMappingServerHardwareRequirements.html"><strong aria-hidden="true">30.2.</strong> Dynamic mapping client/server hardware requirements</a></li></ol></li><li class="chapter-item expanded "><a href="../../Localization/WheelSlipping/WheelSlipping-en.html"><strong aria-hidden="true">31.</strong> Wheel slipping diagnostic</a></li><li class="chapter-item expanded "><a href="../../Localization/3dPositioning/3dPositioning-en.html"><strong aria-hidden="true">32.</strong> 3D positioning</a></li><li class="chapter-item expanded affix "><li class="part-title">Position control</li><li class="chapter-item expanded "><a href="../../PositionControl/StartOffsetSlowdown/StartOffsetSlowdown-en.html"><strong aria-hidden="true">33.</strong> Start offset slowdown</a></li><li class="chapter-item expanded "><a href="../../PositionControl/CoupledDriving/CoupledDrivingFeature-en.html"><strong aria-hidden="true">34.</strong> Coupled driving</a></li><li class="chapter-item expanded "><a href="../../PositionControl/MagneticLineFollowing/MagneticLineFollowing-en.html"><strong aria-hidden="true">35.</strong> Magnetic line following</a></li><li class="chapter-item expanded "><a href="../../PositionControl/TrailerTransport/TrailerTransport-en.html"><strong aria-hidden="true">36.</strong> Trailer transport</a></li><li class="chapter-item expanded "><a href="../../PositionControl/BarrierStop/BarrierStop-en.html"><strong aria-hidden="true">37.</strong> Barrier stop</a></li><li class="chapter-item expanded "><a href="../../PositionControl/DataMatrixDocking/DataMatrixDockingDMC-en.html"><strong aria-hidden="true">38.</strong> Data Matrix Code Docking V2</a></li><li class="chapter-item expanded "><a href="../../PositionControl/Docking/Docking-en.html"><strong aria-hidden="true">39.</strong> Docking</a></li><li class="chapter-item expanded affix "><li class="part-title">Drive control</li><li class="chapter-item expanded "><a href="../../DriveControl/DrivingOptions/DrivingOptions-en.html"><strong aria-hidden="true">40.</strong> Driving options</a></li><li class="chapter-item expanded "><a href="../../DriveControl/Standalone/Standalone-en.html"><strong aria-hidden="true">41.</strong> Standalone</a></li><li class="chapter-item expanded "><a href="../../DriveControl/StopAndHold/StopAndHold-en.html"><strong aria-hidden="true">42.</strong> Stop-and-hold</a></li><li class="chapter-item expanded "><a href="../../DriveControl/VDA5050/VDA5050-en.html"><strong aria-hidden="true">43.</strong> VDA 5050</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../DriveControl/VDA5050/VDA5050FeatureMatrix-en.html"><strong aria-hidden="true">43.1.</strong> VDA 5050 Support status</a></li></ol></li><li class="chapter-item expanded "><a href="../../DriveControl/ReturnToRoute/ReturnToRoute-en.html"><strong aria-hidden="true">44.</strong> Return to route</a></li><li class="chapter-item expanded "><a href="../../DriveControl/ObstacleAvoidance/ObstacleAvoidance-en.html"><strong aria-hidden="true">45.</strong> Obstacle avoidance</a></li><li class="chapter-item expanded "><a href="../../DriveControl/ObstacleAvoidanceV2/ObstacleAvoidanceV2-en.html"><strong aria-hidden="true">46.</strong> Obstacle avoidance V2</a></li><li class="chapter-item expanded "><a href="../../DriveControl/ContainerDriving/ContainerDriving-en.html"><strong aria-hidden="true">47.</strong> Container driving</a></li><li class="chapter-item expanded "><a href="../../DriveControl/RecordAndPlay/RecordAndPlay-en.html"><strong aria-hidden="true">48.</strong> Record and Play</a></li><li class="chapter-item expanded "><a href="../../DriveControl/RouteFreeNavigation/RouteFreeNavigation-en.html"><strong aria-hidden="true">49.</strong> Route free navigation</a></li><li class="chapter-item expanded affix "><li class="part-title">Kinematics</li><li class="chapter-item expanded "><a href="../../Kinematics/OmniSteerLimit/OmniSteerLimit-en.html"><strong aria-hidden="true">50.</strong> Omni steer limit</a></li><li class="chapter-item expanded "><a href="../../Kinematics/OneDriveWheelOmni/OneDriveWheelOmni-en.html"><strong aria-hidden="true">51.</strong> Omni one drive wheel</a></li><li class="chapter-item expanded affix "><li class="part-title">Pickup and drop-off</li><li class="chapter-item expanded "><a href="../../LoadHandling/ActuatorControl/ActuatorControl-en.html"><strong aria-hidden="true">52.</strong> Actuator control</a></li><li class="chapter-item expanded "><a href="../../LoadHandling/ScannerLiftActuator/ScannerLiftActuator-en.html"><strong aria-hidden="true">53.</strong> Scanner lift actuator</a></li><li class="chapter-item expanded "><a href="../../LoadHandling/Racking/Racking-en.html"><strong aria-hidden="true">54.</strong> Racking</a></li><li class="chapter-item expanded "><a href="../../LoadHandling/BufferLanes/BufferLanes-en.html"><strong aria-hidden="true">55.</strong> Buffer lanes</a></li><li class="chapter-item expanded "><a href="../../LoadHandling/StackLoading/StackLoading-en.html"><strong aria-hidden="true">56.</strong> Loading from a stack</a></li><li class="chapter-item expanded "><a href="../../LoadHandling/BlockStacking/BlockStacking-en.html" class="active"><strong aria-hidden="true">57.</strong> Unloading to a stack</a></li><li class="chapter-item expanded "><a href="../../LoadHandling/DistanceToTarget/DistanceToTarget-en.html"><strong aria-hidden="true">58.</strong> Distance to target estimation</a></li><li class="chapter-item expanded affix "><li class="part-title">Target and obstacle detection</li><li class="chapter-item expanded "><a href="../../TargetAndObstacleDetection/PalletDetection/PalletDetection-en.html"><strong aria-hidden="true">59.</strong> Pallet detection</a></li><li class="chapter-item expanded "><a href="../../TargetAndObstacleDetection/3dTargetDetection/3dTargetDetection-en.html"><strong aria-hidden="true">60.</strong> 3D Target detection</a></li><li class="chapter-item expanded "><a href="../../TargetAndObstacleDetection/PatternDetection/PatternDetection-en.html"><strong aria-hidden="true">61.</strong> Pattern detection</a></li><li class="chapter-item expanded "><a href="../../TargetAndObstacleDetection/ObstacleDetection/ObstacleDetection-en.html"><strong aria-hidden="true">62.</strong> Obstacle detection</a></li><li class="chapter-item expanded "><a href="../../TargetAndObstacleDetection/ExternalTargetDetection/ExternalTargetDetection-en.html"><strong aria-hidden="true">63.</strong> External target detection</a></li><li class="chapter-item expanded "><a href="../../TargetAndObstacleDetection/TableDetection/TableDetection-en.html"><strong aria-hidden="true">64.</strong> Table detection</a></li><li class="chapter-item expanded "><a href="../../TargetAndObstacleDetection/Wallmonitoring/Wallmonitoring-en.html"><strong aria-hidden="true">65.</strong> Wall monitoring</a></li><li class="chapter-item expanded "><a href="../../TargetAndObstacleDetection/OccupancyCheck/OccupancyCheck-en.html"><strong aria-hidden="true">66.</strong> Occupancy check</a></li><li class="chapter-item expanded affix "><li class="part-title">Miscellaneous</li><li class="chapter-item expanded "><a href="../../Miscellaneous/ErrorDescriptions/ErrorDescriptions-en.html"><strong aria-hidden="true">67.</strong> Error descriptions</a></li><li class="chapter-item expanded "><a href="../../Miscellaneous/Logging/Logging-en.html"><strong aria-hidden="true">68.</strong> Logging</a></li><li class="chapter-item expanded "><a href="../../Miscellaneous/LinuxImageInstallation/LinuxImagesHeading.html"><strong aria-hidden="true">69.</strong> Linux image installation</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../Miscellaneous/LinuxImageInstallation/CanDrivers/CanDrivers-en.html"><strong aria-hidden="true">69.1.</strong> CAN drivers</a></li><li class="chapter-item expanded "><a href="../../Miscellaneous/LinuxImageInstallation/Clonezilla/ClonezillaInstallation-en.html"><strong aria-hidden="true">69.2.</strong> Clonezilla</a></li><li class="chapter-item expanded "><a href="../../Miscellaneous/LinuxImageInstallation/DebianBuster/DebianBusterInstallation-en.html"><strong aria-hidden="true">69.3.</strong> Debian Buster</a></li><li class="chapter-item expanded "><a href="../../Miscellaneous/LinuxImageInstallation/DebianBullseye/DebianBullseyeInstallation-en.html"><strong aria-hidden="true">69.4.</strong> Debian Bullseye</a></li></ol></li><li class="chapter-item expanded "><a href="../../Miscellaneous/ParameterZones/ParameterZones-en.html"><strong aria-hidden="true">70.</strong> Parameter zones</a></li><li class="chapter-item expanded "><a href="../../Miscellaneous/Reflectors/Reflectors-en.html"><strong aria-hidden="true">71.</strong> Reflectors</a></li><li class="chapter-item expanded "><a href="../../Miscellaneous/SslCertificates/SslCertificates-en.html"><strong aria-hidden="true">72.</strong> SSL Certificate configuration</a></li><li class="chapter-item expanded "><a href="../../Miscellaneous/BatteryOvertemperatureActions/BatteryOvertemperatureActions.html"><strong aria-hidden="true">73.</strong> Battery overtemperature actions</a></li><li class="chapter-item expanded "><a href="../../Miscellaneous/Charging/Charging-en.html"><strong aria-hidden="true">74.</strong> Charging and battery management</a></li><li class="chapter-item expanded "><a href="../../Miscellaneous/HardwareRequirements/HardwareRequirements-en.html"><strong aria-hidden="true">75.</strong> Hardware requirements</a></li></ol>            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="dark">Dark</button></li>
                        </ul>
                                                <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                                            </div>

                    <h1 class="menu-title">NAVITROL USER INSTRUCTIONS - Navitec Systems Oy CONFIDENTIAL</h1>

                    <div class="right-buttons">
                                                <a href="../../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                                                                        
                    </div>
                </div>

                                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="block-stacking-instructions"><a class="header" href="#block-stacking-instructions">Block Stacking Instructions</a></h1>
<p>Updated 09.09.2024</p>
<hr />
<h2 id="introduction"><a class="header" href="#introduction">Introduction</a></h2>
<p>Block stacking is a feature that means <strong>unloading</strong> on top of another pallet. This is very specific feature and can only be used with a certain type of forklifts, because the unloading height on top of a pallet needs to be detected with sensor. Basically, the idea is that when driving on the buffer area (purple area on the Figure 5) the AGV start detecting pallet with the laser scanner on front of the route.
When it detects the pallet, it stops and starts increasing the fork.
Using sensor information, the increase is stopped when the sensor detects the top level of the pallet. This height can be searched with laser scanner or with sensors on the fork tip. Then AGV continue the drive on top of that pallet. When reached to the correct unload location, AGV performs the unload. The drive is finished and AGV start
driving to the next location while keeping the height at the same level where it was after the unload. When the AGV has driven far away from the unload place, the fork is decreased to the floor level.</p>
<p>ATTENTION! Before setting up block stacking, <strong>unload buffer</strong> feature should be tested first. Check Figure 1 and Figure 2 for the difference between unload buffer feature and block stacking feature. The unload buffer means feature where the AGV searches the next pallet ahead on the route with the laser scanner and unload on the floor level in specified distance from that pallet. Block stacking can then be enabled to unload pallets on top of each other.</p>
<p>ATTENTION! The fork tip sensor can be used only with custom CAN interface at the moment.</p>
<p><img src="./media-en/image3.png" alt="" /></p>
<blockquote>
<p>Figure 1: Unload buffer example</p>
</blockquote>
<p><img src="./media-en/image4.png" alt="" /></p>
<blockquote>
<p>Figure 2: Block stacking example</p>
</blockquote>
<h3 id="requirements"><a class="header" href="#requirements">Requirements</a></h3>
<p>Block stacking requires sensor that is used to find the correct unloading height. Fork sensors, for example ultrasonic sensor, on the front of the fork or scanner that is  attached to the lifting part of the fork. If the scanner is used, it needs to see the pallet on front even though the forks have the pallet onboard. The sensor is used to detect the height of the pallet and to unload the carried pallet to the correct level. See the Figure 3 and Figure 4 for illustrations about different options for sensor placements.</p>
<p>There are two options for the sensor placements:</p>
<p><img src="./media-en/image5.png" alt="" /></p>
<blockquote>
<p>Figure 3: Laser distance sensor and laser scanner placement.</p>
</blockquote>
<p>or</p>
<p><img src="./media-en/image6.png" alt="" /></p>
<blockquote>
<p>Figure 4: Laser scanner placement. The scanner should be able to see past the carried pallet.</p>
</blockquote>
<h3 id="specification"><a class="header" href="#specification">Specification</a></h3>
<p>This chapter describes the steps that AGV performs with the blockstacking feature. This can be used to check that blockstacking works as it should.</p>
<ul>
<li>
<p>AGV drives inside unload buffer</p>
</li>
<li>
<p>Drive is stopped in front of the pallet based on scanner detecting the pallet on the route or fork tip sensors.</p>
</li>
<li>
<p>AGV starts lifting the fork to search where the pallet top level is.</p>
</li>
<li>
<p>The lifting is stopped on the top pallet based on the fork sensor or scanner measurements. The lifting is also stopped if fork reaches maximum height. If this maximum height is reached, the pallet is unloaded to the floor level, if AGV is on the buffer area, or the state is aborted. If the state is aborted, then AGV waits for fleet control to give new drive order to buffer that has space.</p>
</li>
<li>
<p>If the top height is detected correctly, fork is still lifted by load aboard offset so the AGV can drive on top of the pallet without fork hitting to the pallet.</p>
</li>
<li>
<p>AGV continues driving until the carried pallet is on top of the other pallet</p>
</li>
<li>
<p>AGV unloads the carried pallet.</p>
</li>
<li>
<p>AGV drives out of the pallet and keeps the fork height where it is to avoid hitting the pallet.</p>
</li>
<li>
<p>Load sensor can be checked when we have driven a certain distance out from the unload location. This can be used to make sure that the pallet is not anymore on the fork, before driving too far.</p>
</li>
<li>
<p>When the AGV has driven to the same location where it was increasing the fork, it will lower the fork to the route value.</p>
</li>
</ul>
<h4 id="pyramid-stacking"><a class="header" href="#pyramid-stacking">Pyramid stacking</a></h4>
<p>Pyramid stacking allows the unloading point to be altered lenghtwise from the target. The lengthwise offset is obtained either via fleet control or parameter <strong>block_stacking_pyramid_length_offset_mm</strong>. The aforementioned offset is only applied when unloading to a stack.</p>
<p><img src="./media-en/pyramidstacking.PNG" alt="" /></p>
<blockquote>
<p>Pyramid stacking allows for altering the unload point lengthwise</p>
</blockquote>
<p>The process is otherwise the same as for normal blockstacking.</p>
<h3 id="limitations"><a class="header" href="#limitations">Limitations</a></h3>
<ul>
<li>
<p>This feature is only for a certain type of fork AGVs. It is required that the AGV can see the pallet ahead with some sensor while increasing the fork.</p>
</li>
<li>
<p>The pallet detection scanner is required to see the pallet on front when the AGV is carrying a pallet if the pallet detection is used on the block stacking. This means that the scanner needs to be below the fork.</p>
</li>
<li>
<p>The final height depends on the sensor and the surface of the pallet's top. If there is plastic on the top or the top is uneven, the result might vary, and it can affect the safety.</p>
</li>
<li>
<p>When using fork sensor, for example ultrasonic sensor on the tip of the fork, there has to be also scanner that can detect the pallet on the floor so the AGV can calculate stopping point in front of that pallet early enough. The fork sensors have limited distance to detect objects on front so they are required to trigger close to this calculated stopping point. If the fork sensors are not triggered when the AGV has driven past this stopping point, AGV just unloads the pallet to the floor to avoid pushing other pallets.</p>
</li>
</ul>
<h2 id="setting-up"><a class="header" href="#setting-up">Setting up</a></h2>
<p>Recommended software:</p>
<ul>
<li>
<p>Navithor 2.8.1.0</p>
</li>
<li>
<p>Navitrol 6.26.00</p>
</li>
<li>
<p>Navithor Tools 3.09.10</p>
</li>
</ul>
<h3 id="navithor-tools"><a class="header" href="#navithor-tools">Navithor Tools</a></h3>
<p>Block stacking needs to be enabled on each symbolic point, where it is used. It can be setup by adding a tag on the symbolic point.</p>
<p>NOTE! Tools version must be higher than 3.09.10!</p>
<ol>
<li>
<p>Create symbolic point and change it to unload type.</p>
</li>
<li>
<p>Edit virtual tag on the symbolic points menu. New window should open.</p>
</li>
<li>
<p>Add new tag by pressing Add tag button. Select NavitrolFeature for the tag type.</p>
</li>
<li>
<p>Select BlockStacking tag from the right-side menu. Exit the window from upper right corner.</p>
</li>
<li>
<p>Select unload buffer feature tag by enabling the Load Unload Buffer</p>
</li>
<li>
<p>Adjust the distance for the buffer lane. The purple line indicates the area where the pallets can be unloaded.</p>
</li>
<li>
<p>Next thing is to add estimate for the number of pallets for the lane. This can be set on the Edit Destinations and Resources menu on the Edit Allowed Resources. The quantity number should be quite close to the maximum number of pallets.</p>
</li>
</ol>
<p><img src="./media-en/image7.png" alt="" /></p>
<blockquote>
<p>Figure 5: Setting up the blockstacking feature on Tools.</p>
</blockquote>
<h2 id="parameters"><a class="header" href="#parameters">Parameters</a></h2>
<h3 id="notes-of-navitrol-parameters"><a class="header" href="#notes-of-navitrol-parameters">Notes of Navitrol parameters</a></h3>
<ul>
<li>
<p>First, select the mode with the <strong>block_stacking_mode</strong>. </p>
<ul>
<li>The mode 1 is occupancy check, so basically it means that when searching for the top of the stack, the AGV uses laser scanner to detect when the pallet's top is reached by checking how many scanner points are found on the area where the pallet's front line is. </li>
<li>The mode 3 uses fork sensor information to define when the fork has reached the top of the pallet. </li>
<li>The mode 4 is 3D camera that has interface to Navitrol</li>
<li>The mode 5 is not dependent to any sensor. In this mode, the target is first detected on the ground and then the fork is moved to the estimated height given with the drive order from Navithor. Then AGV waits for a response from <a href="../../TargetAndObstacleDetection/ExternalTargetDetection/ExternalTargetDetection-en.html">external target detection</a> before it can continue driving.</li>
</ul>
</li>
<li>
<p>Occupancy check will use scanner that is attached to the increasing part of the fork. The requirement is that when the fork increases, this scanner can see when the fork has reached to the level of the top pallet.</p>
</li>
<li>
<p>Fork sensor uses ultrasonic or laser sensor to detect when there is pallet on front. In general, this kind of sensor is at the end of the fork and will be used for safety as well.</p>
</li>
<li>
<p>The <strong>block_stacking_offset_mm</strong> parameter defines the distance from the level where we detect the top pallet level to the safe driving level. Depending where the sensor is installed, but in general the AGV can't drive over another pallet when the sensor detects the top of the pallet.</p>
</li>
<li>
<p><strong>Reference step</strong> is added to fork height reference on each code cycle, meaning something like 20ms. This reference will increase fast in order to create smooth increase for the fork. Depending the fork control, this value can be 1 or 2.
Sometimes, the fork is so fast that it reaches the target before it is increased to next step, so it the fork seems to decelerate and accelerate every now and then. Then this parameter should be increased. It is also safe to add large value, something like 500, if the AGV fork controller can control the fork smoothly to high values.</p>
</li>
<li>
<p><strong>Occupancy min hits</strong> is used on occupancy check to define how many scanner points we can have at minimum on the target area. If there are less scanner point on that area, the area is defined as empty.
The target area is calculated as a square from the pallet's front.
The side of this square is the width of the pallet.</p>
</li>
<li>
<p><strong>Use scanner to check safety</strong> - parameter is used in cases, when there is a static scanner that can see on top of another pallet if it has already pallet on top. Should be used only if stacks have two pallets. If there could be more pallets, pallets could have different heights or there is no static scanner that could see to the stack drop-off location, this parameter should be set to 0. If this scanner detects something on the stack drop-off location, block stacking sequence is not started and normal unload is done to the floor in front of the stack. See figures below.</p>
</li>
</ul>
<p><img src="./media-en/OtherScannerToCheckUnloadArea1.png" alt="" /></p>
<blockquote>
<p>Use scanner to check safety - Drop-off to stack allowed. 1. Scanner that is used to scan the stacking height. 2. E.g. navigation scanner. 3. Stacking drop-off area that is empty. In this case, the scanner 1 is first used to detect the pallet on the floor and to define the location of the possible drop-off area to the stack (3). Then the scanner 2 can be used to check if there is already something on that drop-off area. If there is nothing, then AGV will drive closer and use the scanner 1 to scan the height of the pallet to drop-off on top of it.</p>
</blockquote>
<p><img src="./media-en/OtherScannerToCheckUnloadArea2.png" alt="" /></p>
<blockquote>
<p>Use scanner to check safety - Drop-off to stack not allowed. 1. Scanner that is used to scan the stacking height. 2. E.g. navigation scanner. 3. Stacking drop-off area already has a pallet. In this case, the scanner 1 is first used to detect the pallet on the floor and to define the location of the possible drop-off area to the stack (3). Then the scanner 2 can be used to check if there is already something on that drop-off area. If there is something, then AGV will drive closer and drop-off to the floor in front of the stack without scanning the stack.</p>
</blockquote>
<ul>
<li>
<p><strong>Max diff on target pos</strong> - parameter is a safety check that the pallet detection doesn't change the target too much.</p>
</li>
<li>
<p><strong>Dist to check load sensor</strong> - parameter is used to check if the unload is correctly done after we have driven away for this value. This safety check uses load sensor to check if the load is still on board.</p>
</li>
<li>
<p><strong>Dist to unload</strong> - parameter defines the distance from the point where we are lifting the fork to the point where the unload can be done.</p>
</li>
<li>
<p><strong>Max diff from route</strong> - parameter is a safety check for the pallet that is already on the unload location. If this pallet is too far from the route, block stacking is not started for safety reasons. In block stacking, the assumption is that the pallets are always quite straight on the route. Recommended value for this parameter is 0.15 (cm)</p>
</li>
<li>
<p><strong>Min actuator val after ready</strong> - parameter is used to release the AGV for driving after the fork has decreased until this level. This is used after the unload is done and the fork is decreasing to normal route level.</p>
</li>
<li>
<p><strong>Max heading diff</strong> - parameter is safety check for the pallet's heading. If the pallet angle is too high related to the AGV's heading, the block stacking is not started.</p>
</li>
<li>
<p><strong>Block stacking max height</strong> - parameter is used on the increase phase to define what is the maximum level for block stacking. If the fork is increased to this max level and the occupancy check or fork sensor does not detect the top of the pallet, normal unload is done on that position.</p>
</li>
<li>
<p><strong>Max dist to target</strong> - parameter is meant to be used for fork sensor. It was designed to ignore false fork sensor detections before the AGV is close enough to actual the pallet. This parameter can be used also generally to define the distance where the block stacking is started, when using occupancy check.</p>
</li>
<li>
<p><strong>Max extend drive</strong> - parameter is used with fork sensors. When driving to unload buffer, AGV will first calculate the stopping distance in front of the pallet. When AGV has reached this position and fork sensor is not triggered yet, it can drive the distance of this parameter to test if the sensor is triggered. If the sensor is triggered, it will start block stacking, otherwise normal unload is done.</p>
</li>
<li>
<p><strong>Verify unload height</strong> - parameter requires a load sensor that is high when the pallet is on the fork and low when the pallet is not touching the fork level. So, the sensor should inform when the pallet is on the fork when doing the unload and inform when the pallet is placed on top of the other pallet (There is some space between the fork and the pallet). See additional information (<strong>Figure 2</strong>) at the end of this document.</p>
</li>
<li>
<p><strong>Disable fork sensor dist</strong> - parameter is used to avoid doing unload when the AGV is driving normally on top of the pallet and there is another pallet behind. This parameter should be at least the distance between pallets on the row. See Figure 2 at the end of the document.</p>
</li>
</ul>
<h3 id="list-of-navitrol-parameters"><a class="header" href="#list-of-navitrol-parameters">List of Navitrol Parameters</a></h3>
<table><thead><tr><th>Type</th><th>Name</th><th>Min</th><th>Default</th><th>Max</th><th>Information</th></tr></thead><tbody>
<tr><td>Int</td><td>block_stacking_mode</td><td>0</td><td>0</td><td>5</td><td>Mode for detecting the top pallet.<br>0 = Disabled<br>1 = Occupancy check<br>2 = Pallet detection<br>3 = Fork sensor<br>4 = 3D camera<br>5 = Fork is moved to estimated height</td></tr>
<tr><td>Int</td><td>block_stacking_offset_mm</td><td>-2000</td><td>0</td><td>2000</td><td>Offset (in mm) from the height where the top level is detected to the safe unload height</td></tr>
<tr><td>Int</td><td>block_stacking_reference_step_mm</td><td>1</td><td>2</td><td>5000</td><td>Increase value added to the current height on each step in mm</td></tr>
<tr><td>Int</td><td>block_stacking_max_detection_wait_time_ms</td><td>0</td><td>30000</td><td>100000</td><td>Max wait time in ms for target detection in front of the stack. Used in both dropoff and pickup and with 3D camera and external target detection.</td></tr>
<tr><td>Int</td><td>occup_check_min_hits</td><td></td><td>1</td><td></td><td>How many scanner points are allowed on the occupancy area</td></tr>
<tr><td>Int</td><td>block_stacking_use_scanner_to_check_safety</td><td>0</td><td>0</td><td>2</td><td>Use scanner to check if block stacking is safe to start. Checks occupancy on top of the pallet where the block stacking should be done. If there is already something, block stacking is not started<br>1 = rear<br>2 = front scanner</td></tr>
<tr><td>Float</td><td>block_stacking_dist_to_check_load_sensor</td><td>-1.0</td><td>-1.0</td><td>5.0</td><td>This distance is used to check if the unload is actually done when driving out from the unload location using load sensor. The AGV is stopped if it tries to move and the load is still detected. Negative = not used</td></tr>
<tr><td>Float</td><td>block_stacking_dist_to_unload</td><td>-10</td><td>-2.0</td><td>10</td><td>Distance from detected target to the unload location. Calculated from target's front line to the navigation point.</td></tr>
<tr><td>Float</td><td>block_stacking_target_max_diff_from_route</td><td>0.0</td><td>0.1</td><td>2.0</td><td>How far the target can be from the route. If the target is too far, normal unload is done</td></tr>
<tr><td>Int</td><td>block_stacking_min_actuator_val_after_ready_mm</td><td>0</td><td>200</td><td>1000</td><td>&gt; 0 Use softstop to move the fork to this parameter value when driving away from stack. 0 = move the fork while driving</td></tr>
<tr><td>Float</td><td>block_stacking_target_max_heading_diff_deg</td><td>0.0</td><td>15.0</td><td>360.0</td><td>The maximum angle difference between target and the AGV for starting the sequence (in degrees)</td></tr>
<tr><td>Int</td><td>block_stacking_max_height_mm</td><td>0</td><td>1500</td><td>6000</td><td>Max allowed height for the block stacking (in mm). Required to be smaller than actuator_max_val</td></tr>
<tr><td>Float</td><td>block_stacking_max_dist_to_target</td><td>0.0</td><td>2.0</td><td>10.0</td><td>Max allowed distance (in m) from navigation point to target to start block stacking. If distance to the target is higher when block stacking is triggered, pause mode is enabled.</td></tr>
<tr><td>Float</td><td>block_stacking_max_extend_drive</td><td>0.0</td><td>0.2</td><td>1.0</td><td>Max allowed distance (in m) to extend the drive after stopped with unload buffer if fork sensor is not triggered</td></tr>
<tr><td>Int</td><td>block_stacking_verify_unload_height_mm</td><td>0</td><td>0</td><td>500</td><td>0 = not used. Verify unload with external sensor, by decreasing the actuator for value of this parameter and checking the sensor status. If sensor detects the pallet when decreased this amount, warning is triggered. If the sensor doesn't detect the pallet during the decrease, unload is considered to be ready.</td></tr>
<tr><td>Float</td><td>block_stacking_disable_fork_sensor_dist</td><td>0.0</td><td>1.2</td><td>5.0</td><td>Distance from unload location to navigation point to disable fork sensor triggering unload to the route level after the stack height is detected and when AGV has started to drive on top of the stack. This parameter should have a value that is close to the fork length. Used only if <strong>block_stacking_mode</strong> is 3. Idea is that fork sensors are used to trigger unload if they detect something ahead, but they should be disabled as soon as the fork is on top of the stack.</td></tr>
<tr><td>Int</td><td>block_stacking_verify_unload_height_sensor_offset_mm</td><td>-500</td><td>0</td><td>500</td><td>0 = not used. Offset value for the unload height when the actuator is stopped using the load sensor.</td></tr>
<tr><td>Float</td><td>block_stacking_reset_distance_from_increase_location</td><td>0.0</td><td>0.5</td><td>10.0</td><td>Distance to reset the state machine if AGV is far enough from the location where the increase starts.</td></tr>
<tr><td>Float</td><td>block_stacking_max_unload_error_behind_SP</td><td>0.0</td><td>0.05</td><td>1.0</td><td>Tolerance for calculated unload point behind symbolic point. If it is more than this parameter, stacking is not done and unload will be done in front of the pallet.</td></tr>
<tr><td>Int</td><td>block_stacking_pyramid_length_offset_mm</td><td>-5000</td><td>0</td><td>5000</td><td>The length offset for pyramid stacking. Only enabled if the pyramid stacking flag is received from Fleet Control.</td></tr>
<tr><td>Float</td><td>block_stacking_dist_from_stack_to_move_actuator</td><td>0.0</td><td>0.0</td><td>5.0</td><td>Distance [m] from navigation point to the detected pallet front line to stop AGV for increasing the actuator. 0 = Stopping point for actuator increase is defined by parameter <strong>buffer_stop_dist_from_object_when_unloading</strong>.</td></tr>
</tbody></table>
<h3 id="example-sets-of-navitrol-parameters"><a class="header" href="#example-sets-of-navitrol-parameters">Example sets of Navitrol parameters</a></h3>
<h4 id="agv-with-scanner-moving-with-the-fork"><a class="header" href="#agv-with-scanner-moving-with-the-fork">AGV with scanner moving with the fork</a></h4>
<p>This set of parameters is from the fork that has scanner moving with the fork. This one scanner is used to scan the stacking height.</p>
<pre><code class="language-bash">I,block_stacking_mode, 1
I,block_stacking_offset_mm, 54
I,block_stacking_reference_step_mm, 2
I,block_stacking_use_scanner_to_check_safety, 0
F,block_stacking_dist_to_unload, -0.62
F,block_stacking_target_max_diff_from_route, 0.15
F,block_stacking_target_max_heading_diff_deg, 35.0
I,block_stacking_max_height_mm, 1500
F,block_stacking_max_dist_to_target, 2.0
</code></pre>
<h4 id="agv-with-two-static-scanners-and-fork-tip-sensor-to-scan-the-stacking-height"><a class="header" href="#agv-with-two-static-scanners-and-fork-tip-sensor-to-scan-the-stacking-height">AGV with two static scanners and fork tip sensor to scan the stacking height</a></h4>
<p>This set of parameters is from the fork that has fork sensor at the tip of the fork. It has safety scanner below the fork that is used for detecting the pallet before lifting. There is also one scanner on top of the fork that can see on top of the pallet where we are unloading. On that project, block stacking is used to unload two pallets on top of
each other and this scanner on top is used to check if the area on top of one pallet is free.</p>
<pre><code class="language-bash">I,block_stacking_mode, 3
I,block_stacking_offset_mm, 54
I,block_stacking_reference_step_mm, 2
I,block_stacking_use_scanner_to_check_safety, 2
F,block_stacking_dist_to_unload, -0.62
F,block_stacking_target_max_diff_from_route, 0.15
F,block_stacking_target_max_heading_diff_deg, 35.0
I,block_stacking_max_height_mm, 1500
F,block_stacking_max_dist_to_target, 2.0
F,block_stacking_max_extend_drive, 0.2
</code></pre>
<h2 id="notes-for-customer"><a class="header" href="#notes-for-customer">Notes for Customer</a></h2>
<p>For safety reasons, the AGV should reserve the route all the way until the end symbolic point when driving to unload buffer.
Otherwise, the unload buffer area is not checked correctly. This route reservation can be checked with Monitor by checking how far ahead the purple part of the route is. If it doesn't reach the symbolic point when the AGV is at the beginning of the buffer area, increase Navithor parameter TrafficController_LIMIT_FOR_WP_LOCK_SECONDS.</p>
<p>If block stacking is aborted by Navithor while increasing the fork, increase Navithor parameter TrafficController_ABORT_WAIT_TIME_SECONDS. Generally, the abort     shouldn't be happening when the AGV is searching for the top pallet.
Changing the <strong>block_stacking_max_height</strong> - parameter increases  the search time if not found the top pallet, so this abort parameter should be larger than the time that it takes to lift the actuator to this max parameter and back to the floor.</p>
<p>If the fork is stopping or slowing down while trying to increase, check these parameters:</p>
<ul>
<li>
<p>actuator_inner_tolerance_mm</p>
</li>
<li>
<p>actuator_outer_tolerance_mm</p>
</li>
<li>
<p>actuator_inner_tolerance_timer_ms</p>
</li>
<li>
<p>block_stacking_reference_step_mm</p>
</li>
</ul>
<p>If the reference step is too slow, the fork might reach the tolerance too fast and stop the control for a while before the reference start increasing again. Increasing the inner tolerance timer might help but it always depends on how fast is the fork actuator control.</p>
<p>If the pallet top is not static or the pallet top is hard to find with fork sensors due to an object on top, try setting <strong>block_stacking_verify_unload_height_mm</strong> parameter to for example 0.2 m. See Figure 6 as an example when there is something on top of the pallet. This parameter requires a load sensor that can detect when the pallet is not anymore on the fork when decreasing it to the other pallet. The idea with this parameter is that the fork is decreased this parameter amount from the calculated unload height and stopped if the load sensor doesn't detect the pallet anymore or if the fork reaches this new target height.</p>
<p><img src="./media-en/image8.png" alt="" /></p>
<blockquote>
<p>Figure 6: Detecting wrong height due to some object is on top of the pallet.</p>
</blockquote>
<p>The red object on top of the pallet is the plastic or some other light thing that causes the block stacking to go too high, because we can't detect the static top of the pallet. This object should be so light that the pallet can be unloaded on top of it. The red dashed line is the error height, that should be the set to this  <strong>verify_unload_height -</strong> parameter. Without this new sensor check, the block stacking would do the unload based on the height of the object and then the pallet would not touch the static pallet top when trying to unload resulting the AGV to carry the pallet away.</p>
<p><img src="./media-en/image9.png" alt="" /></p>
<blockquote>
<p>Figure 7: Minimum value for disabling fork sensor and the normal unload to the route level.</p>
</blockquote>
<p>When the AGV is approaching to the pallet, the AGV can perform unload to the ground if the fork sensors are triggered. This might be caused by humans walking in front of the AGV and triggering the block stacking sequence too early. Then the height is detected to wrong height. But in normal case, this shouldn't be triggered and that's why the disable <strong>fork sensor dist</strong> - parameter should be at least the distance between the pallets.</p>
<p>If something goes wrong and blockstacking cannot be completed, its state machine can be reset by driving away from the location where the increase phase was done. The AGV has to drive <strong>block_stacking_reset_distance_from_increase_location</strong> amount away from the increase location, 0.5m by default, to reset the state machine. Then the blockstacking can be tried again. This figure down below shows the location where the state is reset. The sate is reset even though AGV is driven manually away, because it     only checks that navigation point is far enough from the precalculated unload location.</p>
<p><img src="./media-en/image10.png" alt="" /></p>
<blockquote>
<p>Figure 8: Location where the state machine is reset if something goes wrong. Defined with block_stacking_reset_distance_from_increase_location.</p>
</blockquote>
<p>Navitrol will remember the distance to the stack, when the AGV starts to increase the fork when driving towards the stack. Then when AGV is driving away after it has unloaded the pallet, this same distance is used to let the fork to be controlled to the route height. One exception is the case, when AGV is driving to empty buffer lane. Then the distance is the difference between these parameters: <strong>buffer_stop_dist_from_object_when_unloading</strong> - <strong>block_stacking_dist_to_unload</strong>.</p>
<h2 id="troubleshooting"><a class="header" href="#troubleshooting">Troubleshooting</a></h2>
<h3 id="agv-does-drop-off-in-front-of-stack-without-scanning"><a class="header" href="#agv-does-drop-off-in-front-of-stack-without-scanning">AGV does drop-off in front of stack without scanning</a></h3>
<h4 id="stacking-tag-missing-or-stacking-not-allowed"><a class="header" href="#stacking-tag-missing-or-stacking-not-allowed">Stacking tag missing or stacking not allowed</a></h4>
<ul>
<li>Check that symbolic point is Buffer lane and has Blockstacking tag or that Navithor has sent stacking allowed with the drive order.
<ul>
<li>This kind of log line shows Navithor stack data: &quot;ParseDriveCommandV2 received Buffer data. <strong>Stack 1</strong>, estimated height 0, max height 0&quot;</li>
<li>Navithor can order stacking without Blockstacking tag.</li>
</ul>
</li>
</ul>
<h4 id="scanner-sees-something-on-top-of-the-stack"><a class="header" href="#scanner-sees-something-on-top-of-the-stack">Scanner sees something on top of the stack</a></h4>
<ul>
<li>block_stacking_use_scanner_to_check_safety is nonzero and defined scanner sees something on top of the stack.</li>
<li>This kind of log line: &quot;BlockStacking: Sequence couldn't be started. PauseOk 1, <strong>unloadAreaOk 0</strong>, targetDistOk 1, targetAngleOk 1, targetFound 1, distOk 1, Drive end (44.32, 11.99)&quot;</li>
</ul>
<h4 id="pallet-not-detected"><a class="header" href="#pallet-not-detected">Pallet not detected</a></h4>
<ul>
<li>Pallet is required to be detected to start the stacking sequence</li>
<li>This kind of log line: &quot;BlockStacking: Sequence couldn't be started. PauseOk 1, unloadAreaOk 1, targetDistOk 0, targetAngleOk 0, <strong>targetFound 0</strong>, distOk 1, Drive end (44.32, 11.99)&quot;</li>
</ul>
<h4 id="pallet-too-far-from-route"><a class="header" href="#pallet-too-far-from-route">Pallet too far from route</a></h4>
<ul>
<li>block_stacking_target_max_diff_from_route is too small or pallet is too far to the side from the route.</li>
<li>This kind of log line: &quot;BlockStacking: Sequence couldn't be started. PauseOk 1, unloadAreaOk 1, <strong>targetDistOk 0</strong>, targetAngleOk 1, targetFound 1, distOk 1, Drive end (44.32, 11.99)&quot;</li>
</ul>
<h4 id="pallet-angle-difference-relative-to-the-route-is-too-high"><a class="header" href="#pallet-angle-difference-relative-to-the-route-is-too-high">Pallet angle difference relative to the route is too high</a></h4>
<ul>
<li>block_stacking_target_max_heading_diff_deg is too small or pallet angle is too high relative to the route.</li>
<li>This kind of log line: &quot;BlockStacking: Sequence couldn't be started. PauseOk 1, unloadAreaOk 1, targetDistOk 1, <strong>targetAngleOk 0</strong>, targetFound 1, distOk 1, Drive end (44.32, 11.99)&quot;</li>
</ul>
<h4 id="stacking-drop-off-point-too-far-from-symbolic-point"><a class="header" href="#stacking-drop-off-point-too-far-from-symbolic-point">Stacking drop-off point too far from symbolic point</a></h4>
<ul>
<li>block_stacking_max_unload_error_behind_SP is too small or pallet detected on the floor is too far behind symbolic point</li>
<li>This kind of log line: &quot;BlockStacking: Target found, but couldn't start increase. Increase 1, <strong>isStackinUnloadPointValid 0</strong>, distToStartIncrease 0.5, Drive end (44.32, 11.99)&quot;</li>
</ul>
<h3 id="agv-does-drop-off-too-high-in-stack"><a class="header" href="#agv-does-drop-off-too-high-in-stack">AGV does drop-off too high in stack</a></h3>
<p>Detected stack height is too high. If this happens multiple times, decrease <strong>block_stacking_offset_mm</strong>.</p>
<h3 id="agv-drives-too-much-in-to-the-stack"><a class="header" href="#agv-drives-too-much-in-to-the-stack">AGV drives too much in to the stack</a></h3>
<p>AGV stops too late when doing drop-off to the stack. If this happens multiple times, modify <strong>block_stacking_dist_to_unload</strong> closer to 0.</p>
<h3 id="agv-does-drop-off-too-early-on-the-stack"><a class="header" href="#agv-does-drop-off-too-early-on-the-stack">AGV does drop-off too early on the stack</a></h3>
<p>AGV stops too early when doing drop-off to the stack. If this happens multiple times, change <strong>block_stacking_dist_to_unload</strong> higher.</p>
<h3 id="agv-does-drop-off-in-front-of-stack-after-scanning"><a class="header" href="#agv-does-drop-off-in-front-of-stack-after-scanning">AGV does drop-off in front of stack after scanning</a></h3>
<p>The fork reached the maximum height while scanning the stack height. See <strong>block_stacking_max_height_mm</strong> parameter.</p>
<ul>
<li>There is also possibility to get this maximum height from Navithor with Drive order. If Navithor sends 0, then this parameter is used instead. </li>
<li>This kind of log line: &quot;ParseDriveCommandV2 received Buffer data. Stack 0, estimated height 0, <strong>max height 2000</strong>&quot;</li>
</ul>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                                                    <a rel="prev" href="../../LoadHandling/StackLoading/StackLoading-en.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                        
                                                    <a rel="next" href="../../LoadHandling/DistanceToTarget/DistanceToTarget-en.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                                    <a rel="prev" href="../../LoadHandling/StackLoading/StackLoading-en.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                
                                    <a rel="next" href="../../LoadHandling/DistanceToTarget/DistanceToTarget-en.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
                            </nav>

        </div>

        
        
        
                <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        
        
                <script src="../../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../searcher.js" type="text/javascript" charset="utf-8"></script>
        
        <script src="../../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        
        
    </body>
</html>
